[
  {
    "id": "1Password",
    "title": "1Password",
    "publisher": "1Password",
    "descriptionMarkdown": "The [1Password](https://www.1password.com) solution for Microsoft Sentinel enables you to ingest sign-in attempts, item usage, and audit events from your 1Password Business account using the [1Password Events Reporting API](https://developer.1password.com/docs/events-api). This allows you to monitor and investigate events in 1Password in Microsoft Sentinel along with the other applications and services your organization uses.\n\n**Underlying Microsoft Technologies used:**\n\nThis solution depends on the following technologies, and some of which may be in [Preview](https://azure.microsoft.com/support/legal/preview-supplemental-terms/) state or may incur additional ingestion or operational costs:\n\n-  [Azure Functions](https://azure.microsoft.com/services/functions/#overview)",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "1Password",
        "baseQuery": "OnePasswordEventLogs_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Users",
        "query": "OnePasswordEventLogs_CL\n | summarize count() by tostring(target_user.name) \n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "OnePasswordEventLogs_CL",
        "lastDataReceivedQuery": "OnePasswordEventLogs_CL\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "OnePasswordEventLogs_CL\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "1Password Events API Token",
          "description": "A 1Password Events API Token is required. [See the documentation to learn more about the 1Password API](https://developer.1password.com/docs/events-api/reference). \n\n**Note:** A 1Password Business account is required"
        }
      ]
    },
    "instructionSteps": [
      {
        "description": ">**NOTE:** This connector uses Azure Functions to connect to 1Password to pull logs into Microsoft Sentinel. This might result in additional data ingestion costs from Azure. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "description": "**STEP 1 - Configuration steps for the 1Password Events Reporting API**\n\n [Follow these instructions](https://support.1password.com/events-reporting/#appendix-issue-or-revoke-bearer-tokens) provided by 1Password to obtain an Events Reporting API Token. **Note:** A 1Password Business account is required"
      },
      {
        "description": "**STEP 2 - Deploy the functionApp using DeployToAzure button to create the table, dcr and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the 1Password connector, a custom table needs to be created."
      },
      {
        "description": "This method provides an automated deployment of the 1Password connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-OnePassword-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace Name**, **Workspace Name**, **1Password Events API Key**, and **URI**.\n - The default **Time Interval** is set to five (5) minutes. If you'd like to modify the interval, you can adjust the Function App Timer Trigger accordingly (in the function.json file, post deployment) to prevent overlapping data ingestion.\n - Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy.",
        "title": "Option 1 - Azure Resource Manager (ARM) Template"
      }
    ]
  },
  {
    "id": "1PasswordCCPDefinition",
    "title": "1Password (Serverless)",
    "publisher": "1Password",
    "descriptionMarkdown": "The 1Password CCP connector allows the user to ingest 1Password Audit, Signin & ItemUsage events into Microsoft Sentinel.",
    "graphQueries": [
      {
        "metricName": "Total Sign In Attempts received",
        "legend": "SignIn Attempts",
        "baseQuery": "{{graphQueriesTableName}} | where log_source == 'signinattempts'"
      },
      {
        "metricName": "Total Audit Events received",
        "legend": "Audit Events",
        "baseQuery": "{{graphQueriesTableName}} | where log_source == 'auditevents'"
      },
      {
        "metricName": "Total Item Usage Events received",
        "legend": "Item Usage Events",
        "baseQuery": "{{graphQueriesTableName}} | where log_source == 'itemusages'"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of 1Password events",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "OnePasswordEventLogs_CL",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": null,
    "metadata": null
  },
  {
    "id": "42CrunchAPIProtection",
    "title": "API Protection",
    "publisher": "42Crunch",
    "descriptionMarkdown": "Connects the 42Crunch API protection to Azure Log Analytics via the REST API interface",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "42Crunch",
        "baseQuery": "apifirewall_log_1_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "API requests that were rate-limited",
        "query": "apifirewall_log_1_CL\n| where TimeGenerated >= ago(30d)\n| where Status_d == 429"
      },
      {
        "description": "API requests generating a server error",
        "query": "apifirewall_log_1_CL\n| where TimeGenerated >= ago(30d)\n| where Status_d >= 500 and Status_d <= 599"
      },
      {
        "description": "API requests failing JWT validation",
        "query": "apifirewall_log_1_CL\n| where TimeGenerated >= ago(30d)\n| where Error_Message_s contains \"missing [\\\"x-access-token\\\"]\""
      }
    ],
    "dataTypes": [
      {
        "name": "apifirewall_log_1_CL",
        "lastDataReceivedQuery": "apifirewall_log_1_CL\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "apifirewall_log_1_CL\n| summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Step 1 : Read the detailed documentation",
        "description": "The installation process is documented in great detail in the GitHub repository [Microsoft Sentinel integration](https://github.com/42Crunch/azure-sentinel-integration). The user should consult this repository further to understand installation and debug of the integration."
      },
      {
        "title": "Step 2: Retrieve the workspace access credentials",
        "description": "The first installation step is to retrieve both your **Workspace ID** and **Primary Key** from the Microsoft Sentinel platform.\nCopy the values shown below and save them for configuration of the API log forwarder integration.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Step 3: Install the 42Crunch protection and log forwarder",
        "description": "The next step is to install the 42Crunch protection and log forwarder to protect your API. Both components are availabe as containers from the [42Crunch repository](https://hub.docker.com/u/42crunch). The exact installation will depend on your environment, consult the [42Crunch protection documentation](https://docs.42crunch.com/latest/content/concepts/api_firewall_deployment_architecture.htm) for full details. Two common installation scenarios are described below:\n",
        "innerSteps": [
          {
            "title": "Installation via Docker Compose",
            "description": "The solution can be installed using a [Docker compose file](https://github.com/42Crunch/azure-sentinel-integration/blob/main/sample-deployment/docker-compose.yml)."
          },
          {
            "title": "Installation via Helm charts",
            "description": "The solution can be installed using a [Helm chart](https://github.com/42Crunch/azure-sentinel-integration/tree/main/helm/sentinel)."
          }
        ]
      },
      {
        "title": "Step 4: Test the data ingestion",
        "description": "In order to test the data ingestion the user should deploy the sample *httpbin* application alongside the 42Crunch protection and log forwarder [described in detail here](https://github.com/42Crunch/azure-sentinel-integration/tree/main/sample-deployment).",
        "innerSteps": [
          {
            "title": "4.1 Install the sample",
            "description": "The sample application can be installed locally using a [Docker compose file](https://github.com/42Crunch/azure-sentinel-integration/blob/main/sample-deployment/docker-compose.yml) which will install the httpbin API server, the 42Crunch API protection and the Microsoft Sentinel log forwarder. Set the environment variables as required using the values copied from step 2."
          },
          {
            "title": "4.2 Run the sample",
            "description": "Verfify the API protection is connected to the 42Crunch platform, and then exercise the API locally on the *localhost* at port 8080 using Postman, curl, or similar. You should see a mixture of passing and failing API calls. "
          },
          {
            "title": "4.3 Verify the data ingestion on Log Analytics",
            "description": "After approximately 20 minutes access the Log Analytics workspace on your Microsoft Sentinel installation, and locate the *Custom Logs* section verify that a *apifirewall_log_1_CL* table exists. Use the sample queries to examine the data."
          }
        ]
      }
    ],
    "metadata": {
      "id": "0116a50c-9282-4237-9962-4da1dfcbfb55",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "42Crunch"
      },
      "support": {
        "tier": "community",
        "name": "42Crunch",
        "email": "support@42crunch.com",
        "link": "https://github.com/42Crunch/azure-sentinel-integration"
      }
    }
  },
  {
    "id": "AbnormalSecurity",
    "title": "AbnormalSecurity ",
    "publisher": "AbnormalSecurity",
    "descriptionMarkdown": "The Abnormal Security data connector provides the capability to ingest threat and case logs into Microsoft Sentinel using the [Abnormal Security Rest API.](https://app.swaggerhub.com/apis/abnormal-security/abx/)",
    "graphQueries": [
      {
        "metricName": "Abnormal Security Threat Logs",
        "legend": "ABNORMAL_THREAT_MESSAGES_CL",
        "baseQuery": "ABNORMAL_THREAT_MESSAGES_CL"
      },
      {
        "metricName": "Abnormal Security Account Takeover Case Logs",
        "legend": "ABNORMAL_CASES_CL",
        "baseQuery": "ABNORMAL_CASES_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Abnormal Security Threat logs",
        "query": "ABNORMAL_THREAT_MESSAGES_CL\n| sort by TimeGenerated desc"
      },
      {
        "description": "All Abnormal Security Case logs",
        "query": "ABNORMAL_CASES_CL\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "ABNORMAL_THREAT_MESSAGES_CL",
        "lastDataReceivedQuery": "ABNORMAL_THREAT_MESSAGES_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ABNORMAL_CASES_CL",
        "lastDataReceivedQuery": "ABNORMAL_CASES_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ABNORMAL_CASES_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "ABNORMAL_THREAT_MESSAGES_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Abnormal Security API Token",
          "description": "An Abnormal Security API Token is required. [See the documentation to learn more about Abnormal Security API](https://app.swaggerhub.com/apis/abnormal-security/abx/). **Note:** An Abnormal Security account is required"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to Abnormal Security's REST API to pull logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the Abnormal Security API**\n\n [Follow these instructions](https://app.swaggerhub.com/apis/abnormal-security/abx) provided by Abnormal Security to configure the REST API integration. **Note:** An Abnormal Security account is required"
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Abnormal Security data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following), as well as the Abnormal Security API Authorization Token, readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "This method provides an automated deployment of the Abnormal Security connector using an ARM Template.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-abnormalsecurity-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Microsoft Sentinel Workspace ID**, **Microsoft Sentinel Shared Key** and **Abnormal Security REST API Key**.\n - The default **Time Interval** is set to pull the last five (5) minutes of data. If the time interval needs to be modified, it is recommended to change the Function App Timer Trigger accordingly (in the function.json file, post deployment) to prevent overlapping data ingestion.\n 4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the Abnormal Security data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/create-first-function-vs-code-python) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-abnormalsecurity-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. AbnormalSecurityXX).\n\n\te. **Select a runtime:** Choose Python 3.11.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tSENTINEL_WORKSPACE_ID\n\t\tSENTINEL_SHARED_KEY\n\t\tABNORMAL_SECURITY_REST_API_TOKEN\n\t\tlogAnalyticsUri (optional)\n(add any other settings required by the Function App)\nSet the `uri` value to: `<add uri value>` \n>Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Azure Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details.\n - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us.` \n4. Once all application settings have been entered, click **Save**."
      }
    ],
    "metadata": {
      "id": "fe1b4806-215b-4610-bf95-965a7a65579c",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "AbnormalSecurity"
      },
      "author": {
        "name": "Abnormal Security"
      },
      "support": {
        "tier": "developer",
        "name": "Abnormal Security",
        "link": "https://abnormalsecurity.com/contact"
      }
    }
  },
  {
    "id": "Agari",
    "title": "Agari Phishing Defense and Brand Protection",
    "publisher": "Agari",
    "descriptionMarkdown": "This connector uses a Agari REST API connection to push data into Azure Sentinel Log Analytics.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "agari_bpalerts_log_CL",
        "baseQuery": "agari_bpalerts_log_CL"
      },
      {
        "metricName": "Total data received",
        "legend": "agari_apdpolicy_log_CL",
        "baseQuery": "agari_apdpolicy_log_CL"
      },
      {
        "metricName": "Total data received",
        "legend": "agari_apdtc_log_CL",
        "baseQuery": "agari_apdtc_log_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Summary by Attack Type",
        "query": "agari_apdtc_log_CL\n            | summarize Count=count() by attack_types_s"
      },
      {
        "description": "Summary of Policy Hits",
        "query": "agari_apdpolicy_log_CL\n            | summarize Count=count() by alert_definition_name_s"
      }
    ],
    "dataTypes": [
      {
        "name": "agari_bpalerts_log_CL",
        "lastDataReceivedQuery": "agari_bpalerts_log_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "agari_apdtc_log_CL",
        "lastDataReceivedQuery": "agari_apdtc_log_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "agari_apdpolicy_log_CL",
        "lastDataReceivedQuery": "agari_apdpolicy_log_CL\n            | summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "agari_bpalerts_log_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "agari_apdtc_log_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "agari_apdpolicy_log_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Agari Phishing Defense, Phishing Response or Brand Protection API Client ID and Secret",
          "description": "Ensure you have your Client ID and Secret keys. Instructions can be found on the [Agari Developers Site](https://developers.agari.com/agari-platform/docs/quick-start)."
        },
        {
          "name": "(Optional) Microsoft Security Graph API",
          "description": "The Agari Function App has the ability to share threat intelleigence with Sentinel via the Security Graph API. To use this feature, you will need to enable the [Sentinel Threat Intelligence Platforms connector](https://docs.microsoft.com/azure/sentinel/connect-threat-intelligence) as well as register an application in Azure Active Directory. "
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Agari APIs to pull its logs into Azure Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "STEP 1 - Get your Agari API credentials",
        "description": "\n1. Log into any Agari product (Client ID and Secret are the same for all applications) \n2. Click on your username in the upper right and select **Settings**\n3. Click on the **Generate API Secret** link to generate an API client_id and client_secret (the link will read **Regenerate API Secret** if you have already generated an API client ID/secret previously)\n4. Copy both the client_id and client_secret that are generated"
      },
      {
        "title": "STEP 2 - (Optional) Enable the Security Graph API",
        "description": "Follow the instrcutions found on article [Connect Azure Sentinel to your threat intelligence platform](https://docs.microsoft.com/azure/sentinel/connect-threat-intelligence#connect-azure-sentinel-to-your-threat-intelligence-platform). Once the application is created you will need to record the Tenant ID, Client ID and Client Secret."
      },
      {
        "title": "STEP 3 - Deploy the connector and the associated Azure Function",
        "description": "\n>**IMPORTANT:** Before deploying the Agari Connector, have the Workspace ID and Workspace Primary Key (can be copied from the following), as well as the Agari API credentials from the previous step.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Choose a deployement option",
        "description": ""
      },
      {
        "title": "Option 1: Deploy using the Azure Resource Manager (ARM) Template",
        "description": "1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-agari-azuredeploy) \n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace ID**, **Workspace Key**, **Agari Client ID**, **Agari Client Secret**, select `True` or `False` for the products you subscribe to, and if you wish to share IoCs with Sentinel, select `True` For **Enable Security Graph Sharing**, and enter the required IDs from the Azure Application.\n> - The Function App will request data from the Agari APIs every 5 minutes, corresponding to the Funciton App Timer.\n> - Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy.\n6. **NOTE:** Due to the use of Environment Variables to store log access times, the App requires 1 additonal manual step. In the Function App, select the Function App Name and select Click on **Identity** and for System assigned Identity, click on **Azure role assignments** and **Add Role assignment**. Select **Subscription** as the scope, select your subscription and set the Role to **Contributor**. Click on **Save**."
      },
      {
        "title": "Option 2: Manual Deployment of Azure Functions",
        "description": "**1. Create a Function App**\n\n1.  From the Azure Portal, navigate to [Function App](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Web%2Fsites/kind/functionapp), and select **+ Add**.\n2. In the **Basics** tab, ensure Runtime stack is set to **Powershell Core**. \n3. In the **Hosting** tab, ensure the **Consumption (Serverless)** plan type is selected.\n4. Make other preferrable configuration changes, if needed, then click **Create**."
      },
      {
        "title": "",
        "description": "**2. Import Function App Code**\n\n1. In the newly created Function App, select **Functions** on the left pane and click **+ Add**.\n2. Click on **Code + Test** on the left pane. \n3. Copy the [Function App Code](https://aka.ms/sentinel-agari-functionapp) and paste into the Function App `run.ps1` editor.\n3. Click **Save**."
      },
      {
        "title": "",
        "description": "**3. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following eight to twelve (8-12) application settings individually, with their respective string values (case-sensitive): \n\t\tclientID\n\t\tclientSecret\n\t\tworkspaceID\n\t\tworkspaceKey\n\t\tenableBrandProtectionAPI\n\t\tenablePhishingResponseAPI\n\t\tenablePhishingDefenseAPI\n\t\tresGroup\n\t\tfunctionName\n\t\tsubId\n\t\tenableSecurityGraphSharing\n\t\t<--- Required if enableSecurityGraphSharing is set to true --->\n\t\tGraphTenantId\n\t\tGraphClientId\n\t\tGraphClientSecret\n\t\tlogAnalyticsUri (optional)\n> - Enter your Agari ClientID and Secret in 'clientId' and 'clientSecret'\n> - Enter 'true' or 'false' for 'enablePhishingDefense', 'enableBrandProtection', 'enablePhishingResponse' as per your product subscriptions.\n> - Enter your Resource Group name in resGroup, the name of the Function (from previous step) in functionName and your Subscription ID in subId.\n> - Enter 'true' or 'false' for 'enableSecurtyGraphAPI'. If you are enabling the Security Graph, the 'GraphTenantId','GraphClientId', and 'GraphClientSecret' is required.\n> - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n"
      },
      {
        "title": "",
        "description": "**4. Set Permissions for the App**\n\n1. In the Function App, select the Function App Name and select Click on **Identity** and for System assigned Identity, set the status to On. \n\n2. Next, click on **Azure role assignments** and **Add Role assignment**. Select **Subscription** as the scope, select your subscription and set the Role to **Contributor**. Click on **Save**."
      },
      {
        "title": "",
        "description": "**5. Complete Setup.**\n\n1. Once all application settings have been entered, click **Save**. Note that it will take some time to have the required dependencies download, so you may see some inital failure messages."
      }
    ],
    "metadata": {
      "id": "152fa8d4-b84b-4370-8317-b63ed52f9fe3",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Agari"
      },
      "support": {
        "name": "Agari",
        "link": "https://support.agari.com/hc/en-us/articles/360000645632-How-to-access-Agari-Support",
        "tier": "developer"
      }
    }
  },
  {
    "id": "AIVectraDetect",
    "title": "[Deprecated] Vectra AI Detect via Legacy Agent",
    "publisher": "Vectra AI",
    "descriptionMarkdown": "The AI Vectra Detect connector allows users to connect Vectra Detect logs with Microsoft Sentinel, to view dashboards, create custom alerts, and improve investigation. This gives users more insight into their organization's network and improves their security operation capabilities.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "AIVectraDetect",
        "baseQuery": "\nCommonSecurityLog\n| where DeviceVendor == \"Vectra Networks\"\n| where DeviceProduct == \"X Series\"\n"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"Vectra Networks\"\n| where DeviceProduct  == \"X Series\"\n| sort by TimeGenerated \n"
      },
      {
        "description": "Host Count by Severity",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"Vectra Networks\" and DeviceEventClassID == \"hsc\"\n| extend src = coalesce(SourceHostName, SourceIP)\n| summarize arg_max(TimeGenerated, *) by src\n| extend status = case(FlexNumber1>=50 and FlexNumber2<50, \"High\",  FlexNumber1>=50 and FlexNumber2>=50, \"Critical\",  FlexNumber1<50 and FlexNumber2>=50, \"Medium\",  FlexNumber1>0 and FlexNumber1<50 and FlexNumber2>0 and FlexNumber2<50,\"Low\",  \"Other\")\n| where status != \"Other\"\n| summarize Count = count() by status"
      },
      {
        "description": "List of worst offenders",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"Vectra Networks\" and DeviceEventClassID == \"hsc\"\n| extend src = coalesce(SourceHostName, SourceIP)\n| summarize arg_max(TimeGenerated, *) by src\n| sort by FlexNumber1 desc, FlexNumber2 desc\n| limit 10\n| project row_number(), src, SourceIP, FlexNumber1 , FlexNumber2, TimeGenerated\n| project-rename Sr_No = Column1, Source = src, Source_IP = SourceIP, Threat = FlexNumber1, Certainty = FlexNumber2, Latest_Detection = TimeGenerated"
      },
      {
        "description": "Top 10 Detection Types",
        "query": "CommonSecurityLog\r\n| extend ExternalID = coalesce(column_ifexists(\"ExtID\", \"\"), tostring(ExternalID), \"\")\r\n| where DeviceVendor == \"Vectra Networks\" and DeviceEventClassID !in (\"health\", \"audit\", \"campaigns\", \"hsc\", \"asc\") and isnotnull(ExternalID)\r\n| summarize Count = count() by DeviceEventClassID\r\n| top 10 by Count desc"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (AIVectraDetect)",
        "lastDataReceivedQuery": "\nCommonSecurityLog\n| where DeviceVendor == \"Vectra Networks\"\n| where DeviceProduct == \"X Series\"\n\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "\nCommonSecurityLog\n| where DeviceVendor == \"Vectra Networks\"\n| where DeviceProduct == \"X Series\"\n\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 over TCP, UDP or TLS.\n\n> 1. Make sure that you have Python on your machine using the following command: python --version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward AI Vectra Detect logs to Syslog agent in CEF format",
        "description": "Configure Vectra (X Series) Agent to forward Syslog messages in CEF format to your Microsoft Sentinel workspace via the Syslog agent.\n\nFrom the Vectra UI, navigate to Settings > Notifications and Edit Syslog configuration. Follow below instructions to set up the connection:\n\n- Add a new Destination (which is the host where the Microsoft Sentinel Syslog Agent is running)\n\n- Set the Port as **514**\n\n- Set the Protocol as **UDP**\n\n- Set the format to **CEF**\n\n- Set Log types (Select all log types available)\n\n- Click on **Save**\n\nUser can click the **Test** button to force send some test events.\n\n For more information, refer to Cognito Detect Syslog Guide which can be downloaded from the ressource page in Detect UI."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python --version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "2de7b355-5f0b-4eb1-a264-629314ef86e5",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Vectra AI"
      },
      "support": {
        "name": "Vectra AI",
        "link": "https://www.vectra.ai/support",
        "tier": "developer"
      }
    }
  },
  {
    "id": "AIVectraDetectAma",
    "title": "[Deprecated] Vectra AI Detect via AMA",
    "publisher": "Vectra AI",
    "descriptionMarkdown": "The AI Vectra Detect connector allows users to connect Vectra Detect logs with Microsoft Sentinel, to view dashboards, create custom alerts, and improve investigation. This gives users more insight into their organization's network and improves their security operation capabilities.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "AIVectraDetect",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Vectra Networks' \n |where DeviceProduct=~ 'X Series'\n |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"Vectra Networks\"\n| where DeviceProduct  == \"X Series\"\n| sort by TimeGenerated \n"
      },
      {
        "description": "Host Count by Severity",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"Vectra Networks\" and DeviceEventClassID == \"hsc\"\n| extend src = coalesce(SourceHostName, SourceIP)\n| summarize arg_max(TimeGenerated, *) by src\n| extend status = case(FlexNumber1>=50 and FlexNumber2<50, \"High\",  FlexNumber1>=50 and FlexNumber2>=50, \"Critical\",  FlexNumber1<50 and FlexNumber2>=50, \"Medium\",  FlexNumber1>0 and FlexNumber1<50 and FlexNumber2>0 and FlexNumber2<50,\"Low\",  \"Other\")\n| where status != \"Other\"\n| summarize Count = count() by status"
      },
      {
        "description": "List of worst offenders",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"Vectra Networks\" and DeviceEventClassID == \"hsc\"\n| extend src = coalesce(SourceHostName, SourceIP)\n| summarize arg_max(TimeGenerated, *) by src\n| sort by FlexNumber1 desc, FlexNumber2 desc\n| limit 10\n| project row_number(), src, SourceIP, FlexNumber1 , FlexNumber2, TimeGenerated\n| project-rename Sr_No = Column1, Source = src, Source_IP = SourceIP, Threat = FlexNumber1, Certainty = FlexNumber2, Latest_Detection = TimeGenerated"
      },
      {
        "description": "Top 10 Detection Types",
        "query": "CommonSecurityLog\r\n| extend ExternalID = coalesce(column_ifexists(\"ExtID\", \"\"), tostring(ExternalID), \"\")\r\n| where DeviceVendor == \"Vectra Networks\" and DeviceEventClassID !in (\"health\", \"audit\", \"campaigns\", \"hsc\", \"asc\") and isnotnull(ExternalID)\r\n| summarize Count = count() by DeviceEventClassID\r\n| top 10 by Count desc"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (AIVectraDetect)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Vectra Networks' \n |where DeviceProduct=~ 'X Series'\n |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'Vectra Networks' \n |where DeviceProduct=~ 'X Series'\n |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine"
                },
                {
                  "title": "Step B. Forward AI Vectra Detect logs to Syslog agent in CEF format",
                  "description": "Configure Vectra (X Series) Agent to forward Syslog messages in CEF format to your Microsoft Sentinel workspace via the Syslog agent.\n\nFrom the Vectra UI, navigate to Settings > Notifications and Edit Syslog configuration. Follow below instructions to set up the connection:\n\n- Add a new Destination (which is the host where the Microsoft Sentinel Syslog Agent is running)\n\n- Set the Port as **514**\n\n- Set the Protocol as **UDP**\n\n- Set the format to **CEF**\n\n- Set Log types (Select all log types available)\n\n- Click on **Save**\n\nUser can click the **Test** button to force send some test events.\n\n For more information, refer to Cognito Detect Syslog Guide which can be downloaded from the ressource page in Detect UI."
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "2de7b355-5f0b-4eb1-a264-629314ef86e5",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Vectra AI"
      },
      "support": {
        "name": "Vectra AI",
        "link": "https://www.vectra.ai/support",
        "tier": "developer"
      }
    }
  },
  {
    "id": "AIVectraStream",
    "title": "AI Vectra Stream via Legacy Agent",
    "publisher": "Vectra AI",
    "descriptionMarkdown": "The AI Vectra Stream connector allows to send Network Metadata collected by Vectra Sensors accross the Network and Cloud to Microsoft Sentinel",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected [**VectraStream**](https://aka.ms/sentinel-aivectrastream-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "VectraStream_CL",
        "baseQuery": "VectraStream_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "List all DNS Queries",
        "query": "VectraStream \n| where metadata_type == \"metadat_dns\" \n| project orig_hostname, id_orig_h, resp_hostname, id_resp_h, id_resp_p, qtype_name, ['query'], answers"
      },
      {
        "description": "Number of DNS requests per type",
        "query": "VectraStream \n| where metadata_type == \"metadat_dns\" \n| summarize count() by qtype_name"
      },
      {
        "description": "Top 10 of query to non existing domain",
        "query": "VectraStream \n| where metadata_type == \"metadat_dns\" \n| where rcode_name == \"NXDomain\"\n| summarize Count=count() by tostring(query)\n| order by Count desc\n| limit 10"
      },
      {
        "description": "Host and Web sites using non-ephemeral Diffie-Hellman key exchange",
        "query": "VectraStream \n| where metadata_type == \"metadat_dns\" \n| where cipher contains \"TLS_RSA\"\n| distinct orig_hostname, id_orig_h, id_resp_h, server_name, cipher\n| project orig_hostname, id_orig_h, id_resp_h, server_name, cipher"
      }
    ],
    "dataTypes": [
      {
        "name": "VectraStream_CL",
        "lastDataReceivedQuery": "\nVectraStream\n |  summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "\nVectraStream\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Vectra AI Brain",
          "description": "must be configured to export Stream metadata in JSON"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected **VectraStream** which is deployed with the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux",
        "description": "Install the Linux agent on sperate Linux instance.\n\n> Logs are collected only from **Linux** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Linux agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Follow the configuration steps below to get Vectra Stream metadata into Microsoft Sentinel. The Log Analytics agent is leveraged to send custom JSON into Azure Monitor, enabling the storage of the metadata into a custom table. For more information, refer to the [Azure Monitor Documentation](https://docs.microsoft.com/azure/azure-monitor/agents/data-sources-json).\n1. Download config file for the log analytics agent: VectraStream.conf (located in the Connector folder within the Vectra solution: https://aka.ms/sentinel-aivectrastream-conf).\n2. Login to the server where you have installed Azure Log Analytics agent.\n3. Copy VectraStream.conf to the /etc/opt/microsoft/omsagent/**workspace_id**/conf/omsagent.d/ folder.\n4. Edit VectraStream.conf as follows:\n\n\t i. configure an alternate port to send data to, if desired. Default port is 29009.\n\n\t ii. replace **workspace_id** with real value of your Workspace ID.\n5. Save changes and restart the Azure Log Analytics agent for Linux service with the following command:\n\t\tsudo /opt/microsoft/omsagent/bin/service_control restart",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "3. Configure and connect Vectra AI Stream",
        "description": "Configure Vectra AI Brain to forward Stream metadata in JSON format to your Microsoft Sentinel workspace via the Log Analytics Agent.\n\nFrom the Vectra UI, navigate to Settings > Cognito Stream and Edit the destination configuration:\n\n- Select Publisher: RAW JSON\n\n- Set the server IP or hostname (which is the host which run the Log Analytics Agent)\n\n- Set all the port to **29009** (this port can be modified if required)\n\n- Save\n\n- Set Log types (Select all log types available)\n\n- Click on **Save**\n\n"
      }
    ],
    "metadata": {
      "id": "ec069726-811c-4f50-b141-295057367f49",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "Vectra AI"
      },
      "author": {
        "name": "Vectra AI Technical Marketing"
      },
      "support": {
        "tier": "developer",
        "name": "Vectra AI",
        "email": "tme@vectra.ai",
        "link": "https://www.vectra.ai/support"
      }
    }
  },
  {
    "id": "AkamaiSecurityEvents",
    "title": "[Deprecated] Akamai Security Events via Legacy Agent",
    "publisher": "Akamai",
    "descriptionMarkdown": "Akamai Solution for Microsoft Sentinel provides the capability to ingest [Akamai Security Events](https://www.akamai.com/us/en/products/security/) into Microsoft Sentinel. Refer to [Akamai SIEM Integration documentation](https://developer.akamai.com/tools/integrations/siem) for more information.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "AkamaiSecurityEvents",
        "baseQuery": "CommonSecurityLog\n| where DeviceVendor == \"Akamai\"\n| where DeviceProduct == \"akamai_siem\""
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Countries",
        "query": "AkamaiSIEMEvent\n | summarize count() by SrcGeoCountry\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (AkamaiSecurityEvents)",
        "lastDataReceivedQuery": "CommonSecurityLog\n | where DeviceVendor == \"Akamai\"\n | where DeviceProduct == \"akamai_siem\"\n | summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n | where DeviceVendor == \"Akamai\"\n | where DeviceProduct == \"akamai_siem\"\n | summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias Akamai Security Events and load the function code or click [here](https://aka.ms/sentinel-akamaisecurityevents-parser), on the second line of the query, enter the hostname(s) of your Akamai Security Events device(s) and any other unique identifiers for the logstream. The function usually takes 10-15 minutes to activate after solution installation/update."
      },
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Common Event Format (CEF) logs to Syslog agent",
        "description": "[Follow these steps](https://developer.akamai.com/tools/integrations/siem) to configure Akamai CEF connector to send Syslog messages in CEF format to the proxy machine. Make sure you to send the logs to port 514 TCP on the machine's IP address."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "AkamaiSecurityEventsAma",
    "title": "[Deprecated] Akamai Security Events via AMA",
    "publisher": "Akamai",
    "descriptionMarkdown": "Akamai Solution for Microsoft Sentinel provides the capability to ingest [Akamai Security Events](https://www.akamai.com/us/en/products/security/) into Microsoft Sentinel. Refer to [Akamai SIEM Integration documentation](https://developer.akamai.com/tools/integrations/siem) for more information.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "AkamaiSecurityEvents",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Akamai' \n |where DeviceProduct =~ 'akamai_siem'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Countries",
        "query": "AkamaiSIEMEvent\n | summarize count() by SrcGeoCountry\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (AkamaiSecurityEvents)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Akamai' \n |where DeviceProduct =~ 'akamai_siem'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'Akamai' \n |where DeviceProduct =~ 'akamai_siem'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias Akamai Security Events and load the function code or click [here](https://aka.ms/sentinel-akamaisecurityevents-parser), on the second line of the query, enter the hostname(s) of your Akamai Security Events device(s) and any other unique identifiers for the logstream. The function usually takes 10-15 minutes to activate after solution installation/update.",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine",
                  "instructions": []
                },
                {
                  "title": "Step B. Forward Common Event Format (CEF) logs to Syslog agent",
                  "description": "[Follow these steps](https://developer.akamai.com/tools/integrations/siem) to configure Akamai CEF connector to send Syslog messages in CEF format to the proxy machine. Make sure you to send the logs to port 514 TCP on the machine's IP address.",
                  "instructions": []
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "AliCloudActionTrailCCPDefinition",
    "title": "Alibaba Cloud ActionTrail (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The [Alibaba Cloud ActionTrail](https://www.alibabacloud.com/product/actiontrail) data connector provides the capability to retrieve actiontrail events stored into [Alibaba Cloud Simple Log Service](https://www.alibabacloud.com/product/log-service) and store them into Microsoft Sentinel through the [SLS REST API](https://www.alibabacloud.com/help/sls/developer-reference/api-sls-2020-12-30-getlogs). The connector provides ability to get events which helps to examine potential security risks, analyze your team's use of collaboration, diagnose configuration problems and more.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "AliCloud ActionTrail Events",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "All AliCloud ActionTrail logs",
        "query": "{{graphQueriesTableName}}\n| sort by TimeGenerated desc"
      },
      {
        "description": "Total Events",
        "query": "{{graphQueriesTableName}}\n | summarize count() by eventId"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}|summarize Time = max  (TimeGenerated)\n|where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "isPreview": true
    },
    "metadata": null
  },
  {
    "id": "AlsidForAD",
    "title": "Alsid for Active Directory",
    "publisher": "Alsid",
    "descriptionMarkdown": "Alsid for Active Directory connector allows to export Alsid Indicators of Exposures, trailflow and Indicators of Attacks logs to Azure Sentinel in real time.\nIt provides a data parser to manipulate the logs more easily. The different workbooks ease your Active Directory monitoring and provide different ways to visualize the data. The analytic templates allow to automate responses regarding different events, exposures, or attacks.",
    "additionalRequirementBanner": "This data connector depends on a parser based on Kusto Function to work as expected. Follow the steps to use this Kusto Function alias **afad_parser** in queries and workbooks. [Follow steps to get this Kusto Function>](https://aka.ms/sentinel-alsidforad-parser)  ",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "AlsidForADLog_CL",
        "baseQuery": "AlsidForADLog_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get the number of alerts triggered by each IoE",
        "query": "afad_parser\n | where MessageType == 0\n | summarize AlertCount = count() by Codename"
      },
      {
        "description": "Get all IoE alerts with severity superior to the threshold",
        "query": "let threshold = 2;\n let SeverityTable=datatable(Severity:string,Level:int) [\n \"low\", 1,\n \"medium\", 2,\n \"high\", 3,\n \"critical\", 4\n ];\n afad_parser\n | where MessageType == 0\n | lookup kind=leftouter SeverityTable on Severity\n | where Level >= ['threshold']"
      },
      {
        "description": "Get all IoE alerts for the last 24 hours",
        "query": "afad_parser\r\n| where MessageType == 0 and TimeGenerated > ago(1d)"
      },
      {
        "description": "Get all IoE alerts for the last 7 days",
        "query": "afad_parser\r\n| where MessageType == 0 and TimeGenerated > ago(7d)"
      },
      {
        "description": "Get all IoE alerts for the last 30 days",
        "query": "afad_parser\r\n| where MessageType == 0 and TimeGenerated > ago(30d)"
      },
      {
        "description": "Get all trailflow changes for the last 24 hours",
        "query": "afad_parser\r\n| where MessageType == 1 and TimeGenerated > ago(1d)"
      },
      {
        "description": "Get all trailflow changes for the last 7 days",
        "query": "afad_parser\r\n| where MessageType == 1 and TimeGenerated > ago(7d)"
      }
    ],
    "dataTypes": [
      {
        "name": "AlsidForADLog_CL",
        "lastDataReceivedQuery": "AlsidForADLog_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "afad_parser\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">This data connector depends on a parser based on a Kusto Function to work as expected. [Follow these steps](https://aka.ms/sentinel-alsidforad-parser) to create the Kusto Functions alias, **afad_parser**",
        "instructions": []
      },
      {
        "title": "1. Configure the Syslog server",
        "description": "You will first need a **linux Syslog** server that Alsid for AD will send logs to. Typically you can run **rsyslog** on **Ubuntu**.\n You can then configure this server as you wish, but it is recommended to be able to output AFAD logs in a separate file.\nAlternatively you can use [this Quickstart template](https://azure.microsoft.com/resources/templates/alsid-syslog-proxy/) which will deploy the Syslog server and the Microsoft agent for you. If you do use this template, you can skip step 3."
      },
      {
        "title": "2. Configure Alsid to send logs to your Syslog server",
        "description": "On your **Alsid for AD** portal, go to *System*, *Configuration* and then *Syslog*.\nFrom there you can create a new Syslog alert toward your Syslog server.\n\nOnce this is done, check that the logs are correctly gathered on your server in a seperate file (to do this, you can use the *Test the configuration* button in the Syslog alert configuration in AFAD).\nIf you used the Quickstart template, the Syslog server will by default listen on port 514 in UDP and 1514 in TCP, without TLS."
      },
      {
        "title": "3. Install and onboard the Microsoft agent for Linux",
        "description": "You can skip this step if you used the Quickstart template in step 1",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "4. Configure the logs to be collected by the agents",
        "description": "Configure the agent to collect the logs.\n\n1. Under workspace advanced settings **Configuration**, select **Data** and then **Custom Logs**.\n2. Select **Apply below configuration to my machines** and click **Add**.\n3. Upload a sample AFAD Syslog file from the **Linux** machine running the **Syslog** server and click **Next**, for your convenience, you can find such a file [here](https://github.com/Azure/azure-quickstart-templates/blob/master/alsid-syslog-proxy/logs/AlsidForAD.log).\n4. Set the record delimiter to **New Line** if not already the case and click **Next**.\n5. Select **Linux** and enter the file path to the **Syslog** file, click **+** then **Next**. If you used the Quickstart template in step 1, the default location of the file is `/var/log/AlsidForAD.log`.\n6. Set the **Name** to *AlsidForADLog_CL* then click **Done** (Azure automatically adds *_CL* at the end of the name, there must be only one, make sure the name is not *AlsidForADLog_CL_CL*).\n\nAll of these steps are showcased [here](https://www.youtube.com/watch?v=JwV1uZSyXM4&feature=youtu.be) as an example",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenSyslogSettings"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "",
        "description": "> You should now be able to receive logs in the *AlsidForADLog_CL* table, logs data can be parse using the **afad_parser()** function, used by all query samples, workbooks and analytic templates."
      }
    ],
    "metadata": {
      "id": "12ff1831-b733-4861-a3e7-6115d20106f4",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Alsid"
      },
      "support": {
        "name": "Alsid",
        "link": "https://www.alsid.com/contact-us/",
        "tier": "developer"
      }
    }
  },
  {
    "id": "AnvilogicCCFDefinition",
    "title": "Anvilogic",
    "publisher": "Anvilogic",
    "descriptionMarkdown": "The Anvilogic data connector allows you to pull events of interest generated in the Anvilogic ADX cluster into your Microsoft Sentinel",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Anvilogic events of interest",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get a sample of Anvilogic events of interest",
        "query": "{{graphQueriesTableName}} | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}} | summarize Time=max(TimeGenerated) | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "ApacheHTTPServer",
    "title": "[Deprecated] Apache HTTP Server",
    "publisher": "Apache",
    "descriptionMarkdown": "The Apache HTTP Server data connector provides the capability to ingest [Apache HTTP Server](http://httpd.apache.org/) events into Microsoft Sentinel. Refer to [Apache Logs documentation](https://httpd.apache.org/docs/2.4/logs.html) for more information.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ApacheHTTPServer_CL",
        "baseQuery": "ApacheHTTPServer"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Clients (Source IP)",
        "query": "ApacheHTTPServer\n | summarize count() by SrcIpAddr\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "ApacheHTTPServer_CL",
        "lastDataReceivedQuery": "ApacheHTTPServer\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ApacheHTTPServer\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias ApacheHTTPServer and load the function code or click [here](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/ApacheHTTPServer/Parsers/ApacheHTTPServer.txt). The function usually takes 10-15 minutes to activate after solution installation/update.",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux or Windows",
        "description": "Install the agent on the Apache HTTP Server where the logs are generated.\n\n> Logs from Apache HTTP Server deployed on Linux or Windows servers are collected by **Linux** or **Windows** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Linux agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Windows agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Windows Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Windows Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Configure the custom log directory to be collected",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenCustomLogsSettings"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "",
        "description": "1. Select the link above to open your workspace advanced settings \n2. From the left pane, select **Data**, select **Custom Logs** and click **Add+**\n3. Click **Browse** to upload a sample of a Apache HTTP Server log file (e.g. access.log or error.log). Then, click **Next >**\n4. Select **New line** as the record delimiter and click **Next >**\n5. Select **Windows** or **Linux** and enter the path to Apache HTTP logs based on your configuration. Example: \n - **Windows** directory: `C:\\Server\\bin\\Apache24\\logs\\*.log`\n - **Linux** Directory:  `/var/log/httpd/*.log` \n6. After entering the path, click the '+' symbol to apply, then click **Next >** \n7. Add **ApacheHTTPServer_CL** as the custom log Name and click **Done**"
      }
    ]
  },
  {
    "id": "ApacheTomcat",
    "title": "[Deprecated] Apache Tomcat",
    "publisher": "Apache",
    "descriptionMarkdown": "The Apache Tomcat solution provides the capability to ingest [Apache Tomcat](http://tomcat.apache.org/) events into Microsoft Sentinel. Refer to [Apache Tomcat documentation](http://tomcat.apache.org/tomcat-10.0-doc/logging.html) for more information.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Tomcat_CL",
        "baseQuery": "TomcatEvent"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Clients (Source IP)",
        "query": "TomcatEvent\n | summarize count() by SrcIpAddr\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "Tomcat_CL",
        "lastDataReceivedQuery": "TomcatEvent\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "TomcatEvent\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias TomcatEvent and load the function code or click [here](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Tomcat/Parsers/TomcatEvent.txt).The function usually takes 10-15 minutes to activate after solution installation/update.",
        "instructions": []
      },
      {
        "title": "",
        "description": ">**NOTE:** This data connector has been developed using Apache Tomcat version 10.0.4",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux or Windows",
        "description": "Install the agent on the Apache Tomcat Server where the logs are generated.\n\n> Logs from Apache Tomcat Server deployed on Linux or Windows servers are collected by **Linux** or **Windows** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Linux agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Windows agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Windows Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Windows Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Configure the custom log directory to be collected",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenCustomLogsSettings"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "",
        "description": "1. Select the link above to open your workspace advanced settings \n2. From the left pane, select **Data**, select **Custom Logs** and click **Add+**\n3. Click **Browse** to upload a sample of a Tomcat log file (e.g. access.log or error.log). Then, click **Next >**\n4. Select **New line** as the record delimiter and click **Next >**\n5. Select **Windows** or **Linux** and enter the path to Tomcat logs based on your configuration. Example: \n - **Linux** Directory:  '/var/log/tomcat/*.log' \n6. After entering the path, click the '+' symbol to apply, then click **Next >** \n7. Add **Tomcat_CL** as the custom log Name and click **Done**"
      }
    ]
  },
  {
    "id": "ApigeeXDataConnector",
    "title": "[DEPRECATED] Google ApigeeX",
    "publisher": "Google",
    "descriptionMarkdown": "The [Google ApigeeX](https://cloud.google.com/apigee/docs) data connector provides the capability to ingest ApigeeX audit logs into Microsoft Sentinel using the GCP Logging API. Refer to [GCP Logging API documentation](https://cloud.google.com/logging/docs/reference/v2/rest) for more information.\n\n<p><span style='color:red; font-weight:bold;'>NOTE</span>: This data connector has been deprecated, consider moving to the CCF data connector available in the solution which replaces ingestion via the <a href='https://learn.microsoft.com/en-us/azure/azure-monitor/logs/custom-logs-migrate' style='color:#1890F1;'>deprecated HTTP Data Collector API</a>.</p>",
    "additionalRequirementBanner": ">This data connector depends on a parser based on a Kusto Function to work as expected [**ApigeeX**](https://aka.ms/sentinel-ApigeeXDataConnector-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "ApigeeX logs",
        "legend": "ApigeeX_CL",
        "baseQuery": "ApigeeX_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All ApigeeX logs",
        "query": "ApigeeX_CL\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "ApigeeX_CL",
        "lastDataReceivedQuery": "ApigeeX_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ApigeeX_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "GCP service account",
          "description": "GCP service account with permissions to read logs is required for GCP Logging API. Also json file with service account key is required. See the documentation to learn more about [required permissions](https://cloud.google.com/iam/docs/audit-logging#audit_log_permissions), [creating service account](https://cloud.google.com/iam/docs/creating-managing-service-accounts) and [creating service account key](https://cloud.google.com/iam/docs/creating-managing-service-account-keys)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the GCP API to pull logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**ApigeeX**](https://aka.ms/sentinel-ApigeeXDataConnector-parser) which is deployed with the Microsoft Sentinel Solution."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuring GCP and obtaining credentials**\n\n1. Make sure that Logging API is [enabled](https://cloud.google.com/apis/docs/getting-started#enabling_apis). \n\n2. [Create service account](https://cloud.google.com/iam/docs/creating-managing-service-accounts) with [required permissions](https://cloud.google.com/iam/docs/audit-logging#audit_log_permissions) and [get service account key json file](https://cloud.google.com/iam/docs/creating-managing-service-account-keys).\n\n3. Prepare GCP project ID where ApigeeX is located."
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following), as well as Azure Blob Storage connection string and container name, readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the data connector using an ARM Template.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-ApigeeXDataConnector-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Google Cloud Platform Project Id**, **Google Cloud Platform Credentials File Content**, **Microsoft Sentinel Workspace Id**, **Microsoft Sentinel Shared Key**\n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**.\n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/create-first-function-vs-code-python) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-ApigeeXDataConnector-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions.\n\n\te. **Select a runtime:** Choose Python 3.11.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tRESOURCE_NAMES\n\t\tCREDENTIALS_FILE_CONTENT\n\t\tWORKSPACE_ID\n\t\tSHARED_KEY\n\t\tlogAnalyticsUri (Optional)\n - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://WORKSPACE_ID.ods.opinsights.azure.us`. \n4. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "ARGOSCloudSecurity",
    "title": "ARGOS Cloud Security",
    "publisher": "ARGOS Cloud Security",
    "descriptionMarkdown": "The ARGOS Cloud Security integration for Microsoft Sentinel allows you to have all your important cloud security events in one place. This enables you to easily create dashboards, alerts, and correlate events across multiple systems. Overall this will improve your organization's security posture and security incident response.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ARGOS_CL",
        "baseQuery": "ARGOS_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Display all exploitable ARGOS Detections.",
        "query": "ARGOS_CL\n | where exploitable_b"
      },
      {
        "description": "Display all open, exploitable ARGOS Detections on Azure.",
        "query": "ARGOS_CL\n | where exploitable_b and cloud_s == 'azure' and status_s == 'open'"
      },
      {
        "description": "Display all open, exploitable ARGOS Detections on Azure.",
        "query": "ARGOS_CL\n | where exploitable_b and cloud_s == 'azure' and status_s == 'open'\n | sort by TimeGenerated"
      },
      {
        "description": "Render a time chart with all open ARGOS Detections on Azure.",
        "query": "ARGOS_CL\n | where cloud_s == 'azure' and status_s == 'open'\n | summarize count() by TimeGenerated\n | render timechart"
      },
      {
        "description": "Display Top 10, open, exploitable ARGOS Detections on Azure.",
        "query": "ARGOS_CL\n | where cloud_s == 'azure' and status_s == 'open' and exploitable_b\n | summarize count() by ruleId_s\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "ARGOS_CL",
        "lastDataReceivedQuery": "ARGOS_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ARGOS_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Subscribe to ARGOS",
        "description": "Ensure you already own an ARGOS Subscription. If not, browse to [ARGOS Cloud Security](https://argos-security.io) and sign up to ARGOS.\n\nAlternatively, you can also purchase ARGOS via the [Azure Marketplace](https://azuremarketplace.microsoft.com/en-au/marketplace/apps/argoscloudsecurity1605618416175.argoscloudsecurity?tab=Overview)."
      },
      {
        "title": "2. Configure Sentinel integration from ARGOS",
        "description": "Configure ARGOS to forward any new detections to your Sentinel workspace by providing ARGOS with your Workspace ID and Primary Key.\n\nThere is **no need to deploy any custom infrastructure**.\n\nEnter the information into the [ARGOS Sentinel](https://app.argos-security.io/account/sentinel) configuration page.\n\nNew detections will automatically be forwarded.\n\n[Learn more about the integration](https://www.argos-security.io/resources#integrations)",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ],
    "metadata": {
      "id": "e14ac0f5-771f-492e-87fd-cbdca9c2b16e",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "ARGOS Cloud Security"
      },
      "support": {
        "tier": "developer",
        "name": "ARGOS Cloud Security",
        "email": "support@argos-security.io",
        "link": "https://www.argos-security.io/contact-us/#"
      }
    }
  },
  {
    "id": "AristaAwakeSecurity",
    "title": "[Deprecated] Awake Security via Legacy Agent",
    "publisher": "Arista Networks",
    "descriptionMarkdown": "The Awake Security CEF connector allows users to send detection model matches from the Awake Security Platform to Microsoft Sentinel. Remediate threats quickly with the power of network detection and response and speed up investigations with deep visibility especially into unmanaged entities including users, devices and applications on your network. The connector also enables the creation of network security-focused custom alerts, incidents, workbooks and notebooks that align with your existing security operations workflows. ",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "AwakeSecurity",
        "baseQuery": "CommonSecurityLog\n| where DeviceVendor == \"Arista Networks\"\n| where DeviceProduct == \"Awake Security\""
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 5 Adversarial Model Matches by Severity",
        "query": "union CommonSecurityLog\n| where DeviceVendor == \"Arista Networks\" and DeviceProduct == \"Awake Security\"\n| summarize  TotalActivities=sum(EventCount) by Activity,LogSeverity\n| top 5 by LogSeverity desc"
      },
      {
        "description": "Top 5 Devices by Device Risk Score",
        "query": "CommonSecurityLog\r\n| where DeviceVendor == \"Arista Networks\" and DeviceProduct == \"Awake Security\"\r\n| extend DeviceCustomNumber1 = coalesce(column_ifexists(\"FieldDeviceCustomNumber1\", long(null)), DeviceCustomNumber1, long(null))\r\n| summarize MaxDeviceRiskScore=max(DeviceCustomNumber1),TimesAlerted=count() by SourceHostName=coalesce(SourceHostName,\"Unknown\")\r\n| top 5 by MaxDeviceRiskScore desc"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (AwakeSecurity)",
        "lastDataReceivedQuery": "CommonSecurityLog\n| where DeviceVendor == \"Arista Networks\"\n| where DeviceProduct == \"Awake Security\"\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n| where DeviceVendor == \"Arista Networks\"\n| where DeviceProduct == \"Awake Security\"\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Awake Adversarial Model match results to a CEF collector.",
        "description": "Perform the following steps to forward Awake Adversarial Model match results to a CEF collector listening on TCP port **514** at IP **192.168.0.1**:\n- Navigate to the Detection Management Skills page in the Awake UI.\n- Click + Add New Skill.\n- Set the Expression field to,\n>integrations.cef.tcp { destination: \"192.168.0.1\", port: 514, secure: false, severity: Warning }\n- Set the Title field to a descriptive name like,\n>Forward Awake Adversarial Model match result to Microsoft Sentinel.\n- Set the Reference Identifier to something easily discoverable like,\n>integrations.cef.sentinel-forwarder\n- Click Save.\n\nNote: Within a few minutes of saving the definition and other fields the system will begin sending new model match results to the CEF events collector as they are detected.\n\nFor more information, refer to the **Adding a Security Information and Event Management Push Integration** page from the Help Documentation in the Awake UI."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "69203ebb-3834-43bf-9cdd-2936c4e6ae79",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "Awake Security"
      },
      "author": {
        "name": "Awake Security"
      },
      "support": {
        "tier": "developer",
        "name": "Arista - Awake Security",
        "email": "support-security@arista.com",
        "link": "https://awakesecurity.com/"
      }
    }
  },
  {
    "id": "ArmisActivities",
    "title": "Armis Activities",
    "publisher": "Armis",
    "descriptionMarkdown": "The [Armis](https://www.armis.com/) Activities connector gives the capability to ingest Armis device Activities into Microsoft Sentinel through the Armis REST API. Refer to the API documentation: `https://<YourArmisInstance>.armis.com/api/v1/doc` for more information. The connector provides the ability to get device activity information from the Armis platform. Armis uses your existing infrastructure to discover and identify devices without having to deploy any agents. Armis detects what all devices are doing in your environment and classifies those activities to get a complete picture of device behavior. These activities are analyzed for an understanding of normal and abnormal device behavior and used to assess device and network risk.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total Activities data received",
        "legend": "Armis_Activities_CL",
        "baseQuery": "Armis_Activities_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Armis Activity Events - All Activities Activities.",
        "query": "Armis_Activities_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Armis_Activities_CL",
        "lastDataReceivedQuery": "Armis_Activities_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Armis_Activities_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "**Armis Secret Key** is required.  See the documentation to learn more about API on the `https://<YourArmisInstance>.armis.com/api/v1/doc`"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Armis API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "description": "**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias ArmisActivities and load the function code or click [here](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Armis/Parsers/ArmisActivities.yaml). The function usually takes 10-15 minutes to activate after solution installation/update."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the Armis API**\n\n Follow these instructions to create an Armis API secret key.\n 1. Log into your Armis instance\n 2. Navigate to Settings -> API Management\n 3. If the secret key has not already been created, press the Create button to create the secret key\n 4. To access the secret key, press the Show button\n 5. The secret key can now be copied and used during the Armis Activities connector configuration"
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Armis Activities data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following) readily available.., as well as the Armis API Authorization Key(s)",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the Armis connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-ArmisActivitiesAPI-azuredeploy) [![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://aka.ms/sentinel-ArmisActivitiesAPI-azuredeploy-gov)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the below information : \n\t\tFunction Name \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tArmis Secret Key \n\t\tArmis URL (https://<armis-instance>.armis.com/api/v1/) \n\t\tArmis Activity Table Name \n\t\tArmis Schedule \n\t\tAvoid Duplicates (Default: false) \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the Armis Activity data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-ArmisActivitiesAPI-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. ARMISXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.11\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following application settings individually, with their respective values (case-sensitive): \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tArmis Secret Key \n\t\tArmis URL (https://<armis-instance>.armis.com/api/v1/) \n\t\tArmis Activity Table Name \n\t\tArmis Schedule \n\t\tAvoid Duplicates (Default: false) \n\t\tlogAnalyticsUri (optional) \n - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n4. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "ArmisAlerts",
    "title": "Armis Alerts",
    "publisher": "Armis",
    "descriptionMarkdown": "The [Armis](https://www.armis.com/) Alerts connector gives the capability to ingest Armis Alerts into Microsoft Sentinel through the Armis REST API. Refer to the API documentation: `https://<YourArmisInstance>.armis.com/api/v1/docs` for more information. The connector provides the ability to get alert information from the Armis platform and to identify and prioritize threats in your environment. Armis uses your existing infrastructure to discover and identify devices without having to deploy any agents. ",
    "additionalRequirementBanner": "These queries and workbooks are dependent on a parser based on Kusto to work as expected. Follow the steps to use this Kusto functions alias **ArmisAlerts** in queries and workbooks [Follow steps to get this Kusto functions>](https://aka.ms/sentinel-ArmisAlertsAPI-parser).",
    "graphQueries": [
      {
        "metricName": "Total Alerts data received",
        "legend": "Armis_Alerts_CL",
        "baseQuery": "Armis_Alerts_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Armis Alert Events - All Alerts Activities.",
        "query": "Armis_Alerts_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Armis_Alerts_CL",
        "lastDataReceivedQuery": "Armis_Alerts_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Armis_Alerts_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "**Armis Secret Key** is required.  See the documentation to learn more about API on the `https://<YourArmisInstance>.armis.com/api/v1/doc`"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Armis API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected. [Follow these steps](https://aka.ms/sentinel-ArmisAlertsAPI-parser) to create the Kusto functions alias, **ArmisAlerts**"
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the Armis API**\n\n Follow these instructions to create an Armis API secret key.\n 1. Log into your Armis instance\n 2. Navigate to Settings -> API Management\n 3. If the secret key has not already been created, press the Create button to create the secret key\n 4. To access the secret key, press the Show button\n 5. The secret key can now be copied and used during the Armis Alerts connector configuration"
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Armis Alert data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following) readily available.., as well as the Armis API Authorization Key(s)",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the Armis connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-ArmisAlertsAPI-azuredeploy) [![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://aka.ms/sentinel-ArmisAlertsAPI-azuredeploy-gov)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the below information : \n\t\tFunction Name \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tArmis Secret Key \n\t\tArmis URL (https://<armis-instance>.armis.com/api/v1/) \n\t\tArmis Alert Table Name \n\t\tArmis Schedule \n\t\tAvoid Duplicates (Default: true) \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the Armis Alert data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-ArmisAlertsAPI-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. ARMISXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.11\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following application settings individually, with their respective values (case-sensitive): \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tArmis Secret Key \n\t\tArmis URL (https://<armis-instance>.armis.com/api/v1/) \n\t\tArmis Alert Table Name \n\t\tArmis Schedule \n\t\tAvoid Duplicates (Default: true) \n\t\tlogAnalyticsUri (optional) \n - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n4. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "ArmisAlertsActivities",
    "title": "Armis Alerts Activities",
    "publisher": "Armis",
    "descriptionMarkdown": "The [Armis](https://www.armis.com/) Alerts Activities connector gives the capability to ingest Armis Alerts and Activities into Microsoft Sentinel through the Armis REST API. Refer to the API documentation: `https://<YourArmisInstance>.armis.com/api/v1/docs` for more information. The connector provides the ability to get alert and activity information from the Armis platform and to identify and prioritize threats in your environment. Armis uses your existing infrastructure to discover and identify devices without having to deploy any agents. ",
    "additionalRequirementBanner": "These queries and workbooks are dependent on a parser based on Kusto to work as expected. which is deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total Alerts data received",
        "legend": "Armis_Alerts_CL",
        "baseQuery": "Armis_Alerts_CL"
      },
      {
        "metricName": "Total Activities data received",
        "legend": "Armis_Activities_CL",
        "baseQuery": "Armis_Activities_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Armis Alert Events - All Alerts.",
        "query": "Armis_Alerts_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Armis Activity Events - All Activities.",
        "query": "Armis_Activities_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Armis_Alerts_CL",
        "lastDataReceivedQuery": "Armis_Alerts_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Armis_Activities_CL",
        "lastDataReceivedQuery": "Armis_Activities_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Armis_Alerts_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Armis_Activities_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "**Armis Secret Key** is required.  See the documentation to learn more about API on the `https://<YourArmisInstance>.armis.com/api/v1/doc`"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Armis API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias ArmisActivities/ArmisAlerts and load the function code. The function usually takes 10-15 minutes to activate after solution installation/update."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the Armis API**\n\n Follow these instructions to create an Armis API secret key.\n 1. Log into your Armis instance\n 2. Navigate to Settings -> API Management\n 3. If the secret key has not already been created, press the Create button to create the secret key\n 4. To access the secret key, press the Show button\n 5. The secret key can now be copied and used during the Armis Alerts Activities connector configuration"
      },
      {
        "title": "",
        "description": "**STEP 2 - App Registration steps for the Application in Microsoft Entra ID**\n\n This integration requires an App registration in the Azure portal. Follow the steps in this section to create a new application in Microsoft Entra ID:\n 1. Sign in to the [Azure portal](https://portal.azure.com/).\n 2. Search for and select **Microsoft Entra ID**.\n 3. Under **Manage**, select **App registrations > New registration**.\n 4. Enter a display **Name** for your application.\n 5. Select **Register** to complete the initial app registration.\n 6. When registration finishes, the Azure portal displays the app registration's Overview pane. You see the **Application (client) ID** and **Tenant ID**. The client ID and Tenant ID is required as configuration parameters for the execution of Armis Alerts Activities Data Connector. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app)"
      },
      {
        "title": "",
        "description": "**STEP 3 - Add a client secret for application in Microsoft Entra ID**\n\n Sometimes called an application password, a client secret is a string value required for the execution of Armis Alerts Activities Data Connector. Follow the steps in this section to create a new Client Secret:\n 1. In the Azure portal, in **App registrations**, select your application.\n 2. Select **Certificates & secrets > Client secrets > New client secret**.\n 3. Add a description for your client secret.\n 4. Select an expiration for the secret or specify a custom lifetime. Limit is 24 months.\n 5. Select **Add**. \n 6. *Record the secret's value for use in your client application code. This secret value is never displayed again after you leave this page.* The secret value is required as configuration parameter for the execution of Armis Alerts Activities Data Connector. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret)"
      },
      {
        "title": "",
        "description": "**STEP 4 - Assign role of Contributor to application in Microsoft Entra ID**\n\n Follow the steps in this section to assign the role:\n 1. In the Azure portal, Go to **Resource Group** and select your resource group.\n 2. Go to **Access control (IAM)** from left panel.\n 3. Click on **Add**, and then select **Add role assignment**.\n 4. Select **Contributor** as role and click on next.\n 5. In **Assign access to**, select `User, group, or service principal`.\n 6. Click on **add members** and type **your app name** that you have created and select it.\n 7. Now click on **Review + assign** and then again click on **Review + assign**. \n\n> **Reference link:** [https://learn.microsoft.com/azure/role-based-access-control/role-assignments-portal](https://learn.microsoft.com/azure/role-based-access-control/role-assignments-portal)"
      },
      {
        "title": "",
        "description": "**STEP 5 - Create a Keyvault**\n\n Follow these instructions to create a new Keyvault.\n 1. In the Azure portal, Go to **Key vaults**. Click create.\n 2. Select Subsciption, Resource Group and provide unique name of keyvault.\n\n> **NOTE:** Create a separate key vault for each **API key** within one workspace."
      },
      {
        "title": "",
        "description": "**STEP 6 - Create Access Policy in Keyvault**\n\n Follow these instructions to create access policy in Keyvault.\n 1. Go to keyvaults, select your keyvault, go to Access policies on left side panel. Click create.\n 2. Select all keys & secrets permissions. Click next.\n 3. In the principal section, search by application name which was generated in STEP - 2. Click next.\n\n> **NOTE:** Ensure the Permission model in the Access Configuration of Key Vault is set to **'Vault access policy'**"
      },
      {
        "title": "",
        "description": "**STEP 7 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Armis Alerts Activities data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following) readily available.., as well as the Armis API Authorization Key(s)",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the Armis connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-ArmisAlertsActivitiesAPI-azuredeploy) [![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://aka.ms/sentinel-ArmisAlertsActivitiesAPI-azuredeploy-gov)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the below information : \n\t\tFunction Name \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tArmis Secret Key \n\t\tArmis URL (https://<armis-instance>.armis.com/api/v1/) \n\t\tArmis Alert Table Name  \n\t\tArmis Activity Table Name \n\t\tSeverity  (Default: Low) \n\t\tArmis Schedule \n\t\tKeyVault Name \n\t\tAzure Client Id \n\t\tAzure Client Secret \n\t\tTenant Id \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the Armis Alerts Activities data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-ArmisAlertsActivitiesAPI311-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. ARMISXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.11\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following application settings individually, with their respective values (case-sensitive): \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tArmis Secret Key \n\t\tArmis URL (https://<armis-instance>.armis.com/api/v1/) \n\t\tArmis Alert Table Name \n\t\tArmis Activity Table Name \n\t\tSeverity  (Default: Low) \n\t\tArmis Schedule \n\t\tKeyVault Name \n\t\tAzure Client Id \n\t\tAzure Client Secret \n\t\tTenant Id \n\t\tlogAnalyticsUri (optional) \n - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n4. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "ArmisDevices",
    "title": "Armis Devices",
    "publisher": "Armis",
    "descriptionMarkdown": "The [Armis](https://www.armis.com/) Device connector gives the capability to ingest Armis Devices into Microsoft Sentinel through the Armis REST API. Refer to the API documentation: `https://<YourArmisInstance>.armis.com/api/v1/docs` for more information. The connector provides the ability to get device information from the Armis platform. Armis uses your existing infrastructure to discover and identify devices without having to deploy any agents. Armis can also integrate with your existing IT & security management tools to identify and classify each and every device, managed or unmanaged in your environment.",
    "additionalRequirementBanner": "These queries and workbooks are dependent on a parser based on Kusto to work as expected. Follow the steps to use this Kusto functions alias **ArmisDevice** in queries and workbooks [Follow steps to get this Kusto functions>](https://aka.ms/sentinel-ArmisDevice-parser).",
    "graphQueries": [
      {
        "metricName": "Total Devices data received",
        "legend": "Armis_Devices_CL",
        "baseQuery": "Armis_Devices_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Armis Device Events - All Devices Activities.",
        "query": "Armis_Devices_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Armis_Devices_CL",
        "lastDataReceivedQuery": "Armis_Devices_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Armis_Devices_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "**Armis Secret Key** is required.  See the documentation to learn more about API on the `https://<YourArmisInstance>.armis.com/api/v1/doc`"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Armis API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected. [Follow these steps](https://aka.ms/sentinel-ArmisDevice-parser) to create the Kusto functions alias, **ArmisDevice**"
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the Armis API**\n\n Follow these instructions to create an Armis API secret key.\n 1. Log into your Armis instance\n 2. Navigate to Settings -> API Management\n 3. If the secret key has not already been created, press the Create button to create the secret key\n 4. To access the secret key, press the Show button\n 5. The secret key can now be copied and used during the Armis Device connector configuration"
      },
      {
        "title": "",
        "description": "**STEP 2 - App Registration steps for the Application in Microsoft Entra ID**\n\n This integration requires an App registration in the Azure portal. Follow the steps in this section to create a new application in Microsoft Entra ID:\n 1. Sign in to the [Azure portal](https://portal.azure.com/).\n 2. Search for and select **Microsoft Entra ID**.\n 3. Under **Manage**, select **App registrations > New registration**.\n 4. Enter a display **Name** for your application.\n 5. Select **Register** to complete the initial app registration.\n 6. When registration finishes, the Azure portal displays the app registration's Overview pane. You see the **Application (client) ID** and **Tenant ID**. The client ID and Tenant ID is required as configuration parameters for the execution of Armis Device Data Connector. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app)"
      },
      {
        "title": "",
        "description": "**STEP 3 - Add a client secret for application in Microsoft Entra ID**\n\n Sometimes called an application password, a client secret is a string value required for the execution of Armis Device Data Connector. Follow the steps in this section to create a new Client Secret:\n 1. In the Azure portal, in **App registrations**, select your application.\n 2. Select **Certificates & secrets > Client secrets > New client secret**.\n 3. Add a description for your client secret.\n 4. Select an expiration for the secret or specify a custom lifetime. Limit is 24 months.\n 5. Select **Add**. \n 6. *Record the secret's value for use in your client application code. This secret value is never displayed again after you leave this page.* The secret value is required as configuration parameter for the execution of Armis Device Data Connector. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret)"
      },
      {
        "title": "",
        "description": "**STEP 4 - Assign role of Contributor to application in Microsoft Entra ID**\n\n Follow the steps in this section to assign the role:\n 1. In the Azure portal, Go to **Resource Group** and select your resource group.\n 2. Go to **Access control (IAM)** from left panel.\n 3. Click on **Add**, and then select **Add role assignment**.\n 4. Select **Contributor** as role and click on next.\n 5. In **Assign access to**, select `User, group, or service principal`.\n 6. Click on **add members** and type **your app name** that you have created and select it.\n 7. Now click on **Review + assign** and then again click on **Review + assign**. \n\n> **Reference link:** [https://learn.microsoft.com/azure/role-based-access-control/role-assignments-portal](https://learn.microsoft.com/azure/role-based-access-control/role-assignments-portal)"
      },
      {
        "title": "",
        "description": "**STEP 5 - Create a Keyvault**\n\n Follow these instructions to create a new Keyvault.\n 1. In the Azure portal, Go to **Key vaults**. Click create.\n 2. Select Subsciption, Resource Group and provide unique name of keyvault.\n\n> **NOTE:** Create a separate key vault for each **API key** within one workspace."
      },
      {
        "title": "",
        "description": "**STEP 6 - Create Access Policy in Keyvault**\n\n Follow these instructions to create access policy in Keyvault.\n 1. Go to keyvaults, select your keyvault, go to Access policies on left side panel. Click create.\n 2. Select all keys & secrets permissions. Click next.\n 3. In the principal section, search by application name which was generated in STEP - 2. Click next.\n\n> **NOTE:** Ensure the Permission model in the Access Configuration of Key Vault is set to **'Vault access policy'**"
      },
      {
        "title": "",
        "description": "**STEP 7 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Armis Device data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following) readily available.., as well as the Armis API Authorization Key(s)",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the Armis connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-ArmisDevice-azuredeploy) [![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://aka.ms/sentinel-ArmisDevice-azuredeploy-gov)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the below information : \n\t\tFunction Name \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tArmis Secret Key \n\t\tArmis URL (https://<armis-instance>.armis.com/api/v1/) \n\t\tArmis Device Table Name \n\t\tArmis Schedule \n\t\tKeyVault Name \n\t\tAzure Client Id \n\t\tAzure Client Secret \n\t\tTenant Id \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the Armis Device data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-ArmisDevice311-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. ARMISXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.11\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following application settings individually, with their respective values (case-sensitive): \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tArmis Secret Key \n\t\tArmis URL (https://<armis-instance>.armis.com/api/v1/) \n\t\tArmis Device Table Name \n\t\tArmis Schedule \n\t\tKeyVault Name \n\t\tAzure Client Id \n\t\tAzure Client Secret \n\t\tTenant Id \n\t\tlogAnalyticsUri (optional) \n - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n4. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "Armorblox",
    "title": "Armorblox",
    "publisher": "Armorblox",
    "descriptionMarkdown": "The [Armorblox](https://www.armorblox.com/) data connector provides the capability to ingest incidents from your Armorblox instance into Microsoft Sentinel through the REST API. The connector provides ability to get events which helps to examine potential security risks, and more.",
    "graphQueries": [
      {
        "metricName": "Armorblox Incidents",
        "legend": "Armorblox_CL",
        "baseQuery": "Armorblox_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Armorblox Incidents",
        "query": "Armorblox_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Armorblox_CL",
        "lastDataReceivedQuery": "Armorblox_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Armorblox_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Armorblox Instance Details",
          "description": "**ArmorbloxInstanceName** OR **ArmorbloxInstanceURL** is required"
        },
        {
          "name": "Armorblox API Credentials",
          "description": "**ArmorbloxAPIToken** is required"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Armorblox API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the Armorblox API**\n\n Follow the instructions to obtain the API token.\n\n1. Log in to the Armorblox portal with your credentials.\n2. In the portal, click **Settings**.\n3. In the **Settings** view, click **API Keys**\n4. Click **Create API Key**.\n5. Enter the required information.\n6. Click **Create**, and copy the API token displayed in the modal.\n7. Save API token for using in the data connector."
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Armorblox data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following).",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the Armorblox data connector using an ARM Template.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-armorblox-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n> **NOTE:** Within the same resource group, you can't mix Windows and Linux apps in the same region. Select existing resource group without Windows apps in it or create new resource group.\n3. Enter the **ArmorbloxAPIToken**, **ArmorbloxInstanceURL** OR **ArmorbloxInstanceName**, and deploy. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the Armorblox data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-armorblox-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. Armorblox).\n\n\te. **Select a runtime:** Choose Python 3.11.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select ** New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tArmorbloxAPIToken\n\t\tArmorbloxInstanceName OR ArmorbloxInstanceURL\n\t\tWorkspaceID\n\t\tWorkspaceKey\n\t\tLogAnalyticsUri (optional)\n> - Use LogAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n4. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "ArubaClearPass",
    "title": "[Deprecated] Aruba ClearPass via Legacy Agent",
    "publisher": "Aruba Networks",
    "descriptionMarkdown": "The [Aruba ClearPass](https://www.arubanetworks.com/products/security/network-access-control/secure-access/) connector allows you to easily connect your Aruba ClearPass with Microsoft Sentinel, to create custom dashboards, alerts, and improve investigation. This gives you more insight into your organizations network and improves your security operation capabilities.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ArubaClearPass",
        "baseQuery": "CommonSecurityLog\n| where DeviceVendor == \"Aruba Networks\" and DeviceProduct == \"ClearPass\""
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Events by Username",
        "query": "ArubaClearPass \n | summarize count() by UserName \n| top 10 by count_"
      },
      {
        "description": "Top 10 Error Codes",
        "query": "ArubaClearPass \n | summarize count() by ErrorCode \n| top 10 by count_"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n| where DeviceVendor == \"Aruba Networks\" and DeviceProduct == \"ClearPass\"\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (ArubaClearPass)",
        "lastDataReceivedQuery": "CommonSecurityLog\n| where DeviceVendor == \"Aruba Networks\" and DeviceProduct == \"ClearPass\"\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias ArubaClearPass and load the function code or click [here](https://aka.ms/sentinel-arubaclearpass-parser).The function usually takes 10-15 minutes to activate after solution installation/update.",
        "instructions": []
      },
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Aruba ClearPass logs to a Syslog agent",
        "description": "Configure Aruba ClearPass to forward Syslog messages in CEF format to your Microsoft Sentinel workspace via the Syslog agent.\n1. [Follow these instructions](https://www.arubanetworks.com/techdocs/ClearPass/6.7/PolicyManager/Content/CPPM_UserGuide/Admin/syslogExportFilters_add_syslog_filter_general.htm) to configure the Aruba ClearPass to forward syslog.\n2. Use the IP address or hostname for the Linux device with the Linux agent installed as the Destination IP address."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "ArubaClearPassAma",
    "title": "[Deprecated] Aruba ClearPass via AMA",
    "publisher": "Aruba Networks",
    "descriptionMarkdown": "The [Aruba ClearPass](https://www.arubanetworks.com/products/security/network-access-control/secure-access/) connector allows you to easily connect your Aruba ClearPass with Microsoft Sentinel, to create custom dashboards, alerts, and improve investigation. This gives you more insight into your organizations network and improves your security operation capabilities.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ArubaClearPass",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Aruba Networks'\n |where DeviceProduct =~ 'ClearPass'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Events by Username",
        "query": "ArubaClearPass \n | summarize count() by UserName \n| top 10 by count_"
      },
      {
        "description": "Top 10 Error Codes",
        "query": "ArubaClearPass \n | summarize count() by ErrorCode \n| top 10 by count_"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'Aruba Networks'\n |where DeviceProduct =~ 'ClearPass'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (ArubaClearPass)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Aruba Networks'\n |where DeviceProduct =~ 'ClearPass'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias ArubaClearPass and load the function code or click [here](https://aka.ms/sentinel-arubaclearpass-parser).The function usually takes 10-15 minutes to activate after solution installation/update.",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine",
                  "instructions": []
                },
                {
                  "title": "Step B. Forward Aruba ClearPass logs to a Syslog agent",
                  "description": "Configure Aruba ClearPass to forward Syslog messages in CEF format to your Microsoft Sentinel workspace via the Syslog agent.\n1. [Follow these instructions](https://www.arubanetworks.com/techdocs/ClearPass/6.7/PolicyManager/Content/CPPM_UserGuide/Admin/syslogExportFilters_add_syslog_filter_general.htm) to configure the Aruba ClearPass to forward syslog.\n2. Use the IP address or hostname for the Linux device with the Linux agent installed as the Destination IP address.",
                  "instructions": []
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "ASimDnsActivityLogs",
    "title": "Windows DNS Events via AMA",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The Windows DNS log connector allows you to easily filter and stream all analytics logs from your Windows DNS servers to your Microsoft Sentinel workspace using the Azure Monitoring agent (AMA). Having this data in Microsoft Sentinel helps you identify issues and security threats such as:\n- Trying to resolve malicious domain names.\n- Stale resource records.\n- Frequently queried domain names and talkative DNS clients.\n- Attacks performed on DNS server.\n\nYou can get the following insights into your Windows DNS servers from Microsoft Sentinel:\n- All logs centralized in a single place.\n- Request load on DNS servers.\n- Dynamic DNS registration failures.\n\nWindows DNS events are supported by Advanced SIEM Information Model (ASIM) and stream data into the ASimDnsActivityLogs table. [Learn more](https://docs.microsoft.com/azure/sentinel/normalization).\n\nFor more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2225993&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ASimDnsActivityLogs",
        "baseQuery": "ASimDnsActivityLogs\n| where EventProduct == \"DNS Server\"| where EventVendor == \"Microsoft\""
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "ASimDnsActivityLogs\n| where EventProduct == \"DNS Server\"\n            | sort by TimeGenerated"
      },
      {
        "description": "Count the number of failed DNS queries for each source IP address and failure type query.",
        "query": "ASimDnsActivityLogs\n| where EventProduct == \"DNS Server\"\n            | where EventType == \"Query\" and EventResult == \"Failure\"\n| summarize count() by SrcIpAddr, EventResultDetails"
      },
      {
        "description": "Count the number of queries that return NXDOMAIN, indicating that the queries domain name does not exist, and compares the count to a threshold of 100.",
        "query": "ASimDnsActivityLogs\n| where EventProduct == \"DNS Server\"\n            | where EventResultDetails == \"NXDOMAIN\"\n| summarize c=count() by SrcIpAddr\n| where c > 100"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "ASimDnsActivityLogs",
        "value": null
      }
    ],
    "dataTypes": [
      {
        "name": "ASimDnsActivityLogs",
        "lastDataReceivedQuery": "ASimDnsActivityLogs\n| where EventProduct == \"DNS Server\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 2,
      "isPreview": false,
      "featureFlag": {
        "feature": "ASimDnsActivityLogs",
        "featureStates": {
          "1": 2,
          "2": 2,
          "3": 2,
          "4": 2
        }
      }
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces/datasources",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace data sources",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        }
      ]
    },
    "instructionSteps": [
      {
        "instructions": [
          {
            "type": "ASimDnsActivityLogs"
          }
        ]
      }
    ]
  },
  {
    "id": "AtlassianBeaconAlerts",
    "title": "Atlassian Beacon Alerts",
    "publisher": "DEFEND Ltd.",
    "descriptionMarkdown": "Atlassian Beacon is a cloud product that is built for Intelligent threat detection across the Atlassian platforms (Jira, Confluence, and Atlassian Admin). This can help users detect, investigate and respond to risky user activity for the Atlassian suite of products. The solution is  a custom data connector from DEFEND Ltd. that is used to visualize the alerts ingested from Atlassian Beacon to Microsoft Sentinel via a Logic App.",
    "graphQueries": [
      {
        "baseQuery": "atlassian_beacon_alerts_CL",
        "legend": "Atlassian Beacon Alerts",
        "metricName": "Total data received"
      }
    ],
    "sampleQueries": [
      {
        "description": "Atlassian Beacon Alerts",
        "query": "atlassian_beacon_alerts_CL | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "lastDataReceivedQuery": "atlassian_beacon_alerts_CL | summarize Time = max(TimeGenerated) | where isnotempty(Time)",
        "name": "atlassian_beacon_alerts_CL"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "atlassian_beacon_alerts_CL | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "permissionsDisplayText": "read and write permissions are required.",
          "provider": "Microsoft.OperationalInsights/workspaces",
          "providerDisplayName": "Workspace",
          "requiredPermissions": {
            "delete": true,
            "read": true,
            "write": true
          },
          "scope": "Workspace"
        },
        {
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "providerDisplayName": "Keys",
          "requiredPermissions": {
            "action": true
          },
          "scope": "Workspace"
        }
      ]
    },
    "instructionSteps": [
      {
        "description": ">1. Navigate to the newly installed Logic App 'Atlassian Beacon Integration'\n\n>2. Navigate to 'Logic app designer'\n\n>3. Expand the 'When a HTTP request is received'\n\n>4. Copy the 'HTTP POST URL'",
        "title": "1. Microsoft Sentinel"
      },
      {
        "description": ">1. Login to Atlassian Beacon using an admin account\n\n>2. Navigate to 'SIEM forwarding' under SETTINGS\n\n> 3. Paste the copied URL from Logic App in the text box\n\n> 4. Click the 'Save' button",
        "title": "2. Atlassian Beacon"
      },
      {
        "description": ">1. Login to Atlassian Beacon using an admin account\n\n>2. Navigate to 'SIEM forwarding' under SETTINGS\n\n> 3. Click the 'Test' button right next to the newly configured webhook\n\n> 4. Navigate to Microsoft Sentinel\n\n> 5. Navigate to the newly installed Logic App\n\n> 6. Check for the Logic App Run under 'Runs history'\n\n> 7. Check for logs under the table name 'atlassian_beacon_alerts_CL' in 'Logs'\n\n> 8. If the analytic rule has been enabled, the above Test alert should have created an incident in Microsoft Sentinel",
        "title": "3. Testing and Validation"
      }
    ]
  },
  {
    "id": "Auth0",
    "title": "Auth0 Access Management",
    "publisher": "Auth0",
    "descriptionMarkdown": "The [Auth0 Access Management](https://auth0.com/access-management) data connector provides the capability to ingest [Auth0 log events](https://auth0.com/docs/api/management/v2/#!/Logs/get_logs) into Microsoft Sentinel",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Auth0AM_CL",
        "baseQuery": "Auth0AM_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "Auth0AM_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Auth0AM_CL",
        "lastDataReceivedQuery": "Auth0AM_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Auth0AM_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "**API token** is required. [See the documentation to learn more about API token](https://auth0.com/docs/secure/tokens/access-tokens/get-management-api-access-tokens-for-production)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Auth0 Management APIs to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the Auth0 Management API**\n\n Follow the instructions to obtain the credentials.\n\n1. In Auth0 Dashboard, go to **Applications > Applications**.\n2. Select your Application. This should be a \"Machine-to-Machine\" Application configured with at least **read:logs** and **read:logs_users** permissions.\n3. Copy **Domain, ClientID, Client Secret**"
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Auth0 Access Management data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following).",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the Auth0 Access Management data connector using an ARM Template.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-Auth0AccessManagement-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n> **NOTE:** Within the same resource group, you can't mix Windows and Linux apps in the same region. Select existing resource group without Windows apps in it or create new resource group.\n3. Enter the ****Domain, ClientID, Client Secret****, **AzureSentinelWorkspaceId**, **AzureSentinelSharedKey**. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the Auth0 Access Management data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-Auth0AccessManagement-azuredeploy) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. Auth0AMXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.11.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select ** New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tDOMAIN\n\t\tCLIENT_ID\n\t\tCLIENT_SECRET\n\t\tWorkspaceID\n\t\tWorkspaceKey\n\t\tlogAnalyticsUri (optional)\n> - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n4. Once all application settings have been entered, click **Save**."
      }
    ],
    "metadata": {
      "id": "056770e6-8e29-4341-8239-4b38fcd9f53d",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution"
      },
      "author": {
        "name": "Microsoft"
      },
      "support": {
        "tier": "Microsoft",
        "name": "Microsoft",
        "link": "https://support.microsoft.com/"
      }
    }
  },
  {
    "id": "Auth0ConnectorCCPDefinition",
    "title": "Auth0 Logs",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The [Auth0](https://auth0.com/docs/api/management/v2/logs/get-logs) data connector allows ingesting logs from Auth0 API into Microsoft Sentinel. The data connector is built on Microsoft Sentinel Codeless Connector Platform. It uses Auth0 API to fetch logs and it supports DCR-based [ingestion time transformations](https://docs.microsoft.com/azure/azure-monitor/logs/custom-logs-overview) that parses the received security data into a custom table so that queries don't need to parse it again, thus resulting in better performance.",
    "graphQueries": [
      {
        "metricName": "Total logs received",
        "legend": "Auth0 Logs",
        "baseQuery": "Auth0Logs_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of Auth0 logs",
        "query": "Auth0Logs_CL | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "Auth0Logs_CL",
        "lastDataReceivedQuery": "Auth0Logs_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "Authomize",
    "title": "Authomize Data Connector",
    "publisher": "Authomize",
    "descriptionMarkdown": "The Authomize Data Connector provides the capability to ingest custom log types from Authomize into Microsoft Sentinel.",
    "additionalRequirementBanner": "This data connector is not currently dependant on a parser. You will need to follow the steps to use the alias **Authomize_v2_CL** in queries and workbooks. [Follow steps to get this log event file](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Authomize/Data%20Connectors/readme.md)",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Authomize_v2_CL",
        "baseQuery": "Authomize_v2_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Number of Incidents by Severity (Critical, High, Medium, Low",
        "query": "Authomize_v2_CL\n | summarize count() by severity_s"
      },
      {
        "description": "Top 10 policies and number of incidents",
        "query": "Authomize_v2_CL\n | summarize count() by policy_name_s\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "Authomize_v2_CL",
        "lastDataReceivedQuery": "Authomize_v2_CL\n | summarize TimeGenerated=max(TimeGenerated)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Authomize_v2_CL\n | summarize LastLogReceived=max(TimeGenerated)\n | project ConnectionState=iff(LastLogReceived > ago(30d), 'Connected', 'Disconnected')"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Include custom pre-requisites if the connectivity requires - else delete customs",
          "description": "Description for any custom pre-requisite"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Locate your Authomize API key",
        "description": "Follow the setup instructions [located under Data Connectors for Authomize](https://github.com/authomize/Open-ITDR/blob/main/Open-Connectors/Platform/Azure-Sentinel/Data%20Connectors/readme.md)."
      },
      {
        "title": "2. Deploy the Authomize data connector using the setup instructions.",
        "description": "Follow the Instructions on [deploying the data connector to ingest data from Authomize](https://github.com/authomize/Open-ITDR/blob/main/Open-Connectors/Platform/Azure-Sentinel/Data%20Connectors/readme.md)."
      },
      {
        "title": "3. Finalize your setup",
        "description": "Validate that your script is running. Simple instructions are located under the [Authomize Data Connector area](https://github.com/authomize/Open-ITDR/blob/main/Open-Connectors/Platform/Azure-Sentinel/Data%20Connectors/readme.md)."
      }
    ],
    "metadata": {
      "version": "1.0.0",
      "kind": "dataConnector"
    }
  },
  {
    "id": "AutomatedLogicWebCTRL",
    "title": "Automated Logic WebCTRL ",
    "publisher": "AutomatedLogic",
    "descriptionMarkdown": "You can stream the audit logs from the WebCTRL SQL server hosted on Windows machines connected to your Microsoft Sentinel. This connection enables you to view dashboards, create custom alerts and improve investigation. This gives insights into your Industrial Control Systems that are monitored or controlled by the WebCTRL BAS application.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "AutomatedLogic-WebCTRL",
        "baseQuery": "Event\n| where Source == \"ALCWebCTRL\""
      }
    ],
    "sampleQueries": [
      {
        "description": "Total warnings and errors raised by the application",
        "query": "Event\n| where Source == \"ALCWebCTRL\"\n| where EventLevel in (1,2,3)"
      }
    ],
    "dataTypes": [
      {
        "name": "Event (AutomatedLogic-WebCTRL)",
        "lastDataReceivedQuery": "Event\n| where Source == \"ALCWebCTRL\"\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Event\n| where Source == \"ALCWebCTRL\"\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Install and onboard the Microsoft agent for Windows.",
        "description": "Learn about [agent setup](https://docs.microsoft.com/services-hub/health/mma-setup) and [windows events onboarding](https://docs.microsoft.com/azure/azure-monitor/agents/data-sources-windows-events). \n\n You can skip this step if you have already installed the Microsoft agent for Windows"
      },
      {
        "title": "2. Configure Windows task to read the audit data and write it to windows events",
        "description": "Install and configure the Windows Scheduled Task to read the audit logs in SQL and write them as Windows Events. These Windows Events will be collected by the agent and forward to Microsoft Sentinel.\n\n> Notice that the data from all machines will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "",
            "description": "2.1 Copy the [setup files](https://aka.ms/sentinel-automatedlogicwebctrl-tasksetup) to a location on the server."
          },
          {
            "title": "",
            "description": "2.2 Update the [ALC-WebCTRL-AuditPull.ps1](https://aka.ms/sentinel-automatedlogicwebctrl-auditpull) (copied in above step) script parameters like the target database name and windows event id's. Refer comments in the script for more details."
          },
          {
            "title": "",
            "description": "2.3 Update the windows task settings in the [ALC-WebCTRL-AuditPullTaskConfig.xml](https://aka.ms/sentinel-automatedlogicwebctrl-auditpulltaskconfig) file that was copied in above step as per requirement. Refer comments in the file for more details."
          },
          {
            "title": "",
            "description": "2.4 Install windows tasks using the updated configs copied in the above steps",
            "instructions": [
              {
                "parameters": {
                  "label": "Run the following command in powershell from the directory where the setup files are copied in step 2.1",
                  "value": "schtasks.exe /create /XML \"ALC-WebCTRL-AuditPullTaskConfig.xml\" /tn \"ALC-WebCTRL-AuditPull\""
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the Event schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, validate below steps for any run time issues:\n\n> 1. Make sure that the scheduled task is created and is in running state in the Windows Task Scheduler.\n\n>2. Check for task execution errors in the history tab in Windows Task Scheduler for the newly created task in step 2.4\n\n>3. Make sure that the SQL Audit table consists new records while the scheduled windows task runs."
      }
    ]
  },
  {
    "id": "AWS",
    "title": "Amazon Web Services",
    "publisher": "Amazon",
    "descriptionMarkdown": "Follow these instructions to connect to AWS and stream your CloudTrail logs into Microsoft Sentinel. For more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2218883&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "logo": "Aws.svg",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "awsCloudTrail",
        "baseQuery": "AWSCloudTrail"
      }
    ],
    "sampleQueries": [
      {
        "description": "Summarize by name",
        "query": "AWSCloudTrail\n            | summarize count() by AWSRegion, TimeGenerated\n            | sort by TimeGenerated"
      },
      {
        "description": "Summarize by name",
        "query": "AWSCloudTrail\n            | summarize count() by EventName, TimeGenerated\n            | sort by TimeGenerated"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "SentinelKinds",
        "value": [
          "AmazonWebServicesCloudTrail"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "AWSCloudTrail",
        "lastDataReceivedQuery": "AWSCloudTrail\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 2,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "write permission.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Connect AWS cloud trail with Microsoft Sentinel",
        "description": "The connection necessitates giving Microsoft permissions to access your AWS account. To enable this, follow the instructions under [Connect AWS to Microsoft Sentinel](https://aka.ms/AWSConnector) and use these parameters when prompted:\n\n> Data from all regions will be sent to and stored in the workspace's region.\n\n> It takes about 5 minutes until the connection streams data to your workspace.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "MicrosoftAwsAccount"
              ],
              "label": "Microsoft account ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "External ID (Workspace ID)"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "text": "The integration is applicable for AWS public cloud accounts.",
              "visible": false,
              "inline": true
            },
            "type": "InfoMessage"
          },
          {
            "parameters": {},
            "type": "AwsCloudTrail"
          }
        ]
      }
    ]
  },
  {
    "id": "AwsCloudfrontCcpDefinition",
    "title": "Amazon Web Services CloudFront (via Codeless Connector Framework) (Preview)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "This data connector enables the integration of AWS CloudFront logs with Microsoft Sentinel to support advanced threat detection, investigation, and security monitoring. By utilizing Amazon S3 for log storage and Amazon SQS for message queuing, the connector reliably ingests CloudFront access logs into Microsoft Sentinel",
    "graphQueries": [
      {
        "metricName": "Total access logs received",
        "legend": "Amazon Web Services CloudFront AccessLog",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of access logs",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "AwsNetworkFirewallCcpDefinition",
    "title": "Amazon Web Services NetworkFirewall (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "This data connector allows you to ingest AWS Network Firewall logs into Microsoft Sentinel for advanced threat detection and security monitoring. By leveraging Amazon S3 and Amazon SQS, the connector forwards network traffic logs, intrusion detection alerts, and firewall events to Microsoft Sentinel, enabling real-time analysis and correlation with other security data",
    "graphQueries": [
      {
        "metricName": "Total Flow events received",
        "legend": "Amazon Web Services NetworkFirewall FlowLog",
        "baseQuery": "{{graphQueriesTableName}}"
      },
      {
        "metricName": "Total Alerts received",
        "legend": "Amazon Web Services NetworkFirewall AlertLog",
        "baseQuery": "AWSNetworkFirewallAlert"
      },
      {
        "metricName": "Total TLS logs received",
        "legend": "Amazon Web Services NetworkFirewall TLSLog",
        "baseQuery": "AWSNetworkFirewallTls"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of Flow logs",
        "query": "{{graphQueriesTableName}}\n | take 10"
      },
      {
        "description": "Get Sample of Alert logs",
        "query": "AWSNetworkFirewallAlert\n | take 10"
      },
      {
        "description": "Get Sample of Tls logs",
        "query": "AWSNetworkFirewallTls\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "AWSNetworkFirewallAlert",
        "lastDataReceivedQuery": "AWSNetworkFirewallAlert\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "AWSNetworkFirewallTls",
        "lastDataReceivedQuery": "AWSNetworkFirewallTls\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "AWSRoute53ResolverCCPDefinition",
    "title": "Amazon Web Services S3 DNS Route53 (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "This connector enables ingestion of AWS Route 53 DNS logs into Microsoft Sentinel for enhanced visibility and threat detection. It supports DNS Resolver query logs ingested directly from AWS S3 buckets, while Public DNS query logs and Route 53 audit logs can be ingested using Microsoft Sentinel's AWS CloudWatch and CloudTrail connectors. Comprehensive instructions are provided to guide you through the setup of each log type. Leverage this connector to monitor DNS activity, detect potential threats, and improve your security posture in cloud environments.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "Amazon Web Services S3 Resolver query logs",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of DNS Resolver query logs",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n            | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "AwsS3",
    "title": "Amazon Web Services S3",
    "publisher": "Amazon",
    "descriptionMarkdown": "This connector allows you to ingest AWS service logs, collected in AWS S3 buckets, to Microsoft Sentinel. The currently supported data types are: \n* AWS CloudTrail\n* VPC Flow Logs\n* AWS GuardDuty\n* AWSCloudWatch\n\nFor more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2218883&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "logo": "Aws.svg",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "AWSGuardDuty",
        "baseQuery": "AWSGuardDuty"
      },
      {
        "metricName": "Total data received",
        "legend": "AWSVPCFlow",
        "baseQuery": "AWSVPCFlow"
      },
      {
        "metricName": "Total data received",
        "legend": "AWSCloudTrail",
        "baseQuery": "AWSCloudTrail"
      },
      {
        "metricName": "Total data received",
        "legend": "AWSCloudWatch",
        "baseQuery": "AWSCloudWatch"
      }
    ],
    "sampleQueries": [
      {
        "description": "High severity findings summarized by activity type",
        "query": "AWSGuardDuty\n            | where Severity > 7\n            | summarize count() by ActivityType"
      },
      {
        "description": "Top 10 rejected actions of type IPv4",
        "query": "AWSVPCFlow\n            | where Action == \"REJECT\"\n            | where Type == \"IPv4\"\n            | take 10"
      },
      {
        "description": "User creation events summarized by region",
        "query": "AWSCloudTrail\n            | where EventName == \"CreateUser\"\n            | summarize count() by AWSRegion"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "SentinelKinds",
        "value": [
          "AmazonWebServicesS3"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "AWSGuardDuty",
        "lastDataReceivedQuery": "AWSGuardDuty\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "AWSVPCFlow",
        "lastDataReceivedQuery": "AWSVPCFlow\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "AWSCloudTrail",
        "lastDataReceivedQuery": "AWSCloudTrail\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "AWSCloudWatch",
        "lastDataReceivedQuery": "AWSCloudWatch\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 2,
      "featureFlag": {
        "feature": "AWSS3Connector",
        "featureStates": {
          "Dogfood": "GA",
          "MPAC": "GA",
          "Prod": "GA",
          "Fairfax": "GA",
          "Mooncake": "PrivatePreview",
          "USSec": "PrivatePreview",
          "USNat": "PrivatePreview"
        }
      }
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "write permission.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "Environment",
          "description": "you must have the following AWS resources defined and configured: S3, Simple Queue Service (SQS), IAM roles and permissions policies, and the AWS services whose logs you want to collect."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Set up your AWS environment",
        "description": "There are two options for setting up your AWS environment to send logs from an S3 bucket to your Log Analytics Workspace:",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Setup with PowerShell script (recommended)",
                  "instructions": [
                    {
                      "parameters": {
                        "govScript": "Download and extract the files from the following link: [AWS S3 Setup Script](https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/AWS-S3/ConfigAwsS3DataConnectorScriptsGov.zip).\n\n> 1. Make sure that you have PowerShell on your machine: [Installation instructions for PowerShell](https://docs.microsoft.com/powershell/scripting/install/installing-powershell?view=powershell-7.2).\n\n> 2. Make sure that you have the AWS CLI on your machine: [Installation instructions for the AWS CLI](https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html).\n\nBefore running the script, run the aws configure command from your PowerShell command line, and enter the relevant information as prompted. See [AWS Command Line Interface | Configuration basics](https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-quickstart.html) for details. Note: When Aws configure is run, Default output format should not be set to None. It must be set to some value, such as json.",
                        "prodScript": "Download and extract the files from the following link: [AWS S3 Setup Script](https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/AWS-S3/ConfigAwsS3DataConnectorScripts.zip).\n\n> 1. Make sure that you have PowerShell on your machine: [Installation instructions for PowerShell](https://docs.microsoft.com/powershell/scripting/install/installing-powershell?view=powershell-7.2).\n\n> 2. Make sure that you have the AWS CLI on your machine: [Installation instructions for the AWS CLI](https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html).\n\nBefore running the script, run the aws configure command from your PowerShell command line, and enter the relevant information as prompted. See [AWS Command Line Interface | Configuration basics](https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-quickstart.html) for details. Note: When Aws configure is run, Default output format should not be set to None. It must be set to some value, such as json."
                      },
                      "type": "MarkdownControlEnvBased"
                    },
                    {
                      "parameters": {
                        "label": "Run script to set up the environment",
                        "value": "./ConfigAwsConnector.ps1"
                      },
                      "type": "CopyableLabel"
                    },
                    {
                      "parameters": {
                        "fillWith": [
                          "WorkspaceId"
                        ],
                        "label": "External ID (Workspace ID)"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                },
                {
                  "title": "Manual Setup",
                  "description": "Follow the instruction in the following link to set up the environment: [Connect AWS S3 to Microsoft Sentinel](https://aka.ms/AWSS3Connector)"
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Add connection",
        "instructions": [
          {
            "parameters": {},
            "type": "AwsS3"
          }
        ]
      }
    ]
  },
  {
    "id": "AwsS3ServerAccessLogsDefinition",
    "title": "AWS S3 Server Access Logs (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "This connector allows you to ingest AWS S3 Server Access Logs into Microsoft Sentinel. These logs contain detailed records for requests made to S3 buckets, including the type of request, resource accessed, requester information, and response details. These logs are useful for analyzing access patterns, debugging issues, and ensuring security compliance.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "AWS S3 Server Access Logs",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of logs",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | where TimeGenerated > ago(12h) | summarize LastReceived = max(TimeGenerated)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "AWSS3VPCFlowLogsParquetDefinition",
    "title": "Amazon Web Services S3 VPC Flow Logs",
    "publisher": "Microsoft",
    "descriptionMarkdown": "This connector allows you to ingest AWS VPC Flow Logs, collected in AWS S3 buckets, to Microsoft Sentinel. AWS VPC Flow Logs provide visibility into network traffic within your AWS Virtual Private Cloud (VPC), enabling security analysis and network monitoring.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "AWS VPC Flow Logs Parquet",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of logs",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n            | where TimeGenerated > ago(12h) | where name_s == \"no data test\"               | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "AwsS3WafCcpDefinition",
    "title": "Amazon Web Services S3 WAF",
    "publisher": "Microsoft",
    "descriptionMarkdown": "This connector allows you to ingest AWS WAF logs, collected in AWS S3 buckets, to Microsoft Sentinel. AWS WAF logs are detailed records of traffic that web access control lists (ACLs) analyze, which are essential for maintaining the security and performance of web applications. These logs contain information such as the time AWS WAF received the request, the specifics of the request, and the action taken by the rule that the request matched.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "Amazon Web Services S3 WAF",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of logs",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n            | where TimeGenerated > ago(12h) | where name_s == \"no data test\"               | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "AwsSecurityHubFindingsCcpDefinition",
    "title": "AWS Security Hub Findings (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "This connector enables the ingestion of AWS Security Hub Findings, which are collected in AWS S3 buckets, into Microsoft Sentinel. It helps streamline the process of monitoring and managing security alerts by integrating AWS Security Hub Findings with Microsoft Sentinel's advanced threat detection and response capabilities.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "AWS Security Hub Findings",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of logs",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | where TimeGenerated > ago(12h)\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "AzureActiveDirectory",
    "title": "Microsoft Entra ID",
    "publisher": "Microsoft",
    "logo": {
      "type": 3,
      "options": null
    },
    "descriptionMarkdown": "Gain insights into Microsoft Entra ID by connecting Audit and Sign-in logs to Microsoft Sentinel to gather insights around Microsoft Entra ID scenarios. You can learn about app usage, conditional access policies, legacy auth relate details using our Sign-in logs. You can get information on your Self Service Password Reset (SSPR) usage, Microsoft Entra ID Management activities like user, group, role, app management using our Audit logs table. For more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/?linkid=2219715&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "SigninLogs",
        "baseQuery": "SigninLogs"
      },
      {
        "metricName": "Total data received",
        "legend": "AuditLogs",
        "baseQuery": "AuditLogs"
      },
      {
        "metricName": "Total data received",
        "legend": "AADNonInteractiveUserSignInLogs",
        "baseQuery": "AADNonInteractiveUserSignInLogs"
      },
      {
        "metricName": "Total data received",
        "legend": "AADServicePrincipalSignInLogs",
        "baseQuery": "AADServicePrincipalSignInLogs"
      },
      {
        "metricName": "Total data received",
        "legend": "AADManagedIdentitySignInLogs",
        "baseQuery": "AADManagedIdentitySignInLogs"
      },
      {
        "metricName": "Total data received",
        "legend": "AADProvisioningLogs",
        "baseQuery": "AADProvisioningLogs"
      },
      {
        "metricName": "Total data received",
        "legend": "ADFSSignInLogs",
        "baseQuery": "ADFSSignInLogs"
      },
      {
        "metricName": "Total data received",
        "legend": "AADUserRiskEvents",
        "baseQuery": "AADUserRiskEvents"
      },
      {
        "metricName": "Total data received",
        "legend": "AADRiskyUsers",
        "baseQuery": "AADRiskyUsers"
      },
      {
        "metricName": "Total data received",
        "legend": "NetworkAccessTraffic",
        "baseQuery": "NetworkAccessTraffic"
      },
      {
        "metricName": "Total data received",
        "legend": "AADRiskyServicePrincipals",
        "baseQuery": "AADRiskyServicePrincipals"
      },
      {
        "metricName": "Total data received",
        "legend": "AADServicePrincipalRiskEvents",
        "baseQuery": "AADServicePrincipalRiskEvents"
      }
    ],
    "lastDataReceivedInfoBalloon": "If no new data has been received in the last 14 days, the connector will display as being \"not connected.\" When the connector will recive data , the \"connected\" status will return.",
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "SigninLogs\n            | take 1000\n            | sort by TimeGenerated"
      },
      {
        "description": "Summarize by 1 hour bins",
        "query": "AuditLogs\n            | summarize count() by bin(TimeGenerated, 1h)\n            | sort by TimeGenerated"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "SigninLogs\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AuditLogs\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AADNonInteractiveUserSignInLogs\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AADServicePrincipalSignInLogs\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AADManagedIdentitySignInLogs\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AADProvisioningLogs\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "ADFSSignInLogs\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AADUserRiskEvents\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AADRiskyUsers\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "NetworkAccessTraffic\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AADRiskyServicePrincipals\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AADServicePrincipalRiskEvents\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "SigninLogs",
        "lastDataReceivedQuery": "SigninLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "AuditLogs",
        "lastDataReceivedQuery": "AuditLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "AADNonInteractiveUserSignInLogs",
        "lastDataReceivedQuery": "AADNonInteractiveUserSignInLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "AADServicePrincipalSignInLogs",
        "lastDataReceivedQuery": "AADServicePrincipalSignInLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "AADManagedIdentitySignInLogs",
        "lastDataReceivedQuery": "AADManagedIdentitySignInLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "AADProvisioningLogs",
        "lastDataReceivedQuery": "AADProvisioningLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ADFSSignInLogs",
        "lastDataReceivedQuery": "ADFSSignInLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "AADUserRiskEvents",
        "lastDataReceivedQuery": "AADUserRiskEvents\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "AADRiskyUsers",
        "lastDataReceivedQuery": "AADRiskyUsers\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "NetworkAccessTraffic",
        "lastDataReceivedQuery": "NetworkAccessTraffic\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "AADRiskyServicePrincipals",
        "lastDataReceivedQuery": "AADRiskyServicePrincipals\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "AADServicePrincipalRiskEvents",
        "lastDataReceivedQuery": "AADServicePrincipalRiskEvents\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "tenant": [
        "GlobalAdmin",
        "SecurityAdmin"
      ],
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "microsoft.aadiam/diagnosticSettings",
          "providerDisplayName": "Diagnostic Settings",
          "permissionsDisplayText": "read and write permissions to AAD diagnostic settings.",
          "requiredPermissions": {
            "read": true,
            "write": true
          },
          "scope": "/providers/microsoft.aadiam"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Connect Microsoft Entra ID logs to Microsoft Sentinel",
        "description": "Select Microsoft Entra ID log types:",
        "instructions": [
          {
            "parameters": {
              "connectorKind": "AzureActiveDirectory",
              "dataTypes": [
                {
                  "title": "Sign-In Logs",
                  "name": "SignInLogs",
                  "infoBoxHtmlTemplate": "In order to export Sign-in data, your organization needs Microsoft Entra ID P1 or P2 license. If you don't have a P1 or P2, <a target=\"_blank\" href=\"https://ms.portal.azure.com/#blade/Microsoft_AAD_IAM/TryBuyProductBlade\">start a free trial.</a>"
                },
                {
                  "title": "Audit Logs",
                  "name": "AuditLogs"
                },
                {
                  "title": "Non-Interactive User Sign-In Log",
                  "name": "NonInteractiveUserSignInLogs"
                },
                {
                  "title": "Service Principal Sign-In Logs",
                  "name": "ServicePrincipalSignInLogs"
                },
                {
                  "title": "Managed Identity Sign-In Logs",
                  "name": "ManagedIdentitySignInLogs"
                },
                {
                  "title": "Provisioning Logs",
                  "name": "ProvisioningLogs"
                },
                {
                  "title": "ADFS Sign-In Logs",
                  "name": "ADFSSignInLogs"
                },
                {
                  "title": "User Risk Events",
                  "name": "UserRiskEvents"
                },
                {
                  "title": "Risky Users",
                  "name": "RiskyUsers"
                },
                {
                  "title": "Network Access Traffic Logs",
                  "name": "NetworkAccessTrafficLogs"
                },
                {
                  "title": "Risky Service Principals",
                  "name": "RiskyServicePrincipals"
                },
                {
                  "title": "Service Principal Risk Events",
                  "name": "ServicePrincipalRiskEvents"
                }
              ]
            },
            "type": "AADDataTypes"
          }
        ]
      }
    ]
  },
  {
    "id": "AzureActiveDirectoryIdentityProtection",
    "title": "Microsoft Entra ID Protection",
    "publisher": "Microsoft",
    "logo": {
      "type": 3,
      "options": null
    },
    "descriptionMarkdown": "Microsoft Entra ID Protection provides a consolidated view at risk users, risk events and vulnerabilities, with the ability to remediate risk immediately, and set policies to auto-remediate future events. The service is built on Microsofts experience protecting consumer identities and gains tremendous accuracy from the signal from over 13 billion logins a day. Integrate Microsoft Microsoft Entra ID Protection alerts with Microsoft Sentinel to view dashboards, create custom alerts, and improve investigation. For more information, see the [Microsoft Sentinel documentation ](https://go.microsoft.com/fwlink/p/?linkid=2220065&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).\n\n[Get Microsoft Entra ID Premium P1/P2 ](https://aka.ms/asi-ipcconnectorgetlink)",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "SecurityAlerts (IPC)",
        "baseQuery": "SecurityAlert | where ProductName == \"Azure Active Directory Identity Protection\""
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "SecurityAlert | where ProductName == \"Azure Active Directory Identity Protection\" | summarize arg_max(TimeGenerated, *) by SystemAlertId\n            | sort by TimeGenerated"
      },
      {
        "description": "Summarize by severity",
        "query": "SecurityAlert | where ProductName == \"Azure Active Directory Identity Protection\" | summarize arg_max(TimeGenerated, *) by SystemAlertId\n            | summarize count() by AlertSeverity"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "MtpAlerts",
        "value": [
          "AzureActiveDirectory"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "SecurityAlert (IPC)",
        "lastDataReceivedQuery": "SecurityAlert | where ProductName == \"Azure Active Directory Identity Protection\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 2,
      "isPreview": false,
      "featureFlag": {
        "feature": "AadIp",
        "featureStates": {
          "1": 2,
          "2": 2,
          "3": 2,
          "4": 2,
          "5": 2,
          "6": 1,
          "7": 1
        }
      }
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        }
      ],
      "tenant": [
        "GlobalAdmin",
        "SecurityAdmin"
      ],
      "licenses": [
        "AadP1P2"
      ]
    },
    "instructionSteps": [
      {
        "title": "Microsoft Entra ID Protection alerts to Microsoft Sentinel",
        "description": "Connect Microsoft Entra ID Protection to Microsoft Sentinel. \n            \n> The alerts are sent to this Microsoft Sentinel workspace.",
        "instructions": [
          {
            "parameters": {
              "connectorKind": "AzureActiveDirectory",
              "title": "Microsoft Entra ID Protection",
              "enable": true
            },
            "type": "SentinelResourceProvider"
          }
        ]
      }
    ],
    "caseGenerationSteps": [
      {
        "instructions": [
          {
            "parameters": {
              "filterProduct": "Microsoft Entra ID Protection"
            },
            "type": "FilterAlert"
          }
        ]
      }
    ]
  },
  {
    "id": "AzureActivity",
    "title": "Azure Activity",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Azure Activity Log is a subscription log that provides insight into subscription-level events that occur in Azure, including events from Azure Resource Manager operational data, service health events, write operations taken on the resources in your subscription, and the status of activities performed in Azure. For more information, see the [Microsoft Sentinel documentation ](https://go.microsoft.com/fwlink/p/?linkid=2219695&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "logo": "AzureActivity.svg",
    "lastDataReceivedInfoBalloon": "If no new data has been received in the last 14 days, the connector will display as being \"not connected.\" When the connector will recive data , the \"connected\" status will return.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "AzureActivity",
        "baseQuery": "AzureActivity"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "AzureActivity \n| take 1000"
      },
      {
        "description": "Summarize by 1 hour bins",
        "query": "AzureActivity\n            | summarize count() by bin(TimeGenerated, 1h)\n            | sort by TimeGenerated"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "AzureActivity\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "AzureActivity",
        "lastDataReceivedQuery": "AzureActivity\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "Policy",
          "description": "owner role assigned for each policy assignment scope."
        },
        {
          "name": "Subscription",
          "description": "owner role permission on the relevant subscription"
        }
      ]
    },
    "instructionSteps": [
      {
        "instructions": [
          {
            "parameters": {
              "text": "This connector has been updated to use the diagnostics settings back-end pipeline. which provides increased functionality and better consistency with resource logs.\nConnectors using this pipeline can also be governed at scale by Azure Policy. Learn more about the new <a href=\"https://docs.microsoft.com/azure/sentinel/connect-azure-activity\">Azure Activity connector</a>.\nFollow the instructions below to upgrade your connector to the diagnostics settings pipeline.",
              "visible": true,
              "inline": false
            },
            "type": "InfoMessage"
          }
        ]
      },
      {
        "title": "1. Disconnect your subscriptions from the legacy method",
        "description": "The subscriptions listed below are still using the older, legacy method. You are strongly encouraged to upgrade to the new pipeline.<br>\nTo do this, click on the 'Disconnect All' button below, before proceeding to launch the Azure Policy Assignment wizard.",
        "instructions": [
          {
            "parameters": {
              "datasourceName": "AzureActivityLog"
            },
            "type": "OmsDatasource"
          }
        ]
      },
      {
        "title": "2.  Connect your subscriptions through diagnostic settings new pipeline",
        "description": "This connector uses Azure Policy to apply a single Azure Subscription log-streaming configuration to a collection of subscriptions, defined as a scope.\nFollow the instructions below to create and apply a policy to all current and future subscriptions. **Note**, you may already have an active policy for this resource type.",
        "innerSteps": [
          {
            "title": "Launch the Azure Policy Assignment wizard and follow the steps.",
            "description": ">1. In the **Basics** tab, click the button with the three dots under **Scope** to select your resources assignment scope.\n        >2. In the **Parameters** tab, choose your Microsoft Sentinel workspace from the **Log Analytics workspace** drop-down list, and leave marked as \"True\" all the log and metric types you want to ingest.\n        >3. To apply the policy on your existing resources, select the **Remediation tab** and mark the **Create a remediation task** checkbox.",
            "instructions": [
              {
                "parameters": {
                  "linkType": "OpenPolicyAssignment",
                  "policyDefinitionGuid": "2465583e-4e78-4c15-b6be-a36cbc7c8b0f",
                  "assignMode": 1
                },
                "type": "InstallAgent"
              }
            ]
          }
        ]
      }
    ],
    "metadata": {
      "id": "56a9f1b9-6cc2-4a65-b3bf-1c39bb47c09b",
      "version": "2.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Microsoft"
      },
      "support": {
        "tier": "community",
        "name": "Microsoft",
        "link": "https://github.com/Azure/Azure-Sentinel/issues"
      }
    }
  },
  {
    "id": "AzureAdvancedThreatProtection",
    "title": "Microsoft Defender for Identity",
    "publisher": "Microsoft",
    "logo": {
      "type": 258,
      "options": null
    },
    "descriptionMarkdown": "Connect Microsoft Defender for Identity to gain visibility into the events and user analytics. Microsoft Defender for Identity identifies, detects, and helps you investigate advanced threats, compromised identities, and malicious insider actions directed at your organization. Microsoft Defender for Identity enables SecOp analysts and security professionals struggling to detect advanced attacks in hybrid environments to:\n\n-   Monitor users, entity behavior, and activities with learning-based analytics\n-   Protect user identities and credentials stored in Active Directory\n-   Identify and investigate suspicious user activities and advanced attacks throughout the kill chain\n-   Provide clear incident information on a simple timeline for fast triage\n\n[Try now >](https://aka.ms/AtpTryNow)\n\n[Deploy now >](https://aka.ms/AzureATP_Deploy)\n\nFor more information, see the [Microsoft Sentinel documentation >](https://go.microsoft.com/fwlink/p/?linkid=2220069&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "SecurityAlerts",
        "baseQuery": "SecurityAlert\n    | where ProductName == \"Azure Advanced Threat Protection\"\n        | extend alertWasCustomized = bag_has_key(todynamic(ExtendedProperties), \"OriginalProductName\")\n        | where alertWasCustomized == false"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "SecurityAlert\n    | where ProductName == \"Azure Advanced Threat Protection\"\n        | extend alertWasCustomized = bag_has_key(todynamic(ExtendedProperties), \"OriginalProductName\")\n        | where alertWasCustomized == false | summarize arg_max(TimeGenerated, *) by SystemAlertId\n            | sort by TimeGenerated"
      },
      {
        "description": "Summarize by operation",
        "query": "SecurityAlert\n    | where ProductName == \"Azure Advanced Threat Protection\"\n        | extend alertWasCustomized = bag_has_key(todynamic(ExtendedProperties), \"OriginalProductName\")\n        | where alertWasCustomized == false | summarize arg_max(TimeGenerated, *) by SystemAlertId\n            | summarize count() by TimeGenerated\n            | sort by TimeGenerated"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "MtpAlerts",
        "value": [
          "AzureAdvancedThreatProtection"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "SecurityAlert (AATP)",
        "lastDataReceivedQuery": "SecurityAlert\n    | where ProductName == \"Azure Advanced Threat Protection\"\n        | extend alertWasCustomized = bag_has_key(todynamic(ExtendedProperties), \"OriginalProductName\")\n        | where alertWasCustomized == false\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 2,
      "featureFlag": {
        "feature": "AATPConnector",
        "featureStates": {
          "1": 2,
          "2": 2,
          "3": 2,
          "4": 2,
          "5": 2
        }
      }
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        }
      ],
      "tenant": [
        "SecurityAdmin",
        "GlobalAdmin"
      ],
      "licenses": [
        "Aatp"
      ]
    },
    "instructionSteps": [
      {
        "title": "Connect Microsoft Defender for Identity to Microsoft Sentinel",
        "description": "If your tenant is running [Microsoft Defender for Identity](https://aka.ms/Sentinel/MDI/Preview)  in Microsoft Defender for Cloud Apps, connect here to stream your Microsoft Defender for Identity alerts into Microsoft Sentinel\n\n> In order to integrate with Microsoft Defender for Identity alerts, use  **global administrator**, or  **security administrator**  permission.",
        "instructions": [
          {
            "parameters": {
              "title": "Microsoft Defender for Identity",
              "connectorKind": "AzureAdvancedThreatProtection",
              "enable": true,
              "consentText": "Yes, I have connected Microsoft Defender for Identity to Microsoft Defender for Cloud Apps"
            },
            "type": "SentinelResourceProvider"
          }
        ]
      }
    ],
    "caseGenerationSteps": [
      {
        "instructions": [
          {
            "parameters": {
              "filterProduct": "Azure Advanced Threat Protection"
            },
            "type": "FilterAlert"
          }
        ]
      }
    ]
  },
  {
    "id": "AzureBatchAccount_CCP",
    "title": "Azure Batch Account",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Azure Batch Account is a uniquely identified entity within the Batch service. Most Batch solutions use Azure Storage for storing resource files and output files, so each Batch account is usually associated with a corresponding storage account. This connector lets you stream your Azure Batch account diagnostics logs into Microsoft Sentinel, allowing you to continuously monitor activity. For more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2224103&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "AzureDiagnostics",
        "baseQuery": "AzureDiagnostics| where ResourceProvider == \"MICROSOFT.BATCH\""
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "AzureDiagnostics \n| where ResourceProvider == \"MICROSOFT.BATCH\" \n"
      },
      {
        "description": "Count By Batch Accounts",
        "query": "AzureDiagnostics \n| where ResourceProvider == \"MICROSOFT.BATCH\" \n| summarize count() by Resource"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "AzureDiagnostics | where ResourceProvider == \"MICROSOFT.BATCH\"\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "AzureDiagnostics (Batch Account)",
        "lastDataReceivedQuery": "AzureDiagnostics| where ResourceProvider == \"MICROSOFT.BATCH\" | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "Policy",
          "description": "owner role assigned for each policy assignment scope"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Connect your Azure Batch Account diagnostics logs into Sentinel.",
        "description": "This connector uses Azure Policy to apply a single Azure Batch Account log-streaming configuration to a collection of instances, defined as a scope. Follow the instructions below to create and apply a policy to all current and future instances. Note, you may already have an active policy for this resource type.",
        "instructions": [
          {
            "parameters": {
              "noFxPadding": "1",
              "expanded": "1",
              "instructionSteps": [
                {
                  "title": "Stream diagnostics logs from your Azure Batch Account at scale",
                  "innerSteps": [
                    {
                      "title": "Launch the Azure Policy Assignment wizard and follow the steps. ",
                      "description": ">    1. In the **Basics** tab, click the button with the three dots under **Scope** to select your subscription.<br />2. In the **Parameters** tab, choose your Microsoft Sentinel workspace from the **Log Analytics workspace** drop-down list, and leave marked as \"True\" all the log categories you want to ingest.<br />3. To apply the policy on your existing resources, mark the **Create a remediation task** check box in the **Remediation** tab.</value>",
                      "instructions": [
                        {
                          "parameters": {
                            "policyDefinitionGuid": "c84e5349-db6d-4769-805e-e14037dab9b5"
                          },
                          "type": "PolicyAssignment"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "AzureCloudNGFWByPaloAltoNetworks",
    "title": "Azure CloudNGFW By Palo Alto Networks",
    "publisher": "Palo Alto Networks",
    "descriptionMarkdown": "Cloud Next-Generation Firewall by Palo Alto Networks - an Azure Native ISV Service - is Palo Alto Networks Next-Generation Firewall (NGFW) delivered as a cloud-native service on Azure. You can discover Cloud NGFW in the Azure Marketplace and consume it in your Azure Virtual Networks (VNet). With Cloud NGFW, you can access the core NGFW capabilities such as App-ID, URL filtering based technologies. It provides threat prevention and detection through cloud-delivered security services and threat prevention signatures. The connector allows you to easily connect your Cloud NGFW logs with Microsoft Sentinel, to view dashboards, create custom alerts, and improve investigation. This gives you more insight into your organization's network and improves your security operation capabilities. For more information, see the [Cloud NGFW for Azure documentation](https://docs.paloaltonetworks.com/cloud-ngfw/azure).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Azure CloudNGFW By Palo Alto Networks",
        "baseQuery": "fluentbit_CL\n| where isnotempty(FirewallName_s)\n"
      }
    ],
    "sampleQueries": [
      {
        "description": "List of connected Cloud NGFW resources",
        "query": "fluentbit_CL\n| distinct FirewallName_s"
      },
      {
        "description": "Connectivity status of Cloud NGFW resources",
        "query": "fluentbit_CL\n| extend TimeGenerated = todatetime(TimeGenerated)\n| summarize LastLogReceived = max(TimeGenerated) by FirewallName_s\n| extend Status = iff(now() - LastLogReceived > 24h, \"Disconnected\", \"Connected\")\n| project FirewallName_s, LastLogReceived, Status\n| order by Status desc, LastLogReceived desc"
      },
      {
        "description": "Total data received (MB)",
        "query": "fluentbit_CL\n| extend bytes_received = toint(parse_json(Message).bytes_recv)\n| summarize TotalBytesReceived = sum(bytes_received)\n| extend TotalMBReceived = round(TotalBytesReceived / 1048576.0, 2)\n| project TotalMBReceived"
      },
      {
        "description": "Top 5 apps",
        "query": "fluentbit_CL\n| extend app = tostring(parse_json(Message).app)\n| summarize Count = count() by app\n| top 5 by Count desc\n| project app, Count"
      },
      {
        "description": "Top 5 categories",
        "query": "fluentbit_CL\n| extend category = tostring(parse_json(Message).category)\n| summarize Count = count() by category\n| top 5 by Count desc\n| project category, Count"
      },
      {
        "description": "Top 5 rules",
        "query": "fluentbit_CL\n| summarize Rule=count() by tostring(parse_json(Message).rule)\n| top 5 by Rule desc"
      },
      {
        "description": "Top 5 source IPs",
        "query": "fluentbit_CL\n| summarize SourceIP=count() by tostring(parse_json(Message).src_ip)\n| top 5 by SourceIP desc"
      },
      {
        "description": "Top 5 destination IPs",
        "query": "fluentbit_CL\n| summarize DestinationIP=count() by tostring(parse_json(Message).dst_ip)\n| top 5 by DestinationIP desc"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "fluentbit_CL\n| extend TimeGenerated = todatetime(TimeGenerated)\n| summarize LastLogReceived = max(TimeGenerated) by FirewallName_s\n| project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "fluentbit_CL",
        "lastDataReceivedQuery": "fluentbit_CL\n| extend TimeGenerated = todatetime(TimeGenerated)\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Connect Cloud NGFW by Palo Alto Networks to Microsoft Sentinel",
        "description": "Enable Log Settings on All Cloud NGFWs by Palo Alto Networks.",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenCloudNGFW"
            },
            "type": "ConfigureLogSettings"
          }
        ]
      },
      {
        "title": "",
        "description": "Inside your Cloud NGFW resource:\n\n1.  Navigate to the **Log Settings** from the homepage.\n2.  Ensure the **Enable Log Settings** checkbox is checked.\n3.  From the **Log Settings** drop-down, choose the desired Log Analytics Workspace.\n4.  Confirm your selections and configurations.\n5.  Click **Save** to apply the settings."
      }
    ],
    "metadata": {
      "id": "ef80260c-3aec-43bc-a1e5-c2f2372c9adc",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Palo Alto Networks"
      },
      "support": {
        "name": "Palo Alto Networks",
        "link": "https://www.paloaltonetworks.com/company/contact-support",
        "tier": "developer"
      }
    }
  },
  {
    "id": "AzureCognitiveSearch_CCP",
    "title": "Azure Cognitive Search",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Azure Cognitive Search is a cloud search service that gives developers infrastructure, APIs, and tools for building a rich search experience over private, heterogeneous content in web, mobile, and enterprise applications. This connector lets you stream your Azure Cognitive Search diagnostics logs into Microsoft Sentinel, allowing you to continuously monitor activity. ",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "AzureDiagnostics",
        "baseQuery": "AzureDiagnostics| where ResourceProvider == \"MICROSOFT.SEARCH\""
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "AzureDiagnostics \n| where ResourceProvider == \"MICROSOFT.SEARCH\" \n"
      },
      {
        "description": "Count By Cognitive Search",
        "query": "AzureDiagnostics \n| where ResourceProvider == \"MICROSOFT.SEARCH\" \n| summarize count() by Resource"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "AzureDiagnostics | where ResourceProvider == \"MICROSOFT.SEARCH\"\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "AzureDiagnostics (Cognitive Search)",
        "lastDataReceivedQuery": "AzureDiagnostics| where ResourceProvider == \"MICROSOFT.SEARCH\" | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "Policy",
          "description": "owner role assigned for each policy assignment scope"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Connect your Azure Cognitive Search diagnostics logs into Sentinel.",
        "description": "This connector uses Azure Policy to apply a single Azure Cognitive Search log-streaming configuration to a collection of instances, defined as a scope. Follow the instructions below to create and apply a policy to all current and future instances. Note, you may already have an active policy for this resource type.",
        "instructions": [
          {
            "parameters": {
              "noFxPadding": "1",
              "expanded": "1",
              "instructionSteps": [
                {
                  "title": "Stream diagnostics logs from your Azure Cognitive Search at scale",
                  "innerSteps": [
                    {
                      "title": "Launch the Azure Policy Assignment wizard and follow the steps. ",
                      "description": ">    1. In the **Basics** tab, click the button with the three dots under **Scope** to select your subscription.<br />2. In the **Parameters** tab, choose your Microsoft Sentinel workspace from the **Log Analytics workspace** drop-down list, and leave marked as \"True\" all the log categories you want to ingest.<br />3. To apply the policy on your existing resources, mark the **Create a remediation task** check box in the **Remediation** tab.</value>",
                      "instructions": [
                        {
                          "parameters": {
                            "policyDefinitionGuid": "08ba64b8-738f-4918-9686-730d2ed79c7d"
                          },
                          "type": "PolicyAssignment"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "AzureDataLakeStorageGen1_CCP",
    "title": "Azure Data Lake Storage Gen1",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Azure Data Lake Storage Gen1 is an enterprise-wide hyper-scale repository for big data analytic workloads. Azure Data Lake enables you to capture data of any size, type, and ingestion speed in one single place for operational and exploratory analytics. This connector lets you stream your Azure Data Lake Storage Gen1 diagnostics logs into Microsoft Sentinel, allowing you to continuously monitor activity. For more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2223812&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "AzureDiagnostics",
        "baseQuery": "AzureDiagnostics| where ResourceProvider == \"MICROSOFT.DATALAKESTORE\""
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "AzureDiagnostics \n| where ResourceProvider == \"MICROSOFT.DATALAKESTORE\" \n"
      },
      {
        "description": "Count By Data Lake Storage",
        "query": "AzureDiagnostics \n| where ResourceProvider == \"MICROSOFT.DATALAKESTORE\" \n| summarize count() by Resource"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "AzureDiagnostics | where ResourceProvider == \"MICROSOFT.DATALAKESTORE\"\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "AzureDiagnostics (Data Lake Storage Gen1)",
        "lastDataReceivedQuery": "AzureDiagnostics| where ResourceProvider == \"MICROSOFT.DATALAKESTORE\" | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "Policy",
          "description": "owner role assigned for each policy assignment scope"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Connect your Azure Data Lake Storage Gen1 diagnostics logs into Sentinel.",
        "description": "This connector uses Azure Policy to apply a single Azure Data Lake Storage Gen1 log-streaming configuration to a collection of instances, defined as a scope. Follow the instructions below to create and apply a policy to all current and future instances. Note, you may already have an active policy for this resource type.",
        "instructions": [
          {
            "parameters": {
              "noFxPadding": "1",
              "expanded": "1",
              "instructionSteps": [
                {
                  "title": "Stream diagnostics logs from your Azure Data Lake Storage Gen1 at scale",
                  "innerSteps": [
                    {
                      "title": "Launch the Azure Policy Assignment wizard and follow the steps. ",
                      "description": ">    1. In the **Basics** tab, click the button with the three dots under **Scope** to select your subscription.<br />2. In the **Parameters** tab, choose your Microsoft Sentinel workspace from the **Log Analytics workspace** drop-down list, and leave marked as \"True\" all the log categories you want to ingest.<br />3. To apply the policy on your existing resources, mark the **Create a remediation task** check box in the **Remediation** tab.</value>",
                      "instructions": [
                        {
                          "parameters": {
                            "policyDefinitionGuid": "25763a0a-5783-4f14-969e-79d4933eb74b"
                          },
                          "type": "PolicyAssignment"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "AzureDevOpsAuditLogs",
    "title": "Azure DevOps Audit Logs (via Codeless Connector Platform)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The Azure DevOps Audit Logs data connector allows you to ingest audit events from Azure DevOps into Microsoft Sentinel. This data connector is built using the Microsoft Sentinel Codeless Connector Platform, ensuring seamless integration. It leverages the Azure DevOps Audit Logs API to fetch detailed audit events and supports DCR-based [ingestion time transformations](https://docs.microsoft.com/azure/azure-monitor/logs/custom-logs-overview). These transformations enable parsing of the received audit data into a custom table during ingestion, improving query performance by eliminating the need for additional parsing. By using this connector, you can gain enhanced visibility into your Azure DevOps environment and streamline your security operations.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "Azure DevOps Events",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get a sample of Azure DevOps audit logs",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "AzureEventHub_CCP",
    "title": "Azure Event Hub",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Azure Event Hubs is a big data streaming platform and event ingestion service. It can receive and process millions of events per second. This connector lets you stream your Azure Event Hub diagnostics logs into Microsoft Sentinel, allowing you to continuously monitor activity. ",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "AzureDiagnostics",
        "baseQuery": "AzureDiagnostics| where ResourceProvider == \"MICROSOFT.EVENTHUB\""
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "AzureDiagnostics \n| where ResourceProvider == \"MICROSOFT.EVENTHUB\" \n"
      },
      {
        "description": "Count By Event Hubs",
        "query": "AzureDiagnostics \n| where ResourceProvider == \"MICROSOFT.EVENTHUB\" \n| summarize count() by Resource"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "AzureDiagnostics | where ResourceProvider == \"MICROSOFT.EVENTHUB\"\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "AzureDiagnostics (Event Hub)",
        "lastDataReceivedQuery": "AzureDiagnostics| where ResourceProvider == \"MICROSOFT.EVENTHUB\" | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "Policy",
          "description": "owner role assigned for each policy assignment scope"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Connect your Azure Event Hub diagnostics logs into Sentinel.",
        "description": "This connector uses Azure Policy to apply a single Azure Event Hub log-streaming configuration to a collection of instances, defined as a scope. Follow the instructions below to create and apply a policy to all current and future instances. Note, you may already have an active policy for this resource type.",
        "instructions": [
          {
            "parameters": {
              "noFxPadding": "1",
              "expanded": "1",
              "instructionSteps": [
                {
                  "title": "Stream diagnostics logs from your Azure Event Hub at scale",
                  "innerSteps": [
                    {
                      "title": "Launch the Azure Policy Assignment wizard and follow the steps. ",
                      "description": ">    1. In the **Basics** tab, click the button with the three dots under **Scope** to select your subscription.<br />2. In the **Parameters** tab, choose your Microsoft Sentinel workspace from the **Log Analytics workspace** drop-down list, and leave marked as \"True\" all the log categories you want to ingest.<br />3. To apply the policy on your existing resources, mark the **Create a remediation task** check box in the **Remediation** tab.</value>",
                      "instructions": [
                        {
                          "parameters": {
                            "policyDefinitionGuid": "1f6e93e8-6b31-41b1-83f6-36e449a42579"
                          },
                          "type": "PolicyAssignment"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "AzureFirewall",
    "title": "Azure Firewall",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Connect to Azure Firewall. Azure Firewall is a managed, cloud-based network security service that protects your Azure Virtual Network resources. It's a fully stateful firewall as a service with built-in high availability and unrestricted cloud scalability. For more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2220124&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "lastDataReceivedInfoBalloon": "If no new data has been received in the last 14 days, the connector will display as being \"not connected.\" When the connector will recive data , the \"connected\" status will return.",
    "logo": "AzureFirewall.svg",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "AzureDiagnostics",
        "baseQuery": "AzureDiagnostics | where ResourceType == \"AZUREFIREWALLS\""
      },
      {
        "metricName": "Total data received",
        "legend": "AZFWApplicationRule",
        "baseQuery": "AZFWApplicationRule"
      },
      {
        "metricName": "Total data received",
        "legend": "AZFWFlowTrace",
        "baseQuery": "AZFWFlowTrace"
      },
      {
        "metricName": "Total data received",
        "legend": "AZFWFatFlow",
        "baseQuery": "AZFWFatFlow"
      },
      {
        "metricName": "Total data received",
        "legend": "AZFWNatRule",
        "baseQuery": "AZFWNatRule"
      },
      {
        "metricName": "Total data received",
        "legend": "AZFWDnsQuery",
        "baseQuery": "AZFWDnsQuery"
      },
      {
        "metricName": "Total data received",
        "legend": "AZFWIdpsSignature",
        "baseQuery": "AZFWIdpsSignature"
      },
      {
        "metricName": "Total data received",
        "legend": "AZFWInternalFqdnResolutionFailure",
        "baseQuery": "AZFWInternalFqdnResolutionFailure"
      },
      {
        "metricName": "Total data received",
        "legend": "AZFWNetworkRule",
        "baseQuery": "AZFWNetworkRule"
      },
      {
        "metricName": "Total data received",
        "legend": "AZFWThreatIntel",
        "baseQuery": "AZFWThreatIntel"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "AzureDiagnostics | where ResourceType == \"AZUREFIREWALLS\"\n            | sort by TimeGenerated"
      },
      {
        "description": "Threat Intel Matches",
        "query": "AzureDiagnostics | where ResourceType == \"AZUREFIREWALLS\"\n            | where OperationName == \"AzureFirewallThreatIntelLog\""
      },
      {
        "description": "Log Parser",
        "query": "AzureDiagnostics | where ResourceType == \"AZUREFIREWALLS\"\n            | parse msg_s with Protocol_s 'request from ' SourceHost_s ':' SourcePort_s 'to ' DestinationHost_s ':' DestinationPort_s 'was' Action_s 'to' DNATDestination\n                | parse msg_s with Protocol_S 'request from ' SourceHost_S ':' SourcePort_S 'to ' DestinationHost_S ':' DestinationPort_S '. Action:' Action_S\n                | extend Protocol = strcat(Protocol_s, Protocol_S), SourceHost = strcat(SourceHost_s, SourceHost_S),SourcePort = strcat(SourcePort_s, SourcePort_S), DestinationHost = strcat(DestinationHost_s, DestinationHost_S), DestinationPort = strcat(DestinationPort_s, DestinationPort_S), Action = strcat(Action_s, Action_S)\n                | project TimeGenerated , Protocol , SourceHost , SourcePort , DestinationHost , DestinationPort , DNATDestination , Action , Resource , ResourceGroup , SubscriptionId , OperationName , msg_s\n                | sort by TimeGenerated desc"
      },
      {
        "description": "Azure Firewall flow trace logs",
        "query": "AZFWFlowTrace | where Flag == \"INVALID\"\n            | order by TimeGenerated desc\n | take 100"
      },
      {
        "description": "Threat intelligence logs",
        "query": "AZFWThreatIntel\n            | take 1000\n            | sort by TimeGenerated"
      },
      {
        "description": "Azure Firewall Top Flow Logs",
        "query": "AZFWFatFlow   | take 1000\n        | order by TimeGenerated desc"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "AzureDiagnostics | where ResourceType == \"AZUREFIREWALLS\"\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AZFWApplicationRule\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AZFWFlowTrace\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AZFWFatFlow\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AZFWNatRule\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AZFWDnsQuery\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AZFWIdpsSignature\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AZFWInternalFqdnResolutionFailure\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AZFWNetworkRule\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AZFWThreatIntel\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "AzureDiagnostics (Azure Firewall)",
        "lastDataReceivedQuery": "AzureDiagnostics | where ResourceType == \"AZUREFIREWALLS\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "AZFWApplicationRule",
        "lastDataReceivedQuery": "AZFWApplicationRule\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "AZFWFlowTrace",
        "lastDataReceivedQuery": "AZFWFlowTrace\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "AZFWFatFlow",
        "lastDataReceivedQuery": "AZFWFatFlow\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "AZFWNatRule",
        "lastDataReceivedQuery": "AZFWNatRule\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "AZFWDnsQuery",
        "lastDataReceivedQuery": "AZFWDnsQuery\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "AZFWIdpsSignature",
        "lastDataReceivedQuery": "AZFWIdpsSignature\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "AZFWInternalFqdnResolutionFailure",
        "lastDataReceivedQuery": "AZFWInternalFqdnResolutionFailure\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "AZFWNetworkRule",
        "lastDataReceivedQuery": "AZFWNetworkRule\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "AZFWThreatIntel",
        "lastDataReceivedQuery": "AZFWThreatIntel\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Connect Azure Firewall to Microsoft Sentinel",
        "description": "Enable Diagnostic Logs on All Firewalls.",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenAzureFirewall"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "",
        "description": "Inside your Firewall resource:\n\n1.  Select **Diagnostic logs.**\n2.  Select **+ Add diagnostic setting.**\n3.  In the **Diagnostic setting** blade:\n    -   Type a **Name**.\n    -   Select **Send to Log Analytics**.\n    -   Choose the log destination workspace.\n    -   Select the categories that you want to analyze ( Azure Firewall Network Rule, Azure Firewall Application Rule,Azure Firewall Nat Rule,Azure Firewall Threat Intelligence,Azure Firewall IDPS Signature,Azure Firewall DNS query,Azure Firewall FQDN Resolution Failure,Azure Firewall Fat Flow Log,Azure Firewall Flow Trace Log)\n    -   Click **Save**."
      }
    ]
  },
  {
    "title": "Azure Key Vault",
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "AzureDiagnostics | where ResourceProvider == \"MICROSOFT.KEYVAULT\"\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "id": "AzureKeyVault",
    "publisher": "Microsoft",
    "logo": "AzureKeyVault.svg",
    "lastDataReceivedInfoBalloon": "If no new data has been received in the last 14 days, the connector will display as being \"not connected.\" When the connector will recive data , the \"connected\" status will return.",
    "descriptionMarkdown": "Azure Key Vault is a cloud service for securely storing and accessing secrets. A secret is anything that you want to tightly control access to, such as API keys, passwords, certificates, or cryptographic keys.   This connector lets you stream your Azure Key Vault diagnostics logs into Microsoft Sentinel, allowing you to continuously monitor activity in all your instances. For more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2220125&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "AzureDiagnostics",
        "baseQuery": "AzureDiagnostics | where ResourceProvider == \"MICROSOFT.KEYVAULT\""
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "AzureDiagnostics | where ResourceProvider == \"MICROSOFT.KEYVAULT\"\n            | summarize count() by CallerIPAddress"
      },
      {
        "description": "All logs",
        "query": "AzureDiagnostics | where ResourceProvider == \"MICROSOFT.KEYVAULT\"\n            | where OperationName == \"VaultPut\" or OperationName == \"VaultPatch\"\n            | sort by TimeGenerated"
      },
      {
        "description": "All logs",
        "query": "AzureDiagnostics | where ResourceProvider == \"MICROSOFT.KEYVAULT\"\n            | where ResourceProvider == \"MICROSOFT.KEYVAULT\" \n                                                                              and parse_json(properties_s).DataErrorType in \n                                                                              (\"InputDeserializerError.InvalidData\", \"InputDeserializerError.TypeConversionError\", \n                                                                              \"InputDeserializerError.MissingColumns\", \"InputDeserializerError.InvalidHeader\",\n                                                                              \"InputDeserializerError.InvalidCompressionType\")\n                                                                              | project TimeGenerated, Resource, Region_s, OperationName, properties_s, Level, _ResourceId"
      }
    ],
    "dataTypes": [
      {
        "name": "KeyVaultData",
        "lastDataReceivedQuery": "AzureDiagnostics | where ResourceProvider == \"MICROSOFT.KEYVAULT\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "instructionSteps": [
      {
        "title": "Connect your Azure Key Vault diagnostics logs into Sentinel.",
        "description": "This connector uses Azure Policy to apply a single Azure Key Vault  log-streaming configuration to a collection of instances, defined as a scope.   \nFollow the instructions below to create and apply a policy to all current and future instances. **Note**, you may already have an active policy for this resource type.",
        "instructions": [
          {
            "parameters": {
              "noFxPadding": true,
              "expanded": true,
              "instructionSteps": [
                {
                  "title": "Stream diagnostics logs from your Azure Key Vault at scale",
                  "description": null,
                  "innerSteps": [
                    {
                      "title": "Launch the Azure Policy Assignment wizard and follow the steps.",
                      "description": ">1. In the **Basics** tab, click the button with the three dots under **Scope** to select your resources assignment scope.\n        >2. In the **Parameters** tab, choose your Microsoft Sentinel workspace from the **Log Analytics workspace** drop-down list, and leave marked as \"True\" all the log and metric types you want to ingest.\n        >3. To apply the policy on your existing resources, select the **Remediation tab** and mark the **Create a remediation task** checkbox.",
                      "instructions": [
                        {
                          "parameters": {
                            "linkType": "OpenPolicyAssignment",
                            "policyDefinitionGuid": "951af2fa-529b-416e-ab6e-066fd85ac459",
                            "assignMode": 1
                          },
                          "type": "InstallAgent"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ],
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "Policy",
          "description": "owner role assigned for each policy assignment scope."
        }
      ]
    },
    "availability": {
      "status": 2,
      "isPreview": false,
      "featureFlag": {
        "feature": "AzureKeyVaultFeature",
        "featureStates": {
          "1": 2,
          "2": 2,
          "3": 2,
          "4": 2,
          "5": 2,
          "6": 1,
          "7": 1,
          "8": 2
        }
      }
    },
    "ascAssessment": {
      "assessmentKey": "b1af52e4-e968-4e2b-b6d0-6736c9651f0a",
      "assessmentLinkText": "Enable Microsoft Defender for Key-Vaults now",
      "assessmentDescriptions": "Microsoft Defender for Key-Vaults provides real-time protection for your Azure Key-Vaults Services. Enable Microsoft Defender for Key-Vaults,connect it into Sentinel, and use Key-Vaults diagnostic logs in order to investigate Microsoft Defender alerts into a root cause in Sentinel.",
      "assessmentSectionTitleText": "Enable Microsoft Defender for Key-Vaults - Recommended!"
    }
  },
  {
    "kind": "StaticUI",
    "armId": "/subscriptions/419581d6-4853-49bd-83b6-d94bb8a77887/resourceGroups/eco-connector-test/providers/Microsoft.OperationalInsights/workspaces/eco-connector-test/providers/Microsoft.SecurityInsights/dataConnectors/AzureKubernetesConnector",
    "title": "Azure Kubernetes Service (AKS)",
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "AzureDiagnostics | where Category == \"kube-apiserver\"\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AzureDiagnostics | where Category == \"kube-audit\"\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AzureDiagnostics | where Category == \"kube-audit-admin\"\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AzureDiagnostics | where Category == \"kube-controller-manager\"\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AzureDiagnostics | where Category == \"kube-scheduler\"\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AzureDiagnostics | where Category == \"cluster-autoscaler\"\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AzureDiagnostics | where Category == \"guard\"\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "id": "AzureKubernetes",
    "publisher": "Microsoft",
    "logo": "AzureKubernetes.svg",
    "lastDataReceivedInfoBalloon": "If no new data has been received in the last 14 days, the connector will display as being \"not connected.\" When the connector will recive data , the \"connected\" status will return.",
    "descriptionMarkdown": "Azure Kubernetes Service (AKS) is an open-source, fully-managed container orchestration service that allows you to deploy, scale, and manage Docker containers and container-based applications in a cluster environment. This connector lets you stream your Azure Kubernetes Service (AKS) diagnostics logs into Microsoft Sentinel, allowing you to continuously monitor activity in all your instances. For more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2219762&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "kube-apiserver",
        "baseQuery": "AzureDiagnostics | where Category == \"kube-apiserver\""
      },
      {
        "metricName": "Total data received",
        "legend": "kube-audit",
        "baseQuery": "AzureDiagnostics | where Category == \"kube-audit\""
      },
      {
        "metricName": "Total data received",
        "legend": "kube-audit-admin",
        "baseQuery": "AzureDiagnostics | where Category == \"kube-audit-admin\""
      },
      {
        "metricName": "Total data received",
        "legend": "kube-controller-manager",
        "baseQuery": "AzureDiagnostics | where Category == \"kube-controller-manager\""
      },
      {
        "metricName": "Total data received",
        "legend": "kube-scheduler",
        "baseQuery": "AzureDiagnostics | where Category == \"kube-scheduler\""
      },
      {
        "metricName": "Total data received",
        "legend": "cluster-autoscaler",
        "baseQuery": "AzureDiagnostics | where Category == \"cluster-autoscaler\""
      },
      {
        "metricName": "Total data received",
        "legend": "guard",
        "baseQuery": "AzureDiagnostics | where Category == \"guard\""
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "ContainerInventory\n            | project Computer, Name, Image, ImageTag, ContainerState, CreatedTime, StartedTime, FinishedTime\n                                                                                 | top 200 by FinishedTime desc"
      },
      {
        "description": "All logs",
        "query": "KubeEvents\n            |where TimeGenerated > ago(7d) \n                                                                         | where not(isempty(Namespace))\n                                                                         | top 200 by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "kube-apiserver",
        "lastDataReceivedQuery": "AzureDiagnostics | where Category == \"kube-apiserver\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "kube-audit",
        "lastDataReceivedQuery": "AzureDiagnostics | where Category == \"kube-audit\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "kube-audit-admin",
        "lastDataReceivedQuery": "AzureDiagnostics | where Category == \"kube-audit-admin\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "kube-controller-manager",
        "lastDataReceivedQuery": "AzureDiagnostics | where Category == \"kube-controller-manager\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "kube-scheduler",
        "lastDataReceivedQuery": "AzureDiagnostics | where Category == \"kube-scheduler\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "cluster-autoscaler",
        "lastDataReceivedQuery": "AzureDiagnostics | where Category == \"cluster-autoscaler\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "guard",
        "lastDataReceivedQuery": "AzureDiagnostics | where Category == \"guard\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "instructionSteps": [
      {
        "title": "Connect your Azure Kubernetes Service (AKS) diagnostics logs into Sentinel.",
        "description": "This connector uses Azure Policy to apply a single Azure Kubernetes Service log-streaming configuration to a collection of instances, defined as a scope.\nFollow the instructions below to create and apply a policy to all current and future instances. **Note**, you may already have an active policy for this resource type.",
        "instructions": [
          {
            "parameters": {
              "noFxPadding": true,
              "expanded": true,
              "instructionSteps": [
                {
                  "title": "Stream diagnostics logs from your Azure Kubernetes Service (AKS) at scale",
                  "description": null,
                  "innerSteps": [
                    {
                      "title": "Launch the Azure Policy Assignment wizard and follow the steps.",
                      "description": ">1. In the **Basics** tab, click the button with the three dots under **Scope** to select your resources assignment scope.\n        >2. In the **Parameters** tab, choose your Microsoft Sentinel workspace from the **Log Analytics workspace** drop-down list, and leave marked as \"True\" all the log and metric types you want to ingest.\n        >3. To apply the policy on your existing resources, select the **Remediation tab** and mark the **Create a remediation task** checkbox.",
                      "instructions": [
                        {
                          "parameters": {
                            "linkType": "OpenPolicyAssignment",
                            "policyDefinitionGuid": "6c66c325-74c8-42fd-a286-a74b0e2939d8",
                            "assignMode": 1
                          },
                          "type": "InstallAgent"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ],
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "Policy",
          "description": "owner role assigned for each policy assignment scope."
        }
      ]
    },
    "availability": {
      "status": 2,
      "isPreview": false,
      "featureFlag": {
        "feature": "AzureKubernetesFeature",
        "featureStates": {
          "1": 2,
          "2": 2,
          "3": 2,
          "4": 2,
          "5": 2,
          "6": 1,
          "7": 1,
          "8": 2
        }
      }
    },
    "ascAssessment": {
      "assessmentKey": "86ea1a79-29d3-4eac-a9f4-3541ace4e718",
      "assessmentLinkText": "Enable Microsoft Defender for AKS now",
      "assessmentDescriptions": "Microsoft Defender for Kubernetes provides real-time protection for your Azure Kubernetes Services. Enable Microsoft Defender for Kubernetes,connect it into Sentinel, and use AKS diagnostic logs in order to investigate Microsoft Defender alerts into a root cause in Sentinel.",
      "assessmentSectionTitleText": "Enable Microsoft Defender for Kubernetes - Recommended!"
    },
    "metadata": {
      "contentId": "AzureKubernetesConnector",
      "parentId": "/subscriptions/419581d6-4853-49bd-83b6-d94bb8a77887/resourceGroups/eco-connector-test/providers/Microsoft.OperationalInsights/workspaces/eco-connector-test/providers/Microsoft.SecurityInsights/dataConnectors/AzureKubernetesConnector",
      "kind": "DataConnector",
      "version": "2.0.0",
      "source": {
        "kind": "Solution",
        "name": "AzureKubernetes",
        "sourceId": "azuresentinel.azure-sentinel-solution-testingoffers2"
      },
      "author": {
        "name": "Microsoft",
        "email": "support@microsoft.com"
      },
      "support": {
        "tier": "Microsoft",
        "name": "Microsoft Corporation",
        "email": "support@microsoft.com",
        "link": "https://support.microsoft.com/"
      }
    }
  },
  {
    "id": "AzureLogicApps_CCP",
    "title": "Azure Logic Apps",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Azure Logic Apps is a cloud-based platform for creating and running automated workflows that integrate your apps, data, services, and systems. This connector lets you stream your Azure Logic Apps diagnostics logs into Microsoft Sentinel, allowing you to continuously monitor activity. ",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "AzureDiagnostics",
        "baseQuery": "AzureDiagnostics| where ResourceProvider == \"MICROSOFT.LOGIC\""
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "AzureDiagnostics \n| where ResourceProvider == \"MICROSOFT.LOGIC\" \n"
      },
      {
        "description": "Count By Workflows",
        "query": "AzureDiagnostics \n| where ResourceProvider == \"MICROSOFT.LOGIC\" \n| summarize count() by resource_workflowName_s"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "AzureDiagnostics | where ResourceProvider == \"MICROSOFT.LOGIC\"\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "AzureDiagnostics (Logic Apps)",
        "lastDataReceivedQuery": "AzureDiagnostics| where ResourceProvider == \"MICROSOFT.LOGIC\" | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "Policy",
          "description": "owner role assigned for each policy assignment scope"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Connect your Logic Apps diagnostics logs into Sentinel.",
        "description": "This connector uses Azure Policy to apply a single Azure Logic Apps log-streaming configuration to a collection of instances, defined as a scope. Follow the instructions below to create and apply a policy to all current and future instances. Note, you may already have an active policy for this resource type.",
        "instructions": [
          {
            "parameters": {
              "noFxPadding": "1",
              "expanded": "1",
              "instructionSteps": [
                {
                  "title": "Stream diagnostics logs from your Azure Logic Apps at scale",
                  "innerSteps": [
                    {
                      "title": "Launch the Azure Policy Assignment wizard and follow the steps. ",
                      "description": ">    1. In the **Basics** tab, click the button with the three dots under **Scope** to select your subscription.<br />2. In the **Parameters** tab, choose your Microsoft Sentinel workspace from the **Log Analytics workspace** drop-down list, and leave marked as \"True\" all the log categories you want to ingest.<br />3. To apply the policy on your existing resources, mark the **Create a remediation task** check box in the **Remediation** tab.</value>",
                      "instructions": [
                        {
                          "parameters": {
                            "policyDefinitionGuid": "b889a06c-ec72-4b03-910a-cb169ee18721"
                          },
                          "type": "PolicyAssignment"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "title": "Network Security Groups",
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "AzureDiagnostics | where Category == \"NetworkSecurityGroupEvent\"\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AzureDiagnostics | where Category == \"NetworkSecurityGroupRuleCounter\"\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "id": "AzureNSG",
    "publisher": "Microsoft",
    "logo": "AzureNetworkSecurityGroups.svg",
    "descriptionMarkdown": "Azure network security groups (NSG) allow you to filter network traffic to and from Azure resources in an Azure virtual network. A network security group includes rules that allow or deny traffic to a virtual network subnet, network interface, or both.\n\nWhen you enable logging for an NSG, you can gather the following types of resource log information:\n\n- **Event:** Entries are logged for which NSG rules are applied to VMs, based on MAC address.\n- **Rule counter:** Contains entries for how many times each NSG rule is applied to deny or allow traffic. The status for these rules is collected every 300 seconds.\n\n\nThis connector lets you stream your NSG diagnostics logs into Microsoft Sentinel, allowing you to continuously monitor activity in all your instances. For more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2223718&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "NetworkSecurityGroupEvent",
        "baseQuery": "AzureDiagnostics | where Category == \"NetworkSecurityGroupEvent\""
      },
      {
        "metricName": "Total data received",
        "legend": "NetworkSecurityGroupRuleCounter",
        "baseQuery": "AzureDiagnostics | where Category == \"NetworkSecurityGroupRuleCounter\""
      }
    ],
    "sampleQueries": [
      {
        "description": "All NetworkSecurityGroupEvent category logs",
        "query": "AzureDiagnostics | where Category == \"NetworkSecurityGroupEvent\"\n            | sort by TimeGenerated"
      },
      {
        "description": "All NetworkSecurityGroupRuleCounter category logs",
        "query": "AzureDiagnostics | where Category == \"NetworkSecurityGroupRuleCounter\"\n            | sort by TimeGenerated"
      }
    ],
    "dataTypes": [
      {
        "name": "NetworkSecurityGroupEvent",
        "lastDataReceivedQuery": "AzureDiagnostics | where Category == \"NetworkSecurityGroupEvent\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "NetworkSecurityGroupRuleCounter",
        "lastDataReceivedQuery": "AzureDiagnostics | where Category == \"NetworkSecurityGroupRuleCounter\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "instructionSteps": [
      {
        "title": "Stream diagnostics logs from your Connect your Network Security Groups diagnostics logs into Sentinel. at scale",
        "description": "This connector uses Azure Policy to apply a single Azure Network Security Groups log-streaming configuration to a collection of instances, defined as a scope.   \nFollow the instructions below to create and apply a policy to all current and future instances. **Note**, you may already have an active policy for this resource type.",
        "innerSteps": [
          {
            "title": "Launch the Azure Policy Assignment wizard and follow the steps.",
            "description": ">1. In the **Basics** tab, click the button with the three dots under **Scope** to select your resources assignment scope.\n        >2. In the **Parameters** tab, choose your Microsoft Sentinel workspace from the **Log Analytics workspace** drop-down list, and leave marked as \"True\" all the log and metric types you want to ingest.\n        >3. To apply the policy on your existing resources, select the **Remediation tab** and mark the **Create a remediation task** checkbox.",
            "instructions": [
              {
                "parameters": {
                  "linkType": "OpenPolicyAssignment",
                  "policyDefinitionGuid": "98a2e215-5382-489e-bd29-32e7190a39ba",
                  "assignMode": 1
                },
                "type": "InstallAgent"
              }
            ]
          }
        ]
      }
    ],
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "Policy",
          "description": "owner role assigned for each policy assignment scope."
        }
      ]
    },
    "availability": {
      "status": 2,
      "featureFlag": {
        "feature": "AzureNSGFeature",
        "featureStates": {
          "1": 2,
          "2": 2,
          "3": 2,
          "4": 2,
          "5": 2,
          "6": 1,
          "7": 1
        }
      }
    }
  },
  {
    "id": "AzureResourceGraph",
    "title": "Azure Resource Graph",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Azure Resource Graph connector gives richer insights into Azure events by supplementing details about Azure subscriptions and Azure resources.",
    "logo": "argGraphLogo.svg",
    "graphQueries": [],
    "sampleQueries": [],
    "dataTypes": [],
    "connectivityCriterias": [
      {
        "type": "MSG"
      }
    ],
    "permissions": {
      "customs": [
        {
          "name": "Policy",
          "description": "Owner role permission on Azure subscriptions"
        }
      ]
    },
    "availability": {
      "status": 2
    },
    "instructionSteps": [
      {
        "description": "Connect Azure Resource Graph to Microsoft Sentinel",
        "instructions": [
          {
            "parameters": {
              "description": "**Entities**",
              "items": [
                {
                  "label": "resources"
                },
                {
                  "label": "resourcecontainers"
                },
                {
                  "label": "authorizationresources"
                }
              ]
            },
            "type": "MSG_test"
          }
        ]
      }
    ]
  },
  {
    "id": "AzureSecurityCenter",
    "title": "Subscription-based Microsoft Defender for Cloud (Legacy)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Microsoft Defender for Cloud is a security management tool that allows you to detect and quickly respond to threats across Azure, hybrid, and multi-cloud workloads. This connector allows you to stream your security alerts from Microsoft Defender for Cloud into Microsoft Sentinel, so you can view Defender data in workbooks, query it to produce alerts, and investigate and respond to incidents.\n\n[For more information>](https://aka.ms/ASC-Connector)",
    "logo": "AzureSecurityCenter.svg",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "SecurityAlerts",
        "baseQuery": "SecurityAlert | where ProductName == \"Azure Security Center\""
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "SecurityAlert | where ProductName == \"Azure Security Center\"\n            | sort by TimeGenerated"
      },
      {
        "description": "Summarize by severity",
        "query": "(SecurityAlert\n| where ProductName == \"Azure Security Center\")\n| summarize count() by AlertSeverity"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "SentinelKinds",
        "value": [
          "AzureSecurityCenter"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "SecurityAlert (ASC)",
        "lastDataReceivedQuery": "SecurityAlert | where ProductName == \"Azure Security Center\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "License",
          "description": "The connector is available for all deployments of Microsoft Defender for Cloud."
        },
        {
          "name": "Subscription",
          "description": "[read security data](https://docs.microsoft.com/azure/security-center/security-center-permissions)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Connect Microsoft Defender for Cloud to Microsoft Sentinel",
        "description": "Mark the check box of each Azure subscription whose alerts you want to import into Microsoft Sentinel, then select **Connect** above the list.\n\n> The connector can be enabled only on subscriptions that have at least one Microsoft Defender plan enabled in Microsoft Defender for Cloud, and only by users with Security Reader permissions on the subscription.",
        "instructions": [
          {
            "parameters": {},
            "type": "AzureSecurityCenterSubscriptions"
          }
        ]
      }
    ],
    "caseGenerationSteps": [
      {
        "instructions": [
          {
            "parameters": {
              "filterProduct": "Azure Security Center"
            },
            "type": "FilterAlert"
          }
        ]
      }
    ]
  },
  {
    "id": "AzureServiceBus_CCP",
    "title": "Azure Service Bus",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Azure Service Bus is a fully managed enterprise message broker with message queues and publish-subscribe topics (in a namespace). This connector lets you stream your Azure Service Bus diagnostics logs into Microsoft Sentinel, allowing you to continuously monitor activity. ",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "AzureDiagnostics",
        "baseQuery": "AzureDiagnostics| where ResourceProvider == \"MICROSOFT.SERVICEBUS\""
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "AzureDiagnostics \n| where ResourceProvider == \"MICROSOFT.SERVICEBUS\" \n"
      },
      {
        "description": "Count By Service Bus",
        "query": "AzureDiagnostics \n| where ResourceProvider == \"MICROSOFT.SERVICEBUS\" \n| summarize count() by Resource"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "AzureDiagnostics | where ResourceProvider == \"MICROSOFT.SERVICEBUS\"\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "AzureDiagnostics (Service Bus)",
        "lastDataReceivedQuery": "AzureDiagnostics| where ResourceProvider == \"MICROSOFT.SERVICEBUS\" | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "Policy",
          "description": "owner role assigned for each policy assignment scope"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Connect your Azure Service Bus diagnostics logs into Sentinel.",
        "description": "This connector uses Azure Policy to apply a single Azure Service Bus log-streaming configuration to a collection of instances, defined as a scope. Follow the instructions below to create and apply a policy to all current and future instances. Note, you may already have an active policy for this resource type.",
        "instructions": [
          {
            "parameters": {
              "noFxPadding": "1",
              "expanded": "1",
              "instructionSteps": [
                {
                  "title": "Stream diagnostics logs from your Azure Service Bus at scale",
                  "innerSteps": [
                    {
                      "title": "Launch the Azure Policy Assignment wizard and follow the steps. ",
                      "description": ">    1. In the **Basics** tab, click the button with the three dots under **Scope** to select your subscription.<br />2. In the **Parameters** tab, choose your Microsoft Sentinel workspace from the **Log Analytics workspace** drop-down list, and leave marked as \"True\" all the log categories you want to ingest.<br />3. To apply the policy on your existing resources, mark the **Create a remediation task** check box in the **Remediation** tab.</value>",
                      "instructions": [
                        {
                          "parameters": {
                            "policyDefinitionGuid": "04d53d87-841c-4f23-8a5b-21564380b55e"
                          },
                          "type": "PolicyAssignment"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "AzureSql",
    "title": "Azure SQL Databases",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Azure SQL is a fully managed, Platform-as-a-Service (PaaS) database engine that handles most database management functions, such as upgrading, patching, backups, and monitoring, without necessitating user involvement. This connector lets you stream your Azure SQL databases audit and diagnostic logs into Microsoft Sentinel, allowing you to continuously monitor activity in all your instances.",
    "logo": "AzureSql.svg",
    "lastDataReceivedInfoBalloon": "If no new data has been received in the last 14 days, the connector will display as being \"not connected.\" When the connector will recive data , the \"connected\" status will return.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "SQLSecurityAuditEvents",
        "baseQuery": "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"SQLSecurityAuditEvents\""
      },
      {
        "metricName": "Total data received",
        "legend": "SQLInsights",
        "baseQuery": "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"SQLInsights\""
      },
      {
        "metricName": "Total data received",
        "legend": "AutomaticTuning",
        "baseQuery": "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"AutomaticTuning\""
      },
      {
        "metricName": "Total data received",
        "legend": "QueryStoreWaitStatistics",
        "baseQuery": "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"QueryStoreWaitStatistics\""
      },
      {
        "metricName": "Total data received",
        "legend": "Errors",
        "baseQuery": "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"Errors\""
      },
      {
        "metricName": "Total data received",
        "legend": "DatabaseWaitStatistics",
        "baseQuery": "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"DatabaseWaitStatistics\""
      },
      {
        "metricName": "Total data received",
        "legend": "Timeouts",
        "baseQuery": "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"Timeouts\""
      },
      {
        "metricName": "Total data received",
        "legend": "Blocks",
        "baseQuery": "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"Blocks\""
      },
      {
        "metricName": "Total data received",
        "legend": "Deadlocks",
        "baseQuery": "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"Deadlocks\""
      },
      {
        "metricName": "Total data received",
        "legend": "Basic",
        "baseQuery": "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"Basic\""
      },
      {
        "metricName": "Total data received",
        "legend": "InstanceAndAppAdvanced",
        "baseQuery": "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"InstanceAndAppAdvanced\""
      },
      {
        "metricName": "Total data received",
        "legend": "WorkloadManagement",
        "baseQuery": "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"WorkloadManagement\""
      },
      {
        "metricName": "Total data received",
        "legend": "DevOpsOperationsAudit",
        "baseQuery": "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"DevOpsOperationsAudit\""
      }
    ],
    "sampleQueries": [
      {
        "description": "SQL Diagnostics logs",
        "query": "AzureDiagnostics | where ResourceProvider == \"MICROSOFT.SQL\"|  where ResourceType == \"SERVERS/DATABASES\" | where TimeGenerated > ago(7d)"
      },
      {
        "description": "SQL Audit Logs",
        "query": "AzureDiagnostics | where Category contains \"SQLSecurityAuditEvents\" | where TimeGenerated > ago(7d)"
      }
    ],
    "dataTypes": [
      {
        "name": "SQLSecurityAuditEvents",
        "lastDataReceivedQuery": "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"SQLSecurityAuditEvents\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "SQLInsights",
        "lastDataReceivedQuery": "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"SQLInsights\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "AutomaticTuning",
        "lastDataReceivedQuery": "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"AutomaticTuning\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "QueryStoreWaitStatistics",
        "lastDataReceivedQuery": "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"QueryStoreWaitStatistics\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Errors",
        "lastDataReceivedQuery": "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"Errors\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "DatabaseWaitStatistics",
        "lastDataReceivedQuery": "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"DatabaseWaitStatistics\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Timeouts",
        "lastDataReceivedQuery": "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"Timeouts\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Blocks",
        "lastDataReceivedQuery": "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"Blocks\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Deadlocks",
        "lastDataReceivedQuery": "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"Deadlocks\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Basic",
        "lastDataReceivedQuery": "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"Basic\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "InstanceAndAppAdvanced",
        "lastDataReceivedQuery": "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"InstanceAndAppAdvanced\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "WorkloadManagement",
        "lastDataReceivedQuery": "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"WorkloadManagement\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "DevOpsOperationsAudit",
        "lastDataReceivedQuery": "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"DevOpsOperationsAudit\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"SQLSecurityAuditEvents\"\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"SQLInsights\"\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"AutomaticTuning\"\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"QueryStoreWaitStatistics\"\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"Errors\"\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"DatabaseWaitStatistics\"\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"Timeouts\"\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"Blocks\"\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"Deadlocks\"\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"Basic\"\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"InstanceAndAppAdvanced\"\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"WorkloadManagement\"\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AzureDiagnostics | where ResourceType == \"SERVERS/DATABASES\" | where ResourceProvider == \"MICROSOFT.SQL\" | where Category == \"DevOpsOperationsAudit\"\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "Policy",
          "description": "owner role assigned for each policy assignment scope."
        },
        {
          "name": "Auditing",
          "description": "read and write permissions to Azure SQL Server audit settings."
        }
      ]
    },
    "ascAssessment": {
      "assessmentKey": "58d72d9d-0310-4792-9a3b-6dd111093cdb",
      "assessmentLinkText": "Enable Microsoft Defender for SQL Databases and Servers now",
      "assessmentDescriptions": "Microsoft Defender for SQL Database and Servers provides real-time protection for your Azure SQL and Database Services. Enable Microsoft Defender for Azure SQL, connect it into Sentinel, and use SQL diagnostic logs in order to investigate Microsoft Defender alerts into a root cause in Sentinel.",
      "assessmentSectionTitleText": "Enable Microsoft Defender for Azure SQL - Recommended!"
    },
    "instructionSteps": [
      {
        "title": "Connect your Azure SQL databases diagnostics logs into Sentinel.",
        "description": "This connector uses Azure Policy to apply a single Azure SQL Database log-streaming configuration to a collection of instances, defined as a scope.   \nFollow the instructions below to create and apply a policy to all current and future instances. **Note**, you may already have an active policy for this resource type.",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Stream diagnostics logs from your Azure SQL Databases at scale",
                  "innerSteps": [
                    {
                      "title": "Launch the Azure Policy Assignment wizard and follow the steps.",
                      "description": ">1. In the **Basics** tab, click the button with the three dots under **Scope** to select your resources assignment scope.\n        >2. In the **Parameters** tab, choose your Microsoft Sentinel workspace from the **Log Analytics workspace** drop-down list, and leave marked as \"True\" all the log and metric types you want to ingest.\n        >3. To apply the policy on your existing resources, select the **Remediation tab** and mark the **Create a remediation task** checkbox.",
                      "instructions": [
                        {
                          "parameters": {
                            "linkType": "OpenPolicyAssignment",
                            "policyDefinitionGuid": "b79fa14e-238a-4c2d-b376-442ce508fc84",
                            "assignMode": 1
                          },
                          "type": "InstallAgent"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          },
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Stream audit logs from your Azure SQL Databases at the server level at scale",
                  "innerSteps": [
                    {
                      "title": "Launch the Azure Policy Assignment wizard and follow the steps.",
                      "description": ">1. In the **Basics** tab, click the button with the three dots under **Scope** to select your resources assignment scope.\n        >2. In the **Parameters** tab, choose your Microsoft Sentinel workspace from the **Log Analytics workspace** drop-down list, and leave marked as \"True\" all the log and metric types you want to ingest.\n        >3. To apply the policy on your existing resources, select the **Remediation tab** and mark the **Create a remediation task** checkbox.",
                      "instructions": [
                        {
                          "parameters": {
                            "linkType": "OpenPolicyAssignment",
                            "policyDefinitionGuid": "7ea8a143-05e3-4553-abfe-f56bef8b0b70",
                            "assignMode": 1
                          },
                          "type": "InstallAgent"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "AzureStorageAccount",
    "title": "Azure Storage Account",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Azure Storage account is a cloud solution for modern data storage scenarios. It contains all your data objects: blobs, files, queues, tables, and disks. This connector lets you stream Azure Storage accounts diagnostics logs into your Microsoft Sentinel workspace, allowing you to continuously monitor activity in all your instances, and detect malicious activity in your organization. For more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2220068&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "AzureStorageAccount",
        "baseQuery": "AzureMetrics| where ResourceProvider == \"MICROSOFT.STORAGE\""
      },
      {
        "metricName": "Total data received",
        "legend": "StorageBlobLogs",
        "baseQuery": "StorageBlobLogs"
      },
      {
        "metricName": "Total data received",
        "legend": "StorageQueueLogs",
        "baseQuery": "StorageQueueLogs"
      },
      {
        "metricName": "Total data received",
        "legend": "StorageTableLogs",
        "baseQuery": "StorageTableLogs"
      },
      {
        "metricName": "Total data received",
        "legend": "StorageFileLogs",
        "baseQuery": "StorageFileLogs"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "StorageBlobLogs\n | where TimeGenerated > ago(3d) \n | project TimeGenerated, OperationName, StatusCode, StatusText, _ResourceId\n | sort by TimeGenerated"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "AzureMetrics| where ResourceProvider == \"MICROSOFT.STORAGE\"\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "StorageBlobLogs\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "StorageQueueLogs\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "StorageTableLogs\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "StorageFileLogs\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "AzureMetrics (Azure Storage)",
        "lastDataReceivedQuery": "AzureMetrics| where ResourceProvider == \"MICROSOFT.STORAGE\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "StorageBlobLogs",
        "lastDataReceivedQuery": "StorageBlobLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "StorageQueueLogs",
        "lastDataReceivedQuery": "StorageQueueLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "StorageTableLogs",
        "lastDataReceivedQuery": "StorageTableLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "StorageFileLogs",
        "lastDataReceivedQuery": "StorageFileLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "Policy",
          "description": "owner role assigned for each policy assignment scope"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Connect your Azure Storage Account diagnostics logs into Sentinel.",
        "description": "This connector uses a set of Azure Policies to apply a log-streaming configuration to a collection of instances, defined as a scope. Follow the instructions below to create and apply policies to all current and future instances. To get most out of the Storage Account Diagnostic logging from the Azure Storage Account, we recommend that you enable Diagnostic logging from all services within the Azure Storage Account - Blob, Queue, Table and File. Note, you may already have an active policy for this resource type.",
        "instructions": [
          {
            "parameters": {
              "noFxPadding": "1",
              "expanded": "1",
              "instructionSteps": [
                {
                  "title": "Stream diagnostics logs from your Azure Storage Account at scale",
                  "innerSteps": [
                    {
                      "title": "Launch the Azure Policy Assignment wizard and follow the steps. ",
                      "description": ">    1. In the **Basics** tab, click the button with the three dots under **Scope** to select your subscription.<br />2. In the **Parameters** tab, choose your Microsoft Sentinel workspace from the **Log Analytics workspace** drop-down list, and leave marked as \"True\" all the log categories you want to ingest.<br />3. To apply the policy on your existing resources, mark the **Create a remediation task** check box in the **Remediation** tab.</value>",
                      "instructions": [
                        {
                          "parameters": {
                            "policyDefinitionGuid": "59759c62-9a22-4cdf-ae64-074495983fef"
                          },
                          "type": "PolicyAssignment"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          },
          {
            "parameters": {
              "noFxPadding": "1",
              "expanded": "1",
              "instructionSteps": [
                {
                  "title": "Stream diagnostics logs from your Azure Storage Blob service at scale",
                  "innerSteps": [
                    {
                      "title": "Launch the Azure Policy Assignment wizard and follow the steps. ",
                      "description": ">    1. In the **Basics** tab, click the button with the three dots under **Scope** to select your subscription.<br />2. In the **Parameters** tab, choose your Microsoft Sentinel workspace from the **Log Analytics workspace** drop-down list, and leave marked as \"True\" all the log categories you want to ingest.<br />3. To apply the policy on your existing resources, mark the **Create a remediation task** check box in the **Remediation** tab.</value>",
                      "instructions": [
                        {
                          "parameters": {
                            "policyDefinitionGuid": "b4fe1a3b-0715-4c6c-a5ea-ffc33cf823cb"
                          },
                          "type": "PolicyAssignment"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          },
          {
            "parameters": {
              "noFxPadding": "1",
              "expanded": "1",
              "instructionSteps": [
                {
                  "title": "Stream diagnostics logs from your Azure Storage Queue service at scale",
                  "innerSteps": [
                    {
                      "title": "Launch the Azure Policy Assignment wizard and follow the steps. ",
                      "description": ">    1. In the **Basics** tab, click the button with the three dots under **Scope** to select your subscription.<br />2. In the **Parameters** tab, choose your Microsoft Sentinel workspace from the **Log Analytics workspace** drop-down list, and leave marked as \"True\" all the log categories you want to ingest.<br />3. To apply the policy on your existing resources, mark the **Create a remediation task** check box in the **Remediation** tab.</value>",
                      "instructions": [
                        {
                          "parameters": {
                            "policyDefinitionGuid": "7bd000e3-37c7-4928-9f31-86c4b77c5c45"
                          },
                          "type": "PolicyAssignment"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          },
          {
            "parameters": {
              "noFxPadding": "1",
              "expanded": "1",
              "instructionSteps": [
                {
                  "title": "Stream diagnostics logs from your Azure Storage Table service at scale",
                  "innerSteps": [
                    {
                      "title": "Launch the Azure Policy Assignment wizard and follow the steps. ",
                      "description": ">    1. In the **Basics** tab, click the button with the three dots under **Scope** to select your subscription.<br />2. In the **Parameters** tab, choose your Microsoft Sentinel workspace from the **Log Analytics workspace** drop-down list, and leave marked as \"True\" all the log categories you want to ingest.<br />3. To apply the policy on your existing resources, mark the **Create a remediation task** check box in the **Remediation** tab.</value>",
                      "instructions": [
                        {
                          "parameters": {
                            "policyDefinitionGuid": "2fb86bf3-d221-43d1-96d1-2434af34eaa0"
                          },
                          "type": "PolicyAssignment"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          },
          {
            "parameters": {
              "noFxPadding": "1",
              "expanded": "1",
              "instructionSteps": [
                {
                  "title": "Stream diagnostics logs from your Azure Storage File service at scale",
                  "innerSteps": [
                    {
                      "title": "Launch the Azure Policy Assignment wizard and follow the steps. ",
                      "description": ">    1. In the **Basics** tab, click the button with the three dots under **Scope** to select your subscription.<br />2. In the **Parameters** tab, choose your Microsoft Sentinel workspace from the **Log Analytics workspace** drop-down list, and leave marked as \"True\" all the log categories you want to ingest.<br />3. To apply the policy on your existing resources, mark the **Create a remediation task** check box in the **Remediation** tab.</value>",
                      "instructions": [
                        {
                          "parameters": {
                            "policyDefinitionGuid": "25a70cc8-2bd4-47f1-90b6-1478e4662c96"
                          },
                          "type": "PolicyAssignment"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "AzureStreamAnalytics_CCP",
    "title": "Azure Stream Analytics",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Azure Stream Analytics is a real-time analytics and complex event-processing engine that is designed to analyze and process high volumes of fast streaming data from multiple sources simultaneously. This connector lets you stream your Azure Stream Analytics hub diagnostics logs into Microsoft Sentinel, allowing you to continuously monitor activity. ",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "AzureDiagnostics",
        "baseQuery": "AzureDiagnostics| where ResourceProvider == \"MICROSOFT.STREAMANALYTICS\""
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "AzureDiagnostics \n| where ResourceProvider == \"MICROSOFT.STREAMANALYTICS\" \n"
      },
      {
        "description": "Count By Stream Analytics",
        "query": "AzureDiagnostics \n| where ResourceProvider == \"MICROSOFT.STREAMANALYTICS\" \n| summarize count() by Resource"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "AzureDiagnostics | where ResourceProvider == \"MICROSOFT.STREAMANALYTICS\"\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "AzureDiagnostics (Stream Analytics)",
        "lastDataReceivedQuery": "AzureDiagnostics| where ResourceProvider == \"MICROSOFT.STREAMANALYTICS\" | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "Policy",
          "description": "owner role assigned for each policy assignment scope"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Connect your Azure Stream Analytics diagnostics logs into Sentinel.",
        "description": "This connector uses Azure Policy to apply a single Azure Stream Analytics log-streaming configuration to a collection of instances, defined as a scope. Follow the instructions below to create and apply a policy to all current and future instances. Note, you may already have an active policy for this resource type.",
        "instructions": [
          {
            "parameters": {
              "noFxPadding": "1",
              "expanded": "1",
              "instructionSteps": [
                {
                  "title": "Stream diagnostics logs from your Azure Stream Analytics at scale",
                  "innerSteps": [
                    {
                      "title": "Launch the Azure Policy Assignment wizard and follow the steps. ",
                      "description": ">    1. In the **Basics** tab, click the button with the three dots under **Scope** to select your subscription.<br />2. In the **Parameters** tab, choose your Microsoft Sentinel workspace from the **Log Analytics workspace** drop-down list, and leave marked as \"True\" all the log categories you want to ingest.<br />3. To apply the policy on your existing resources, mark the **Create a remediation task** check box in the **Remediation** tab.</value>",
                      "instructions": [
                        {
                          "parameters": {
                            "policyDefinitionGuid": "237e0f7e-b0e8-4ec4-ad46-8c12cb66d673"
                          },
                          "type": "PolicyAssignment"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "Barracuda",
    "title": "[Deprecated] Barracuda Web Application Firewall via Legacy Agent",
    "publisher": "Barracuda",
    "descriptionMarkdown": "The Barracuda Web Application Firewall (WAF) connector allows you to easily connect your Barracuda logs with Microsoft Sentinel, to view dashboards, create custom alerts, and improve investigation. This gives you more insight into your organizations network and improves your security operation capabilities.\n\n[For more information >](https://aka.ms/CEF-Barracuda)",
    "logo": "barracuda_logo_light.png",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Barracuda CEF",
        "baseQuery": "\nCommonSecurityLog \n| where DeviceVendor == \"Barracuda\"\n"
      },
      {
        "metricName": "Total data received",
        "legend": "Barracuda CL",
        "baseQuery": "barracuda_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "\nCommonSecurityLog \n| where DeviceVendor == \"Barracuda\"\n\n            | sort by TimeGenerated"
      },
      {
        "description": "Summarize by protocol and destination IP",
        "query": "\nCommonSecurityLog \n| where DeviceVendor == \"Barracuda\"\n\n            | summarize count() by ApplicationProtocol, DestinationIP"
      },
      {
        "description": "Barracuda audit logs events",
        "query": "barracuda_CL\n            | where Vendor_s == \"Barracuda\" and Product_s == \"WAF\"\n| where LogType_s == \"AUDIT\"\n            | sort by TimeGenerated"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "\nCommonSecurityLog \n| where DeviceVendor == \"Barracuda\"\n\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "barracuda_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (Barracuda)",
        "lastDataReceivedQuery": "\nCommonSecurityLog \n| where DeviceVendor == \"Barracuda\"\n\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Barracuda_CL",
        "lastDataReceivedQuery": "barracuda_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Configure and connect Barracuda WAF",
        "description": "The Barracuda Web Application Firewall can integrate with and export logs directly to Microsoft Sentinel via Azure OMS Server.\n\n1.  Go to [Barracuda WAF configuration](https://aka.ms/asi-barracuda-connector), and follow the instructions, using the parameters below to set up the connection:.\n\n2.  Web Firewall logs facility: Go to the advanced settings (link below) for your workspace and on the **Data > Syslog** tabs, make sure that the facility exists.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "linkType": "OpenSyslogSettings"
            },
            "type": "InstallAgent"
          }
        ]
      }
    ],
    "metadata": {
      "id": "5fcd2f13-eaf9-46a7-8c6e-aa5d86b8f1f7",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Barracuda Networks"
      },
      "support": {
        "name": "Barracuda Networks",
        "link": "https://www.barracuda.com/support",
        "tier": "developer"
      }
    }
  },
  {
    "id": "BarracudaCloudFirewall",
    "title": "[Deprecated] Barracuda CloudGen Firewall",
    "publisher": "Barracuda",
    "descriptionMarkdown": "The Barracuda CloudGen Firewall (CGFW) connector allows you to easily connect your Barracuda CGFW logs with Microsoft Sentinel, to view dashboards, create custom alerts, and improve investigation. This gives you more insight into your organization's network and improves your security operation capabilities.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Syslog (Barracuda)",
        "baseQuery": "CGFWFirewallActivity"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "CGFWFirewallActivity\n            | sort by TimeGenerated"
      },
      {
        "description": "Top 10 Active Users (Last 24 Hours)",
        "query": "CGFWFirewallActivity\n            | extend User = coalesce(User, \"Unauthenticated\") \n                    | summarize count() by User\n                    | take 10"
      },
      {
        "description": "Top 10 Applications (Last 24 Hours)",
        "query": "CGFWFirewallActivity\n            | where isnotempty(Application)\n                    | summarize count() by Application\n                    | take 10"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CGFWFirewallActivity\n   |where TimeGenerated > ago(3d)\n    |take 1\n   | project IsConnected = true"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog (Barracuda)",
        "lastDataReceivedQuery": "CGFWFirewallActivity\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "write permission is required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "Barracuda CloudGen Firewall",
          "description": "must be configured to export logs via Syslog"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias CGFWFirewallActivity and load the function code or click [here](https://aka.ms/sentinel-barracudacloudfirewall-parser). The function usually takes 10-15 minutes to activate after solution installation/update.",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux",
        "description": "Typically, you should install the agent on a different computer from the one on which the logs are generated.\n\n>  Syslog logs are collected only from **Linux** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Configure the facilities you want to collect and their severities.\n\n1.  Under workspace advanced settings **Configuration**, select **Data** and then **Syslog**.\n2.  Select **Apply below configuration to my machines** and select the facilities and severities.\n3.  Click **Save**."
      },
      {
        "title": "Configure and connect the Barracuda CloudGen Firewall",
        "description": "[Follow instructions](https://aka.ms/sentinel-barracudacloudfirewall-connector) to configure syslog streaming. Use the IP address or hostname for the Linux machine with the Microsoft Sentinel agent installed for the Destination IP address.",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenSyslogSettings"
            },
            "type": "InstallAgent"
          }
        ]
      }
    ],
    "metadata": {
      "id": "afbf6c4a-7190-442a-a649-5c18a907ceb3",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Barracuda Networks"
      },
      "support": {
        "name": "Barracuda Networks",
        "link": "https://www.barracuda.com/support",
        "tier": "Community"
      }
    }
  },
  {
    "id": "BetterMTD",
    "title": "BETTER Mobile Threat Defense (MTD)",
    "publisher": "BETTER Mobile",
    "descriptionMarkdown": "The BETTER MTD Connector allows Enterprises to connect their Better MTD instances with Microsoft Sentinel, to view their data in Dashboards, create custom alerts, use it to trigger playbooks and expands threat hunting capabilities. This gives users more insight into their organization's mobile devices and ability to quickly analyze current mobile security posture which improves their overall SecOps capabilities.",
    "graphQueries": [
      {
        "metricName": "Total incidents received",
        "legend": "BetterMTDIncidentLog_CL",
        "baseQuery": "BetterMTDIncidentLog_CL"
      },
      {
        "metricName": "Total devcie enrolled",
        "legend": "BetterMTDDeviceLog_CL",
        "baseQuery": "BetterMTDDeviceLog_CL"
      },
      {
        "metricName": "Total netflow traffic recieved",
        "legend": "BetterMTDNetflowLog_CL",
        "baseQuery": "BetterMTDNetflowLog_CL"
      },
      {
        "metricName": "Total device applications",
        "legend": "BetterMTDAppLog_CL",
        "baseQuery": "BetterMTDAppLog_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All threats in the past 24 hour",
        "query": "BetterMTDIncidentLog_CL\n            | where TimeGenerated > ago(24h)\n            | sort by TimeGenerated\n            | limit 100"
      },
      {
        "description": "Enrolled Devices in the past 24 hour",
        "query": "BetterMTDDeviceLog_CL\n            | where TimeGenerated > ago(24h)\n            | sort by TimeGenerated\n            | limit 100"
      },
      {
        "description": "Installed applications in the last 24 hour",
        "query": "BetterMTDAppLog_CL\n            | where TimeGenerated > ago(24h)  and  AppStatus_s  == \"installed\" \n            | sort by TimeGenerated            \n| limit 100"
      },
      {
        "description": "Blocked Network traffics in the last 24 hour",
        "query": "BetterMTDNetflowLog_CL\n            | where TimeGenerated > ago(24h)  and  Status_s == \"blocked\"\n            | sort by TimeGenerated\n            | limit 100"
      }
    ],
    "dataTypes": [
      {
        "name": "BetterMTDIncidentLog_CL",
        "lastDataReceivedQuery": "BetterMTDIncidentLog_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "BetterMTDDeviceLog_CL",
        "lastDataReceivedQuery": "BetterMTDDeviceLog_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "BetterMTDAppLog_CL",
        "lastDataReceivedQuery": "BetterMTDAppLog_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "BetterMTDNetflowLog_CL",
        "lastDataReceivedQuery": "BetterMTDNetflowLog_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "BetterMTDIncidentLog_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "BetterMTDDeviceLog_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "BetterMTDAppLog_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "BetterMTDNetflowLog_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "1. In **Better MTD Console**, click on **Integration** on the side bar.\n2. Select  **Others** tab.\n3. Click the **ADD ACCOUNT** button and Select **Microsoft Sentinel** from the available integrations.\n4. Create the Integration:\n  - set `ACCOUNT NAME` to a descriptive name that identifies the integration then click **Next**\n  - Enter your `WORKSPACE ID` and `PRIMARY KEY` from the fields below, click **Save**\n  - Click **Done**\n5.  Threat Policy setup (Which Incidents should be reported to `Microsoft Sentinel`):\n  - In **Better MTD Console**, click on **Policies** on the side bar\n  - Click on the **Edit** button of the Policy that you are using.\n  - For each Incident types that you want to be logged go to **Send to Integrations** field and select **Sentinel**\n6. For additional information, please refer to our [Documentation](https://mtd-docs.bmobi.net/integrations/how-to-setup-azure-sentinel-integration#mtd-integration-configuration).",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ],
    "metadata": {
      "id": "31f0ea52-dcd4-443b-9d04-a3e709addebc",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Better Mobile"
      },
      "support": {
        "name": "Better Mobile",
        "email": "support@better.mobi",
        "tier": "developer"
      }
    }
  },
  {
    "id": "BeyondSecuritybeSECURE",
    "title": "Beyond Security beSECURE",
    "publisher": "Beyond Security",
    "descriptionMarkdown": "The [Beyond Security beSECURE](https://beyondsecurity.com/) connector allows you to easily connect your Beyond Security beSECURE scan events, scan results and audit trail with Azure Sentinel, to view dashboards, create custom alerts, and improve investigation. This gives you more insight into your organization's network and improves your security operation capabilities.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Beyond Security beSECURE Scan Event",
        "baseQuery": "beSECURE_ScanEvent_CL"
      },
      {
        "metricName": "Total data received",
        "legend": "Beyond Security beSECURE Scan Results",
        "baseQuery": "beSECURE_ScanResults_CL"
      },
      {
        "metricName": "Total data received",
        "legend": "Beyond Security beSECURE Audit",
        "baseQuery": "beSECURE_Audit_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "CVSS Score Aggregated",
        "query": "beSECURE_ScanResults_CL  | summarize count() by cvss_score_s"
      },
      {
        "description": "Risk Aggregated",
        "query": "beSECURE_ScanResults_CL  | summarize count() by risk_name_s"
      },
      {
        "description": "Host Risk Aggregated",
        "query": "beSECURE_ScanResults_CL  | summarize count() by destination_host_s, risk_name_s"
      },
      {
        "description": "Top 10 most vulnerable Hosts",
        "query": "beSECURE_ScanResults_CL  | \n where (risk_value_s == 8 or risk_value_s == 4) | \n summarize count() by destination_host_s, risk_value_s | \n order by risk_value_s, count_ | \n limit 10"
      },
      {
        "description": "Failed login",
        "query": "beSECURE_Audit_CL | \n where audit_event_s == 'Login failed' "
      },
      {
        "description": "Completed Scans",
        "query": "beSECURE_ScanEvent_CL | \n where scan_event_s == 'Scan Complete' | \n summarize count()"
      },
      {
        "description": "Failed to Complete Scans",
        "query": "beSECURE_ScanEvent_CL | \n where scan_event_s == 'Scan Failed' | \n summarize count()"
      }
    ],
    "dataTypes": [
      {
        "name": "beSECURE_ScanResults_CL",
        "lastDataReceivedQuery": "beSECURE_ScanResults_CL \n | summarize Time = max(TimeGenerated)\n      | where isnotempty(Time)"
      },
      {
        "name": "beSECURE_ScanEvent_CL",
        "lastDataReceivedQuery": "beSECURE_ScanEvent_CL \n | summarize Time = max(TimeGenerated)\n      | where isnotempty(Time)"
      },
      {
        "name": "beSECURE_Audit_CL",
        "lastDataReceivedQuery": "beSECURE_Audit_CL \n | summarize Time = max(TimeGenerated)\n      | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "beSECURE_ScanEvent_CL \n | summarize LastLogReceived = max(TimeGenerated) \n | project IsConnected = LastLogReceived > ago(30d)",
          "beSECURE_ScanResults_CL \n | summarize LastLogReceived = max(TimeGenerated) \n | project IsConnected = LastLogReceived > ago(30d)",
          "beSECURE_Audit_CL \n | summarize LastLogReceived = max(TimeGenerated) \n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Configure beSECURE",
        "description": "Follow the steps below to configure your beSECURE solution to send out scan results, scan status and audit trail to Azure Sentinel.",
        "innerSteps": [
          {
            "title": "1. Access the Integration menu",
            "description": "1.1 Click on the 'More' menu option\n\n1.2 Select Server\n\n1.3 Select Integration\n\n1.4 Enable Azure Sentinel"
          },
          {
            "title": "2. Provide Azure Sentinel settings",
            "description": "Fill in the Workspace ID and Primary Key values, click 'Modify'",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId"
                  ],
                  "label": "Workspace ID"
                },
                "type": "CopyableLabel"
              },
              {
                "parameters": {
                  "fillWith": [
                    "PrimaryKey"
                  ],
                  "label": "Primary Key"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      }
    ],
    "metadata": {
      "id": "3be993d4-3aa7-41de-8280-e62de7859eca",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Beyond Security"
      },
      "support": {
        "name": "Beyond Security",
        "link": "https://beyondsecurity.freshdesk.com/support/home",
        "tier": "developer"
      }
    }
  },
  {
    "id": "BigIDDSPMLogsConnectorDefinition",
    "title": "BigID DSPM connector",
    "publisher": "BigID",
    "descriptionMarkdown": "The [BigID DSPM](https://bigid.com/data-security-posture-management/) data connector provides the capability to ingest BigID DSPM cases with affected objects and datasource information into Microsoft Sentinel.",
    "graphQueries": [
      {
        "metricName": "Total Cases received",
        "legend": "BigID DSPM Catalog",
        "baseQuery": "BigIDDSPMCatalog_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get a sample of BigID DSPM Event logs",
        "query": "BigIDDSPMCatalog_CL\n| take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "BigIDDSPMCatalog_CL",
        "lastDataReceivedQuery": "BigIDDSPMCatalog_CL\n|summarize Time = max  (TimeGenerated)\n|where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "Bitglass",
    "title": "Bitglass",
    "publisher": "Bitglass",
    "descriptionMarkdown": "The [Bitglass](https://www.bitglass.com/) data connector provides the capability to retrieve security event logs of the Bitglass services and more events into Microsoft Sentinel through the REST API. The connector provides ability to get events which helps to examine potential security risks, analyze your team's use of collaboration, diagnose configuration problems and more.",
    "additionalRequirementBanner": ">This data connector depends on a parser based on a Kusto Function to work as expected [**Bitglass**](https://aka.ms/sentinel-bitglass-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "BitglassLogs_CL",
        "baseQuery": "BitglassLogs_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Bitglass Events - All Activities.",
        "query": "BitglassLogs_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "BitglassLogs_CL",
        "lastDataReceivedQuery": "BitglassLogs_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "BitglassLogs_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "**BitglassToken** and **BitglassServiceURL** are required for making API calls."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Azure Blob Storage API to pull logs into Microsoft Sentinel. This might result in additional costs for data ingestion and for storing data in Azure Blob Storage costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) and [Azure Blob Storage pricing page](https://azure.microsoft.com/pricing/details/storage/blobs/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**Bitglass**](https://aka.ms/sentinel-bitglass-parser) which is deployed with the Microsoft Sentinel Solution."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the Bitglass Log Retrieval API**\n\n Follow the instructions to obtain the credentials.\n\n1. Please contact Bitglass [support](https://pages.bitglass.com/Contact.html) and obtain the **BitglassToken** and **BitglassServiceURL** ntation].\n2. Save credentials for using in the data connector."
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Bitglass data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following).",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the Bitglass data connector using an ARM Template.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-bitglass-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n> **NOTE:** Within the same resource group, you can't mix Windows and Linux apps in the same region. Select existing resource group without Windows apps in it or create new resource group.\n3. Enter the **BitglassToken**, **BitglassServiceURL**  and deploy. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the Bitglass data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-bitglass-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. BitglassXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.11.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select ** New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tBitglassToken\n\t\tBitglassServiceURL\n\t\tWorkspaceID\n\t\tWorkspaceKey\n\t\tlogAnalyticsUri (optional)\n> - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n4. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "BitSight",
    "title": "Bitsight data connector",
    "publisher": "BitSight Technologies, Inc.",
    "descriptionMarkdown": "The [BitSight](https://www.BitSight.com/) Data Connector supports evidence-based cyber risk monitoring by bringing BitSight data in Microsoft Sentinel.",
    "graphQueries": [
      {
        "metricName": "Total Alerts data received",
        "legend": "BitsightAlerts_data_CL",
        "baseQuery": "BitsightAlerts_data_CL"
      },
      {
        "metricName": "Total Breaches data received",
        "legend": "BitsightBreaches_data_CL",
        "baseQuery": "BitsightBreaches_data_CL"
      },
      {
        "metricName": "Total Company Details received",
        "legend": "BitsightCompany_details_CL",
        "baseQuery": "BitsightCompany_details_CL"
      },
      {
        "metricName": "Total Company Ratings received",
        "legend": "BitsightCompany_rating_details_CL",
        "baseQuery": "BitsightCompany_rating_details_CL"
      },
      {
        "metricName": "Total Diligence Historical Statistics data received",
        "legend": "BitsightDiligence_historical_statistics_CL",
        "baseQuery": "BitsightDiligence_historical_statistics_CL"
      },
      {
        "metricName": "Total Diligence Statistics data received",
        "legend": "BitsightDiligence_statistics_CL",
        "baseQuery": "BitsightDiligence_statistics_CL"
      },
      {
        "metricName": "Total Findings data received",
        "legend": "BitsightFindings_data_CL",
        "baseQuery": "BitsightFindings_data_CL"
      },
      {
        "metricName": "Total Findings Summary data received",
        "legend": "BitsightFindings_summary_CL",
        "baseQuery": "BitsightFindings_summary_CL"
      },
      {
        "metricName": "Total Graph data received",
        "legend": "BitsightGraph_data_CL",
        "baseQuery": "BitsightGraph_data_CL"
      },
      {
        "metricName": "Total Industrial Statistics data received",
        "legend": "BitsightIndustrial_statistics_CL",
        "baseQuery": "BitsightIndustrial_statistics_CL"
      },
      {
        "metricName": "Total Observation Statistics data received",
        "legend": "BitsightObservation_statistics_CL",
        "baseQuery": "BitsightObservation_statistics_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "BitSight Alert Events - Alerts Event for all Companies in portfolio.",
        "query": "BitsightAlerts_data_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "BitSight Breaches Events - Breaches Event for all Companies in portfolio.",
        "query": "BitsightBreaches_data_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "BitSight Company Details Events - Company Details Event for all Companies in portfolio.",
        "query": "BitsightCompany_details_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "BitSight Company Ratings Events - Company Ratings Event for all Companies.",
        "query": "BitsightCompany_rating_details_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "BitSight Diligence Historical Statistics Events - Diligence Historical Statistics Event for all Companies.",
        "query": "BitsightDiligence_historical_statistics_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "BitSight Diligence Statistics Events - Diligence Statistics Event for all Companies.",
        "query": "BitsightDiligence_statistics_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "BitSight Findings Events - Findings Event for all Companies.",
        "query": "BitsightFindings_data_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "BitSight Findings Summary Events - Findings Summary Event for all Companies.",
        "query": "BitsightFindings_summary_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "BitSight Graph Events - Graph Event for all Companies.",
        "query": "BitsightGraph_data_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "BitSight Industrial Statistics Events - Industrial Statistics Event for all Companies.",
        "query": "BitsightIndustrial_statistics_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "BitSight Observation Statistics Events - Observation Statistics Event for all Companies.",
        "query": "BitsightObservation_statistics_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "BitsightAlerts_data_CL",
        "lastDataReceivedQuery": "BitsightAlerts_data_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "BitsightBreaches_data_CL",
        "lastDataReceivedQuery": "BitsightBreaches_data_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "BitsightCompany_details_CL",
        "lastDataReceivedQuery": "BitsightCompany_details_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "BitsightCompany_rating_details_CL",
        "lastDataReceivedQuery": "BitsightCompany_rating_details_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "BitsightDiligence_historical_statistics_CL",
        "lastDataReceivedQuery": "BitsightDiligence_historical_statistics_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "BitsightDiligence_statistics_CL",
        "lastDataReceivedQuery": "BitsightDiligence_statistics_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "BitsightFindings_data_CL",
        "lastDataReceivedQuery": "BitsightFindings_data_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "BitsightFindings_summary_CL",
        "lastDataReceivedQuery": "BitsightFindings_summary_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "BitsightGraph_data_CL",
        "lastDataReceivedQuery": "BitsightGraph_data_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "BitsightIndustrial_statistics_CL",
        "lastDataReceivedQuery": "BitsightIndustrial_statistics_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "BitsightObservation_statistics_CL",
        "lastDataReceivedQuery": "BitsightObservation_statistics_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "BitsightAlerts_data_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "BitsightBreaches_data_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "BitsightCompany_details_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "BitsightCompany_rating_details_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "BitsightDiligence_historical_statistics_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "BitsightDiligence_statistics_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "BitsightFindings_data_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "BitsightFindings_summary_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "BitsightGraph_data_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "BitsightIndustrial_statistics_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "BitsightObservation_statistics_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "BitSight API Token is required.  See the documentation to [learn more](https://help.bitsighttech.com/hc/en-us/articles/115014888388-API-Token-Management) about API Token."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the BitSight API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1 - Steps to Create/Get Bitsight API Token**\n\n Follow these instructions to get a BitSight API Token.\n 1. For SPM App: Refer to the [User Preference](https://service.bitsight.com/app/spm/account) tab of your Account page, \n\t\tGo to Settings > Account > User Preferences > API Token.\n 2. For TPRM App: Refer to the [User Preference](https://service.bitsight.com/app/tprm/account) tab of your Account page, \n\t\tGo to Settings > Account > User Preferences > API Token.\n 3. For Classic BitSight: Go to your [Account](https://service.bitsight.com/settings) page, \n\t\tGo to Settings > Account > API Token."
      },
      {
        "title": "",
        "description": "**STEP 2 - App Registration steps for the Application in Microsoft Entra ID**\n\n This integration requires an App registration in the Azure portal. Follow the steps in this section to create a new application in Microsoft Entra ID:\n 1. Sign in to the [Azure portal](https://portal.azure.com/).\n 2. Search for and select **Microsoft Entra ID**.\n 3. Under **Manage**, select **App registrations > New registration**.\n 4. Enter a display **Name** for your application.\n 5. Select **Register** to complete the initial app registration.\n 6. When registration finishes, the Azure portal displays the app registration's Overview pane. You see the **Application (client) ID** and **Tenant ID**. The client ID and Tenant ID is required as configuration parameters for the execution of BitSight Data Connector. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app)"
      },
      {
        "title": "",
        "description": "**STEP 3 - Add a client secret for application in Microsoft Entra ID**\n\n Sometimes called an application password, a client secret is a string value required for the execution of BitSight Data Connector. Follow the steps in this section to create a new Client Secret:\n 1. In the Azure portal, in **App registrations**, select your application.\n 2. Select **Certificates & secrets > Client secrets > New client secret**.\n 3. Add a description for your client secret.\n 4. Select an expiration for the secret or specify a custom lifetime. Limit is 24 months.\n 5. Select **Add**. \n 6. *Record the secret's value for use in your client application code. This secret value is never displayed again after you leave this page.* The secret value is required as configuration parameter for the execution of BitSight Data Connector. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret)"
      },
      {
        "title": "",
        "description": "**STEP 4 - Get Object ID of your application in Microsoft Entra ID**\n\n After creating your app registration, follow the steps in this section to get Object ID:\n 1. Go to **Microsoft Entra ID**.\n 2. Select **Enterprise applications** from the left menu.\n 3. Find your newly created application in the list (you can search by the name you provided).\n 4. Click on the application.\n 5. On the overview page, copy the **Object ID**. This is the **AzureEntraObjectId** needed for your ARM template role assignment.\n"
      },
      {
        "title": "",
        "description": "**STEP 5 - Assign role of Contributor to application in Microsoft Entra ID**\n\n Follow the steps in this section to assign the role:\n 1. In the Azure portal, Go to **Resource Group** and select your resource group.\n 2. Go to **Access control (IAM)** from left panel.\n 3. Click on **Add**, and then select **Add role assignment**.\n 4. Select **Contributor** as role and click on next.\n 5. In **Assign access to**, select `User, group, or service principal`.\n 6. Click on **add members** and type **your app name** that you have created and select it.\n 7. Now click on **Review + assign** and then again click on **Review + assign**. \n\n> **Reference link:** [https://learn.microsoft.com/azure/role-based-access-control/role-assignments-portal](https://learn.microsoft.com/azure/role-based-access-control/role-assignments-portal)"
      },
      {
        "title": "",
        "description": "**STEP 6 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the BitSight data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following) readily available.., as well as the BitSight API Token.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the BitSight connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-BitSight-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the below information :  \n\n\t a. **FunctionName** - Name of the Azure Function App to be created. Default is BitSight. \n\n\t b. **API_token** - Enter API Token of your BitSight account. \n\n\t c. **Azure_Client_Id** - Enter Azure Client Id that you have created during app registration. \n\n\t d. **Azure_Client_Secret** - Enter Azure Client Secret that you have created during creating the client secret. \n\n\t e. **Azure_Tenant_Id** - Enter Azure Tenant Id of your Microsoft Entra ID. \n\n\t f. **Azure_Entra_Object_Id** - Enter Object id of your Microsoft Entra App. \n\n\t g. **Companies** - Please add valid company names separated by asterisk(*). For example: Actors Films*Goliath Investments LLC*HCL Group*Saperix, Inc. \n\n\t h. **Location** - The location in which the data collection rules and data collection endpoints should be deployed. \n\n\t i. **WorkspaceName** - Log analytics workspace name. Can be found under Log analytics \"Settings\". \n\n\t j. **Portfolio_Companies_Table_Name** - Name of the table to store portfolio companies. Default is BitsightPortfolio_Companies. Please do not keep this field as empty else you will get validation error. \n\n\t k. **Alerts_Table_Name** - Name of the table to store alerts. Default is BitsightAlerts_data. Please do not keep this field as empty else you will get validation error. \n\n\t l. **Breaches_Table_Name** - Name of the table to store breaches. Default is BitsightBreaches_data. Please do not keep this field as empty else you will get validation error. \n\n\t m. **Company_Table_Name** - Name of the table to store company details. Default is BitsightCompany_details. Please do not keep this field as empty else you will get validation error. \n\n\t n. **Company_Rating_Details_Table_Name** - Name of the table to store company rating details. Default is BitsightCompany_rating_details. Please do not keep this field as empty else you will get validation error. \n\n\t o. **Diligence_Historical_Statistics_Table_Name** - Name of the table to store diligence historical statistics. Default is BitsightDiligence_historical_statistics. Please do not keep this field as empty else you will get validation error. \n\n\t p. **Diligence_Statistics_Table_Name** - Name of the table to store diligence statistics. Default is BitsightDiligence_statistics. Please do not keep this field as empty else you will get validation error. \n\n\t q. **Findings_Summary_Table_Name** - Name of the table to store findings summary. Default is BitsightFindings_summary. Please do not keep this field as empty else you will get validation error. \n\n\t r. **Findings_Table_Name** - Name of the table to store findings data. Default is BitsightFindings_data. Please do not keep this field as empty else you will get validation error. \n\n\t s. **Graph_Table_Name** - Name of the table to store graph data. Default is BitsightGraph_data. Please do not keep this field as empty else you will get validation error. \n\n\t t. **Industrial_Statistics_Table_Name** - Name of the table to store industrial statistics. Default is BitsightIndustrial_statistics. Please do not keep this field as empty else you will get validation error. \n\n\t u. **Observation_Statistics_Table_Name** - Name of the table to store observation statistics. Default is BitsightObservation_statistics. Please do not keep this field as empty else you will get validation error. \n\n\t v. **LogLevel** - Select log level or log severity value from DEBUG, INFO, ERROR. By default it is set to INFO. \n\n\t w. **Schedule** - Please enter a valid Quartz cron-expression. (Example: 0 0 * * * *). \n\n\t x. **Schedule_Portfolio** - Please enter a valid Quartz cron-expression. (Example: 0 */30 * * * *). \n\n\t y. **AppInsightsWorkspaceResourceID** - Use 'Log Analytic Workspace-->Properties' blade having 'Resource ID' property value. This is a fully qualified resourceId which is in format '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}'. \n4. Once all application settings have been entered, click **Review + create** to deploy.."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the BitSight data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-BitSight310-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. BitSightXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.8 or above.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following application settings individually, with their respective values (case-sensitive): \n\n\t a. **FunctionName** - Name of the Azure Function App to be created. Default is BitSight. \n\n\t b. **API_token** - Enter API Token of your BitSight account. \n\n\t c. **Azure_Client_Id** - Enter Azure Client Id that you have created during app registration. \n\n\t d. **Azure_Client_Secret** - Enter Azure Client Secret that you have created during creating the client secret. \n\n\t e. **Azure_Tenant_Id** - Enter Azure Tenant Id of your Microsoft Entra ID. \n\n\t f. **Azure_Entra_Object_Id** - Enter Object id of your Microsoft Entra App. \n\n\t g. **Companies** - Please add valid company names separated by asterisk(*). For example: Actors Films*Goliath Investments LLC*HCL Group*Saperix, Inc. \n\n\t h. **Location** - The location in which the data collection rules and data collection endpoints should be deployed. \n\n\t i. **WorkspaceName** - Log analytics workspace name. Can be found under Log analytics \"Settings\". \n\n\t j. **Portfolio_Companies_Table_Name** - Name of the table to store portfolio companies. Default is BitsightPortfolio_Companies. Please do not keep this field as empty else you will get validation error. \n\n\t k. **Alerts_Table_Name** - Name of the table to store alerts. Default is BitsightAlerts_data. Please do not keep this field as empty else you will get validation error. \n\n\t l. **Breaches_Table_Name** - Name of the table to store breaches. Default is BitsightBreaches_data. Please do not keep this field as empty else you will get validation error. \n\n\t m. **Company_Table_Name** - Name of the table to store company details. Default is BitsightCompany_details. Please do not keep this field as empty else you will get validation error. \n\n\t n. **Company_Rating_Details_Table_Name** - Name of the table to store company rating details. Default is BitsightCompany_rating_details. Please do not keep this field as empty else you will get validation error. \n\n\t o. **Diligence_Historical_Statistics_Table_Name** - Name of the table to store diligence historical statistics. Default is BitsightDiligence_historical_statistics. Please do not keep this field as empty else you will get validation error. \n\n\t p. **Diligence_Statistics_Table_Name** - Name of the table to store diligence statistics. Default is BitsightDiligence_statistics. Please do not keep this field as empty else you will get validation error. \n\n\t q. **Findings_Summary_Table_Name** - Name of the table to store findings summary. Default is BitsightFindings_summary. Please do not keep this field as empty else you will get validation error. \n\n\t r. **Findings_Table_Name** - Name of the table to store findings data. Default is BitsightFindings_data. Please do not keep this field as empty else you will get validation error. \n\n\t s. **Graph_Table_Name** - Name of the table to store graph data. Default is BitsightGraph_data. Please do not keep this field as empty else you will get validation error. \n\n\t t. **Industrial_Statistics_Table_Name** - Name of the table to store industrial statistics. Default is BitsightIndustrial_statistics. Please do not keep this field as empty else you will get validation error. \n\n\t u. **Observation_Statistics_Table_Name** - Name of the table to store observation statistics. Default is BitsightObservation_statistics. Please do not keep this field as empty else you will get validation error. \n\n\t v. **LogLevel** - Select log level or log severity value from DEBUG, INFO, ERROR. By default it is set to INFO. \n\n\t w. **Schedule** - Please enter a valid Quartz cron-expression. (Example: 0 0 * * * *). \n\n\t x. **Schedule_Portfolio** - Please enter a valid Quartz cron-expression. (Example: 0 */30 * * * *). \n\n\t y. **AppInsightsWorkspaceResourceID** - Use 'Log Analytic Workspace-->Properties' blade having 'Resource ID' property value. This is a fully qualified resourceId which is in format '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}'. \n4. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "BitwardenEventLogs",
    "title": "Bitwarden Event Logs",
    "publisher": "Bitwarden Inc",
    "descriptionMarkdown": "This connector provides insight into activity of your Bitwarden organization such as user's activity (logged in, changed password, 2fa, etc.), cipher activity (created, updated, deleted, shared, etc.), collection activity, organization activity, and more.",
    "graphQueries": [
      {
        "metricName": "Total event logs received",
        "legend": "Bitwarden Event Logs",
        "baseQuery": "BitwardenEventLogs_CL"
      }
    ],
    "sampleQueries": [
      {
        "name": "Get sample of Bitwarden Event Logs",
        "query": "BitwardenEventLogs",
        "description": "Get sample of Bitwarden Event Logs"
      }
    ],
    "dataTypes": [
      {
        "name": "EventLogs",
        "lastDataReceivedQuery": "BitwardenEventLogs_CL\n | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
      },
      {
        "name": "Members",
        "lastDataReceivedQuery": "BitwardenMembers_CL\n | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
      },
      {
        "name": "Groups",
        "lastDataReceivedQuery": "BitwardenGroups_CL\n | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "BlackberryCylancePROTECT",
    "title": "[Deprecated] Blackberry CylancePROTECT",
    "publisher": "Blackberry",
    "descriptionMarkdown": "The [Blackberry CylancePROTECT](https://www.blackberry.com/us/en/products/blackberry-protect) connector allows you to easily connect your CylancePROTECT logs with Microsoft Sentinel. This gives you more insight into your organization's network and improves your security operation capabilities.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CylancePROTECT",
        "baseQuery": "CylancePROTECT"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Event Types",
        "query": "CylancePROTECT\n            | summarize count() by EventName\n            | top 10 by count_"
      },
      {
        "description": "Top 10 Triggered Policies",
        "query": "CylancePROTECT\n            | where EventType == \"Threat\" \n            | summarize count() by PolicyName \n            | top 10 by count_"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CylancePROTECT\n |where TimeGenerated > ago(3d)\n    |take 1\n   | project IsConnected = true"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog (CylancePROTECT)",
        "lastDataReceivedQuery": "CylancePROTECT\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "write permission.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "CylancePROTECT",
          "description": "must be configured to export logs via Syslog."
        }
      ]
    },
    "instructionSteps": [
      {
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias CyclanePROTECT and load the function code or click [here](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Blackberry%20CylancePROTECT/Parsers/CylancePROTECT.txt), on the second line of the query, enter the hostname(s) of your CyclanePROTECT device(s) and any other unique identifiers for the logstream. The function usually takes 10-15 minutes to activate after solution installation/update."
      },
      {
        "title": "1. Install and onboard the agent for Linux",
        "description": "Typically, you should install the agent on a different computer from the one on which the logs are generated.\n\n>  Syslog logs are collected only from **Linux** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Configure the facilities you want to collect and their severities.\n\n1.  Select the link below to open your workspace **agents configuration**, and select the **Syslog** tab.\n2.  Select **Add facility** and choose from the drop-down list of facilities. Repeat for all the facilities you want to add.\n3.  Mark the check boxes for the desired severities for each facility.\n4.  Click **Apply**.",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenSyslogSettings"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "3. Configure and connect the CylancePROTECT",
        "description": "[Follow these instructions](https://docs.blackberry.com/content/dam/docs-blackberry-com/release-pdfs/en/cylance-products/syslog-guides/Cylance%20Syslog%20Guide%20v2.0%20rev12.pdf) to configure the CylancePROTECT to forward syslog. Use the IP address or hostname for the Linux device with the Linux agent installed as the Destination IP address."
      }
    ]
  },
  {
    "id": "BloodHoundEnterprise",
    "title": "Bloodhound Enterprise",
    "publisher": "SpecterOps",
    "descriptionMarkdown": "The solution is designed to test Bloodhound Enterprise package creation process.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total Attack Paths Details",
        "legend": "Bloodhound Enterprise Attack Paths Details",
        "baseQuery": "BHEAttackPathsData_CL "
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Bloodhound Enterprise Attack Path Details",
        "query": "BHEAttackPathsData_CL  | top 10 by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "BHEAttackPathsData_CL ",
        "lastDataReceivedQuery": "BHEAttackPathsData_CL "
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "BHEAttackPathsData_CL "
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "**BloodHound Enterprise API key & Id** is required.  See the documentation to learn more about API on the `https://bloodhound.specterops.io/integrations/bloodhound-api/working-with-api`."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to a 'BloodHound Enterprise' to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": "**STEP 1 - Retrieve BloodHound Enterprise API Key and ID**\n\nTo enable the Azure Function to authenticate successfully and pull logs into Microsoft Sentinel, you must first obtain the API Key and ID from your BloodHound Enterprise instance. See the documentation to learn more about API on the `https://bloodhound.specterops.io/integrations/bloodhound-api/working-with-api`."
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the 'BloodHound Enterprise' connector, have the Workspace ID  and Workspace Primary Key (can be copied from the following), as well as the 'BloodHound Enterprise' API authorization key(s) or Token, readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "",
        "description": "**Option 1 - Azure Resource Manager (ARM) Template**\n\nUse this method for automated deployment of the 'BloodHound Enterprise' connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)]()\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Tenant URL**, **API Key**, **API ID** 'and/or Other required fields'. \n>Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "",
        "description": "**Option 2 - Manual Deployment of Azure Functions**\n\n Use the following step-by-step instructions to deploy the 'BloodHound Enterprise' connector manually with Azure Functions."
      },
      {
        "title": "1. Create a Function App",
        "description": "1.  From the Azure Portal, navigate to [Function App](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Web%2Fsites/kind/functionapp).\n2. Click **+ Create** at the top.\n3. In the **Basics** tab, ensure Runtime stack is set to **python 3.11**. \n4. In the **Hosting** tab, ensure **Plan type** is set to **'Consumption (Serverless)'**.\n5.select Storage account\n6. 'Add other required configurations'. \n5. 'Make other preferable configuration changes', if needed, then click **Create**."
      },
      {
        "title": "2. Import Function App Code(Zip deployment)",
        "description": "1. Install Azure CLI\n2. From terminal type **az functionapp deployment source config-zip -g <ResourceGroup> -n <FunctionApp> --src <Zip File>** and hit enter. Set the `ResourceGroup` value to: your resource group name. Set the `FunctionApp` value to: your newly created function app name. Set the `Zip File` value to: `digitalshadowsConnector.zip`(path to your zip file). Note:- Download the zip file from the link - [Function App Code](https://github.com/metron-labs/Azure-Sentinel/blob/bloodhound/Solutions/BloodHound/Data%20Connectors/BloodHoundAzureFunction.zip)"
      },
      {
        "title": "3. Configure the Function App",
        "description": "1. In the Function App screen, click the Function App name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following 'x (number of)' application settings individually, under Name, with their respective string values (case-sensitive) under Value: \n\t\tDigitalShadowsAccountID\n\t\tWorkspaceID\n\t\tWorkspaceKey\n\t\tDigitalShadowsKey\n\t\tDigitalShadowsSecret\n\t\tHistoricalDays\n\t\tDigitalShadowsURL\n\t\tClassificationFilterOperation\n\t\tHighVariabilityClassifications\n\t\tFUNCTION_NAME\n\t\tlogAnalyticsUri (optional)\n(add any other settings required by the Function App)\nSet the `DigitalShadowsURL` value to: `https://api.searchlight.app/v1`\nSet the `HighVariabilityClassifications` value to: `exposed-credential,marked-document`\nSet the `ClassificationFilterOperation` value to: `exclude` for exclude function app or `include` for include function app \n>Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Azure Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details.\n - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: https://<CustomerId>.ods.opinsights.azure.us. \n4. Once all application settings have been entered, click **Save**."
      },
      {
        "instructions": [
          {
            "type": "InstructionStepsGroup",
            "parameters": {
              "enable": true,
              "instructionSteps": [
                {
                  "title": "**STEP 3 - Register the Application in Microsoft Entra ID",
                  "description": "1. **Open the [Microsoft Entra ID page](https://entra.microsoft.com/)**:\n   - Click the provided link to open the **Microsoft Entra ID** registration page in a new tab.\n   - Ensure you are logged in with an account that has **Admin level** permissions.\n\n2. **Create a New Application**:\n   - In the **Microsoft Entra ID portal**, select **App registrations** mentioned on the left-hand side tab.\n   - Click on **+ New registration**.\n   - Fill out the following fields:\n     - **Name**: Enter a name for the app (e.g., BloodHound App).\n     - **Supported account types**: Choose **Accounts in this organizational directory only** (Default Directory only - Single tenant).\n     - **Redirect URI**: Leave this blank unless required otherwise.\n   - Click **Register** to create the application.\n\n3. **Copy Application and Tenant IDs**:\n   - Once the app is registered, note the **Application (client) ID** and **Directory (tenant) ID** from the **Overview** page. Youll need these for the integration.\n\n4. **Create a Client Secret**:\n   - In the **Certificates & secrets** section, click **+ New client secret**.\n   - Add a description (e.g., 'BloodHound Secret') and set an expiration (e.g., 1 year).\n   - Click **Add**.\n   - **Copy the client secret value immediately**, as it will not be shown again."
                },
                {
                  "title": "**STEP 4 - Assign the \"Monitoring Metrics Publisher\" Role to the App",
                  "description": "1. **Open the Resource Group in Azure Portal**:\n   - Navigate to the **Resource Group** that contains the **Log Analytics Workspace** and **Data Collection Rules (DCRs)** where you want the app to push data.\n\n2. **Assign the Role**:\n   - In the **Resource Group** menu, click on **Access control (IAM)** mentioned on the left-hand side tab ..\n   - Click on **+ Add** and select **Add role assignment**.\n   - In the **Role** dropdown, search for and select the **Monitoring Metrics Publisher** role.\n   - Under **Assign access to**, choose **Azure AD user, group, or service principal**.\n   - In the **Select** field, search for your registered app by **name** or **client ID**.\n   - Click **Save** to assign the role to the application."
                },
                {
                  "title": "**STEP 5 - Deploy the ARM Template",
                  "description": "1. **Retrieve the Workspace ID**:\n   - After assigning the role, you will need the **Workspace ID**.\n   - Navigate to the **Log Analytics Workspace** within the **Resource Group**.\n   - In the **Overview** section, locate the **Workspace ID** field under **Workspace details**.\n   - **Copy the Workspace ID** and keep it handy for the next steps.\n\n2. **Click the Deploy to Azure Button**:\n   - [![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmetron-labs%2FAzure-Sentinel%2Fbloodhound%2FSolutions%2FBloodHound%2FData%2520Connectors%2FDeployToAzure.json).\n   - This will take you directly to the Azure portal to start the deployment.\n\n3. **Review and Customize Parameters**:\n   - On the custom deployment page, ensure youre deploying to the correct **subscription** and **resource group**.\n   - Fill in the parameters like **workspace name**, **workspace ID**, and **workspace location**.\n\n4. **Click Review + Create** and then **Create** to deploy the resources."
                },
                {
                  "title": "**STEP 6 - Verify DCE, DCR, and Log Analytics Table Setup",
                  "description": "1. **Check the Data Collection Endpoint (DCE)**:\n   - After deploying, go to **Azure Portal > Data Collection Endpoints**.\n   - Verify that the **BloodHoundDCE** endpoint has been created successfully.\n   - **Copy the DCE Logs Ingestion URI**, as youll need this for generating the webhook URL.\n\n2. **Confirm Data Collection Rule (DCR) Setup**:\n   - Go to **Azure Portal > Data Collection Rules**.\n   - Ensure the **BloodHoundDCR** rule is present.\n   - **Copy the Immutable ID** of the DCR from the Overview page, as youll need it for the webhook URL.\n\n3. **Validate Log Analytics Table**:\n   - Navigate to your **Log Analytics Workspace** (linked to Microsoft Sentinel).\n   - Under the **Tables** section, verify that the **BloodHoundTable_CL** table has been created successfully and is ready to receive data."
                }
              ]
            }
          }
        ]
      }
    ],
    "metadata": {
      "version": "1.0.0",
      "kind": "dataConnector"
    }
  },
  {
    "id": "BoschAIShield",
    "title": "AIShield",
    "publisher": "Bosch",
    "descriptionMarkdown": "[AIShield](https://www.boschaishield.com/) connector allows users to connect with AIShield custom defense mechanism logs with Microsoft Sentinel, allowing the creation of dynamic Dashboards, Workbooks, Notebooks and tailored Alerts to improve investigation and thwart attacks on AI systems. It gives users more insight into their organization's AI assets security posturing and improves their AI systems security operation capabilities.AIShield.GuArdIan analyzes the LLM generated content to identify and mitigate harmful content, safeguarding against legal, policy, role based, and usage based violations",
    "additionalRequirementBanner": "This data connector depends on a parser based on Kusto Function to work as expected [**AIShield**](https://aka.ms/sentinel-boschaishield-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "AIShield_CL",
        "baseQuery": "AIShield_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get all incidents order by time",
        "query": "AIShield\n            | order by TimeGenerated desc "
      },
      {
        "description": "Get high risk incidents",
        "query": "AIShield\n            |  where Severity =~ 'High'"
      }
    ],
    "dataTypes": [
      {
        "name": "AIShield_CL",
        "lastDataReceivedQuery": "AIShield_CL\n            | summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "AIShield_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Note",
          "description": "Users should have utilized AIShield SaaS offering to conduct vulnerability analysis and deployed custom defense mechanisms generated along with their AI asset. [**Click here**](https://azuremarketplace.microsoft.com/marketplace/apps/rbei.bgsw_aishield_product) to know more or get in touch."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**AIShield**](https://aka.ms/sentinel-boschaishield-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "",
        "description": "\n>**IMPORTANT:** Before deploying the AIShield Connector, have the Workspace ID and Workspace Primary Key (can be copied from the following).",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ],
    "metadata": {
      "id": "cb950e71-d52e-4333-8637-96e3a5aaf70d",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "AIShield"
      },
      "author": {
        "name": "AIShield"
      },
      "support": {
        "name": "AIShield",
        "link": "mailto:AIShield.Contact@bosch.com",
        "tier": "developer"
      }
    }
  },
  {
    "id": "BoxDataConnector",
    "title": "Box",
    "publisher": "Box",
    "descriptionMarkdown": "The Box data connector provides the capability to ingest [Box enterprise's events](https://developer.box.com/guides/events/#admin-events) into Microsoft Sentinel using the Box REST API. Refer to [Box  documentation](https://developer.box.com/guides/events/enterprise-events/for-enterprise/) for more information.",
    "additionalRequirementBanner": "This connector depends on a parser based on Kusto Function to work as expected [**BoxEvents**](https://aka.ms/sentinel-BoxDataConnector-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Box events",
        "legend": "BoxEvents_CL",
        "baseQuery": "BoxEvents_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Box events",
        "query": "BoxEvents\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "BoxEvents_CL",
        "lastDataReceivedQuery": "BoxEvents_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "BoxEvents_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Box API Credentials",
          "description": "Box config JSON file is required for Box REST API JWT authentication. [See the documentation to learn more about JWT authentication](https://developer.box.com/guides/authentication/jwt/)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Box REST API to pull logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": ">**NOTE:** This connector depends on a parser based on Kusto Function to work as expected [**BoxEvents**](https://aka.ms/sentinel-BoxDataConnector-parser) which is deployed with the Microsoft Sentinel Solution."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration of the Box events collection**\n\nSee documentation to [setup JWT authentication](https://developer.box.com/guides/authentication/jwt/jwt-setup/) and [obtain JSON file with credentials](https://developer.box.com/guides/authentication/jwt/with-sdk/#prerequisites)."
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Box data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following), as well as the Box JSON configuration file, readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Option 1 - Azure Resource Manager (ARM) Template",
                  "description": "Use this method for automated deployment of the Box data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-BoxDataConnector-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **AzureSentinelWorkspaceId**, **AzureSentinelSharedKey**, **BoxConfigJSON**\n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**.\n5. Click **Purchase** to deploy."
                },
                {
                  "title": "Option 2 - Manual Deployment of Azure Functions",
                  "description": "Use the following step-by-step instructions to deploy the Box data connector manually with Azure Functions (Deployment via Visual Studio Code).",
                  "instructions": [
                    {
                      "parameters": {
                        "instructionSteps": [
                          {
                            "title": "Step 1 - Deploy a Function App",
                            "description": "1. Download the [Azure Function App](https://aka.ms/sentinel-BoxDataConnector-functionapp) file. Extract archive to your local development computer.\n2. Follow the [function app manual deployment instructions](https://github.com/Azure/Azure-Sentinel/blob/master/DataConnectors/AzureFunctionsManualDeployment.md#function-app-manual-deployment-instructions) to deploy the Azure Functions app using VSCode.\n3. After successful deployment of the function app, follow next steps for configuring it."
                          },
                          {
                            "title": "Step 2 - Configure the Function App",
                            "description": "1. Go to Azure Portal for the Function App configuration.\n2. In the Function App, select the Function App Name and select **Configuration**.\n3. In the **Application settings** tab, select **+ New application setting**.\n4. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tAzureSentinelWorkspaceId\n\t\tAzureSentinelSharedKey\n\t\tBOX_CONFIG_JSON\n\t\tlogAnalyticsUri (optional)\n> - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n5. Once all application settings have been entered, click **Save**."
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "BoxEventsCCPDefinition",
    "title": "Box Events (CCP)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The Box data connector provides the capability to ingest [Box enterprise's events](https://developer.box.com/guides/events/#admin-events) into Microsoft Sentinel using the Box REST API. Refer to [Box  documentation](https://developer.box.com/guides/events/enterprise-events/for-enterprise/) for more information.",
    "graphQueries": [
      {
        "metricName": "Events received",
        "legend": "Box events received",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Box events",
        "query": "BoxEvents\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": null,
    "metadata": null
  },
  {
    "id": "BroadcomSymantecDLP",
    "title": "[Deprecated] Broadcom Symantec DLP via Legacy Agent",
    "publisher": "Broadcom",
    "descriptionMarkdown": "The [Broadcom Symantec Data Loss Prevention (DLP)](https://www.broadcom.com/products/cyber-security/information-protection/data-loss-prevention) connector allows you to easily connect your Symantec DLP with Microsoft Sentinel, to create custom dashboards, alerts, and improve investigation. This gives you more insight into your organizations information, where it travels, and improves your security operation capabilities.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "SymantecDLP",
        "baseQuery": "CommonSecurityLog \n| where DeviceVendor == \"Symantec\" and DeviceProduct == \"DLP\""
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Triggered Activities",
        "query": "SymantecDLP \n | summarize count() by Activity \n| top 10 by count_"
      },
      {
        "description": "Top 10 Filenames",
        "query": "SymantecDLP \n | summarize count() by FileName \n| top 10 by count_"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog \n| where DeviceVendor == \"Symantec\" and DeviceProduct == \"DLP\"\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(3d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (SymantecDLP)",
        "lastDataReceivedQuery": "CommonSecurityLog \n| where DeviceVendor == \"Symantec\" and DeviceProduct == \"DLP\"\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias SymantecDLP and load the function code or click [here](https://aka.ms/sentinel-symantecdlp-parser). The function usually takes 10-15 minutes to activate after solution installation/update.",
        "instructions": []
      },
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Symantec DLP logs to a Syslog agent",
        "description": "Configure Symantec DLP to forward Syslog messages in CEF format to your Microsoft Sentinel workspace via the Syslog agent.\n1. [Follow these instructions](https://knowledge.broadcom.com/external/article/159509/generating-syslog-messages-from-data-los.html) to configure the Symantec DLP to forward syslog\n2. Use the IP address or hostname for the Linux device with the Linux agent installed as the Destination IP address."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "BroadcomSymantecDLPAma",
    "title": "[Deprecated] Broadcom Symantec DLP via AMA",
    "publisher": "Broadcom",
    "descriptionMarkdown": "The [Broadcom Symantec Data Loss Prevention (DLP)](https://www.broadcom.com/products/cyber-security/information-protection/data-loss-prevention) connector allows you to easily connect your Symantec DLP with Microsoft Sentinel, to create custom dashboards, alerts, and improve investigation. This gives you more insight into your organizations information, where it travels, and improves your security operation capabilities.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "SymantecDLP",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Symantec'\n |where DeviceProduct =~ 'DLP'\n |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Triggered Activities",
        "query": "SymantecDLP \n | summarize count() by Activity \n| top 10 by count_"
      },
      {
        "description": "Top 10 Filenames",
        "query": "SymantecDLP \n | summarize count() by FileName \n| top 10 by count_"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'Symantec'\n |where DeviceProduct =~ 'DLP'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (SymantecDLP)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Symantec'\n |where DeviceProduct =~ 'DLP'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias SymantecDLP and load the function code or click [here](https://aka.ms/sentinel-symantecdlp-parser). The function usually takes 10-15 minutes to activate after solution installation/update.",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine",
                  "instructions": []
                },
                {
                  "title": "Step B. Forward Symantec DLP logs to a Syslog agent",
                  "description": "Configure Symantec DLP to forward Syslog messages in CEF format to your Microsoft Sentinel workspace via the Syslog agent.\n1. [Follow these instructions](https://knowledge.broadcom.com/external/article/159509/generating-syslog-messages-from-data-los.html) to configure the Symantec DLP to forward syslog\n2. Use the IP address or hostname for the Linux device with the Linux agent installed as the Destination IP address.",
                  "instructions": []
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "carbonBlackAWSS3",
    "title": "VMware Carbon Black Cloud via AWS S3",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The [VMware Carbon Black Cloud](https://www.vmware.com/products/carbon-black-cloud.html) via AWS S3 data connector provides the capability to ingest watchlist, alerts, auth and endpoints events via AWS S3 and stream them to ASIM normalized tables. The connector provides ability to get events which helps to examine potential security risks, analyze your team's use of collaboration, diagnose configuration problems and more.",
    "graphQueries": [
      {
        "metricName": "CarbonBlack_Alerts_CL",
        "legend": "Alerts",
        "baseQuery": "CarbonBlack_Alerts_CL"
      },
      {
        "metricName": "CarbonBlack_Watchlist_CL",
        "legend": "Watchlist",
        "baseQuery": "CarbonBlack_Watchlist_CL"
      },
      {
        "metricName": "ASimNetworkSessionLogs",
        "legend": "ASimNetworkSessionLogs",
        "baseQuery": "ASimNetworkSessionLogs | where EventProduct == 'Carbon Black Cloud' and EventVendor == 'VMWare' "
      },
      {
        "metricName": "ASimProcessEventLogs",
        "legend": "ASimProcessEventLogs",
        "baseQuery": "ASimProcessEventLogs | where EventProduct == 'Carbon Black Cloud' and EventVendor == 'VMWare' "
      },
      {
        "metricName": "ASimFileEventLogs",
        "legend": "ASimFileEventLogs",
        "baseQuery": "ASimFileEventLogs | where EventProduct == 'Carbon Black Cloud' and EventVendor == 'VMWare' "
      },
      {
        "metricName": "ASimRegistryEventLogs",
        "legend": "ASimRegistryEventLogs",
        "baseQuery": "ASimRegistryEventLogs | where EventProduct == 'Carbon Black Cloud' and EventVendor == 'VMWare' "
      },
      {
        "metricName": "ASimAuthenticationEventLogs",
        "legend": "Auth",
        "baseQuery": "ASimAuthenticationEventLogs | where EventProduct == 'Carbon Black Cloud' and EventVendor == 'VMWare'"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get a sample of CarbonBlack Alert logs",
        "query": "CarbonBlack_Alerts_CL\n | take 10"
      },
      {
        "description": "Get a sample of CarbonBlack Watchlist logs",
        "query": "CarbonBlack_Watchlist_CL\n| take 10"
      },
      {
        "description": "Get a sample of Carbonblack ASimNetwork Session logs",
        "query": "ASimNetworkSessionLogs\n | where EventProduct == 'Carbon Black Cloud' and EventVendor == 'VMWare'\n| take 10"
      },
      {
        "description": "Get a sample of CarbonBlack ASimProcess Event logs",
        "query": "ASimProcessEventLogs\n | where EventProduct == 'Carbon Black Cloud' and EventVendor == 'VMWare'\n| take 10"
      },
      {
        "description": "Get a sample of CarbonBlack ASimFile Event logs",
        "query": "ASimFileEventLogs\n | where EventProduct == 'Carbon Black Cloud' and EventVendor == 'VMWare'\n| take 10"
      },
      {
        "description": "Get a sample of CarbonBlack ASimRegistry Event logs",
        "query": "ASimRegistryEventLogs\n | where EventProduct == 'Carbon Black Cloud' and EventVendor == 'VMWare'\n| take 10"
      },
      {
        "description": "Get a sample of CarbonBlack ASimAuthentication Event logs",
        "query": "ASimAuthenticationEventLogs\n | where EventProduct == 'Carbon Black Cloud' and EventVendor == 'VMWare'\n| take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "CarbonBlack_Alerts_CL",
        "lastDataReceivedQuery": "CarbonBlack_Alerts_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CarbonBlack_Watchlist_CL",
        "lastDataReceivedQuery": "CarbonBlack_Watchlist_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ASimNetworkSessionLogs",
        "lastDataReceivedQuery": "union ASimNetworkSessionLogs | where TimeGenerated > ago(12h) | where EventProduct == 'Carbon Black Cloud' and EventVendor == 'VMWare' | summarize Time = max(TimeGenerated)| where isnotempty(Time)"
      },
      {
        "name": "ASimProcessEventLogs",
        "lastDataReceivedQuery": "union ASimProcessEventLogs | where TimeGenerated > ago(12h) | where EventProduct == 'Carbon Black Cloud' and EventVendor == 'VMWare' | summarize Time = max(TimeGenerated)| where isnotempty(Time)"
      },
      {
        "name": "ASimFileEventLogs",
        "lastDataReceivedQuery": "union ASimFileEventLogs | where TimeGenerated > ago(12h) | where EventProduct == 'Carbon Black Cloud' and EventVendor == 'VMWare' | summarize Time = max(TimeGenerated)| where isnotempty(Time)"
      },
      {
        "name": "ASimAuthenticationEventLogs",
        "lastDataReceivedQuery": "ASimAuthenticationEventLogs\n  | where EventProduct == 'Carbon Black Cloud' and EventVendor == 'VMWare' |  where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ASimRegistryEventLogs",
        "lastDataReceivedQuery": "ASimRegistryEventLogs\n  | where EventProduct == 'Carbon Black Cloud' and EventVendor == 'VMWare' |  where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "CBSPollingIDAzureFunctions",
    "title": "Cyber Blind Spot Integration",
    "publisher": "CTM360",
    "descriptionMarkdown": "Through the API integration, you have the capability to retrieve all the issues related to your CBS organizations via a RESTful interface.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CBS log events",
        "baseQuery": "CBSLog_Azure_1_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "CBSLog_Azure_1_CL \n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "CBSLog_Azure_1_CL",
        "lastDataReceivedQuery": "CBSLog_Azure_1_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CBSLog_Azure_1_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to a 'CyberBlindSpot' to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the 'CyberBlindSpot' API**\n\nThe provider should provide or link to detailed steps to configure the 'CyberBlindSpot' API endpoint so that the Azure Function can authenticate to it successfully, get its authorization key or token, and pull the appliance's logs into Microsoft Sentinel."
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the 'CyberBlindSpot' connector, have the Workspace ID  and Workspace Primary Key (can be copied from the following), as well as the 'CyberBlindSpot' API authorization key(s) readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "",
        "description": "**Option 1 - Azure Resource Manager (ARM) Template**\n\nUse this method for automated deployment of the 'CyberBlindSpot' connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-CTM360-CBS-azuredeploy) [![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://aka.ms/sentinel-CTM360-CBS-azuredeploy-gov)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace ID**, **Workspace Key**, **API **, 'and/or Other required fields'. \n>Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the CTM360 CBS data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/create-first-function-vs-code-python) for Azure function development.\n\n1. Download the [Azure Function App](https://raw.githubusercontent.com/CTM360-Integrations/Azure-Sentinel/ctm360-HV-CBS-azurefunctionapp/Solutions/CTM360/Data%20Connectors/CBS/AzureFunctionCTM360_CBS.zip) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. CTIXYZ).\n\n\te. **Select a runtime:** Choose Python 3.11.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive):  \n\t\tCTM360AccountID\n\t\tWorkspaceID\n\t\tWorkspaceKey\n\t\tCTM360Key\n\t\tFUNCTION_NAME\n\t\tlogAnalyticsUri  - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n3. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "CEF",
    "title": "Common Event Format (CEF)",
    "publisher": "Any",
    "descriptionMarkdown": "Common Event Format (CEF) is an industry standard format on top of Syslog messages, used by many security vendors to allow event interoperability among different platforms. By connecting your CEF logs to Microsoft Sentinel, you can take advantage of search & correlation, alerting, and threat intelligence enrichment for each log. For more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2223902&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CommonSecurityLog",
        "baseQuery": "\nCommonSecurityLog \n| where DeviceVendor !in (\"Cisco\",\"Check Point\",\"Palo Alto Networks\",\"Fortinet\",\"F5\",\"Barracuda\",\"ExtraHop\",\"OneIdentity\",\"Zscaler\", \"ForgeRock Inc\", \"Cyber-Ark\", \"illusive\", \"Vectra Networks\", \"Citrix\", \"Darktrace\", \"Akamai\", \"Aruba Networks\", \"CrowdStrike\", \"Symantec\", \"Claroty\", \"Contrast Security\", \"Delinea Software\", \"Thycotic Software\", \"FireEye\", \"Forcepoint CSG\", \"Forcepoint\", \"Forcepoint CASB\", \"iboss\", \"Illumio\", \"Imperva Inc.\", \"Infoblox\", \"Morphisec\", \"Netwrix\", \"Nozomi\", \"Onapsis\", \"OSSEC\", \"PingFederate\", \"RidgeSecurity\", \"SonicWall\", \"Trend Micro\", \"vArmour\", \"Votiro\")\n"
      }
    ],
    "sampleQueries": [
      {
        "query": "\nCommonSecurityLog \n| where DeviceVendor !in (\"Cisco\",\"Check Point\",\"Palo Alto Networks\",\"Fortinet\",\"F5\",\"Barracuda\",\"ExtraHop\",\"OneIdentity\",\"Zscaler\", \"ForgeRock Inc\", \"Cyber-Ark\", \"illusive\", \"Vectra Networks\", \"Citrix\", \"Darktrace\", \"Akamai\", \"Aruba Networks\", \"CrowdStrike\", \"Symantec\", \"Claroty\", \"Contrast Security\", \"Delinea Software\", \"Thycotic Software\", \"FireEye\", \"Forcepoint CSG\", \"Forcepoint\", \"Forcepoint CASB\", \"iboss\", \"Illumio\", \"Imperva Inc.\", \"Infoblox\", \"Morphisec\", \"Netwrix\", \"Nozomi\", \"Onapsis\", \"OSSEC\", \"PingFederate\", \"RidgeSecurity\", \"SonicWall\", \"Trend Micro\", \"vArmour\")\n\n            | sort by TimeGenerated"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog",
        "lastDataReceivedQuery": "\nCommonSecurityLog \n| where DeviceVendor !in (\"Cisco\",\"Check Point\",\"Palo Alto Networks\",\"Fortinet\",\"F5\",\"Barracuda\",\"ExtraHop\",\"OneIdentity\",\"Zscaler\", \"ForgeRock Inc\", \"Cyber-Ark\", \"illusive\", \"Vectra Networks\", \"Citrix\", \"Darktrace\", \"Akamai\", \"Aruba Networks\", \"CrowdStrike\", \"Symantec\", \"Claroty\", \"Contrast Security\", \"Delinea Software\", \"Thycotic Software\", \"FireEye\", \"Forcepoint CSG\", \"Forcepoint\", \"Forcepoint CASB\", \"iboss\", \"Illumio\", \"Imperva Inc.\", \"Infoblox\", \"Morphisec\", \"Netwrix\", \"Nozomi\", \"Onapsis\", \"OSSEC\", \"PingFederate\", \"RidgeSecurity\", \"SonicWall\", \"Trend Micro\", \"vArmour\", \"Votiro\")\n\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "\nCommonSecurityLog \n| where DeviceVendor !in (\"Cisco\",\"Check Point\",\"Palo Alto Networks\",\"Fortinet\",\"F5\",\"Barracuda\",\"ExtraHop\",\"OneIdentity\",\"Zscaler\", \"ForgeRock Inc\", \"Cyber-Ark\", \"illusive\", \"Vectra Networks\", \"Citrix\", \"Darktrace\", \"Akamai\", \"Aruba Networks\", \"CrowdStrike\", \"Symantec\", \"Claroty\", \"Contrast Security\", \"Delinea Software\", \"Thycotic Software\", \"FireEye\", \"Forcepoint CSG\", \"Forcepoint\", \"Forcepoint CASB\", \"iboss\", \"Illumio\", \"Imperva Inc.\", \"Infoblox\", \"Morphisec\", \"Netwrix\", \"Nozomi\", \"Onapsis\", \"OSSEC\", \"PingFederate\", \"RidgeSecurity\", \"SonicWall\", \"Trend Micro\", \"vArmour\", \"Votiro\")\n\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(3d)"
        ]
      }
    ],
    "availability": {
      "status": 1
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python --version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Common Event Format (CEF) logs to Syslog agent",
        "description": "Set your security solution to send Syslog messages in CEF format to the proxy machine. Make sure you to send the logs to port 514 TCP on the machines IP address."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python --version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "CefAma",
    "title": "Common Event Format (CEF) via AMA",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Common Event Format (CEF) is an industry standard format on top of Syslog messages, used by many security vendors to allow event interoperability among different platforms. By connecting your CEF logs to Microsoft Sentinel, you can take advantage of search & correlation, alerting, and threat intelligence enrichment for each log. For more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2223547&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CommonSecurityLog",
        "baseQuery": "CommonSecurityLog"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "CommonSecurityLog\n            | sort by TimeGenerated"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "CEFAMA",
        "value": null
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog",
        "lastDataReceivedQuery": "CommonSecurityLog\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces/datasources",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace data sources",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Enable data collection rule",
        "description": ">  CEF Events logs are collected only from **Linux** agents.",
        "instructions": [
          {
            "type": "CefAma"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenCreateDataCollectionRule",
              "dataCollectionRuleType": 3
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "Run the following command to install and apply the CEF collector:",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId",
                "PrimaryKey"
              ],
              "label": "",
              "value": "sudo wget -O Forwarder_AMA_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Forwarder_AMA_installer.py&&sudo python Forwarder_AMA_installer.py"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ]
  },
  {
    "id": "CheckPointCyberintAlerts",
    "title": "Check Point Cyberint Alerts Connector (via Codeless Connector Platform)",
    "publisher": "Checkpoint Cyberint",
    "descriptionMarkdown": "Cyberint, a Check Point company, provides a Microsoft Sentinel integration to streamline critical Alerts and bring enriched threat intelligence from the Infinity External Risk Management solution into Microsoft Sentinel. This simplifies the process of tracking the status of tickets with automatic sync updates across systems. Using this new integration for Microsoft Sentinel, existing Cyberint and Microsoft Sentinel customers can easily pull logs based on Cyberint's findings into Microsoft Sentinel platform.",
    "graphQueries": [
      {
        "metricName": "Alerts received",
        "legend": "My data connector alerts",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "All alert logs",
        "query": "{{graphQueriesTableName}} \n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}} \n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": null,
    "metadata": null
  },
  {
    "id": "CheckPointCyberintIOC",
    "title": "Check Point Cyberint IOC Connector",
    "publisher": "Checkpoint Cyberint",
    "descriptionMarkdown": "This is data connector for Check Point Cyberint IOC.",
    "graphQueries": [
      {
        "metricName": "IOC received",
        "legend": "My data connector IOC",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "All IOC logs",
        "query": "{{graphQueriesTableName}} \n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}} \n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": null,
    "metadata": null
  },
  {
    "id": "CiscoACI",
    "title": "[Deprecated] Cisco Application Centric Infrastructure",
    "publisher": "Cisco",
    "descriptionMarkdown": "[Cisco Application Centric Infrastructure (ACI)](https://www.cisco.com/c/en/us/solutions/collateral/data-center-virtualization/application-centric-infrastructure/solution-overview-c22-741487.html) data connector provides the capability to ingest [Cisco ACI logs](https://www.cisco.com/c/en/us/td/docs/switches/datacenter/aci/apic/sw/all/syslog/guide/b_ACI_System_Messages_Guide/m-aci-system-messages-reference.html) into Microsoft Sentinel.",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected [**CiscoACIEvent**](https://aka.ms/sentinel-CiscoACI-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CiscoACIEvent",
        "baseQuery": "CiscoACIEvent"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Resources (DstResourceId)",
        "query": "CiscoACIEvent\n | where notempty(DstResourceId)\n | summarize count() by DstResourceId\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog (CiscoACIEvent)",
        "lastDataReceivedQuery": "CiscoACIEvent\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CiscoACIEvent\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "write permission is required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key)",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**CiscoACIEvent**](https://aka.ms/sentinel-CiscoACI-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "",
        "description": ">**NOTE:**  This data connector has been developed using Cisco ACI Release 1.x",
        "instructions": []
      },
      {
        "title": "1. Configure Cisco ACI system sending logs via Syslog to remote server where you will install the agent.",
        "description": "[Follow these steps](https://www.cisco.com/c/en/us/td/docs/switches/datacenter/aci/apic/sw/1-x/basic-config/b_ACI_Config_Guide/b_ACI_Config_Guide_chapter_010.html#d2933e4611a1635) to configure Syslog Destination, Destination Group, and Syslog Source."
      },
      {
        "title": "2. Install and onboard the agent for Linux or Windows",
        "description": "Install the agent on the Server to which the logs will be forwarded.\n\n> Logs on Linux or Windows servers are collected by **Linux** or **Windows** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Linux agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Windows agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Windows Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Windows Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "3. Check logs in Microsoft Sentinel",
        "description": "Open Log Analytics to check if the logs are received using the Syslog schema.\n\n>**NOTE:** It may take up to 15 minutes before new logs will appear in Syslog table.",
        "instructions": []
      }
    ]
  },
  {
    "id": "CiscoASA",
    "title": "Cisco ASA via Legacy Agent",
    "publisher": "Cisco",
    "descriptionMarkdown": "The Cisco ASA firewall connector allows you to easily connect your Cisco ASA logs with Microsoft Sentinel, to view dashboards, create custom alerts, and improve investigation. This gives you more insight into your organization's network and improves your security operation capabilities.",
    "logo": "CiscoLogo.svg",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Cisco",
        "baseQuery": "\nCommonSecurityLog \n| where DeviceVendor =~ \"Cisco\"\n| where DeviceProduct == \"ASA\"\n"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "\nCommonSecurityLog \n| where DeviceVendor =~ \"Cisco\"\n| where DeviceProduct == \"ASA\"\n\n            | sort by TimeGenerated"
      },
      {
        "description": "Deny device actions",
        "query": "\nCommonSecurityLog \n| where DeviceVendor =~ \"Cisco\"\n| where DeviceProduct == \"ASA\"\n\n            | where SimplifiedDeviceAction == \"Deny\"\n            | sort by TimeGenerated"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "\nCommonSecurityLog \n| where DeviceVendor =~ \"Cisco\"\n| where DeviceProduct == \"ASA\"\n\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(3d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (Cisco)",
        "lastDataReceivedQuery": "\nCommonSecurityLog \n| where DeviceVendor =~ \"Cisco\"\n| where DeviceProduct == \"ASA\"\n\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 2,
      "isPreview": false,
      "featureFlag": {
        "feature": "CiscoASAConnector",
        "featureStates": {
          "1": 2,
          "2": 2,
          "3": 2,
          "4": 2,
          "5": 2,
          "6": 1,
          "7": 1
        }
      }
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python --version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Cisco ASA logs to Syslog agent",
        "description": "Configure Cisco ASA to forward Syslog messages in CEF format to your Microsoft Sentinel workspace via the Syslog agent.\n\nGo to[Send Syslog messages to an external Syslog server](https://aka.ms/asi-syslog-cisco-forwarding), and follow the instructions to set up the connection. Use these parameters when prompted:\n\n1.  Set \"port\" to 514.\n2.  Set \"syslog_ip\" to the IP address of the Syslog agent.\n\n\n[Learn more >](https://aka.ms/CEFCisco)"
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python --version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "31e95c16-9972-4afe-9697-05b9f40f2a58",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Cisco Systems"
      },
      "support": {
        "name": "Cisco Systems",
        "link": "https://www.cisco.com/c/en/us/support/index.html",
        "tier": "developer"
      }
    }
  },
  {
    "id": "CiscoAsaAma",
    "title": "Cisco ASA/FTD via AMA",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The Cisco ASA firewall connector allows you to easily connect your Cisco ASA logs with Microsoft Sentinel, to view dashboards, create custom alerts, and improve investigation. This gives you more insight into your organization's network and improves your security operation capabilities.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CommonSecurityLog",
        "baseQuery": "CommonSecurityLog\n| where DeviceVendor == \"Cisco\"\n| where DeviceProduct in (\"ASA\", \"FTD\")\n| extend ingestion_time = bin(TimeGenerated, 1m)\n| join kind=inner (Heartbeat \n| where Category == \"Azure Monitor Agent\" \n| project TimeGenerated, _ResourceId\n| summarize by _ResourceId, ingestion_time = bin(TimeGenerated, 1m)) on _ResourceId, ingestion_time\n| project-away  _ResourceId1, ingestion_time, ingestion_time1"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"Cisco\"\n| where DeviceProduct in (\"ASA\", \"FTD\")\n| extend ingestion_time = bin(TimeGenerated, 1m)\n| join kind=inner (Heartbeat \n| where Category == \"Azure Monitor Agent\" \n| project TimeGenerated, _ResourceId\n| summarize by _ResourceId, ingestion_time = bin(TimeGenerated, 1m)) on _ResourceId, ingestion_time\n| project-away  _ResourceId1, ingestion_time, ingestion_time1 \n            | sort by TimeGenerated"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "CiscoAsaAMA"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog",
        "lastDataReceivedQuery": "CommonSecurityLog\n| where DeviceVendor == \"Cisco\"\n| where DeviceProduct in (\"ASA\", \"FTD\")\n| extend ingestion_time = bin(TimeGenerated, 1m)\n| join kind=inner (Heartbeat \n| where Category == \"Azure Monitor Agent\" \n| project TimeGenerated, _ResourceId\n| summarize by _ResourceId, ingestion_time = bin(TimeGenerated, 1m)) on _ResourceId, ingestion_time\n| project-away  _ResourceId1, ingestion_time, ingestion_time1 \n             | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces/datasources",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace data sources",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Enable data collection rule",
        "description": "> Cisco ASA/FTD event logs are collected only from **Linux** agents.",
        "instructions": [
          {
            "type": "CiscoAsaAma"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenCreateDataCollectionRule",
              "dataCollectionRuleType": 4
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "Run the following command to install and apply the Cisco ASA/FTD collector:",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId",
                "PrimaryKey"
              ],
              "label": "",
              "value": "sudo wget -O Forwarder_AMA_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Forwarder_AMA_installer.py&&sudo python Forwarder_AMA_installer.py"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ]
  },
  {
    "id": "CiscoDuoSecurity",
    "title": "Cisco Duo Security",
    "publisher": "Cisco",
    "descriptionMarkdown": "The Cisco Duo Security data connector provides the capability to ingest [authentication logs](https://duo.com/docs/adminapi#authentication-logs), [administrator logs](https://duo.com/docs/adminapi#administrator-logs), [telephony logs](https://duo.com/docs/adminapi#telephony-logs), [offline enrollment logs](https://duo.com/docs/adminapi#offline-enrollment-logs) and [Trust Monitor events](https://duo.com/docs/adminapi#trust-monitor) into Microsoft Sentinel using the Cisco Duo Admin API. Refer to [API documentation](https://duo.com/docs/adminapi) for more information.",
    "additionalRequirementBanner": ">This data connector depends on a parser based on a Kusto Function to work as expected [**CiscoDuo**](https://aka.ms/sentinel-CiscoDuoSecurity-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Cisco Duo logs",
        "legend": "CiscoDuo_CL",
        "baseQuery": "CiscoDuo_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Cisco Duo logs",
        "query": "CiscoDuo_CL\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "CiscoDuo_CL",
        "lastDataReceivedQuery": "CiscoDuo_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CiscoDuo_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Cisco Duo API credentials",
          "description": "Cisco Duo API credentials with permission *Grant read log* is required for Cisco Duo API. See the [documentation](https://duo.com/docs/adminapi#first-steps) to learn more about creating Cisco Duo API credentials."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Cisco Duo API to pull logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**CiscoDuo**](https://aka.ms/sentinel-CiscoDuoSecurity-parser) which is deployed with the Microsoft Sentinel Solution."
      },
      {
        "title": "",
        "description": "**STEP 1 - Obtaining Cisco Duo Admin API credentials**\n\n1. Follow [the instructions](https://duo.com/docs/adminapi#first-steps) to obtain **integration key**, **secret key**, and **API hostname**. Use **Grant read log** permission in the 4th step of [the instructions](https://duo.com/docs/adminapi#first-steps)."
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following), as well as Azure Blob Storage connection string and container name, readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the data connector using an ARM Template.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-CiscoDuoSecurity-azuredeploy) [![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://aka.ms/sentinel-CiscoDuoSecurity-azuredeploy-gov)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Cisco Duo Integration Key**, **Cisco Duo Secret Key**, **Cisco Duo API Hostname**, **Cisco Duo Log Types**, **Microsoft Sentinel Workspace Id**, **Microsoft Sentinel Shared Key**\n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**.\n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the data connector manually with Azure Functions (Deployment via Visual Studio Code).",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Step 1 - Deploy a Function App",
                  "description": "1. Download the [Azure Function App](https://aka.ms/sentinel-CiscoDuoSecurity-functionapp) file. Extract archive to your local development computer.\n2. Follow the [function app manual deployment instructions](https://github.com/Azure/Azure-Sentinel/blob/master/DataConnectors/AzureFunctionsManualDeployment.md#function-app-manual-deployment-instructions) to deploy the Azure Functions app using VSCode.\n3. After successful deployment of the function app, follow next steps for configuring it."
                },
                {
                  "title": "Step 2 - Configure the Function App",
                  "description": "1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tCISCO_DUO_INTEGRATION_KEY\n\t\tCISCO_DUO_SECRET_KEY\n\t\tCISCO_DUO_API_HOSTNAME\n\t\tCISCO_DUO_LOG_TYPES\n\t\tWORKSPACE_ID\n\t\tSHARED_KEY\n\t\tlogAnalyticsUri (Optional)\n - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://WORKSPACE_ID.ods.opinsights.azure.us`. \n4. Once all application settings have been entered, click **Save**."
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "CiscoETD",
    "title": "Cisco ETD",
    "publisher": "Cisco",
    "descriptionMarkdown": "The connector fetches data from ETD api for threat analysis",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CiscoETD_CL",
        "baseQuery": "CiscoETD_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Incidents aggregated over a period on verdict type",
        "query": "CiscoETD_CL | summarize ThreatCount = count() by verdict_category_s, TimeBin = bin(TimeGenerated, 1h) | project TimeBin, verdict_category_s, ThreatCount | render columnchart"
      }
    ],
    "dataTypes": [
      {
        "name": "CiscoETD_CL",
        "lastDataReceivedQuery": "CiscoETD_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CiscoETD_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Email Threat Defense API, API key, Client ID and Secret",
          "description": "Ensure you have the API key, Client ID and Secret key."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the ETD API to pull its logs into Microsoft Sentinel."
      },
      {
        "title": "",
        "description": "**Follow the deployment steps to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the ETD data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following).\n",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the Cisco ETD data connector using an ARM Template.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-CiscoETD-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Region**. \n3. Enter the **WorkspaceID**, **SharedKey**, **ClientID**, **ClientSecret**, **ApiKey**, **Verdicts**, **ETD Region**\n4. Click **Create** to deploy."
      }
    ],
    "metadata": {
      "id": "CiscoETD_connector",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "ETD API",
        "name": "ETD API"
      },
      "author": {
        "name": "Cisco"
      },
      "support": {
        "tier": "Developer Support",
        "name": "Cisco"
      }
    }
  },
  {
    "id": "CiscoFirepowerEStreamer",
    "title": "[Deprecated] Cisco Firepower eStreamer via Legacy Agent",
    "publisher": "Cisco",
    "descriptionMarkdown": "eStreamer is a Client Server API designed for the Cisco Firepower NGFW Solution. The eStreamer client requests detailed event data on behalf of the SIEM or logging solution in the Common Event Format (CEF).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CiscoFirepowerEstreamerCEF",
        "baseQuery": "CommonSecurityLog\n| where DeviceVendor == \"Cisco\"\n| where DeviceProduct == \"Firepower\""
      }
    ],
    "sampleQueries": [
      {
        "description": "Firewall Blocked Events",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"Cisco\"\n| where DeviceProduct == \"Firepower\" | where DeviceAction != \"Allow\""
      },
      {
        "description": "File Malware Events",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"Cisco\"\n| where DeviceProduct == \"Firepower\" | where Activity == \"File Malware Event\""
      },
      {
        "description": "Outbound Web Traffic Port 80",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"Cisco\"\n| where DeviceProduct == \"Firepower\" | where DestinationPort == \"80\""
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (CiscoFirepowerEstreamerCEF)",
        "lastDataReceivedQuery": "CommonSecurityLog\n| where DeviceVendor == \"Cisco\"\n| where DeviceProduct == \"Firepower\"\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n| where DeviceVendor == \"Cisco\"\n| where DeviceProduct == \"Firepower\"\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 25226 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Install the Firepower eNcore client",
        "description": "Install and configure the Firepower eNcore eStreamer client, for more details see full install [guide](https://www.cisco.com/c/en/us/td/docs/security/firepower/670/api/eStreamer_enCore/eStreamereNcoreSentinelOperationsGuide_409.html)",
        "innerSteps": [
          {
            "title": "2.1 Download the Firepower Connector from github",
            "description": "Download the latest version of the Firepower eNcore connector for Microsoft Sentinel [here](https://github.com/CiscoSecurity/fp-05-microsoft-sentinel-connector).  If you plan on using python3 use the [python3 eStreamer connector](https://github.com/CiscoSecurity/fp-05-microsoft-sentinel-connector/tree/python3)"
          },
          {
            "title": "2.2 Create a pkcs12 file using the Azure/VM Ip Address",
            "description": "Create a pkcs12 certificate using the public IP of the VM instance in Firepower under System->Integration->eStreamer, for more information please see install [guide](https://www.cisco.com/c/en/us/td/docs/security/firepower/670/api/eStreamer_enCore/eStreamereNcoreSentinelOperationsGuide_409.html#_Toc527049443)"
          },
          {
            "title": "2.3  Test Connectivity between the Azure/VM Client and the FMC",
            "description": "Copy the pkcs12 file from the FMC to the Azure/VM instance and run the test utility (./encore.sh test) to ensure a connection can be established, for more details please see the setup [guide](https://www.cisco.com/c/en/us/td/docs/security/firepower/670/api/eStreamer_enCore/eStreamereNcoreSentinelOperationsGuide_409.html#_Toc527049430)"
          },
          {
            "title": "2.4 Configure encore to stream data to the agent",
            "description": "Configure encore to stream data via TCP to the Microsoft Agent, this should be enabled by default, however, additional ports and streaming protocols can configured depending on your network security posture, it is also possible to save the data to the file system, for more information please see [Configure Encore](https://www.cisco.com/c/en/us/td/docs/security/firepower/670/api/eStreamer_enCore/eStreamereNcoreSentinelOperationsGuide_409.html#_Toc527049433)"
          }
        ]
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "CiscoFirepowerEStreamerAma",
    "title": "[Deprecated] Cisco Firepower eStreamer via AMA",
    "publisher": "Cisco",
    "descriptionMarkdown": "eStreamer is a Client Server API designed for the Cisco Firepower NGFW Solution. The eStreamer client requests detailed event data on behalf of the SIEM or logging solution in the Common Event Format (CEF).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CiscoFirepowerEstreamerCEF",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Cisco'\n |where DeviceProduct =~ 'Firepower'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "Firewall Blocked Events",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"Cisco\"\n| where DeviceProduct == \"Firepower\" | where DeviceAction != \"Allow\""
      },
      {
        "description": "File Malware Events",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"Cisco\"\n| where DeviceProduct == \"Firepower\" | where Activity == \"File Malware Event\""
      },
      {
        "description": "Outbound Web Traffic Port 80",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"Cisco\"\n| where DeviceProduct == \"Firepower\" | where DestinationPort == \"80\""
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (CiscoFirepowerEstreamerCEF)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Cisco'\n |where DeviceProduct =~ 'Firepower'\n |where DeviceProduct =~ '\"Firepower'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'Cisco'\n |where DeviceProduct =~ 'Firepower'\n |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine",
                  "instructions": []
                },
                {
                  "title": "Step B. Install the Firepower eNcore client",
                  "description": "Install and configure the Firepower eNcore eStreamer client, for more details see full install [guide](https://www.cisco.com/c/en/us/td/docs/security/firepower/670/api/eStreamer_enCore/eStreamereNcoreSentinelOperationsGuide_409.html)",
                  "innerSteps": [
                    {
                      "title": "1. Download the Firepower Connector from github",
                      "description": "Download the latest version of the Firepower eNcore connector for Microsoft Sentinel [here](https://github.com/CiscoSecurity/fp-05-microsoft-sentinel-connector).  If you plan on using python3 use the [python3 eStreamer connector](https://github.com/CiscoSecurity/fp-05-microsoft-sentinel-connector/tree/python3)"
                    },
                    {
                      "title": "2. Create a pkcs12 file using the Azure/VM Ip Address",
                      "description": "Create a pkcs12 certificate using the public IP of the VM instance in Firepower under System->Integration->eStreamer, for more information please see install [guide](https://www.cisco.com/c/en/us/td/docs/security/firepower/670/api/eStreamer_enCore/eStreamereNcoreSentinelOperationsGuide_409.html#_Toc527049443)"
                    },
                    {
                      "title": "3.  Test Connectivity between the Azure/VM Client and the FMC",
                      "description": "Copy the pkcs12 file from the FMC to the Azure/VM instance and run the test utility (./encore.sh test) to ensure a connection can be established, for more details please see the setup [guide](https://www.cisco.com/c/en/us/td/docs/security/firepower/670/api/eStreamer_enCore/eStreamereNcoreSentinelOperationsGuide_409.html#_Toc527049430)"
                    },
                    {
                      "title": "4. Configure encore to stream data to the agent",
                      "description": "Configure encore to stream data via TCP to the Microsoft Agent, this should be enabled by default, however, additional ports and streaming protocols can configured depending on your network security posture, it is also possible to save the data to the file system, for more information please see [Configure Encore](https://www.cisco.com/c/en/us/td/docs/security/firepower/670/api/eStreamer_enCore/eStreamereNcoreSentinelOperationsGuide_409.html#_Toc527049433)"
                    }
                  ]
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "CiscoISE",
    "title": "[Deprecated] Cisco Identity Services Engine",
    "publisher": "Cisco",
    "descriptionMarkdown": "The Cisco Identity Services Engine (ISE) data connector provides the capability to ingest [Cisco ISE](https://www.cisco.com/c/en/us/products/security/identity-services-engine/index.html) events into Microsoft Sentinel. It helps you gain visibility into what is happening in your network, such as who is connected, which applications are installed and running, and much more. Refer to [Cisco ISE logging mechanism documentation](https://www.cisco.com/c/en/us/td/docs/security/ise/2-7/admin_guide/b_ise_27_admin_guide/b_ISE_admin_27_maintain_monitor.html#reference_BAFBA5FA046A45938810A5DF04C00591) for more information.",
    "additionalRequirementBanner": "This data connector depends on a parser based on Kusto Function to work as expected. Follow the steps to use this Kusto Function alias **CiscoISEEvent** in queries and workbooks. [Follow steps to get this Kusto Function>](https://aka.ms/sentinel-ciscoise-parser)",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CiscoISE",
        "baseQuery": "CiscoISEEvent"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Reporting Devices",
        "query": "CiscoISEEvent\n | summarize count() by DvcHostname\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog(CiscoISE)",
        "lastDataReceivedQuery": "CiscoISEEvent\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CiscoISEEvent\n            | where TimeGenerated > ago(3d)\n    | take 1\n        | project IsConnected = true"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "write permission is required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected. [Follow these steps](https://aka.ms/sentinel-ciscoise-parser) to create the Kusto Functions alias, **CiscoISEEvent**",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux",
        "description": "Typically, you should install the agent on a different computer from the one on which the logs are generated.\n\n>  Syslog logs are collected only from **Linux** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Configure the facilities you want to collect and their severities.\n\n1.  Under workspace advanced settings **Configuration**, select **Data** and then **Syslog**.\n2.  Select **Apply below configuration to my machines** and select the facilities and severities.\n3.  Click **Save**.",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenSyslogSettings"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "3. Configure Cisco ISE Remote Syslog Collection Locations",
        "description": "[Follow these instructions](https://www.cisco.com/c/en/us/td/docs/security/ise/2-7/admin_guide/b_ise_27_admin_guide/b_ISE_admin_27_maintain_monitor.html#ID58) to configure remote syslog collection locations in your Cisco ISE deployment."
      }
    ]
  },
  {
    "id": "CiscoMeraki",
    "title": "[Deprecated] Cisco Meraki",
    "publisher": "Cisco",
    "descriptionMarkdown": "The [Cisco Meraki](https://meraki.cisco.com/) connector allows you to easily connect your Cisco Meraki (MX/MR/MS) logs with Microsoft Sentinel. This gives you more insight into your organization's network and improves your security operation capabilities.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CiscoMeraki",
        "baseQuery": "CiscoMeraki"
      }
    ],
    "sampleQueries": [
      {
        "description": "Total Events by Log Type",
        "query": "CiscoMeraki \n | summarize count() by LogType"
      },
      {
        "description": "Top 10 Blocked Connections",
        "query": "CiscoMeraki \n | where LogType == \"security_event\" \n | where Action == \"block\" \n | summarize count() by SrcIpAddr, DstIpAddr, Action, Disposition \n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "CiscoMeraki",
        "lastDataReceivedQuery": "CiscoMeraki \n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CiscoMeraki \n      | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "write permission is required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "Cisco Meraki",
          "description": "must be configured to export logs via Syslog"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias CiscoMeraki and load the function code or click [here](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/CiscoMeraki/Parsers/CiscoMeraki.txt). The function usually takes 10-15 minutes to activate after solution installation/update.",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux",
        "description": "Typically, you should install the agent on a different computer from the one on which the logs are generated.\n\n>  Syslog logs are collected only from **Linux** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Follow the configuration steps below to get Cisco Meraki device logs into Microsoft Sentinel. Refer to the [Azure Monitor Documentation](https://docs.microsoft.com/azure/azure-monitor/agents/data-sources-json) for more details on these steps.\n For Cisco Meraki logs, we have issues while parsing the data by OMS agent data using default settings. \nSo we advice to capture the logs into custom table **meraki_CL** using below instructions. \n1. Login to the server where you have installed OMS agent.\n2. Download config file [meraki.conf](https://aka.ms/sentinel-ciscomerakioms-conf) \n\t\twget -v https://aka.ms/sentinel-ciscomerakioms-conf -O meraki.conf \n3. Copy meraki.conf to the /etc/opt/microsoft/omsagent/**workspace_id**/conf/omsagent.d/ folder. \n\t\tcp meraki.conf /etc/opt/microsoft/omsagent/<<workspace_id>>/conf/omsagent.d/\n4. Edit meraki.conf as follows:\n\n\t a. meraki.conf uses the port **22033** by default. Ensure this port is not being used by any other source on your server\n\n\t b. If you would like to change the default port for **meraki.conf** make sure that you dont use default Azure monitoring /log analytic agent ports I.e.(For example CEF uses TCP port **25226** or **25224**) \n\n\t c. replace **workspace_id** with real value of your Workspace ID (lines 14,15,16,19)\n5. Save changes and restart the Azure Log Analytics agent for Linux service with the following command:\n\t\tsudo /opt/microsoft/omsagent/bin/service_control restart\n6. Modify /etc/rsyslog.conf file - add below template preferably at the beginning / before directives section \n\t\t$template meraki,\"%timestamp% %hostname% %msg%\\n\" \n7. Create a custom conf file in /etc/rsyslog.d/ for example 10-meraki.conf and add following filter conditions.\n\n\t With an added statement you will need to create a filter which will specify the logs coming from the Cisco Meraki to be forwarded to the custom table.\n\n\t reference: [Filter Conditions  rsyslog 8.18.0.master documentation](https://rsyslog.readthedocs.io/en/latest/configuration/filters.html)\n\n\t Here is an example of filtering that can be defined, this is not complete and will require additional testing for each installation.\n\t\t if $rawmsg contains \"flows\" then @@127.0.0.1:22033;meraki\n\t\t & stop\n\t\t if $rawmsg contains \"firewall\" then @@127.0.0.1:22033;meraki\n\t\t & stop\n\t\t if $rawmsg contains \"urls\" then @@127.0.0.1:22033;meraki\n\t\t & stop\n\t\t if $rawmsg contains \"ids-alerts\" then @@127.0.0.1:22033;meraki\n\t\t & stop\n\t\t if $rawmsg contains \"events\" then @@127.0.0.1:22033;meraki\n\t\t & stop\n\t\t if $rawmsg contains \"ip_flow_start\" then @@127.0.0.1:22033;meraki\n\t\t & stop\n\t\t if $rawmsg contains \"ip_flow_end\" then @@127.0.0.1:22033;meraki\n\t\t & stop \n8. Restart rsyslog\n\t\t systemctl restart rsyslog",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "3. Configure and connect the Cisco Meraki device(s)",
        "description": "[Follow these instructions](https://documentation.meraki.com/General_Administration/Monitoring_and_Reporting/Meraki_Device_Reporting_-_Syslog%2C_SNMP_and_API) to configure the Cisco Meraki device(s) to forward syslog. Use the IP address or hostname for the Linux device with the Linux agent installed as the Destination IP address."
      }
    ]
  },
  {
    "id": "CiscoMerakiMultiRule",
    "title": "Cisco Meraki (using REST API)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The [Cisco Meraki](https://aka.ms/ciscomeraki) connector allows you to easily connect your Cisco Meraki organization events (Security events, Configuration Changes and API Requests) to Microsoft Sentinel. The data connector uses the [Cisco Meraki REST API](https://developer.cisco.com/meraki/api-v1/#!get-organization-appliance-security-events) to fetch logs and supports DCR-based [ingestion time transformations](https://docs.microsoft.com/azure/azure-monitor/logs/custom-logs-overview) that parses the received data and ingests into ASIM and custom tables in your Log Analytics workspace. This data connector benefits from capabilities such as DCR based ingestion-time filtering, data normalization.\n\n **Supported ASIM schema:** \n 1. Network Session \n 2. Web Session  \n 3. Audit Event",
    "graphQueries": [
      {
        "metricName": "Total IDS alerts received",
        "legend": "Get IDS Alerts",
        "baseQuery": "{{graphQueriesTableName}} | where EventProduct == \"Meraki\" and EventVendor == \"Cisco\""
      },
      {
        "metricName": "Total File Scanned events received",
        "legend": "Get File Scanned",
        "baseQuery": "ASimWebSessionLogs | where EventProduct == \"Meraki\" and EventVendor == \"Cisco\" and EventOriginalType == \"File Scanned\""
      },
      {
        "metricName": "Total API request events received",
        "legend": "Get API Request",
        "baseQuery": "ASimWebSessionLogs | where EventProduct == \"Meraki\" and EventVendor == \"Cisco\" and EventOriginalType == \"API Request\""
      },
      {
        "metricName": "Total Configuration Changes received",
        "legend": "Get Configuration Changes",
        "baseQuery": "ASimAuditEventLogs | where EventProduct == \"Meraki\" and EventVendor == \"Cisco\""
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of Cisco Meraki IDS Alerts",
        "query": "{{graphQueriesTableName}}\n | where EventProduct == \"Meraki\" and EventVendor == \"Cisco\"\n | take 10"
      },
      {
        "description": "Total Events by Event Type",
        "query": "union {{graphQueriesTableName}}, ASimWebSessionLogs, ASimAuditEventLogs\n | where EventProduct == \"Meraki\" and EventVendor == \"Cisco\"\n | summarize count() by EventOriginalType"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n       | where TimeGenerated > ago(7d)    | where EventProduct == \"Meraki\" and EventVendor == \"Cisco\"         | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ASimWebSessionLogs",
        "lastDataReceivedQuery": "ASimWebSessionLogs\n       | where TimeGenerated > ago(7d)    | where EventProduct == \"Meraki\" and EventVendor == \"Cisco\"                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ASimAuditEventLogs",
        "lastDataReceivedQuery": "ASimAuditEventLogs\n       | where TimeGenerated > ago(7d)    | where EventProduct == \"Meraki\" and EventVendor == \"Cisco\"                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "CiscoSDWAN",
    "title": "Cisco Software Defined WAN",
    "publisher": "Cisco",
    "descriptionMarkdown": "The Cisco Software Defined WAN(SD-WAN) data connector provides the capability to ingest [Cisco SD-WAN](https://www.cisco.com/c/en_in/solutions/enterprise-networks/sd-wan/index.html) Syslog and Netflow data into Microsoft Sentinel.",
    "additionalRequirementBanner": "These queries and workbooks are dependent on a parser based on Kusto to work as expected. Follow the steps to use this Kusto functions alias **CiscoSyslogUTD** in queries and workbooks [Follow steps to get this CiscoSyslogUTD Kusto functions>](https://aka.ms/sentinel-CiscoSyslogUTD-parser), **CiscoSyslogFW6LogSummary** in queries and workbooks [Follow steps to get this CiscoSyslogFW6LogSummary Kusto functions>](https://aka.ms/sentinel-CiscoSyslogFW6LogSummary-parser) and **CiscoSDWANNetflow** in queries and workbooks [Follow steps to get this CiscoSDWANNetflow Kusto functions>](https://aka.ms/sentinel-CiscoSDWANNetflow-parser).",
    "graphQueries": [
      {
        "metricName": "Total Syslog data received",
        "legend": "Syslog",
        "baseQuery": "Syslog"
      },
      {
        "metricName": "Total Netflow data received",
        "legend": "CiscoSDWANNetflow_CL",
        "baseQuery": "CiscoSDWANNetflow_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Syslog Events - All Syslog Events.",
        "query": "Syslog\n | sort by TimeGenerated desc"
      },
      {
        "description": "Cisco SD-WAN Netflow Events - All Netflow Events.",
        "query": "CiscoSDWANNetflow_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog",
        "lastDataReceivedQuery": "Syslog\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CiscoSDWANNetflow_CL",
        "lastDataReceivedQuery": "CiscoSDWANNetflow_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Syslog\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "CiscoSDWANNetflow_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "write permission is required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "description": "**To ingest Cisco SD-WAN Syslog and Netflow data into Microsoft Sentinel follow the steps below.**"
      },
      {
        "title": "1. Steps to ingest Syslog data to Microsoft sentinel",
        "description": "Azure Monitor Agent will be used to collect the syslog data into Microsoft sentinel. For that first need to create an azure arc server for the VM from which syslog data will be sent.\n"
      },
      {
        "title": "1.1 Steps to Add Azure Arc Server",
        "description": "1. In Azure portal, go to Servers - Azure Arc and click on Add.\n2. Select Generate Script under Add a single server section. A User can also generate scripts for Multiple Servers as well.\n3. Review the information on the Prerequisites page, then select Next.\n4. On the Resource details page, provide the subscription and resource group of the Microsoft Sentinel, Region, Operating system and Connectivity method. Then select Next.\n5. On the Tags page, review the default Physical location tags suggested and enter a value, or specify one or more Custom tags to support your standards. Then select Next\n6. Select Download to save the script file. \n7. Now that you have generated the script, the next step is to run it on the server that you want to onboard to Azure Arc. \n8. If you have Azure VM follow the steps mentioned in the [link](https://learn.microsoft.com/azure/azure-arc/servers/plan-evaluate-on-azure-virtual-machine) before running the script. \n9. Run the script by the following command: `./<ScriptName>.sh`\n10. After you install the agent and configure it to connect to Azure Arc-enabled servers, go to the Azure portal to verify that the server has successfully connected. View your machine in the Azure portal.\n> **Reference link:** [https://learn.microsoft.com/azure/azure-arc/servers/learn/quick-enable-hybrid-vm](https://learn.microsoft.com/azure/azure-arc/servers/learn/quick-enable-hybrid-vm)"
      },
      {
        "title": "1.2 Steps to Create Data Collection Rule (DCR)",
        "description": "1. In Azure Portal search for Monitor. Under Settings, select Data Collection Rules and Select Create.\n2. On the Basics panel, enter the Rule Name, Subscription, Resource group, Region and Platform Type.\n3. Select Next: Resources.\n4. Select Add resources.Use the filters to find the virtual machine that you&#39;ll use to collect logs.\n5. Select the virtual machine. Select Apply.\n6. Select Next: Collect and deliver.\n7. Select Add data source. For Data source type, select Linux syslog. \n8. For Minimum log level, leave the default values LOG_DEBUG.\n9. Select Next: Destination.\n10. Select Add destination and add Destination type, Subscription and Account or namespace.\n11. Select Add data source. Select Next: Review + create.\n12. Select Create. Wait for 20 minutes. In Microsoft Sentinel or Azure Monitor, verify that the Azure Monitor agent is running on your VM.\n> **Reference link:** [https://learn.microsoft.com/azure/sentinel/forward-syslog-monitor-agent](https://learn.microsoft.com/azure/sentinel/forward-syslog-monitor-agent)"
      },
      {
        "title": "2. Steps to ingest Netflow data to Microsoft sentinel",
        "description": "To Ingest Netflow data into Microsoft sentinel, Filebeat and Logstash needs to be installed and configured on the VM. After the configuration, vm will be able to receive netflow data on the configured port and that data will be ingested into the workspace of Microsoft sentinel.\n"
      },
      {
        "title": "2.1 Install filebeat and logstash",
        "description": "1. For the installation of filebeat and logstash using apt refer to this doc: \n 1. Filebeat: [https://www.elastic.co/guide/en/beats/filebeat/current/setup-repositories.html](https://www.elastic.co/guide/en/beats/filebeat/current/setup-repositories.html). \n 2. Logstash: [https://www.elastic.co/guide/en/logstash/current/installing-logstash.html](https://www.elastic.co/guide/en/logstash/current/installing-logstash.html). \n2. For the installation of filebeat and logstash for RedHat based Linux (yum) steps are as follows: \n 1. Filebeat: [https://www.elastic.co/guide/en/beats/filebeat/current/setup-repositories.html#_yum](https://www.elastic.co/guide/en/beats/filebeat/current/setup-repositories.html#_yum). \n 2. Logstash: [https://www.elastic.co/guide/en/logstash/current/installing-logstash.html#_yum](https://www.elastic.co/guide/en/logstash/current/installing-logstash.html#_yum)"
      },
      {
        "title": "2.2 Configure Filebeat to send events to Logstash",
        "description": "1. Edit filebeat.yml file: `vi /etc/filebeat/filebeat.yml` \n2. Comment out the Elasticsearch Output section. \n3. Uncomment Logstash Output section (Uncomment out only these two lines)-\n\t\toutput.logstash\n\t\thosts: [\"localhost:5044\"] \n3. In the Logstash Output section, if you want to send the data other than the default port i.e. 5044 port, then replace the port number in the hosts field. (Note: This port should be added in the conf file, while configuring logstash.) \n4. In the 'filebeat.inputs' section comment out existing configuration and add the following configuration: \n\t\t- type: netflow\n\t\t  max_message_size: 10KiB\n\t\t  host: \"0.0.0.0:2055\"\n\t\t  protocols: [ v5, v9, ipfix ]\n\t\t  expiration_timeout: 30m\n\t\t  queue_size: 8192\n\t\t  custom_definitions:\n\t\t  - /etc/filebeat/custom.yml\n\t\t  detect_sequence_reset: true\n\t\t  enabled: true \n6. In the Filebeat inputs section, if you want to receive the data other than the default port i.e. 2055 port, then replace the port number in the host field. \n7. Add the provided [custom.yml](https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Cisco%20SD-WAN/Data%20Connectors/custom.yml) file inside the /etc/filebeat/ directory. \n8. Open the filebeat input and output port in the firewall. \n 1. Run command: `firewall-cmd --zone=public --permanent --add-port=2055/udp` \n 2. Run command: `firewall-cmd --zone=public --permanent --add-port=5044/udp` \n> Note: if a custom port is added for filebeat input/output, then open that port in the firewall."
      },
      {
        "title": "2.3 Configure Logstash to send events to Microsoft Sentinel",
        "description": "1. Install the Azure Log Analytics plugin: \n 1. Run Command: `sudo /usr/share/logstash/bin/logstash-plugin install microsoft-logstash-output-azure-loganalytics` \n3. Store the Log Analytics workspace key in the Logstash key store. The workspace key can be found in Azure Portal under Log analytic workspace > Select workspace > Under Settings select Agent > Log Analytics agent instructions. \n4. Copy the Primary key and run the following commands: \n 1. `sudo /usr/share/logstash/bin/logstash-keystore --path.settings /etc/logstash create LogAnalyticsKey` \n 2. `sudo /usr/share/logstash/bin/logstash-keystore --path.settings /etc/logstash add LogAnalyticsKey` \n5. Create the configuration file /etc/logstash/cisco-netflow-to-sentinel.conf: \n\t\tinput {\n\t\t    beats {\n\t\t        port => <port_number> #(Enter output port number which has been configured during filebeat configuration i.e. filebeat.yml file .)\n\t\t     }\n\t\t}\n\t\toutput {\n\t\t    microsoft-logstash-output-azure-loganalytics {\n\t\t        workspace_id => \"<workspace_id>\"\n\t\t        workspace_key => \"${LogAnalyticsKey}\"\n\t\t        custom_log_table_name => \"CiscoSDWANNetflow\"\n\t\t    }\n\t\t} \n> Note: If table is not present in Microsoft sentinel, then it will create a new table in sentinel."
      },
      {
        "title": "2.4 Run Filebeat:",
        "description": "1. Open a terminal and run the command: \n> `systemctl start filebeat` \n2. This command will start running filebeat in the background. To see the logs stop the filebeat (`systemctl stop filebeat`) then run the following command: \n> `filebeat run -e`"
      },
      {
        "title": "2.5 Run Logstash:",
        "description": "1. In another terminal run the command: \n> `/usr/share/logstash/bin/logstash --path.settings /etc/logstash -f /etc/logstash/cisco-netflow-to-sentinel.conf &` \n2. This command will start running the logstash in the background. To see the logs of logstash kill the above process and run the following command : \n> `/usr/share/logstash/bin/logstash --path.settings /etc/logstash -f /etc/logstash/cisco-netflow-to-sentinel.conf`"
      }
    ]
  },
  {
    "id": "CiscoSecureEndpoint",
    "title": "[DEPRECATED] Cisco Secure Endpoint (AMP)",
    "publisher": "Cisco",
    "descriptionMarkdown": "The Cisco Secure Endpoint (formerly AMP for Endpoints) data connector provides the capability to ingest Cisco Secure Endpoint [audit logs](https://api-docs.amp.cisco.com/api_resources/AuditLog?api_host=api.amp.cisco.com&api_version=v1) and [events](https://api-docs.amp.cisco.com/api_actions/details?api_action=GET+%2Fv1%2Fevents&api_host=api.amp.cisco.com&api_resource=Event&api_version=v1) into Microsoft Sentinel.\n\n<p><span style='color:red; font-weight:bold;'>NOTE</span>: This data connector has been deprecated, consider moving to the CCF data connector available in the solution which replaces ingestion via the <a href='https://learn.microsoft.com/en-us/azure/azure-monitor/logs/custom-logs-migrate' style='color:#1890F1;'>deprecated HTTP Data Collector API</a>.</p>",
    "additionalRequirementBanner": ">This data connector depends on a parser based on a Kusto Function to work as expected [**CiscoSecureEndpoint**](https://aka.ms/sentinel-ciscosecureendpoint-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Cisco Secure Endpoint logs",
        "legend": "CiscoSecureEndpoint_CL",
        "baseQuery": "CiscoSecureEndpoint_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Cisco Secure Endpoint logs",
        "query": "CiscoSecureEndpoint_CL\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "CiscoSecureEndpoint_CL",
        "lastDataReceivedQuery": "CiscoSecureEndpoint_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CiscoSecureEndpoint_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Cisco Secure Endpoint API credentials",
          "description": "Cisco Secure Endpoint Client ID and API Key are required. [See the documentation to learn more about Cisco Secure Endpoint API](https://api-docs.amp.cisco.com/api_resources?api_host=api.amp.cisco.com&api_version=v1). [API domain](https://api-docs.amp.cisco.com) must be provided as well."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Cisco Secure Endpoint API to pull logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**CiscoSecureEndpoint**](https://aka.ms/sentinel-ciscosecureendpoint-parser) which is deployed with the Microsoft Sentinel Solution."
      },
      {
        "title": "",
        "description": "**STEP 1 - Obtaining Cisco Secure Endpoint API credentials**\n\n1. Follow the instructions in the [documentation](https://api-docs.amp.cisco.com/api_resources?api_host=api.amp.cisco.com&api_version=v1) to generate Client ID and API Key."
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following), as well as Azure Blob Storage connection string and container name, readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the data connector using an ARM Template.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-ciscosecureendpoint-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Cisco Secure Endpoint Api Host**, **Cisco Secure Endpoint Client Id**, **Cisco Secure Endpoint Api Key**, **Microsoft Sentinel Workspace Id**, **Microsoft Sentinel Shared Key**\n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**.\n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/create-first-function-vs-code-python) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-ciscosecureendpoint-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions.\n\n\te. **Select a runtime:** Choose Python 3.11.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tCISCO_SE_API_API_HOST\n\t\tCISCO_SE_API_CLIENT_ID\n\t\tCISCO_SE_API_KEY\n\t\tWORKSPACE_ID\n\t\tSHARED_KEY\n\t\tlogAnalyticsUri (Optional)\n - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://WORKSPACE_ID.ods.opinsights.azure.us`. \n4. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "CiscoSecureEndpointLogsCCPDefinition",
    "title": "Cisco Secure Endpoint (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The Cisco Secure Endpoint (formerly AMP for Endpoints) data connector provides the capability to ingest Cisco Secure Endpoint [audit logs](https://developer.cisco.com/docs/secure-endpoint/auditlog/) and [events](https://developer.cisco.com/docs/secure-endpoint/v1-api-reference-event/) into Microsoft Sentinel.",
    "graphQueries": [
      {
        "metricName": "Total audit logs received",
        "legend": "Cisco Secure Endpoint Audit logs",
        "baseQuery": "CiscoSecureEndpointAuditLogsV2_CL"
      },
      {
        "metricName": "Total events received",
        "legend": "Cisco Secure Endpoint Events",
        "baseQuery": "CiscoSecureEndpointEventsV2_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get a Sample of Cisco Secure Endpoint Audit Logs",
        "query": "CiscoSecureEndpointAuditLogsV2_CL\n | take 10"
      },
      {
        "description": "Get a Sample of Cisco Secure Endpoint Events",
        "query": "CiscoSecureEndpointEventsV2_CL\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "CiscoSecureEndpointAuditLogsV2_CL",
        "lastDataReceivedQuery": "CiscoSecureEndpointAuditLogsV2_CL\n | summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      },
      {
        "name": "CiscoSecureEndpointEventsV2_CL",
        "lastDataReceivedQuery": "CiscoSecureEndpointEventsV2_CL\n | summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "CiscoSEG",
    "title": "[Deprecated] Cisco Secure Email Gateway via Legacy Agent",
    "publisher": "Cisco",
    "descriptionMarkdown": "The [Cisco Secure Email Gateway (SEG)](https://www.cisco.com/c/en/us/products/security/email-security/index.html) data connector provides the capability to ingest [Cisco SEG Consolidated Event Logs](https://www.cisco.com/c/en/us/td/docs/security/esa/esa14-0/user_guide/b_ESA_Admin_Guide_14-0/b_ESA_Admin_Guide_12_1_chapter_0100111.html#con_1061902) into Microsoft Sentinel.",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected [**CiscoSEGEvent**](https://aka.ms/sentinel-CiscoSEG-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CiscoSEG",
        "baseQuery": "CiscoSEGEvent"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Senders",
        "query": "CiscoSEGEvent\n | where isnotempty(SrcUserName)\n    | summarize count() by SrcUserName\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (CiscoSEG)",
        "lastDataReceivedQuery": "CiscoSEGEvent\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CiscoSEGEvent\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(3d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**CiscoSEGEvent**](https://aka.ms/sentinel-CiscoSEG-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "",
        "description": ">**NOTE:** This data connector has been developed using AsyncOS 14.0 for Cisco Secure Email Gateway",
        "instructions": []
      },
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Common Event Format (CEF) logs to Syslog agent",
        "description": "Follow these steps to configure Cisco Secure Email Gateway to forward logs via syslog:\n\n2.1. Configure [Log Subscription](https://www.cisco.com/c/en/us/td/docs/security/esa/esa14-0/user_guide/b_ESA_Admin_Guide_14-0/b_ESA_Admin_Guide_12_1_chapter_0100111.html#con_1134718)\n\n>**NOTE:** Select **Consolidated Event Logs** in Log Type field."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "CiscoSEGAma",
    "title": "[Deprecated] Cisco Secure Email Gateway via AMA",
    "publisher": "Cisco",
    "descriptionMarkdown": "The [Cisco Secure Email Gateway (SEG)](https://www.cisco.com/c/en/us/products/security/email-security/index.html) data connector provides the capability to ingest [Cisco SEG Consolidated Event Logs](https://www.cisco.com/c/en/us/td/docs/security/esa/esa14-0/user_guide/b_ESA_Admin_Guide_14-0/b_ESA_Admin_Guide_12_1_chapter_0100111.html#con_1061902) into Microsoft Sentinel.",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected [**CiscoSEGEvent**](https://aka.ms/sentinel-CiscoSEG-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CiscoSEG",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Cisco'\n |where DeviceProduct =~ 'ESA_CONSOLIDATED_LOG_EVENT'\n |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Senders",
        "query": "CiscoSEGEvent\n | where isnotempty(SrcUserName)\n    | summarize count() by SrcUserName\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (CiscoSEG)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Cisco'\n |where DeviceProduct =~ 'ESA_CONSOLIDATED_LOG_EVENT'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'Cisco'\n |where DeviceProduct =~ 'ESA_CONSOLIDATED_LOG_EVENT'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(3d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**CiscoSEGEvent**](https://aka.ms/sentinel-CiscoSEG-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine",
                  "instructions": []
                },
                {
                  "title": "Step B. Forward Common Event Format (CEF) logs to Syslog agent",
                  "description": "Follow these steps to configure Cisco Secure Email Gateway to forward logs via syslog:\n\n Configure [Log Subscription](https://www.cisco.com/c/en/us/td/docs/security/esa/esa14-0/user_guide/b_ESA_Admin_Guide_14-0/b_ESA_Admin_Guide_12_1_chapter_0100111.html#con_1134718)\n\n>**NOTE:** Select **Consolidated Event Logs** in Log Type field.",
                  "instructions": []
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "2Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "CiscoUCS",
    "title": "[Deprecated] Cisco UCS",
    "publisher": "Cisco",
    "descriptionMarkdown": "The [Cisco Unified Computing System (UCS)](https://www.cisco.com/c/en/us/products/servers-unified-computing/index.html) connector allows you to easily connect your Cisco UCS logs with Microsoft Sentinel This gives you more insight into your organization's network and improves your security operation capabilities.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CiscoUCS",
        "baseQuery": "CiscoUCS"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Target User Names for Audit Events",
        "query": "CiscoUCS \n | where Mneumonic == \"AUDIT\" \n | summarize count() by DstUserName \n | top 10 by DstUserName"
      },
      {
        "description": "Top 10 Devices generating Audit Events",
        "query": "CiscoUCS \n | where Mneumonic == \"AUDIT\" \n | summarize count() by Computer \n | top 10 by Computer"
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog (CiscoUCS)",
        "lastDataReceivedQuery": "CiscoUCS \n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CiscoUCS \n      | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "write permission is required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "Cisco UCS",
          "description": "must be configured to export logs via Syslog"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias CiscoUCS and load the function code or click [here](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Cisco%20UCS/Parsers/CiscoUCS.yaml). The function usually takes 10-15 minutes to activate after solution installation/update.",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux",
        "description": "Typically, you should install the agent on a different computer from the one on which the logs are generated.\n\n>  Syslog logs are collected only from **Linux** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Configure the facilities you want to collect and their severities.\n 1. Under workspace advanced settings **Configuration**, select **Data** and then **Syslog**.\n 2. Select **Apply below configuration to my machines** and select the facilities and severities.\n 3.  Click **Save**.",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenSyslogSettings"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "3. Configure and connect the Cisco UCS",
        "description": "[Follow these instructions](https://www.cisco.com/c/en/us/support/docs/servers-unified-computing/ucs-manager/110265-setup-syslog-for-ucs.html#configsremotesyslog) to configure the Cisco UCS to forward syslog. Use the IP address or hostname for the Linux device with the Linux agent installed as the Destination IP address."
      }
    ]
  },
  {
    "id": "CiscoUmbrellaDataConnector",
    "title": "Cisco Cloud Security",
    "publisher": "Cisco",
    "descriptionMarkdown": "The Cisco Cloud Security solution for Microsoft Sentinel enables you to ingest [Cisco Secure Access](https://docs.sse.cisco.com/sse-user-guide/docs/welcome-cisco-secure-access) and [Cisco Umbrella](https://docs.umbrella.com/umbrella-user-guide/docs/getting-started) [logs](https://docs.sse.cisco.com/sse-user-guide/docs/manage-your-logs) stored in Amazon S3 into Microsoft Sentinel using the Amazon S3 REST API. Refer to [Cisco Cloud Security log management documentation](https://docs.umbrella.com/deployment-umbrella/docs/log-management) for more information.",
    "additionalRequirementBanner": "These queries and workbooks are dependent on a parser based on Kusto to work as expected. Follow the steps to use this Kusto functions alias **Cisco_Umbrella** in queries and workbooks. [Follow steps to get this Kusto functions>](https://aka.ms/sentinel-ciscoumbrella-function) ",
    "graphQueries": [
      {
        "metricName": "Cisco Cloud Security DNS Logs",
        "legend": "Cisco_Umbrella_dns_CL",
        "baseQuery": "Cisco_Umbrella_dns_CL"
      },
      {
        "metricName": "Cisco Cloud Security Proxy Logs",
        "legend": "Cisco_Umbrella_proxy_CL",
        "baseQuery": "Cisco_Umbrella_proxy_CL"
      },
      {
        "metricName": "Cisco Cloud Security IP Logs",
        "legend": "Cisco_Umbrella_ip_CL",
        "baseQuery": "Cisco_Umbrella_ip_CL"
      },
      {
        "metricName": "Cisco Cloud Security Cloud Firewall Logs",
        "legend": "Cisco_Umbrella_cloudfirewall_CL",
        "baseQuery": "Cisco_Umbrella_cloudfirewall_CL"
      },
      {
        "metricName": "Cisco Cloud Security Firewall Logs",
        "legend": "Cisco_Umbrella_firewall_CL",
        "baseQuery": "Cisco_Umbrella_firewall_CL"
      },
      {
        "metricName": "Cisco Cloud Security DLP Logs",
        "legend": "Cisco_Umbrella_dlp_CL",
        "baseQuery": "Cisco_Umbrella_dlp_CL"
      },
      {
        "metricName": "Cisco Cloud Security Cloud RAVPN Logs",
        "legend": "Cisco_Umbrella_ravpnlogs_CL",
        "baseQuery": "Cisco_Umbrella_ravpnlogs_CL"
      },
      {
        "metricName": "Cisco Cloud Security Audit Logs",
        "legend": "Cisco_Umbrella_audit_CL",
        "baseQuery": "Cisco_Umbrella_audit_CL"
      },
      {
        "metricName": "Cisco Cloud Security ZTNA Logs",
        "legend": "Cisco_Umbrella_ztna_CL",
        "baseQuery": "Cisco_Umbrella_ztna_CL"
      },
      {
        "metricName": "Cisco Cloud Security Intrusion Logs",
        "legend": "Cisco_Umbrella_intrusion_CL",
        "baseQuery": "Cisco_Umbrella_intrusion_CL"
      },
      {
        "metricName": "Cisco Cloud Security ZTA flow Logs",
        "legend": "Cisco_Umbrella_ztaflow_CL",
        "baseQuery": "Cisco_Umbrella_ztaflow_CL"
      },
      {
        "metricName": "Cisco Cloud Security File Event Logs",
        "legend": "Cisco_Umbrella_fileevent_CL",
        "baseQuery": "Cisco_Umbrella_fileevent_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Cisco Cloud Security Logs",
        "query": "Cisco_Umbrella\n| sort by TimeGenerated desc"
      },
      {
        "description": "Cisco Cloud Security DNS Logs",
        "query": "Cisco_Umbrella\n | where EventType == 'dnslogs'\n| sort by TimeGenerated desc"
      },
      {
        "description": "Cisco Cloud Security Proxy Logs",
        "query": "Cisco_Umbrella\n | where EventType == 'proxylogs'\n| sort by TimeGenerated desc"
      },
      {
        "description": "Cisco Cloud Security IP Logs",
        "query": "Cisco_Umbrella\n | where EventType == 'iplogs'\n| sort by TimeGenerated desc"
      },
      {
        "description": "Cisco Cloud Security Cloud Firewall Logs",
        "query": "Cisco_Umbrella\n | where EventType == 'cloudfirewalllogs'\n| sort by TimeGenerated desc"
      },
      {
        "description": "Cisco Cloud Security Firewall Logs",
        "query": "Cisco_Umbrella\n | where EventType == 'firewalllogs'\n| sort by TimeGenerated desc"
      },
      {
        "description": "Cisco Cloud Security DLP Logs",
        "query": "Cisco_Umbrella\n | where EventType == 'dlplogs'\n| sort by TimeGenerated desc"
      },
      {
        "description": "Cisco Cloud Security Cloud RAVPN Logs",
        "query": "Cisco_Umbrella\n | where EventType == 'ravpnlogs'\n| sort by TimeGenerated desc"
      },
      {
        "description": "Cisco Cloud Security Audit Logs",
        "query": "Cisco_Umbrella\n | where EventType == 'auditlogs'\n| sort by TimeGenerated desc"
      },
      {
        "description": "Cisco Cloud Security ZTNA Logs",
        "query": "Cisco_Umbrella\n | where EventType == 'ztnalogs'\n| sort by TimeGenerated desc"
      },
      {
        "description": "Cisco Cloud Security Cloud Intrusion Logs",
        "query": "Cisco_Umbrella\n | where EventType == 'intrusionlogs'\n| sort by TimeGenerated desc"
      },
      {
        "description": "Cisco Cloud Security Cloud ZTA Flow Logs",
        "query": "Cisco_Umbrella\n | where EventType == 'ztaflowlogs'\n| sort by TimeGenerated desc"
      },
      {
        "description": "Cisco Cloud Security Cloud File Event Logs",
        "query": "Cisco_Umbrella\n | where EventType == 'fileeventlogs'\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Cisco_Umbrella_dns_CL",
        "lastDataReceivedQuery": "Cisco_Umbrella_dns_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Cisco_Umbrella_proxy_CL",
        "lastDataReceivedQuery": "Cisco_Umbrella_proxy_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Cisco_Umbrella_ip_CL",
        "lastDataReceivedQuery": "Cisco_Umbrella_ip_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Cisco_Umbrella_cloudfirewall_CL",
        "lastDataReceivedQuery": "Cisco_Umbrella_cloudfirewall_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Cisco_Umbrella_firewall_CL",
        "lastDataReceivedQuery": "Cisco_Umbrella_firewall_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Cisco_Umbrella_dlp_CL",
        "lastDataReceivedQuery": "Cisco_Umbrella_dlp_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Cisco_Umbrella_ravpnlogs_CL",
        "lastDataReceivedQuery": "Cisco_Umbrella_ravpnlogs_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Cisco_Umbrella_audit_CL",
        "lastDataReceivedQuery": "Cisco_Umbrella_audit_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Cisco_Umbrella_ztna_CL",
        "lastDataReceivedQuery": "Cisco_Umbrella_ztna_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Cisco_Umbrella_intrusion_CL",
        "lastDataReceivedQuery": "Cisco_Umbrella_intrusion_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Cisco_Umbrella_ztaflow_CL",
        "lastDataReceivedQuery": "Cisco_Umbrella_ztaflow_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Cisco_Umbrella_fileevent_CL",
        "lastDataReceivedQuery": "Cisco_Umbrella_fileevent_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Cisco_Umbrella_dns_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)",
          "Cisco_Umbrella_proxy_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)",
          "Cisco_Umbrella_ip_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)",
          "Cisco_Umbrella_cloudfirewall_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)",
          "Cisco_Umbrella_firewall_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)",
          "Cisco_Umbrella_dlp_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)",
          "Cisco_Umbrella_ravpnlogs_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)",
          "Cisco_Umbrella_audit_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)",
          "Cisco_Umbrella_ztna_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)",
          "Cisco_Umbrella_intrusion_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)",
          "Cisco_Umbrella_ztaflow_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)",
          "Cisco_Umbrella_fileevent_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required.",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Amazon S3 REST API Credentials/permissions",
          "description": "**AWS Access Key Id**, **AWS Secret Access Key**, **AWS S3 Bucket Name** are required for Amazon S3 REST API."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Amazon S3 REST API to pull logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**NOTE:** This connector has been updated to support [Cisco Cloud Security log schema version 11.](https://docs.umbrella.com/deployment-umbrella/docs/log-formats-and-versioning)"
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Functions App."
      },
      {
        "title": "",
        "description": ">**NOTE:** This connector uses a parser based on a Kusto Function to normalize fields. [Follow these steps](https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Parsers/CiscoUmbrella/Cisco_Umbrella) to create the Kusto function alias **Cisco_Umbrella**."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration of the Cisco Cloud Security logs collection**\n\n[See documentation](https://docs.umbrella.com/deployment-umbrella/docs/log-management#section-logging-to-amazon-s-3) and follow the instructions for set up logging and obtain credentials."
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Functions**\n\n>**IMPORTANT:** Before deploying the Cisco Cloud Security data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following), as well as the Amazon S3 REST API Authorization credentials, readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Option 1 - Azure Resource Manager (ARM) Template",
                  "description": "Use this method for automated deployment of the Cisco Cloud Security data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinelciscoumbrellaazuredeploy) [![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://aka.ms/sentinelciscoumbrellaazuredeploy-gov)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace ID**, **Workspace Key**, **S3Bucket**, **AWSAccessKeyId**, **AWSSecretAccessKey**\n**Note:** For the S3Bucket use the value that Cisco referrs to as the _S3 Bucket Data Path_ and add a / (forward slash) to the end of the value\n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**.\n5. Click **Purchase** to deploy."
                },
                {
                  "title": "Option 2 - Manual Deployment of Azure Functions",
                  "description": "Use the following step-by-step instructions to deploy the Cisco Cloud Security data connector manually with Azure Functions (Deployment via Visual Studio Code).",
                  "instructions": [
                    {
                      "parameters": {
                        "instructionSteps": [
                          {
                            "title": "Step 1 - Deploy a Function App",
                            "description": "**NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/create-first-function-vs-code-python) for Azure Functions development.\n\n1. Download the [Azure Functions App](https://aka.ms/sentinel-CiscoUmbrellaConn-functionapp) file. Extract archive to your local development computer.\n2. Follow the [function app manual deployment instructions](https://github.com/Azure/Azure-Sentinel/blob/master/DataConnectors/AzureFunctionsManualDeploymentWithPythonVersion3.9.md#function-app-manual-deployment-instructions) to deploy the Azure Functions app using VSCode.\n3. After successful deployment of the function app, follow next steps for configuring it."
                          },
                          {
                            "title": "Step 2 - Configure the Function App",
                            "description": "1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tWorkspaceID\n\t\tWorkspaceKey\n\t\tS3Bucket\n\t\tAWSAccessKeyId\n\t\tAWSSecretAccessKey\n\t\tlogAnalyticsUri (optional)\n> - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n3. Once all application settings have been entered, click **Save**."
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "CiscoUmbrellaDataConnectorelasticpremium",
    "title": "Cisco Cloud Security (using elastic premium plan)",
    "publisher": "Cisco",
    "descriptionMarkdown": "The Cisco Umbrella data connector provides the capability to ingest [Cisco Umbrella](https://docs.umbrella.com/) events stored in Amazon S3 into Microsoft Sentinel using the Amazon S3 REST API. Refer to [Cisco Umbrella log management documentation](https://docs.umbrella.com/deployment-umbrella/docs/log-management) for more information.\n\n**NOTE:** This data connector uses the [Azure Functions Premium Plan](https://learn.microsoft.com/azure/azure-functions/functions-premium-plan?tabs=portal) to enable secure ingestion capabilities and will incur additional costs. More pricing details are [here](https://azure.microsoft.com/pricing/details/functions/?msockid=2f4366822d836a7c2ac673462cfc6ba8#pricing).",
    "additionalRequirementBanner": "These queries and workbooks are dependent on a parser based on Kusto to work as expected. Follow the steps to use this Kusto functions alias **Cisco_Umbrella** in queries and workbooks. [Follow steps to get this Kusto functions>](https://aka.ms/sentinel-ciscoumbrella-function) ",
    "graphQueries": [
      {
        "metricName": "Cisco Cloud Security DNS Logs",
        "legend": "Cisco_Umbrella_dns_CL",
        "baseQuery": "Cisco_Umbrella_dns_CL"
      },
      {
        "metricName": "Cisco Cloud Security Proxy Logs",
        "legend": "Cisco_Umbrella_proxy_CL",
        "baseQuery": "Cisco_Umbrella_proxy_CL"
      },
      {
        "metricName": "Cisco Cloud Security IP Logs",
        "legend": "Cisco_Umbrella_ip_CL",
        "baseQuery": "Cisco_Umbrella_ip_CL"
      },
      {
        "metricName": "Cisco Cloud Security Cloud Firewall Logs",
        "legend": "Cisco_Umbrella_cloudfirewall_CL",
        "baseQuery": "Cisco_Umbrella_cloudfirewall_CL"
      },
      {
        "metricName": "Cisco Cloud Security Firewall Logs",
        "legend": "Cisco_Umbrella_firewall_CL",
        "baseQuery": "Cisco_Umbrella_firewall_CL"
      },
      {
        "metricName": "Cisco Cloud Security DLP Logs",
        "legend": "Cisco_Umbrella_dlp_CL",
        "baseQuery": "Cisco_Umbrella_dlp_CL"
      },
      {
        "metricName": "Cisco Cloud Security Cloud RAVPN Logs",
        "legend": "Cisco_Umbrella_ravpnlogs_CL",
        "baseQuery": "Cisco_Umbrella_ravpnlogs_CL"
      },
      {
        "metricName": "Cisco Cloud Security Audit Logs",
        "legend": "Cisco_Umbrella_audit_CL",
        "baseQuery": "Cisco_Umbrella_audit_CL"
      },
      {
        "metricName": "Cisco Cloud Security ZTNA Logs",
        "legend": "Cisco_Umbrella_ztna_CL",
        "baseQuery": "Cisco_Umbrella_ztna_CL"
      },
      {
        "metricName": "Cisco Cloud Security Intrusion Logs",
        "legend": "Cisco_Umbrella_intrusion_CL",
        "baseQuery": "Cisco_Umbrella_intrusion_CL"
      },
      {
        "metricName": "Cisco Cloud Security ZTA flow Logs",
        "legend": "Cisco_Umbrella_ztaflow_CL",
        "baseQuery": "Cisco_Umbrella_ztaflow_CL"
      },
      {
        "metricName": "Cisco Cloud Security File Event Logs",
        "legend": "Cisco_Umbrella_fileevent_CL",
        "baseQuery": "Cisco_Umbrella_fileevent_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Cisco Cloud Security Logs",
        "query": "Cisco_Umbrella\n| sort by TimeGenerated desc"
      },
      {
        "description": "Cisco Cloud Security DNS Logs",
        "query": "Cisco_Umbrella\n | where EventType == 'dnslogs'\n| sort by TimeGenerated desc"
      },
      {
        "description": "Cisco Cloud Security Proxy Logs",
        "query": "Cisco_Umbrella\n | where EventType == 'proxylogs'\n| sort by TimeGenerated desc"
      },
      {
        "description": "Cisco Cloud Security IP Logs",
        "query": "Cisco_Umbrella\n | where EventType == 'iplogs'\n| sort by TimeGenerated desc"
      },
      {
        "description": "Cisco Cloud Security Cloud Firewall Logs",
        "query": "Cisco_Umbrella\n | where EventType == 'cloudfirewalllogs'\n| sort by TimeGenerated desc"
      },
      {
        "description": "Cisco Cloud Security Firewall Logs",
        "query": "Cisco_Umbrella\n | where EventType == 'firewalllogs'\n| sort by TimeGenerated desc"
      },
      {
        "description": "Cisco Cloud Security DLP Logs",
        "query": "Cisco_Umbrella\n | where EventType == 'dlplogs'\n| sort by TimeGenerated desc"
      },
      {
        "description": "Cisco Cloud Security Cloud RAVPN Logs",
        "query": "Cisco_Umbrella\n | where EventType == 'ravpnlogs'\n| sort by TimeGenerated desc"
      },
      {
        "description": "Cisco Cloud Security Audit Logs",
        "query": "Cisco_Umbrella\n | where EventType == 'auditlogs'\n| sort by TimeGenerated desc"
      },
      {
        "description": "Cisco Cloud Security ZTNA Logs",
        "query": "Cisco_Umbrella\n | where EventType == 'ztnalogs'\n| sort by TimeGenerated desc"
      },
      {
        "description": "Cisco Cloud Security Cloud Intrusion Logs",
        "query": "Cisco_Umbrella\n | where EventType == 'intrusionlogs'\n| sort by TimeGenerated desc"
      },
      {
        "description": "Cisco Cloud Security Cloud ZTA Flow Logs",
        "query": "Cisco_Umbrella\n | where EventType == 'ztaflowlogs'\n| sort by TimeGenerated desc"
      },
      {
        "description": "Cisco Cloud Security Cloud File Event Logs",
        "query": "Cisco_Umbrella\n | where EventType == 'fileeventlogs'\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Cisco_Umbrella_dns_CL",
        "lastDataReceivedQuery": "Cisco_Umbrella_dns_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Cisco_Umbrella_proxy_CL",
        "lastDataReceivedQuery": "Cisco_Umbrella_proxy_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Cisco_Umbrella_ip_CL",
        "lastDataReceivedQuery": "Cisco_Umbrella_ip_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Cisco_Umbrella_cloudfirewall_CL",
        "lastDataReceivedQuery": "Cisco_Umbrella_cloudfirewall_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Cisco_Umbrella_firewall_CL",
        "lastDataReceivedQuery": "Cisco_Umbrella_firewall_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Cisco_Umbrella_dlp_CL",
        "lastDataReceivedQuery": "Cisco_Umbrella_dlp_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Cisco_Umbrella_ravpnlogs_CL",
        "lastDataReceivedQuery": "Cisco_Umbrella_ravpnlogs_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Cisco_Umbrella_audit_CL",
        "lastDataReceivedQuery": "Cisco_Umbrella_audit_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Cisco_Umbrella_ztna_CL",
        "lastDataReceivedQuery": "Cisco_Umbrella_ztna_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Cisco_Umbrella_intrusion_CL",
        "lastDataReceivedQuery": "Cisco_Umbrella_intrusion_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Cisco_Umbrella_ztaflow_CL",
        "lastDataReceivedQuery": "Cisco_Umbrella_ztaflow_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Cisco_Umbrella_fileevent_CL",
        "lastDataReceivedQuery": "Cisco_Umbrella_fileevent_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Cisco_Umbrella_dns_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(1d)",
          "Cisco_Umbrella_proxy_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(1d)",
          "Cisco_Umbrella_ip_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(1d)",
          "Cisco_Umbrella_cloudfirewall_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(1d)",
          "Cisco_Umbrella_firewall_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(1d)",
          "Cisco_Umbrella_dlp_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(1d)",
          "Cisco_Umbrella_ravpnlogs_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(1d)",
          "Cisco_Umbrella_audit_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(1d)",
          "Cisco_Umbrella_ztna_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(1d)",
          "Cisco_Umbrella_intrusion_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(1d)",
          "Cisco_Umbrella_ztaflow_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(1d)",
          "Cisco_Umbrella_fileevent_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(1d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required.",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Amazon S3 REST API Credentials/permissions",
          "description": "**AWS Access Key Id**, **AWS Secret Access Key**, **AWS S3 Bucket Name** are required for Amazon S3 REST API."
        },
        {
          "name": "Virtual Network permissions (for private access)",
          "description": "For private storage account access, **Network Contributor** permissions are required on the Virtual Network and subnet. The subnet must be delegated to **Microsoft.Web/serverFarms** for Function App VNet integration."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Amazon S3 REST API to pull logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**NOTE:** This connector has been updated to support [cisco umbrella log schema version 11.](https://docs.umbrella.com/deployment-umbrella/docs/log-formats-and-versioning)"
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Functions App."
      },
      {
        "title": "",
        "description": ">**NOTE:** This connector uses a parser based on a Kusto Function to normalize fields. [Follow these steps](https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Parsers/CiscoUmbrella/Cisco_Umbrella) to create the Kusto function alias **Cisco_Umbrella**."
      },
      {
        "title": "",
        "description": "**STEP 1 - Network Prerequisites for Private Access**\n\n>**IMPORTANT:** When deploying with private storage account access, ensure the following network prerequisites are met:\n> - **Virtual Network**: An existing Virtual Network (VNet) must be available\n> - **Subnet**: A dedicated subnet within the VNet must be delegated to **Microsoft.Web/serverFarms** for Function App VNet integration\n> - **Subnet Delegation**: Configure the subnet delegation using Azure Portal, ARM template, or Azure CLI:\n>   - Azure Portal: Go to Virtual networks  Select your VNet  Subnets  Select subnet  Delegate subnet to service  Choose **Microsoft.Web/serverFarms**\n>   - Azure CLI: `az network vnet subnet update --resource-group <rg-name> --vnet-name <vnet-name> --name <subnet-name> --delegations Microsoft.Web/serverFarms`\n> - **Private Endpoints**: The deployment will create private endpoints for storage account services (blob, file, queue, table) within the same subnet"
      },
      {
        "title": "",
        "description": "**STEP 2 - Configuration of the Cisco Umbrella logs collection**\n\n[See documentation](https://docs.umbrella.com/deployment-umbrella/docs/log-management#section-logging-to-amazon-s-3) and follow the instructions for set up logging and obtain credentials."
      },
      {
        "title": "",
        "description": "**STEP 3 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Functions**\n\n>**IMPORTANT:** Before deploying the Cisco Umbrella data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following), as well as the Amazon S3 REST API Authorization credentials, readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Option 1 - Azure Resource Manager (ARM) Template",
                  "description": "Use this method for automated deployment of the Cisco Umbrella data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinelciscoumbrellaelasticpremiumazuredeploy) [![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://aka.ms/sentinelciscoumbrellaelasticpremiumazuredeploy-gov)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace ID**, **Workspace Key**, **S3Bucket**, **AWSAccessKeyId**, **AWSSecretAccessKey**\n4. **For Private Access Deployment**: Also enter **existingVnetName**, **existingVnetResourceGroupName**, and **existingSubnetName** (ensure subnet is delegated to Microsoft.Web/serverFarms)\n**Note:** For the S3Bucket use the value that Cisco referrs to as the _S3 Bucket Data Path_ and add a / (forward slash) to the end of the value\n5. Mark the checkbox labeled **I agree to the terms and conditions stated above**.\n6. Click **Purchase** to deploy."
                },
                {
                  "title": "Option 2 - Manual Deployment of Azure Functions",
                  "description": "Use the following step-by-step instructions to deploy the Cisco Umbrella data connector manually with Azure Functions (Deployment via Visual Studio Code).",
                  "instructions": [
                    {
                      "parameters": {
                        "instructionSteps": [
                          {
                            "title": "Step 1 - Deploy a Function App",
                            "description": "**NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/create-first-function-vs-code-python) for Azure Functions development.\n\n1. Download the [Azure Functions App](https://aka.ms/sentinel-CiscoUmbrellaConn-functionapp) file. Extract archive to your local development computer.\n2. Follow the [function app manual deployment instructions](https://github.com/Azure/Azure-Sentinel/blob/master/DataConnectors/AzureFunctionsManualDeploymentWithPythonVersion3.9.md#function-app-manual-deployment-instructions) to deploy the Azure Functions app using VSCode.\n3. After successful deployment of the function app, follow next steps for configuring it."
                          },
                          {
                            "title": "Step 2 - Configure the Function App",
                            "description": "1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tWorkspaceID\n\t\tWorkspaceKey\n\t\tS3Bucket\n\t\tAWSAccessKeyId\n\t\tAWSSecretAccessKey\n\t\tlogAnalyticsUri (optional)\n> - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n3. Once all application settings have been entered, click **Save**."
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "CiscoWSA",
    "title": "[Deprecated] Cisco Web Security Appliance",
    "publisher": "Cisco",
    "descriptionMarkdown": "[Cisco Web Security Appliance (WSA)](https://www.cisco.com/c/en/us/products/security/web-security-appliance/index.html) data connector provides the capability to ingest [Cisco WSA Access Logs](https://www.cisco.com/c/en/us/td/docs/security/wsa/wsa_14-0/User-Guide/b_WSA_UserGuide_14_0/b_WSA_UserGuide_11_7_chapter_010101.html) into Microsoft Sentinel.",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected [**CiscoWSAEvent**](https://aka.ms/sentinel-CiscoWSA-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CiscoWSAEvent",
        "baseQuery": "CiscoWSAEvent"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Clients (Source IP)",
        "query": "CiscoWSAEvent\n | where notempty(SrcIpAddr)\n | summarize count() by SrcIpAddr\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog (CiscoWSAEvent)",
        "lastDataReceivedQuery": "CiscoWSAEvent\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CiscoWSAEvent\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(3d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "write permission is required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key)",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**CiscoWSAEvent**](https://aka.ms/sentinel-CiscoWSA-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "",
        "description": ">**NOTE:** This data connector has been developed using AsyncOS 14.0 for Cisco Web Security Appliance",
        "instructions": []
      },
      {
        "title": "1. Configure Cisco Web Security Appliance to forward logs via Syslog to remote server where you will install the agent.",
        "description": "[Follow these steps](https://www.cisco.com/c/en/us/td/docs/security/esa/esa14-0/user_guide/b_ESA_Admin_Guide_14-0/b_ESA_Admin_Guide_12_1_chapter_0100111.html#con_1134718) to configure Cisco Web Security Appliance to forward logs via Syslog\n\n>**NOTE:** Select **Syslog Push** as a Retrieval Method."
      },
      {
        "title": "2. Install and onboard the agent for Linux or Windows",
        "description": "Install the agent on the Server to which the logs will be forwarded.\n\n> Logs on Linux or Windows servers are collected by **Linux** or **Windows** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Linux agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Windows agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Windows Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Windows Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "3. Check logs in Microsoft Sentinel",
        "description": "Open Log Analytics to check if the logs are received using the Syslog schema.\n\n>**NOTE:** It may take up to 15 minutes before new logs will appear in Syslog table.",
        "instructions": []
      }
    ]
  },
  {
    "id": "Citrix",
    "title": "CITRIX SECURITY ANALYTICS",
    "publisher": "CITRIX",
    "descriptionMarkdown": "Citrix Analytics (Security) integration with Microsoft Sentinel helps you to export data analyzed for risky events from Citrix Analytics (Security) into Microsoft Sentinel environment. You can create custom dashboards, analyze data from other sources along with that from Citrix Analytics (Security) and create custom workflows using Logic Apps to monitor and mitigate security events.",
    "graphQueries": [
      {
        "metricName": "Total Risk Indicator Summary Events received",
        "legend": "CitrixAnalytics_indicatorSummary_CL",
        "baseQuery": "CitrixAnalytics_indicatorSummary_CL"
      },
      {
        "metricName": "Total Risk Indicator Detail Events received",
        "legend": "CitrixAnalytics_indicatorEventDetails_CL",
        "baseQuery": "CitrixAnalytics_indicatorSummary_CL"
      },
      {
        "metricName": "Total Risk Score Change Events received",
        "legend": "CitrixAnalytics_riskScoreChange_CL",
        "baseQuery": "CitrixAnalytics_indicatorSummary_CL"
      },
      {
        "metricName": "Total User Profile Events received",
        "legend": "CitrixAnalytics_userProfile_CL",
        "baseQuery": "CitrixAnalytics_userProfile_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "High Risk Users",
        "query": "CitrixAnalytics_userProfile_CL\n  | where cur_riskscore_d > 64\n | where cur_riskscore_d < 100\n | summarize arg_max(TimeGenerated, cur_riskscore_d) by entity_id_s\n | count "
      },
      {
        "description": "Medium Risk Users",
        "query": "CitrixAnalytics_userProfile_CL\n  | where cur_riskscore_d > 34\n | where cur_riskscore_d < 63\n | summarize arg_max(TimeGenerated, cur_riskscore_d) by entity_id_s\n | count "
      },
      {
        "description": "Low Risk Users",
        "query": "CitrixAnalytics_userProfile_CL\n  | where cur_riskscore_d > 1\n | where cur_riskscore_d < 33\n | summarize arg_max(TimeGenerated, cur_riskscore_d) by entity_id_s\n | count "
      }
    ],
    "dataTypes": [
      {
        "name": "CitrixAnalytics_indicatorSummary_CL",
        "lastDataReceivedQuery": "CitrixAnalytics_indicatorSummary_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CitrixAnalytics_indicatorEventDetails_CL",
        "lastDataReceivedQuery": "CitrixAnalytics_indicatorEventDetails_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CitrixAnalytics_riskScoreChange_CL",
        "lastDataReceivedQuery": "CitrixAnalytics_riskScoreChange_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CitrixAnalytics_userProfile_CL",
        "lastDataReceivedQuery": "CitrixAnalytics_userProfile_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CitrixAnalytics_userProfile_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Licensing",
          "description": "Entitlements to Citrix Security Analytics in Citrix Cloud. Please review [Citrix Tool License Agreement.](https://aka.ms/sentinel-citrixanalyticslicense-readme)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "To get access to this capability and the configuration steps on Citrix Analytics, please visit: [Connect Citrix to Microsoft Sentinel.](https://aka.ms/Sentinel-Citrix-Connector)\n",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ],
    "metadata": {
      "id": "54468043-90ac-4b79-8036-f5b7d0402aae",
      "version": "2.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "sourceRepository"
      },
      "author": {
        "name": "Citrix Systems Inc."
      },
      "support": {
        "tier": "developer",
        "name": "Citrix Systems Inc.",
        "email": "CAS-PM-Ext@citrix.com",
        "link": "https://www.citrix.com/support/"
      }
    }
  },
  {
    "id": "CitrixADC",
    "title": "[Deprecated] Citrix ADC (former NetScaler)",
    "publisher": "Citrix",
    "descriptionMarkdown": "The [Citrix ADC (former NetScaler)](https://www.citrix.com/products/citrix-adc/) data connector provides the capability to ingest Citrix ADC logs into Microsoft Sentinel. If you want to ingest Citrix WAF logs into Microsoft Sentinel, refer this [documentation](https://learn.microsoft.com/azure/sentinel/data-connectors/citrix-waf-web-app-firewall)",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CitrixADC",
        "baseQuery": "CitrixADCEvent"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Event Types",
        "query": "CitrixADCEvent\n | where isnotempty(EventType)\n    | summarize count() by EventType\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog",
        "lastDataReceivedQuery": "CitrixADCEvent\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CitrixADCEvent\n |  where TimeGenerated > ago(3d)\n    | take 1\n | project IsConnected = true"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "write permission is required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** 1. This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias CitrixADCEvent and load the function code or click [here](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Citrix%20ADC/Parsers/CitrixADCEvent.yaml), this function maps Citrix ADC (former NetScaler) events to Advanced Security Information Model [ASIM](https://docs.microsoft.com/azure/sentinel/normalization). The function usually takes 10-15 minutes to activate after solution installation/update. \n\n>**NOTE:** 2. This parser requires a watchlist named **`Sources_by_SourceType`** \n\n> i. If you don't have watchlist already created, please click [here](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2FAzure-Sentinel%2Fmaster%2FASIM%2Fdeploy%2FWatchlists%2FASimSourceType.json) to create. \n\n> ii. Open watchlist **`Sources_by_SourceType`** and add entries for this data source.\n\n> iii. The SourceType value for CitrixADC is **`CitrixADC`**. \n\n> You can refer [this](https://learn.microsoft.com/en-us/azure/sentinel/normalization-manage-parsers?WT.mc_id=Portal-fx#configure-the-sources-relevant-to-a-source-specific-parser) documentation for more details",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux",
        "description": "Typically, you should install the agent on a different computer from the one on which the logs are generated.\n\n>  Syslog logs are collected only from **Linux** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Configure the facilities you want to collect and their severities.\n 1. Under workspace advanced settings **Configuration**, select **Data** and then **Syslog**.\n 2. Select **Apply below configuration to my machines** and select the facilities and severities.\n 3.  Click **Save**.",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenSyslogSettings"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "3. Configure Citrix ADC to forward logs via Syslog",
        "description": "3.1 Navigate to **Configuration tab > System > Auditing > Syslog > Servers tab**\n\n 3.2 Specify **Syslog action name**.\n\n 3.3 Set IP address of remote Syslog server and port.\n\n 3.4 Set **Transport type** as **TCP** or **UDP** depending on your remote Syslog server configuration.\n\n 3.5 You can refer Citrix ADC (former NetScaler) [documentation](https://docs.netscaler.com/) for more details."
      },
      {
        "title": "4. Check logs in Microsoft Sentinel",
        "description": "Open Log Analytics to check if the logs are received using the Syslog schema.\n\n>**NOTE:** It may take up to 15 minutes before new logs will appear in Syslog table.",
        "instructions": []
      }
    ],
    "metadata": {
      "id": "c546d5dd-dfec-41fb-a680-af0c66531adc",
      "version": "1.0.1",
      "kind": "dataConnector",
      "source": {
        "kind": "solution"
      },
      "author": {
        "name": "Microsoft"
      },
      "support": {
        "name": "Microsoft",
        "link": "https://support.microsoft.com/",
        "tier": "Microsoft"
      }
    }
  },
  {
    "id": "CitrixWAF",
    "title": "[Deprecated] Citrix WAF (Web App Firewall) via Legacy Agent",
    "publisher": "Citrix Systems Inc.",
    "descriptionMarkdown": " Citrix WAF (Web App Firewall) is an industry leading enterprise-grade WAF solution. Citrix WAF mitigates threats against your public-facing assets, including websites, apps, and APIs. From layer 3 to layer 7, Citrix WAF includes protections such as IP reputation, bot mitigation, defense against the OWASP Top 10 application threats, built-in signatures to protect against application stack vulnerabilities, and more. \n\nCitrix WAF supports Common Event Format (CEF) which is an industry standard format on top of Syslog messages . By connecting Citrix WAF CEF logs to Microsoft Sentinel, you can take advantage of search & correlation, alerting, and threat intelligence enrichment for each log.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CitrixWafLogs",
        "baseQuery": "\nCommonSecurityLog\n| where DeviceVendor == \"Citrix\"\n| where DeviceProduct == \"NetScaler\"\n"
      }
    ],
    "sampleQueries": [
      {
        "description": "Citrix WAF Logs",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"Citrix\"\n| where DeviceProduct == \"NetScaler\"\n"
      },
      {
        "description": "Citrix Waf logs for cross site scripting",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"Citrix\"\n| where DeviceProduct == \"NetScaler\"\n| where Activity == \"APPFW_XSS\"\n"
      },
      {
        "description": "Citrix Waf logs for SQL Injection",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"Citrix\"\n| where DeviceProduct == \"NetScaler\"\n| where Activity == \"APPFW_SQL\"\n"
      },
      {
        "description": "Citrix Waf logs for Bufferoverflow",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"Citrix\"\n| where DeviceProduct == \"NetScaler\"\n| where Activity == \"APPFW_STARTURL\"\n"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (CitrixWAFLogs)",
        "lastDataReceivedQuery": "\nCommonSecurityLog\n| where DeviceVendor == \"Citrix\"\n| where DeviceProduct == \"NetScaler\"\n\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "\nCommonSecurityLog\n| where DeviceVendor == \"Citrix\"\n| where DeviceProduct == \"NetScaler\"\n\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Common Event Format (CEF) logs to Syslog agent",
        "description": "Configure Citrix WAF to send Syslog messages in CEF format to the proxy machine using the steps below. \n\n1. Follow [this guide](https://support.citrix.com/article/CTX234174) to configure WAF.\n\n2. Follow [this guide](https://support.citrix.com/article/CTX136146) to configure CEF logs.\n\n3. Follow [this guide](https://docs.citrix.com/en-us/citrix-adc/13/system/audit-logging/configuring-audit-logging.html) to forward the logs to proxy . Make sure you to send the logs to port 514 TCP on the Linux machine's IP address.\n\n"
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "7504f78d-1928-4399-a1ae-ba826c47c42d",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Citrix Systems"
      },
      "support": {
        "name": "Citrix Systems",
        "link": "https://www.citrix.com/support/",
        "tier": "developer"
      }
    }
  },
  {
    "id": "CitrixWAFAma",
    "title": "[Deprecated] Citrix WAF (Web App Firewall) via AMA",
    "publisher": "Citrix Systems Inc.",
    "descriptionMarkdown": " Citrix WAF (Web App Firewall) is an industry leading enterprise-grade WAF solution. Citrix WAF mitigates threats against your public-facing assets, including websites, apps, and APIs. From layer 3 to layer 7, Citrix WAF includes protections such as IP reputation, bot mitigation, defense against the OWASP Top 10 application threats, built-in signatures to protect against application stack vulnerabilities, and more. \n\nCitrix WAF supports Common Event Format (CEF) which is an industry standard format on top of Syslog messages . By connecting Citrix WAF CEF logs to Microsoft Sentinel, you can take advantage of search & correlation, alerting, and threat intelligence enrichment for each log.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CitrixWafLogs",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Citrix'\n |where DeviceProduct =~ 'NetScaler'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "Citrix WAF Logs",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"Citrix\"\n| where DeviceProduct == \"NetScaler\"\n"
      },
      {
        "description": "Citrix Waf logs for cross site scripting",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"Citrix\"\n| where DeviceProduct == \"NetScaler\"\n| where Activity == \"APPFW_XSS\"\n"
      },
      {
        "description": "Citrix Waf logs for SQL Injection",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"Citrix\"\n| where DeviceProduct == \"NetScaler\"\n| where Activity == \"APPFW_SQL\"\n"
      },
      {
        "description": "Citrix Waf logs for Bufferoverflow",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"Citrix\"\n| where DeviceProduct == \"NetScaler\"\n| where Activity == \"APPFW_STARTURL\"\n"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (CitrixWAFLogs)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Citrix'\n |where DeviceProduct =~ 'NetScaler'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'Citrix'\n |where DeviceProduct =~ 'NetScaler'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine",
                  "instructions": []
                },
                {
                  "title": "Step B. Forward Common Event Format (CEF) logs to Syslog agent",
                  "description": "Configure Citrix WAF to send Syslog messages in CEF format to the proxy machine using the steps below. \n\n1. Follow [this guide](https://support.citrix.com/article/CTX234174) to configure WAF.\n\n2. Follow [this guide](https://support.citrix.com/article/CTX136146) to configure CEF logs.\n\n3. Follow [this guide](https://docs.citrix.com/en-us/citrix-adc/13/system/audit-logging/configuring-audit-logging.html) to forward the logs to proxy . Make sure you to send the logs to port 514 TCP on the Linux machine's IP address.\n\n",
                  "instructions": []
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "7504f78d-1928-4399-a1ae-ba826c47c42d",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Citrix Systems"
      },
      "support": {
        "name": "Citrix Systems",
        "link": "https://www.citrix.com/support/",
        "tier": "developer"
      }
    }
  },
  {
    "id": "Claroty",
    "title": "[Deprecated] Claroty via Legacy Agent",
    "publisher": "Claroty",
    "descriptionMarkdown": "The [Claroty](https://claroty.com/) data connector provides the capability to ingest [Continuous Threat Detection](https://claroty.com/resources/datasheets/continuous-threat-detection) and [Secure Remote Access](https://claroty.com/industrial-cybersecurity/sra) events into Microsoft Sentinel.",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected [**ClarotyEvent**](https://aka.ms/sentinel-claroty-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Claroty",
        "baseQuery": "ClarotyEvent"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Destinations",
        "query": "ClarotyEvent\n | where isnotempty(DstIpAddr)\n    | summarize count() by DstIpAddr\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (Claroty)",
        "lastDataReceivedQuery": "ClarotyEvent\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ClarotyEvent\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**ClarotyEvent**](https://aka.ms/sentinel-claroty-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2.  Configure Claroty to send logs using CEF",
        "description": "Configure log forwarding using CEF:\n\n1. Navigate to the **Syslog** section of the Configuration menu.\n\n2. Select **+Add**.\n\n3. In the **Add New Syslog Dialog** specify Remote Server **IP**, **Port**, **Protocol** and select **Message Format** - **CEF**.\n\n4. Choose **Save** to exit the **Add Syslog dialog**."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "ClarotyAma",
    "title": "[Deprecated] Claroty via AMA",
    "publisher": "Claroty",
    "descriptionMarkdown": "The [Claroty](https://claroty.com/) data connector provides the capability to ingest [Continuous Threat Detection](https://claroty.com/resources/datasheets/continuous-threat-detection) and [Secure Remote Access](https://claroty.com/industrial-cybersecurity/sra) events into Microsoft Sentinel.",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected [**ClarotyEvent**](https://aka.ms/sentinel-claroty-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Claroty",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Claroty'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Destinations",
        "query": "ClarotyEvent\n | where isnotempty(DstIpAddr)\n    | summarize count() by DstIpAddr\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (Claroty)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Claroty'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'Claroty'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**ClarotyEvent**](https://aka.ms/sentinel-claroty-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine",
                  "instructions": []
                },
                {
                  "title": "Step B. Configure Claroty to send logs using CEF",
                  "description": "Configure log forwarding using CEF:\n\n1. Navigate to the **Syslog** section of the Configuration menu.\n\n2. Select **+Add**.\n\n3. In the **Add New Syslog Dialog** specify Remote Server **IP**, **Port**, **Protocol** and select **Message Format** - **CEF**.\n\n4. Choose **Save** to exit the **Add Syslog dialog**.",
                  "instructions": []
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "ClarotyxDome",
    "title": "Claroty xDome",
    "publisher": "Claroty",
    "logo": "ClarotyLogo.svg",
    "descriptionMarkdown": "[Claroty](https://claroty.com/) xDome delivers comprehensive security and alert management capabilities for healthcare and industrial network environments. It is designed to map multiple source types, identify the collected data, and integrate it into Microsoft Sentinel data models. This results in the ability to monitor all potential threats in your healthcare and industrial environments in one location, leading to more effective security monitoring and a stronger security posture.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ClarotyxDomeLogs",
        "baseQuery": "CommonSecurityLog\n| where DeviceVendor in (\"Medigate\", \"Claroty\")"
      }
    ],
    "sampleQueries": [
      {
        "description": "Fetch logs from Claroty xDome",
        "query": "\nCommonSecurityLog\n| where DeviceVendor in (\"Medigate\", \"Claroty\") | sort by TimeGenerated"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "\nCommonSecurityLog\n| where DeviceVendor in (\"Medigate\", \"Claroty\")\n\n| summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (ClarotyxDome)",
        "lastDataReceivedQuery": "\nCommonSecurityLog\n| where DeviceVendor in (\"Medigate\", \"Claroty\")\n\n | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python --version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Common Event Format (CEF) logs to Syslog agent",
        "description": "Configure the Claroty xDome - Microsoft Sentinel integration to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python --version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "d37af052-f3e4-4bd5-9f5d-f12469037cc8",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "Claroty"
      },
      "author": {
        "name": "Claroty"
      },
      "support": {
        "name": "xDome Customer Support",
        "link": "https://claroty.com/support-policy",
        "tier": "developer"
      }
    }
  },
  {
    "id": "CloudflareDataConnector",
    "title": "[DEPRECATED] Cloudflare",
    "publisher": "Cloudflare",
    "descriptionMarkdown": "The Cloudflare data connector provides the capability to ingest [Cloudflare logs](https://developers.cloudflare.com/logs/) into Microsoft Sentinel using the Cloudflare Logpush and Azure Blob Storage. Refer to [Cloudflare  documentation](https://developers.cloudflare.com/logs/logpush) for more information.\n\n<p><span style='color:red; font-weight:bold;'>NOTE</span>: This data connector has been deprecated, consider moving to the CCF data connector available in the solution which replaces ingestion via the <a href='https://learn.microsoft.com/en-us/azure/azure-monitor/logs/custom-logs-migrate' style='color:#1890F1;'>deprecated HTTP Data Collector API</a>.</p>",
    "additionalRequirementBanner": ">This data connector depends on a parser based on a Kusto Function to work as expected [**Cloudflare**](https://aka.ms/sentinel-CloudflareDataConnector-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Cloudflare logs",
        "legend": "Cloudflare_CL",
        "baseQuery": "Cloudflare_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Cloudflare logs",
        "query": "Cloudflare_CL\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Cloudflare_CL",
        "lastDataReceivedQuery": "Cloudflare_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Cloudflare_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Azure Blob Storage connection string and container name",
          "description": "Azure Blob Storage connection string and container name where the logs are pushed to by Cloudflare Logpush. [See the documentation to learn more about creating Azure Blob Storage container.](https://learn.microsoft.com/azure/storage/blobs/storage-quickstart-blobs-portal)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Azure Blob Storage API to pull logs into Microsoft Sentinel. This might result in additional costs for data ingestion and for storing data in Azure Blob Storage costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) and [Azure Blob Storage pricing page](https://azure.microsoft.com/pricing/details/storage/blobs/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**Cloudflare**](https://aka.ms/sentinel-CloudflareDataConnector-parser) which is deployed with the Microsoft Sentinel Solution."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration of the Cloudflare Logpush**\n\nSee documentation to [setup Cloudflare Logpush to Microsoft Azure](https://developers.cloudflare.com/logs/logpush/logpush-dashboard)"
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Cloudflare data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following), as well as Azure Blob Storage connection string and container name, readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the Cloudflare data connector using an ARM Template.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-CloudflareDataConnector-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Azure Blob Storage Container Name**, **Azure Blob Storage Connection String**, **Microsoft Sentinel Workspace Id**, **Microsoft Sentinel Shared Key**\n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**.\n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the Cloudflare data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/create-first-function-vs-code-python) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-CloudflareDataConnector-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. CloudflareXX).\n\n\te. **Select a runtime:** Choose Python 3.11.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tCONTAINER_NAME\n\t\tAZURE_STORAGE_CONNECTION_STRING\n\t\tWORKSPACE_ID\n\t\tSHARED_KEY\n\t\tlogAnalyticsUri (Optional)\n - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://WORKSPACE_ID.ods.opinsights.azure.us`. \n4. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "CloudflareDefinition",
    "title": "Cloudflare (Using Blob Container) (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": " The Cloudflare data connector provides the capability to ingest Cloudflare logs into Microsoft Sentinel using the Cloudflare Logpush and Azure Blob Storage. Refer to [Cloudflare documentation](https://developers.cloudflare.com/logs/about/)for more information.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "Cloudflare logs",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Cloudflare Logs",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n|summarize Time = max(TimeGenerated)\n|where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "CloudflareDefinition",
    "title": "Cloudflare (Using Blob Container) (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": " The Cloudflare data connector provides the capability to ingest Cloudflare logs into Microsoft Sentinel using the Cloudflare Logpush and Azure Blob Storage. Refer to [Cloudflare documentation](https://developers.cloudflare.com/logs/about/)for more information.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "Cloudflare logs",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Cloudflare Logs",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n|summarize Time = max(TimeGenerated)\n|where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "CloudGuardCCPDefinition",
    "title": "Check Point CloudGuard CNAPP Connector for Microsoft Sentinel",
    "publisher": "CheckPoint",
    "descriptionMarkdown": "The [CloudGuard](https://sc1.checkpoint.com/documents/CloudGuard_Dome9/Documentation/Overview/CloudGuard-CSPM-Introduction.htm?cshid=help_center_documentation) data connector enables the ingestion of security events from the CloudGuard API into Microsoft Sentinel, using Microsoft Sentinels Codeless Connector Platform. The connector supports DCR-based [ingestion time transformations](https://docs.microsoft.com/azure/azure-monitor/logs/custom-logs-overview) which parses incoming security event data into custom columns. This pre-parsing process eliminates the need for query-time parsing, resulting in improved performance for data queries.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CloudGuard Events",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of CloudGuard Events",
        "query": "{{graphQueriesTableName}}\n | take 10"
      },
      {
        "description": "Total Events by uuid",
        "query": "{{graphQueriesTableName}}\n | summarize count() by OriginalEventUid"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}|summarize Time = max  (TimeGenerated)\n|where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "CofenseIntelligence",
    "title": "Cofense Intelligence Threat Indicators Ingestion",
    "publisher": "Cofense",
    "descriptionMarkdown": "The [Cofense-Intelligence](https://cofense.com/product-services/phishing-intelligence/) data connector provides the following capabilities: \n 1. CofenseToSentinel : \n >* Get Threat Indicators from the Cofense Intelligence platform and create Threat Intelligence Indicators in Microsoft Sentinel. \n 2. SentinelToDefender : \n >* Get Malware from Cofense Intelligence and post to custom logs table. \n 3. CofenseIntelligenceMalware : \n >* Get Cofense Intelligence Threat Intelligence Indicators from Microsoft Sentinel Threat Intelligence and create/update Indicators in Microsoft Defender for Endpoints.\n 4. DownloadThreatReports : \n >* This data connector will fetch the malware data and create the Link from which we can download Threat Reports. \n 5. RetryFailedIndicators : \n >* This data connector will fetch failed indicators from failed indicators file and retry creating/updating Threat Intelligence indicators in Microsoft Sentinel. \n\n\n For more details of REST APIs refer to the below documentations: \n 1. Cofense Intelligence API documentation: \n> https://www.threathq.com/docs/rest_api_reference.html \n 2. Microsoft Threat Intelligence Indicator documentation: \n> https://learn.microsoft.com/rest/api/securityinsights/preview/threat-intelligence-indicator \n 3. Microsoft Defender for Endpoints Indicator documentation: \n> https://learn.microsoft.com/microsoft-365/security/defender-endpoint/ti-indicator?view=o365-worldwide",
    "graphQueries": [
      {
        "metricName": "Cofense Intelligence Threat Indicators data received",
        "legend": "ThreatIntelligenceIndicator | where SourceSystem startswith 'Cofense Intelligence : '",
        "baseQuery": "ThreatIntelligenceIndicator | where SourceSystem startswith 'Cofense Intelligence : '"
      },
      {
        "metricName": "Cofense Intelligence Malware data and report links data received",
        "legend": "Malware_Data_CL",
        "baseQuery": "Malware_Data_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Cofense Based Indicators Events - All Cofense indicators in Microsoft Sentinel Threat Intelligence.",
        "query": "ThreatIntelligenceIndicator\n | where SourceSystem startswith 'Cofense Intelligence : '\n | sort by TimeGenerated desc"
      },
      {
        "description": "Cofense Intelligence malware data and all Cofense indicators report links data.",
        "query": "Malware_Data_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "ThreatIntelligenceIndicator",
        "lastDataReceivedQuery": "ThreatIntelligenceIndicator\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Malware_Data_CL",
        "lastDataReceivedQuery": "Malware_Data_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ThreatIntelligenceIndicator\n            | where SourceSystem startswith 'Cofense Intelligence : '\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Malware_Data_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Azure Subscription",
          "description": "Azure Subscription with owner role is required to register an application in azure active directory() and assign role of contributor to app in resource group."
        },
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "**Cofense Username** and **Password** is required.  See the documentation to learn more about API on the [Rest API reference](https://www.threathq.com/docs/rest_api_reference.html)"
        },
        {
          "name": "Microsoft Defender for Endpoints",
          "description": "**Microsoft Defender for Endpoints License** is required for SentinelToDefender function."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Cofense Intelligence APIs to pull its Threat Indicators and create Threat Intelligence Indicators into Microsoft Sentinel Threat Intelligence and create/update Threat Indicators in Cofense. Likewise, it also creates/updates Cofense Based Threat Indicators in Microsoft Defender for Endpoints. All this might result in additional indicator and data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1 - App Registration steps for the Microsoft Azure Active Directory Application**\n\n This integration requires an App registration in the Azure portal. Follow the steps in this section to create a new Azure Active Directory application:\n 1. Sign in to the [Azure portal](https://portal.azure.com/).\n 2. Search for and select **Azure Active Directory**.\n 3. Under **Manage**, select **App registrations > New registration**.\n 4. Enter a display **Name** for your application.\n 5. Select **Register** to complete the initial app registration.\n 6. When registration finishes, the Azure portal displays the app registration's Overview pane. You see the **Application (client) ID** and **Tenant ID**. The client ID and Tenant ID is required as configuration parameters for the execution of CofenseIntelligence Data Connector. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app)"
      },
      {
        "title": "",
        "description": "**STEP 2 - Add a client secret for Microsoft Azure Active Directory Application**\n\n Sometimes called an application password, a client secret is a string value required for the execution of CofenseIntelligence Data Connector. Follow the steps in this section to create a new Client Secret:\n 1. In the Azure portal, in **App registrations**, select your application.\n 2. Select **Certificates & secrets > Client secrets > New client secret**.\n 3. Add a description for your client secret.\n 4. Select an expiration for the secret or specify a custom lifetime. Limit is 24 months.\n 5. Select **Add**. \n 6. *Record the secret's value for use in your client application code. This secret value is never displayed again after you leave this page.* The secret value is required as configuration parameter for the execution of CofenseIntelligence Data Connector. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret)"
      },
      {
        "title": "",
        "description": "**STEP 3 - Assign role of Contributor to Microsoft Azure Active Directory Application**\n\n Follow the steps in this section to assign the role:\n 1. In the Azure portal, Go to **Resource Group** and select your resource group.\n 2. Go to **Access control (IAM)** from left panel.\n 3. Click on **Add**, and then select **Add role assignment**.\n 4. Select **Contributor** as role and click on next.\n 5. In **Assign access to**, select `User, group, or service principal`.\n 6. Click on **add members** and type **your app name** that you have created and select it.\n 7. Now click on **Review + assign** and then again click on **Review + assign**. \n\n> **Reference link:** [https://learn.microsoft.com/azure/role-based-access-control/role-assignments-portal](https://learn.microsoft.com/azure/role-based-access-control/role-assignments-portal)"
      },
      {
        "title": "",
        "description": "**STEP 4 - Assign Defender Threat Indicator permissions to Microsoft Azure Active Directory Application**\n\n Follow the steps in this section to assign the permissions:\n 1. In the Azure portal, in **App registrations**, select **your application**.\n 2. To enable an app to access Defender for Endpoint indicators, assign it **'Ti.ReadWrite.All'** permission, on your application page, select **API Permissions > Add permission > APIs my organization uses >, type WindowsDefenderATP, and then select WindowsDefenderATP**.\n 3. Select **Application permissions > Ti.ReadWrite.All**, and then select **Add permissions**.\n 4. Select **Grant consent**. \n\n> **Reference link:** [https://docs.microsoft.com/microsoft-365/security/defender-endpoint/exposed-apis-create-app-webapp?view=o365-worldwide](https://docs.microsoft.com/microsoft-365/security/defender-endpoint/exposed-apis-create-app-webapp?view=o365-worldwide)"
      },
      {
        "title": "",
        "description": "**STEP 5 - Steps to create/get Credentials for the Cofense Intelligence account** \n\n Follow the steps in this section to create/get **Cofense Username** and **Password**:\n 1. Login to https://threathq.com and go to the **Settings menu** on the left navigation bar.\n 2. Choose the API Tokens tab and select **Add a New Token**\n 3. Make sure to save the **password**, as it will not be accessible again."
      },
      {
        "title": "",
        "description": "**STEP 6 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Cofense Intelligence Threat Indicators data connector, have the  Workspace ID and Workspace Primary Key (can be copied from the following) readily available.., as well as the Cofense API Authorization Key(s).",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the Cofense connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-CofenseIntelligence-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the below information : \n\t\tFunction Name \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tCofense BaseURL (https://<your-cofense-instance-name>/)  \n\t\tCofense Username \n\t\tCofense Password \n\t\tAzure Client ID \n\t\tAzure Client Secret \n\t\tAzure Tenant ID \n\t\tAzure Resource Group Name \n\t\tAzure Workspace Name \n\t\tAzure Subscription ID \n\t\tRequireProxy \n\t\tProxy Username (optional) \n\t\tProxy Password (optional) \n\t\tProxy URL (optional) \n\t\tProxy Port (optional) \n\t\tLogLevel (optional) \n\t\tMalware_Data_Table_name\n\t\tSendCofenseIndicatorToDefender \n\t\tSchedule \n4. Click on **Review+Create**. \n5. Then after validation click on **Create** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the Cofense Intelligence Threat Indicators data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-CofenseIntelligence-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. CofenseXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.11 or above.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following application settings individually, with their respective values (case-sensitive): \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tCofense BaseURL (https://<your-cofense-instance-name>/)  \n\t\tCofense Username \n\t\tCofense Password \n\t\tAzure Client ID \n\t\tAzure Client Secret \n\t\tAzure Tenant ID \n\t\tAzure Resource Group Name \n\t\tAzure Workspace Name \n\t\tFunction App Name \n\t\tAzure Subscription ID \n\t\tRequireProxy \n\t\tProxy Username (optional) \n\t\tProxy Password (optional) \n\t\tProxy URL (optional) \n\t\tProxy Port (optional) \n\t\tLogLevel (optional) \n\t\tMalware_Data_Table_name\n\t\tSendCofenseIndicatorToDefender \n\t\tSchedule \n4. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "CofenseTriage",
    "title": "Cofense Triage Threat Indicators Ingestion",
    "publisher": "Cofense",
    "descriptionMarkdown": "The [Cofense-Triage](https://cofense.com/product-services/cofense-triage/) data connector provides the following capabilities: \n 1. CofenseBasedIndicatorCreator : \n >* Get Threat Indicators from the Cofense Triage platform and create Threat Intelligence Indicators in Microsoft Sentinel. \n > * Ingest Cofense Indicator ID and report links into custom logs table. \n 2. NonCofenseBasedIndicatorCreatorToCofense : \n >* Get Non-Cofense Threat Intelligence Indicators from Microsoft Sentinel Threat Intelligence and create/update Indicators in Cofense Triage platform. \n 3. IndicatorCreatorToDefender : \n >* Get Cofense Triage Threat Intelligence Indicators from Microsoft Sentinel Threat Intelligence and create/update Indicators in Microsoft Defender for Endpoints. \n 4. RetryFailedIndicators : \n >* Get failed indicators from failed indicators files and retry creating/updating Threat Intelligence indicators in Microsoft Sentinel. \n\n\n For more details of REST APIs refer to the below two documentations: \n 1. Cofense API documentation: \n> https://`<your-cofense-instance-name>`/docs/api/v2/index.html \n 2. Microsoft Threat Intelligence Indicator documentation: \n> https://learn.microsoft.com/rest/api/securityinsights/preview/threat-intelligence-indicator \n 3. Microsoft Defender for Endpoints Indicator documentation: \n> https://learn.microsoft.com/microsoft-365/security/defender-endpoint/ti-indicator?view=o365-worldwide",
    "graphQueries": [
      {
        "metricName": "Cofense Triage Threat Indicators data received",
        "legend": "ThreatIntelligenceIndicator | where SourceSystem startswith 'Cofense : '",
        "baseQuery": "ThreatIntelligenceIndicator | where SourceSystem startswith 'Cofense : '"
      },
      {
        "metricName": "Total cofense report links data received",
        "legend": "Report_links_data_CL",
        "baseQuery": "Report_links_data_CL"
      },
      {
        "metricName": "Non-Cofense Triage Threat Indicators data received",
        "legend": "ThreatIntelligenceIndicator | where SourceSystem !startswith 'Cofense : '",
        "baseQuery": "ThreatIntelligenceIndicator | where SourceSystem !startswith 'Cofense : '"
      },
      {
        "metricName": "Total cofense triage failed to create indicators",
        "legend": "Cofense_Triage_failed_indicators_CL",
        "baseQuery": "Cofense_Triage_failed_indicators_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Cofense Based Indicators Events - All Cofense indicators in Microsoft Sentinel Threat Intelligence.",
        "query": "ThreatIntelligenceIndicator\n | where SourceSystem startswith 'Cofense : '\n | sort by TimeGenerated desc"
      },
      {
        "description": "Cofense report links Events - All cofense indicators report links data.",
        "query": "Report_links_data_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Non-Cofense Based Indicators Events - All Non-Cofense indicators in Microsoft Sentinel Threat Intelligence.",
        "query": "ThreatIntelligenceIndicator\n | where SourceSystem !startswith 'Cofense : '\n | sort by TimeGenerated desc"
      },
      {
        "description": "Cofense Triage Failed Indicators - All Cofense triage failed indicators data.",
        "query": "Cofense_Triage_failed_indicators_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "ThreatIntelligenceIndicator",
        "lastDataReceivedQuery": "ThreatIntelligenceIndicator\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Report_links_data_CL",
        "lastDataReceivedQuery": "Report_links_data_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Cofense_Triage_failed_indicators_CL",
        "lastDataReceivedQuery": "Cofense_Triage_failed_indicators_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ThreatIntelligenceIndicator\n            | where SourceSystem startswith 'Cofense : '\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Report_links_data_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "ThreatIntelligenceIndicator\n             | where SourceSystem !startswith 'Cofense : '\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Cofense_Triage_failed_indicators_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Azure Subscription",
          "description": "Azure Subscription with owner role is required to register an application in azure active directory() and assign role of contributor to app in resource group."
        },
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "**Cofense Client ID** and **Client Secret** is required.  See the documentation to learn more about API on the `https://<your-cofense-instance-name>/docs/api/v2/index.html`"
        },
        {
          "name": "Microsoft Defender for Endpoints",
          "description": "**Microsoft Defender for Endpoints License** is required for IndicatorCreatorToDefender function."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Cofense APIs to pull its Threat Indicators and create Threat Intelligence Indicators into Microsoft Sentinel Threat Intelligence and pulls Non-Cofense Threat Intelligence Indicators from Microsoft Sentinel and create/update Threat Indicators in Cofense. Likewise, it also creates/updates Cofense Based Threat Indicators in Microsoft Defender for Endpoints. All this might result in additional indicator and data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1 - App Registration steps for the Microsoft Azure Active Directory Application**\n\n This integration requires an App registration in the Azure portal. Follow the steps in this section to create a new Azure Active Directory application:\n 1. Sign in to the [Azure portal](https://portal.azure.com/).\n 2. Search for and select **Azure Active Directory**.\n 3. Under **Manage**, select **App registrations > New registration**.\n 4. Enter a display **Name** for your application.\n 5. Select **Register** to complete the initial app registration.\n 6. When registration finishes, the Azure portal displays the app registration's Overview pane. You see the **Application (client) ID** and **Tenant ID**. The client ID and Tenant ID is required as configuration parameters for the execution of CofenseTriage Data Connector. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app)"
      },
      {
        "title": "",
        "description": "**STEP 2 - Add a client secret for Microsoft Azure Active Directory Application**\n\n Sometimes called an application password, a client secret is a string value required for the execution of CofenseTriage Data Connector. Follow the steps in this section to create a new Client Secret:\n 1. In the Azure portal, in **App registrations**, select your application.\n 2. Select **Certificates & secrets > Client secrets > New client secret**.\n 3. Add a description for your client secret.\n 4. Select an expiration for the secret or specify a custom lifetime. Limit is 24 months.\n 5. Select **Add**. \n 6. *Record the secret's value for use in your client application code. This secret value is never displayed again after you leave this page.* The secret value is required as configuration parameter for the execution of CofenseTriage Data Connector. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret)"
      },
      {
        "title": "",
        "description": "**STEP 3 - Assign role of Contributor to Microsoft Azure Active Directory Application**\n\n Follow the steps in this section to assign the role:\n 1. In the Azure portal, Go to **Resource Group** and select your resource group.\n 2. Go to **Access control (IAM)** from left panel.\n 3. Click on **Add**, and then select **Add role assignment**.\n 4. Select **Contributor** as role and click on next.\n 5. In **Assign access to**, select `User, group, or service principal`.\n 6. Click on **add members** and type **your app name** that you have created and select it.\n 7. Now click on **Review + assign** and then again click on **Review + assign**. \n\n> **Reference link:** [https://learn.microsoft.com/azure/role-based-access-control/role-assignments-portal](https://learn.microsoft.com/azure/role-based-access-control/role-assignments-portal)"
      },
      {
        "title": "",
        "description": "**STEP 4 - Assign Defender Threat Indicator permissions to Microsoft Azure Active Directory Application**\n\n Follow the steps in this section to assign the permissions:\n 1. In the Azure portal, in **App registrations**, select **your application**.\n 2. To enable an app to access Defender for Endpoint indicators, assign it **'Ti.ReadWrite.All'** permission, on your application page, select **API Permissions > Add permission > APIs my organization uses >, type WindowsDefenderATP, and then select WindowsDefenderATP**.\n 3. Select **Application permissions > Ti.ReadWrite.All**, and then select **Add permissions**.\n 4. Select **Grant consent**. \n\n> **Reference link:** [https://docs.microsoft.com/microsoft-365/security/defender-endpoint/exposed-apis-create-app-webapp?view=o365-worldwide](https://docs.microsoft.com/microsoft-365/security/defender-endpoint/exposed-apis-create-app-webapp?view=o365-worldwide)"
      },
      {
        "title": "",
        "description": "**STEP 5 - Steps to create/get Credentials for the Cofense Triage account** \n\n Follow the steps in this section to create/get **Cofense Client ID** and **Client Secret**:\n 1. Go to **Administration > API Management > Version 2 tab > Applications**\n 2. Click on **New Application**\n 3. Add the required information and click on **submit**."
      },
      {
        "title": "",
        "description": "**STEP 6 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Cofense Triage Threat Indicators data connector, have the  Workspace ID and Workspace Primary Key (can be copied from the following) readily available.., as well as the Cofense API Authorization Key(s).",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the Cofense connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-CofenseTriage-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the below information : \n\t\tFunction Name \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tCofense URL (https://<your-cofense-instance-name>/)  \n\t\tCofense Client ID \n\t\tCofense Client Secret \n\t\tAzure Client ID \n\t\tAzure Client Secret \n\t\tAzure Tenant ID \n\t\tAzure Resource Group Name \n\t\tAzure Workspace Name \n\t\tAzure Subscription ID \n\t\tThreat Level \n\t\tProxy Username (optional) \n\t\tProxy Password (optional) \n\t\tProxy URL (optional) \n\t\tProxy Port (optional) \n\t\tThrottle Limit for Non-Cofense Indicators (optional) \n\t\tLogLevel (optional) \n\t\tReports Table Name \n\t\tSchedule \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the Cofense Triage Threat Indicators data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-CofenseThreatIndicatorsAPI-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. CofenseXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.11 or above.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following application settings individually, with their respective values (case-sensitive): \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tCofense URL (https://<your-cofense-instance-name>/)  \n\t\tCofense Client ID \n\t\tCofense Client Secret \n\t\tAzure Client ID \n\t\tAzure Client Secret \n\t\tAzure Tenant ID \n\t\tAzure Resource Group Name \n\t\tAzure Workspace Name \n\t\tAzure Subscription ID \n\t\tThreat Level \n\t\tProxy Username (optional) \n\t\tProxy Password (optional) \n\t\tProxy URL (optional) \n\t\tProxy Port (optional) \n\t\tThrottle Limit for Non-Cofense Indicators (optional) \n\t\tLogLevel (optional) \n\t\tReports Table Name \n\t\tSchedule \n\t\tlogAnalyticsUri (optional) \n - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n4. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "CognniSentinelDataConnector",
    "title": "Cognni",
    "publisher": "Cognni",
    "descriptionMarkdown": "The Cognni connector offers a quick and simple integration with Microsoft Sentinel. You can use Cognni to autonomously map your previously unclassified important information and detect related incidents. This allows you to recognize risks to your important information, understand the severity of the incidents, and investigate the details you need to remediate, fast enough to make a difference.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CognniIncidents_CL",
        "baseQuery": "CognniIncidents_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get all incidents order by time",
        "query": "CognniIncidents_CL            | order by TimeGenerated desc "
      },
      {
        "description": "Get high risk incidents",
        "query": "CognniIncidents_CL            | where Severity == 3"
      },
      {
        "description": "Get medium risk incidents",
        "query": "CognniIncidents_CL            | where Severity == 2"
      },
      {
        "description": "Get low risk incidents",
        "query": "CognniIncidents_CL            | where Severity == 1"
      }
    ],
    "dataTypes": [
      {
        "name": "CognniIncidents_CL",
        "lastDataReceivedQuery": "CognniIncidents_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CognniIncidents_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Connect to Cognni",
        "description": "1. Go to [Cognni integrations page](https://intelligence.cognni.ai/integrations)\n2. Click **'Connect'** on the 'Microsoft Sentinel' box\n3. Copy and paste **'workspaceId'** and **'sharedKey'** (from below) to the related fields on Cognni's integrations screen\n4. Click the **'Connect'** botton to complete the configuration.  \n  Soon, all your Cognni-detected incidents will be forwarded here (into Microsoft Sentinel)\n\nNot a Cognni user? [Join us](https://azuremarketplace.microsoft.com/en-us/marketplace/apps/shieldox.appsource_freetrial)",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Shared Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ]
  },
  {
    "id": "CognyteLuminar",
    "title": "Luminar IOCs and Leaked Credentials",
    "publisher": "Cognyte Technologies Israel Ltd",
    "descriptionMarkdown": "Luminar IOCs and Leaked Credentials connector allows integration of intelligence-based IOC data and customer-related leaked records identified by Luminar.",
    "graphQueries": [
      {
        "metricName": "Cognyte Luminar Threat Indicators data received",
        "legend": "ThreatIntelligenceIndicator | where SourceSystem contains 'Luminar'",
        "baseQuery": "ThreatIntelligenceIndicator | where SourceSystem contains 'Luminar'"
      },
      {
        "metricName": "Non-Cognyte Luminar Threat Indicators data received",
        "legend": "ThreatIntelligenceIndicator | where SourceSystem !contains 'Luminar'",
        "baseQuery": "ThreatIntelligenceIndicator | where SourceSystem !contains 'Luminar'"
      }
    ],
    "sampleQueries": [
      {
        "description": "Cognyte Luminar Based Indicators Events - All Cognyte Luminar indicators in Microsoft Sentinel Threat Intelligence.",
        "query": "ThreatIntelligenceIndicator\n | where SourceSystem contains 'Luminar'\n | sort by TimeGenerated desc"
      },
      {
        "description": "Non-Cognyte Luminar Based Indicators Events - All Non-Cognyte Luminar indicators in Microsoft Sentinel Threat Intelligence.",
        "query": "ThreatIntelligenceIndicator\n | where SourceSystem !contains 'Luminar'\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "ThreatIntelligenceIndicator",
        "lastDataReceivedQuery": "ThreatIntelligenceIndicator\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ThreatIntelligenceIndicator\n            | where SourceSystem contains 'Luminar'\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Report_links_data_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "ThreatIntelligenceIndicator\n             | where SourceSystem !contains 'Luminar'\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Azure Subscription",
          "description": "Azure Subscription with owner role is required to register an application in azure active directory() and assign role of contributor to app in resource group."
        },
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "**Luminar Client ID**, **Luminar Client Secret** and **Luminar Account ID** are required."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Cognyte Luminar API to pull Luminar IOCs and Leaked Credentials into Microsoft Sentinel. This might result in additional costs for data ingestion and for storing data in Azure Blob Storage costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) and [Azure Blob Storage pricing page](https://azure.microsoft.com/pricing/details/storage/blobs/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template for Flex Consumption Plan",
        "description": "Use this method for automated deployment of the data connector using an ARM Template.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-CognyteLuminar-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Application ID**, **Tenant ID**,**Client Secret**, **Luminar API Client ID**, **Luminar API Account ID**, **Luminar API Client Secret**, **Luminar Initial Fetch Date**, **TimeInterval** and deploy.\n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**.\n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template for Premium Plan",
        "description": "Use this method for automated deployment of the data connector using an ARM Template.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-CognyteLuminar-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Application ID**, **Tenant ID**,**Client Secret**, **Luminar API Client ID**, **Luminar API Account ID**, **Luminar API Client Secret**, **Luminar Initial Fetch Date**, **TimeInterval** and deploy.\n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**.\n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the Cognyte Luminar data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> NOTE:You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-CognyteLuminar-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. CognyteLuminarXXX).\n\n\te. **Select a runtime:** Choose Python 3.11.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\\n\\n1. In the Function App, select the Function App Name and select **Configuration**.\\n2. In the **Application settings** tab, select **+ New application setting**.\\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \\n\\tApplication ID\\n\\tTenant ID\\n\\tClient Secret\\n\\tLuminar API Client ID\\n\\tLuminar API Account ID\\n\\tLuminar API Client Secret\\n\\tLuminar Initial Fetch Date\\n\\tTimeInterval - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`\\n3. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "CohesityDataConnector",
    "title": "Cohesity",
    "publisher": "Cohesity",
    "descriptionMarkdown": "The Cohesity function apps provide the ability to ingest Cohesity Datahawk ransomware alerts into Microsoft Sentinel.",
    "additionalRequirementBanner": ">This data connector depends on two functions apps - [one](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/CohesitySecurity/Data%20Connectors/Helios2Sentinel/IncidentProducer) gets the data about new incidents from Cohesity Datahawk, formats and adds them to the queue; [another one](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/CohesitySecurity/Data%20Connectors/Helios2Sentinel/IncidentConsumer) takes them from the queue and stores in the MS Sentinel Incidents table. The functions have their own configs and depends on Blob storage and KeyVault",
    "graphQueries": [
      {
        "metricName": "Cohesity logs",
        "legend": "Cohesity_CL",
        "baseQuery": "Cohesity_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Cohesity logs",
        "query": "Cohesity_CL\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Cohesity_CL",
        "lastDataReceivedQuery": "Cohesity_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Cohesity_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Azure Blob Storage connection string and container name",
          "description": "Azure Blob Storage connection string and container name"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions that connect to the Azure Blob Storage and KeyVault. This might result in additional costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/), [Azure Blob Storage pricing page](https://azure.microsoft.com/pricing/details/storage/blobs/) and [Azure KeyVault pricing page](https://azure.microsoft.com/pricing/details/key-vault/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1 - Get a Cohesity DataHawk API key (see troubleshooting [instruction 1](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/CohesitySecurity/Data%20Connectors/Helios2Sentinel/IncidentProducer))**"
      },
      {
        "title": "",
        "description": "**STEP 2 - Register Azure app ([link](https://portal.azure.com/#view/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/~/RegisteredApps)) and save Application (client) ID, Directory (tenant) ID, and Secret Value ([instructions](https://learn.microsoft.com/en-us/azure/healthcare-apis/register-application)). Grant it Azure Storage (user_impersonation) permission. Also, assign the 'Microsoft Sentinel Contributor' role to the application in the appropriate subscription.**"
      },
      {
        "title": "",
        "description": "**STEP 3 - Deploy the connector and the associated Azure Functions**."
      },
      {
        "title": "Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the Cohesity data connector using an ARM Template.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-Cohesity-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the parameters that you created at the previous steps\n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**.\n5. Click **Purchase** to deploy."
      }
    ]
  },
  {
    "id": "CommvaultSecurityIQ_CL",
    "title": "CommvaultSecurityIQ",
    "publisher": "Commvault",
    "descriptionMarkdown": "This Azure Function enables Commvault users to ingest alerts/events into their Microsoft Sentinel instance. With Analytic Rules,Microsoft Sentinel can automatically create Microsoft Sentinel incidents from incoming events and logs.",
    "graphQueries": [
      {
        "metricName": "Commvault Events",
        "legend": "Commvault Security IQ Logs",
        "baseQuery": "CommvaultSecurityIQ_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Last 10 events/alerts ",
        "query": "CommvaultSecurityIQ_CL \n| where TimeGenerated > ago(24h) \n| limit 10"
      }
    ],
    "dataTypes": [
      {
        "name": "CommvaultSecurityIQ_CL",
        "lastDataReceivedQuery": "CommvaultSecurityIQ_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommvaultSecurityIQ_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Commvault Environment Endpoint URL",
          "description": "Make sure to follow the documentation and set the secret value in KeyVault"
        },
        {
          "name": "Commvault QSDK Token",
          "description": "Make sure to follow the documentation and set the secret value in KeyVault"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to a Commvault Instance to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the Commvalut QSDK Token**\n\n[Follow these instructions](https://documentation.commvault.com/2024e/essential/creating_access_token.html) to create an API Token."
      },
      {
        "title": "",
        "description": "**STEP 2 - Deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the CommvaultSecurityIQ data connector, have the Workspace ID  and Workspace Primary Key (can be copied from the following), as well as the Commvault Endpoint URL and QSDK Token, readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "",
        "description": "**Azure Resource Manager (ARM) Template**\n\nUse this method for automated deployment of the Commvault Security IQ data connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-CommvaultSecurityIQ-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Region**. \n3. Enter the **Workspace ID**, **Workspace Key** 'and/or Other required fields' and click Next. \n4. Click **Create** to deploy."
      }
    ]
  },
  {
    "id": "ConfluenceAuditAPI",
    "title": "[Deprecated] Atlassian Confluence Audit",
    "publisher": "Atlassian",
    "descriptionMarkdown": "The [Atlassian Confluence](https://www.atlassian.com/software/confluence) Audit data connector provides the capability to ingest [Confluence Audit Records](https://support.atlassian.com/confluence-cloud/docs/view-the-audit-log/) for more information. The connector provides ability to get events which helps to examine potential security risks, analyze your team's use of collaboration, diagnose configuration problems and more.<p><span style='color:red; font-weight:bold;'>NOTE</span>: This data connector has been deprecated, consider moving to the CCP data connector available in the solution which replaces ingestion via the <a href='https://learn.microsoft.com/en-us/azure/azure-monitor/logs/custom-logs-migrate' style='color:#1890F1;'>deprecated HTTP Data Collector API</a>.</p>",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Confluence_Audit_CL",
        "baseQuery": "Confluence_Audit_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Confluence Audit Events - All Activities",
        "query": "ConfluenceAudit\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Confluence_Audit_CL",
        "lastDataReceivedQuery": "Confluence_Audit_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Confluence_Audit_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "**ConfluenceAccessToken**, **ConfluenceUsername** is required for REST API. [See the documentation to learn more about API](https://developer.atlassian.com/cloud/confluence/rest/api-group-audit/). Check all [requirements and follow  the instructions](https://developer.atlassian.com/cloud/confluence/rest/intro/#auth) for obtaining credentials."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Confluence REST API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the Confluence API**\n\n [Follow the instructions](https://developer.atlassian.com/cloud/confluence/rest/intro/#auth) to obtain the credentials. \n"
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Workspace data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following).",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the Confluence Audit data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-confluenceaudit-azuredeploy) [![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://aka.ms/sentinel-confluenceaudit-azuredeploy-gov)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n> **NOTE:** Within the same resource group, you can't mix Windows and Linux apps in the same region. Select existing resource group without Windows apps in it or create new resource group.\n3. Enter the **ConfluenceAccessToken**, **ConfluenceUsername**, **ConfluenceHomeSiteName** (short site name part, as example HOMESITENAME from https://community.atlassian.com) and deploy. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the Confluence Audit data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-confluenceauditapi-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. ConflAuditXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.11.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select ** New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tConfluenceUsername\n\t\tConfluenceAccessToken\n\t\tConfluenceHomeSiteName\n\t\tWorkspaceID\n\t\tWorkspaceKey\n\t\tlogAnalyticsUri (optional)\n> - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n4. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "ConfluenceAuditCCPDefinition",
    "title": " Atlassian Confluence Audit (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The [Atlassian Confluence](https://www.atlassian.com/software/confluence) Audit data connector provides the capability to ingest [Confluence Audit Records](https://support.atlassian.com/confluence-cloud/docs/view-the-audit-log/) events into Microsoft Sentinel through the REST API. Refer to [API documentation](https://support.atlassian.com/confluence-cloud/docs/view-the-audit-log/) for more information. The connector provides ability to get events which helps to examine potential security risks, analyze your team's use of collaboration, diagnose configuration problems and more.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Confluence Audit Events",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Atlassian Confluence Audit logs",
        "query": "{{graphQueriesTableName}}\n| sort by TimeGenerated desc"
      },
      {
        "description": "Total Events",
        "query": "{{graphQueriesTableName}}\n | summarize count() by OriginalEventUid"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}|summarize Time = max  (TimeGenerated)\n|where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "ContrastADR",
    "title": "ContrastADR",
    "publisher": "Contrast Security",
    "descriptionMarkdown": "The ContrastADR data connector provides the capability to ingest Contrast ADR attack events into Microsoft Sentinel using the ContrastADR Webhook. ContrastADR data connector can enrich the incoming webhook data with ContrastADR API enrichment calls.",
    "graphQueries": [
      {
        "metricName": "Attack event Data",
        "legend": "ContrastADR_CL",
        "baseQuery": "ContrastADR_CL"
      },
      {
        "metricName": "Incident event data",
        "legend": "ContrastADRIncident_CL",
        "baseQuery": "ContrastADRIncident_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All ContrastADR Attack event logs",
        "query": "ContrastADR_CL\n| sort by TimeGenerated desc"
      },
      {
        "description": "All ContrastADR incident logs",
        "query": "ContrastADRIncident_CL\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "ContrastADR_CL",
        "lastDataReceivedQuery": "ContrastADR_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ContrastADRIncident_CL",
        "lastDataReceivedQuery": "ContrastADRIncident_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ContrastADR_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "ContrastADRIncident_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "Use these Workspace id and primakey key as shared key in azure function app",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Azure Resource Manager (ARM) Template",
        "description": "Use this method to automate deployment of the ContrastADR Data Connector using ARM Template.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-ContrastADR-azuredeploy)\n2. Provide the following parameters: Region, Function Name, LOG_ANALYTICS_SHARED_KEY, LOG_ANALYTICS_WORKSPACE_ID "
      }
    ]
  },
  {
    "id": "ContrastProtect",
    "title": "[Deprecated] Contrast Protect via Legacy Agent",
    "publisher": "Contrast Security",
    "descriptionMarkdown": "Contrast Protect mitigates security threats in production applications with runtime protection and observability.  Attack event results (blocked, probed, suspicious...) and other information can be sent to Microsoft Microsoft Sentinel to blend with security information from other systems.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ContrastProtect",
        "baseQuery": "CommonSecurityLog\n| where DeviceVendor == \"Contrast Security\""
      }
    ],
    "sampleQueries": [
      {
        "description": "All attacks",
        "query": "let extract_data=(a:string, k:string) {\r\n  parse_urlquery(replace(@';', @'&', a))[\"Query Parameters\"][k]\r\n};\r\nCommonSecurityLog \r\n| where DeviceVendor == 'Contrast Security'\r\n| extend Outcome = replace(@'INEFFECTIVE', @'PROBED', tostring(coalesce(column_ifexists(\"EventOutcome\", \"\"), extract_data(AdditionalExtensions, 'outcome'), \"\")))\r\n| where Outcome != 'success'\r\n| extend Rule = extract_data(AdditionalExtensions, 'pri')\r\n| project TimeGenerated, ApplicationProtocol, Rule, Activity, Outcome, RequestURL, SourceIP\r\n| order by TimeGenerated desc\r\n"
      },
      {
        "description": "Effective attacks",
        "query": "let extract_data=(a:string, k:string) {\n  parse_urlquery(replace(@';', @'&', a))[\"Query Parameters\"][k]\n};\nCommonSecurityLog \n| where DeviceVendor == 'Contrast Security'\n| extend Outcome = tostring(coalesce(column_ifexists(\"EventOutcome\", \"\"), extract_data(AdditionalExtensions, 'outcome'), \"\"))\n| where Outcome in ('EXPLOITED','BLOCKED','SUSPICIOUS')\n| extend Rule = extract_data(AdditionalExtensions, 'pri')\n| project TimeGenerated, ApplicationProtocol, Rule, Activity, Outcome, RequestURL, SourceIP\n| order by TimeGenerated desc\n"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (ContrastProtect)",
        "lastDataReceivedQuery": "CommonSecurityLog\n| where DeviceVendor == \"Contrast Security\"\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n| where DeviceVendor == \"Contrast Security\"\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Common Event Format (CEF) logs to Syslog agent",
        "description": "Configure the Contrast Protect agent to forward events to syslog as described here: https://docs.contrastsecurity.com/en/output-to-syslog.html. Generate some attack events for your application."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "838441a0-8138-4ff4-8a2f-aa86696ceaa4",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Contrast Security"
      },
      "support": {
        "tier": "community",
        "name": "Contrast Security",
        "email": "support@contrastsecurity.com",
        "link": "https://docs.contrastsecurity.com/"
      }
    }
  },
  {
    "id": "ContrastProtectAma",
    "title": "[Deprecated] Contrast Protect via AMA",
    "publisher": "Contrast Security",
    "descriptionMarkdown": "Contrast Protect mitigates security threats in production applications with runtime protection and observability.  Attack event results (blocked, probed, suspicious...) and other information can be sent to Microsoft Microsoft Sentinel to blend with security information from other systems.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ContrastProtect",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Contrast Security'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "All attacks",
        "query": "let extract_data=(a:string, k:string) {\r\n  parse_urlquery(replace(@';', @'&', a))[\"Query Parameters\"][k]\r\n};\r\nCommonSecurityLog \r\n| where DeviceVendor == 'Contrast Security'\r\n| extend Outcome = replace(@'INEFFECTIVE', @'PROBED', tostring(coalesce(column_ifexists(\"EventOutcome\", \"\"), extract_data(AdditionalExtensions, 'outcome'), \"\")))\r\n| where Outcome != 'success'\r\n| extend Rule = extract_data(AdditionalExtensions, 'pri')\r\n| project TimeGenerated, ApplicationProtocol, Rule, Activity, Outcome, RequestURL, SourceIP\r\n| order by TimeGenerated desc\r\n"
      },
      {
        "description": "Effective attacks",
        "query": "let extract_data=(a:string, k:string) {\n  parse_urlquery(replace(@';', @'&', a))[\"Query Parameters\"][k]\n};\nCommonSecurityLog \n| where DeviceVendor == 'Contrast Security'\n| extend Outcome = tostring(coalesce(column_ifexists(\"EventOutcome\", \"\"), extract_data(AdditionalExtensions, 'outcome'), \"\"))\n| where Outcome in ('EXPLOITED','BLOCKED','SUSPICIOUS')\n| extend Rule = extract_data(AdditionalExtensions, 'pri')\n| project TimeGenerated, ApplicationProtocol, Rule, Activity, Outcome, RequestURL, SourceIP\n| order by TimeGenerated desc\n"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (ContrastProtect)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Contrast Security'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'Contrast Security'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine",
                  "instructions": []
                },
                {
                  "title": "Step B. Forward Common Event Format (CEF) logs to Syslog agent",
                  "description": "Configure the Contrast Protect agent to forward events to syslog as described here: https://docs.contrastsecurity.com/en/output-to-syslog.html. Generate some attack events for your application.",
                  "instructions": []
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "838441a0-8138-4ff4-8a2f-aa86696ceaa4",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Contrast Security"
      },
      "support": {
        "tier": "community",
        "name": "Contrast Security",
        "email": "support@contrastsecurity.com",
        "link": "https://docs.contrastsecurity.com/"
      }
    }
  },
  {
    "id": "CorelightConnectorExporter",
    "title": "Corelight Connector Exporter",
    "publisher": "Corelight",
    "descriptionMarkdown": "The [Corelight](https://corelight.com/) data connector enables incident responders and threat hunters who use Microsoft Sentinel to work faster and more effectively. The data connector enables ingestion of events from [Zeek](https://zeek.org/) and [Suricata](https://suricata-ids.org/) via Corelight Sensors into Microsoft Sentinel.",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected [**Corelight**](https://aka.ms/sentinel-Corelight-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Corelight_CL",
        "baseQuery": "Corelight"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Clients (Source IP)",
        "query": "Corelight\n\t| summarize count() by id_orig_h\n\t| top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "corelight_bacnet",
        "lastDataReceivedQuery": "Corelight_v2_bacnet_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_capture_loss",
        "lastDataReceivedQuery": "Corelight_v2_capture_loss_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_cip",
        "lastDataReceivedQuery": "Corelight_v2_cip_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_conn_long",
        "lastDataReceivedQuery": "Corelight_v2_conn_long_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_conn_red",
        "lastDataReceivedQuery": "Corelight_v2_conn_red_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_conn",
        "lastDataReceivedQuery": "Corelight_v2_conn_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_corelight_burst",
        "lastDataReceivedQuery": "Corelight_v2_corelight_burst_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_corelight_overall_capture_loss",
        "lastDataReceivedQuery": "Corelight_v2_corelight_overall_capture_loss_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_corelight_profiling",
        "lastDataReceivedQuery": "Corelight_v2_corelight_profiling_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_datared",
        "lastDataReceivedQuery": "Corelight_v2_datared_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_dce_rpc",
        "lastDataReceivedQuery": "Corelight_v2_dce_rpc_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_dga",
        "lastDataReceivedQuery": "Corelight_v2_dga_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_dhcp",
        "lastDataReceivedQuery": "Corelight_v2_dhcp_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_dnp3",
        "lastDataReceivedQuery": "Corelight_v2_dnp3_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_dns_red",
        "lastDataReceivedQuery": "Corelight_v2_dns_red_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_dns",
        "lastDataReceivedQuery": "Corelight_v2_dns_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_dpd",
        "lastDataReceivedQuery": "Corelight_v2_dpd_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_encrypted_dns",
        "lastDataReceivedQuery": "Corelight_v2_encrypted_dns_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_enip_debug",
        "lastDataReceivedQuery": "Corelight_v2_enip_debug_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_enip_list_identity",
        "lastDataReceivedQuery": "Corelight_v2_enip_list_identity_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_enip",
        "lastDataReceivedQuery": "Corelight_v2_enip_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_etc_viz",
        "lastDataReceivedQuery": "Corelight_v2_etc_viz_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_files_red",
        "lastDataReceivedQuery": "Corelight_v2_files_red_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_files",
        "lastDataReceivedQuery": "Corelight_v2_files_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_ftp",
        "lastDataReceivedQuery": "Corelight_v2_ftp_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_generic_dns_tunnels",
        "lastDataReceivedQuery": "Corelight_v2_generic_dns_tunnels_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_generic_icmp_tunnels",
        "lastDataReceivedQuery": "Corelight_v2_generic_icmp_tunnels_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_http2",
        "lastDataReceivedQuery": "Corelight_v2_http2_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_http_red",
        "lastDataReceivedQuery": "Corelight_v2_http_red_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_http",
        "lastDataReceivedQuery": "Corelight_v2_http_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_icmp_specific_tunnels",
        "lastDataReceivedQuery": "Corelight_v2_icmp_specific_tunnels_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_intel",
        "lastDataReceivedQuery": "Corelight_v2_intel_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_ipsec",
        "lastDataReceivedQuery": "Corelight_v2_ipsec_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_irc",
        "lastDataReceivedQuery": "Corelight_v2_irc_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_iso_cotp",
        "lastDataReceivedQuery": "Corelight_v2_iso_cotp_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_kerberos",
        "lastDataReceivedQuery": "Corelight_v2_kerberos_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_known_certs",
        "lastDataReceivedQuery": "Corelight_v2_known_certs_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_known_devices",
        "lastDataReceivedQuery": "Corelight_v2_known_devices_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_known_domains",
        "lastDataReceivedQuery": "Corelight_v2_known_domains_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_known_hosts",
        "lastDataReceivedQuery": "Corelight_v2_known_hosts_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_known_names",
        "lastDataReceivedQuery": "Corelight_v2_known_names_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_known_remotes",
        "lastDataReceivedQuery": "Corelight_v2_known_remotes_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_known_services",
        "lastDataReceivedQuery": "Corelight_v2_known_services_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_known_users",
        "lastDataReceivedQuery": "Corelight_v2_known_users_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_local_subnets_dj",
        "lastDataReceivedQuery": "Corelight_v2_local_subnets_dj_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_local_subnets_graphs",
        "lastDataReceivedQuery": "Corelight_v2_local_subnets_graphs_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_local_subnets",
        "lastDataReceivedQuery": "Corelight_v2_local_subnets_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_log4shell",
        "lastDataReceivedQuery": "Corelight_v2_log4shell_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_modbus",
        "lastDataReceivedQuery": "Corelight_v2_modbus_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_mqtt_connect",
        "lastDataReceivedQuery": "Corelight_v2_mqtt_connect_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_mqtt_publish",
        "lastDataReceivedQuery": "Corelight_v2_mqtt_publish_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_mqtt_subscribe",
        "lastDataReceivedQuery": "Corelight_v2_mqtt_subscribe_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_mysql",
        "lastDataReceivedQuery": "Corelight_v2_mysql_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_notice",
        "lastDataReceivedQuery": "Corelight_v2_notice_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_ntlm",
        "lastDataReceivedQuery": "Corelight_v2_ntlm_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_ntp",
        "lastDataReceivedQuery": "Corelight_v2_ntp_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_ocsp",
        "lastDataReceivedQuery": "Corelight_v2_ocsp_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_openflow",
        "lastDataReceivedQuery": "Corelight_v2_openflow_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_packet_filter",
        "lastDataReceivedQuery": "Corelight_v2_packet_filter_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_pe",
        "lastDataReceivedQuery": "Corelight_v2_pe_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_profinet_dce_rpc",
        "lastDataReceivedQuery": "Corelight_v2_profinet_dce_rpc_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_profinet_debug",
        "lastDataReceivedQuery": "Corelight_v2_profinet_debug_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_profinet",
        "lastDataReceivedQuery": "Corelight_v2_profinet_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_radius",
        "lastDataReceivedQuery": "Corelight_v2_radius_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_rdp",
        "lastDataReceivedQuery": "Corelight_v2_rdp_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_reporter",
        "lastDataReceivedQuery": "Corelight_v2_reporter_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_rfb",
        "lastDataReceivedQuery": "Corelight_v2_rfb_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_s7comm",
        "lastDataReceivedQuery": "Corelight_v2_s7comm_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_signatures",
        "lastDataReceivedQuery": "Corelight_v2_signatures_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_sip",
        "lastDataReceivedQuery": "Corelight_v2_sip_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_smartpcap_stats",
        "lastDataReceivedQuery": "Corelight_v2_smartpcap_stats_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_smartpcap",
        "lastDataReceivedQuery": "Corelight_v2_smartpcap_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_smb_files",
        "lastDataReceivedQuery": "Corelight_v2_smb_files_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_smb_mapping",
        "lastDataReceivedQuery": "Corelight_v2_smb_mapping_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_smtp_links",
        "lastDataReceivedQuery": "Corelight_v2_smtp_links_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_smtp",
        "lastDataReceivedQuery": "Corelight_v2_smtp_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_snmp",
        "lastDataReceivedQuery": "Corelight_v2_snmp_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_socks",
        "lastDataReceivedQuery": "Corelight_v2_socks_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_software",
        "lastDataReceivedQuery": "Corelight_v2_software_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_specific_dns_tunnels",
        "lastDataReceivedQuery": "Corelight_v2_specific_dns_tunnels_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_ssh",
        "lastDataReceivedQuery": "Corelight_v2_ssh_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_ssl_red",
        "lastDataReceivedQuery": "Corelight_v2_ssl_red_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_ssl",
        "lastDataReceivedQuery": "Corelight_v2_ssl_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_stats",
        "lastDataReceivedQuery": "Corelight_v2_stats_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_stepping",
        "lastDataReceivedQuery": "Corelight_v2_stepping_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_stun_nat",
        "lastDataReceivedQuery": "Corelight_v2_stun_nat_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_stun",
        "lastDataReceivedQuery": "Corelight_v2_stun_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_suricata_corelight",
        "lastDataReceivedQuery": "Corelight_v2_suricata_corelight_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_suricata_eve",
        "lastDataReceivedQuery": "Corelight_v2_suricata_eve_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_suricata_stats",
        "lastDataReceivedQuery": "Corelight_v2_suricata_stats_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_suricata_zeek_stats",
        "lastDataReceivedQuery": "Corelight_v2_suricata_zeek_stats_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_syslog",
        "lastDataReceivedQuery": "Corelight_v2_syslog_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_tds_rpc",
        "lastDataReceivedQuery": "Corelight_v2_tds_rpc_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_tds_sql_batch",
        "lastDataReceivedQuery": "Corelight_v2_tds_sql_batch_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_tds",
        "lastDataReceivedQuery": "Corelight_v2_tds_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_traceroute",
        "lastDataReceivedQuery": "Corelight_v2_traceroute_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_tunnel",
        "lastDataReceivedQuery": "Corelight_v2_tunnel_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "Corelight",
        "lastDataReceivedQuery": "Corelight_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_unknown_smartpcap",
        "lastDataReceivedQuery": "Corelight_v2_unknown_smartpcap_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_util_stats",
        "lastDataReceivedQuery": "Corelight_v2_util_stats_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_vpn",
        "lastDataReceivedQuery": "Corelight_v2_vpn_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_weird_red",
        "lastDataReceivedQuery": "Corelight_v2_weird_red_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_weird_stats",
        "lastDataReceivedQuery": "Corelight_v2_weird_stats_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_weird",
        "lastDataReceivedQuery": "Corelight_v2_weird_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_wireguard",
        "lastDataReceivedQuery": "Corelight_v2_wireguard_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_x509_red",
        "lastDataReceivedQuery": "Corelight_v2_x509_red_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_x509",
        "lastDataReceivedQuery": "Corelight_v2_x509_CL\n\t| summarize Time=max(TimeGenerated)"
      },
      {
        "name": "corelight_zeek_doctor",
        "lastDataReceivedQuery": "Corelight_v2_zeek_doctor_CL\n\t| summarize Time=max(TimeGenerated)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Corelight\n\t| summarize LastLogReceived = max(TimeGenerated)\n\t| project IsConnected = LastLogReceived > ago(30m)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**Corelight**](https://aka.ms/sentinel-Corelight-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "1. Get the files",
        "description": "Contact your TAM, SE, or info@corelight.com to get the files needed for the Microsoft Sentinel integration."
      },
      {
        "title": "2. Replay sample data.",
        "description": "Replay sample data to create the needed tables in your Log Analytics workspace.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId",
                "PrimaryKey"
              ],
              "label": "Send sample data (only needed once per Log Analytics workspace)",
              "value": "./send_samples.py --workspace-id {0} --workspace-key {1}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "3. Install custom exporter.",
        "description": "Install the custom exporter or the logstash container."
      },
      {
        "title": "4. Configure the Corelight Sensor to send logs to the Azure Log Analytics Agent.",
        "description": "Using the following values, configure your Corelight Sensor to use the Microsoft Sentinel exporter. Alternatively, you can configure the logstash container with these values and configure your sensor to send JSON over TCP to that container on the appropriate port.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Workspace Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ]
  },
  {
    "id": "CortexXDRDataConnector",
    "title": "Palo Alto Cortex XDR",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The [Palo Alto Cortex XDR](https://cortex-panw.stoplight.io/docs/cortex-xdr/branches/main/09agw06t5dpvw-cortex-xdr-rest-api) data connector allows ingesting logs from the Palo Alto Cortex XDR API into Microsoft Sentinel. The data connector is built on Microsoft Sentinel Codeless Connector Platform. It uses the Palo Alto Cortex XDR API to fetch logs and it supports DCR-based [ingestion time transformations](https://docs.microsoft.com/azure/azure-monitor/logs/custom-logs-overview) that parses the received security data into a custom table so that queries don't need to parse it again, thus resulting in better performance.",
    "graphQueries": [
      {
        "metricName": "Total incident logs received",
        "legend": "Palo Alto Cortex XDR incident Logs",
        "baseQuery": "PaloAltoCortexXDR_Incidents_CL"
      },
      {
        "metricName": "Total Endpoint logs received",
        "legend": "Palo Alto Cortex XDR endpoint Logs",
        "baseQuery": "PaloAltoCortexXDR_Endpoints_CL"
      },
      {
        "metricName": "Total Audit Management logs received",
        "legend": "Palo Alto Cortex XDR Audit Management Logs",
        "baseQuery": "PaloAltoCortexXDR_Audit_Management_CL"
      },
      {
        "metricName": "Total Agent Audit logs received",
        "legend": "Palo Alto Cortex XDR Agent Audit Logs",
        "baseQuery": "PaloAltoCortexXDR_Audit_Agent_CL"
      },
      {
        "metricName": "Total Alert logs received",
        "legend": "Palo Alto Cortex XDR Alert Logs",
        "baseQuery": "PaloAltoCortexXDR_Alerts_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of Cortex XDR incident logs",
        "query": "PaloAltoCortexXDR_Incidents_CL| take 10"
      },
      {
        "description": "Get Sample of Cortex XDR endpoint logs",
        "query": "PaloAltoCortexXDR_Endpoints_CL| take 10"
      },
      {
        "description": "Get Sample of Cortex XDR alert logs",
        "query": "PaloAltoCortexXDR_Alerts_CL| take 10"
      },
      {
        "description": "Get Sample of Cortex XDR Audit Management logs",
        "query": "PaloAltoCortexXDR_Audit_Management_CL| take 10"
      },
      {
        "description": "Get Sample of Cortex XDR Agent Audit logs",
        "query": "PaloAltoCortexXDR_Audit_Agent_CL| take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "PaloAltoCortexXDR_Incidents_CL",
        "lastDataReceivedQuery": "PaloAltoCortexXDR_Incidents_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "PaloAltoCortexXDR_Endpoints_CL",
        "lastDataReceivedQuery": "PaloAltoCortexXDR_Endpoints_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "PaloAltoCortexXDR_Alerts_CL",
        "lastDataReceivedQuery": "PaloAltoCortexXDR_Alerts_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "PaloAltoCortexXDR_Audit_Management_CL",
        "lastDataReceivedQuery": "PaloAltoCortexXDR_Audit_Management_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "PaloAltoCortexXDR_Audit_Agent_CL",
        "lastDataReceivedQuery": "PaloAltoCortexXDR_Audit_Agent_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "CortexXDRDataConnector",
    "title": "Palo Alto Cortex XDR",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The [Palo Alto Cortex XDR](https://cortex-panw.stoplight.io/docs/cortex-xdr/branches/main/09agw06t5dpvw-cortex-xdr-rest-api) data connector allows ingesting logs from the Palo Alto Cortex XDR API into Microsoft Sentinel. The data connector is built on Microsoft Sentinel Codeless Connector Platform. It uses the Palo Alto Cortex XDR API to fetch logs and it supports DCR-based [ingestion time transformations](https://docs.microsoft.com/azure/azure-monitor/logs/custom-logs-overview) that parses the received security data into a custom table so that queries don't need to parse it again, thus resulting in better performance.",
    "graphQueries": [
      {
        "metricName": "Total incident logs received",
        "legend": "Palo Alto Cortex XDR incident Logs",
        "baseQuery": "PaloAltoCortexXDR_Incidents_CL"
      },
      {
        "metricName": "Total Endpoint logs received",
        "legend": "Palo Alto Cortex XDR endpoint Logs",
        "baseQuery": "PaloAltoCortexXDR_Endpoints_CL"
      },
      {
        "metricName": "Total Audit Management logs received",
        "legend": "Palo Alto Cortex XDR Audit Management Logs",
        "baseQuery": "PaloAltoCortexXDR_Audit_Management_CL"
      },
      {
        "metricName": "Total Agent Audit logs received",
        "legend": "Palo Alto Cortex XDR Agent Audit Logs",
        "baseQuery": "PaloAltoCortexXDR_Audit_Agent_CL"
      },
      {
        "metricName": "Total Alert logs received",
        "legend": "Palo Alto Cortex XDR Alert Logs",
        "baseQuery": "PaloAltoCortexXDR_Alerts_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of Cortex XDR incident logs",
        "query": "PaloAltoCortexXDR_Incidents_CL| take 10"
      },
      {
        "description": "Get Sample of Cortex XDR endpoint logs",
        "query": "PaloAltoCortexXDR_Endpoints_CL| take 10"
      },
      {
        "description": "Get Sample of Cortex XDR alert logs",
        "query": "PaloAltoCortexXDR_Alerts_CL| take 10"
      },
      {
        "description": "Get Sample of Cortex XDR Audit Management logs",
        "query": "PaloAltoCortexXDR_Audit_Management_CL| take 10"
      },
      {
        "description": "Get Sample of Cortex XDR Agent Audit logs",
        "query": "PaloAltoCortexXDR_Audit_Agent_CL| take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "PaloAltoCortexXDR_Incidents_CL",
        "lastDataReceivedQuery": "PaloAltoCortexXDR_Incidents_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "PaloAltoCortexXDR_Endpoints_CL",
        "lastDataReceivedQuery": "PaloAltoCortexXDR_Endpoints_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "PaloAltoCortexXDR_Alerts_CL",
        "lastDataReceivedQuery": "PaloAltoCortexXDR_Alerts_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "PaloAltoCortexXDR_Audit_Management_CL",
        "lastDataReceivedQuery": "PaloAltoCortexXDR_Audit_Management_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "PaloAltoCortexXDR_Audit_Agent_CL",
        "lastDataReceivedQuery": "PaloAltoCortexXDR_Audit_Agent_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "Cribl",
    "title": "Cribl",
    "publisher": "Cribl",
    "descriptionMarkdown": "The [Cribl](https://cribl.io/accelerate-cloud-migration/) connector allows you to easily connect your Cribl (Cribl Enterprise Edition - Standalone) logs with Microsoft Sentinel. This gives you more security insight into your organization's data pipelines.",
    "additionalRequirementBanner": "This data connector depends on four parsers based on a Kusto Function to work as expected [**Cribl Access Logs**](https://aka.ms/sentinel-CriblAccess-parser), [**Cribl UI Access Logs**](https://aka.ms/sentinel-CriblUIAccess-parser), [**Cribl Audit Logs**](https://aka.ms/sentinel-CriblAudit-parser) and [**Cribl Internal Logs**](https://aka.ms/sentinel-CriblInternal-parser) which are deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Cribl Internal Events",
        "legend": "CriblInternal",
        "baseQuery": "CriblInternal_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Cribl Internal Logs",
        "query": "CriblInternal_CL | sort by TimeGenerated"
      },
      {
        "description": "Cribl Audit Logs",
        "query": "CriblAudit_CL | sort by TimeGenerated"
      },
      {
        "description": "Cribl Access Logs",
        "query": "CriblAccess_CL | sort by TimeGenerated"
      },
      {
        "description": "Cribl UI Access Logs",
        "query": "CriblUIAccess_CL | sort by TimeGenerated"
      }
    ],
    "dataTypes": [
      {
        "name": "CriblAccess_CL",
        "lastDataReceivedQuery": "CriblAccess_CL           | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CriblAudit_CL",
        "lastDataReceivedQuery": "CriblAudit_CL            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CriblUIAccess_CL",
        "lastDataReceivedQuery": "CriblUIAccess_CL           | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CriblInternal_CL",
        "lastDataReceivedQuery": "CriblInternal_CL            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CriblInternal_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "CriblAudit_CL\n           | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "CriblAccess_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "CriblUIAccess_CL\n           | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Installation and setup instructions for Cribl Stream for Microsoft Sentinel",
        "description": "Use the documentation from this Github repository and configure Cribl Stream using \n\nhttps://docs.cribl.io/stream/usecase-azure-workspace/"
      }
    ],
    "metadata": {
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "support": {
        "tier": "Partner",
        "name": "Cribl",
        "link": "https://cribl.io/support"
      }
    }
  },
  {
    "id": "CrowdStrikeAPICCPDefinition",
    "title": "CrowdStrike API Data Connector (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The [CrowdStrike Data Connector](https://www.crowdstrike.com/) allows ingesting logs from the CrowdStrike API into Microsoft Sentinel. This connector is built on the Microsoft Sentinel Codeless Connector Platform and uses the CrowdStrike API to fetch logs for Alerts, Detections, Hosts, Incidents, and Vulnerabilities. It supports DCR-based ingestion time transformations so that queries can run more efficiently.",
    "graphQueries": [
      {
        "metricName": "Total Vulnerability logs received",
        "legend": "CrowdStrike Vulnerability Logs",
        "baseQuery": "{{graphQueriesTableName}}"
      },
      {
        "metricName": "Total Alert logs received",
        "legend": "CrowdStrike Alert Logs",
        "baseQuery": "CrowdStrikeAlerts"
      },
      {
        "metricName": "Total Incident logs received",
        "legend": "CrowdStrike Incident Logs",
        "baseQuery": "CrowdStrikeIncidents"
      },
      {
        "metricName": "Total Detection logs received",
        "legend": "CrowdStrike Detection Logs",
        "baseQuery": "CrowdStrikeDetections"
      },
      {
        "metricName": "Total Host logs received",
        "legend": "CrowdStrike Host Logs",
        "baseQuery": "CrowdStrikeHosts"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get sample of CrowdStrike Vulnerability logs",
        "query": "{{graphQueriesTableName}}\n | take 10"
      },
      {
        "description": "Get sample of CrowdStrike Alert logs",
        "query": "CrowdStrikeAlerts\n | take 10"
      },
      {
        "description": "Get sample of CrowdStrike Incident logs",
        "query": "CrowdStrikeIncidents\n | take 10"
      },
      {
        "description": "Get sample of CrowdStrike Detection logs",
        "query": "CrowdStrikeDetections\n | take 10"
      },
      {
        "description": "Get sample of CrowdStrike Host logs",
        "query": "CrowdStrikeHosts\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "CrowdStrikeAlerts",
        "lastDataReceivedQuery": "CrowdStrikeAlerts\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "CrowdStrikeIncidents",
        "lastDataReceivedQuery": "CrowdStrikeIncidents\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "CrowdStrikeDetections",
        "lastDataReceivedQuery": "CrowdStrikeDetections\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "CrowdStrikeHosts",
        "lastDataReceivedQuery": "CrowdStrikeHosts\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "isPreview": true,
      "status": 1
    },
    "metadata": null
  },
  {
    "id": "CrowdStrikeFalconAdversaryIntelligence",
    "title": "CrowdStrike Falcon Adversary Intelligence ",
    "publisher": "CrowdStrike",
    "descriptionMarkdown": "The [CrowdStrike](https://www.crowdstrike.com/) Falcon Indicators of Compromise connector retrieves the Indicators of Compromise from the Falcon Intel API and uploads them [Microsoft Sentinel Threat Intel](https://learn.microsoft.com/en-us/azure/sentinel/understand-threat-intelligence).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Crowdstrike Indicators of Compromise",
        "baseQuery": "ThreatIntelligenceIndicator\n            | where SourceSystem == 'CrowdStrike Falcon Adversary Intelligence'"
      }
    ],
    "sampleQueries": [
      {
        "description": "Threat Intel - Crowdstrike Indicators of Compromise",
        "query": "ThreatIntelligenceIndicator\n | where SourceSystem == 'CrowdStrike Falcon Adversary Intelligence'\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "IndicatorsOfCompromise",
        "lastDataReceivedQuery": "ThreatIntelligenceIndicator\n              | where SourceSystem == 'CrowdStrike Falcon Adversary Intelligence'\n              | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ThreatIntelligenceIndicator\n            | where SourceSystem == 'CrowdStrike Falcon Adversary Intelligence'\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(3d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "CrowdStrike API Client ID and Client Secret",
          "description": "**CROWDSTRIKE_CLIENT_ID**, **CROWDSTRIKE_CLIENT_SECRET**, **CROWDSTRIKE_BASE_URL**. CrowdStrike credentials must have Indicators (Falcon Intelligence) read scope."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "**STEP 1 - [Generate CrowdStrike API credentials](https://www.crowdstrike.com/blog/tech-center/get-access-falcon-apis/).**\n"
      },
      {
        "title": "",
        "description": "Make sure 'Indicators (Falcon Intelligence)' scope has 'read' selected"
      },
      {
        "title": "",
        "description": "**STEP 2 - [Register an Entra App](https://learn.microsoft.com/en-us/entra/identity-platform/quickstart-register-app) with client secret.**\n"
      },
      {
        "title": "",
        "description": "Provide the Entra App principal with 'Microsoft Sentinel Contributor' role assignment on the respective log analytics workspace. [How to assign roles on Azure](https://learn.microsoft.com/en-us/azure/role-based-access-control/role-assignments-portal)."
      },
      {
        "title": "",
        "description": "**STEP 3 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the CrowdStrike Falcon Indicator of Compromise connector, have the Workspace ID (can be copied from the following).",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the CrowdStrike Falcon Adversary Intelligence connector connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-CrowdStrikeFalconAdversaryIntelligence-azuredeploy)\n2. Provide the following parameters: CrowdStrikeClientId, CrowdStrikeClientSecret, CrowdStrikeBaseUrl, WorkspaceId, TenantId, Indicators, AadClientId, AadClientSecret, LookBackDays"
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the CrowdStrike Falcon Adversary Intelligence connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-CrowdStrikeFalconAdversaryIntelligence-Functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. CrowdStrikeFalconIOCXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.12.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select ** New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tCROWDSTRIKE_CLIENT_ID\n\t\tCROWDSTRIKE_CLIENT_SECRET\n\t\tCROWDSTRIKE_BASE_URL\n\t\tTENANT_ID\n\t\tINDICATORS\n\t\tWorkspaceKey\n\t\tAAD_CLIENT_ID\n\t\tAAD_CLIENT_SECRET \n\t\tLOOK_BACK_DAYS \n\t\tWORKSPACE_ID  \n4. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "CrowdStrikeFalconEndpointProtection",
    "title": "[Deprecated] CrowdStrike Falcon Endpoint Protection via Legacy Agent",
    "publisher": "CrowdStrike",
    "descriptionMarkdown": "The [CrowdStrike Falcon Endpoint Protection](https://www.crowdstrike.com/endpoint-security-products/) connector allows you to easily connect your CrowdStrike Falcon Event Stream with Microsoft Sentinel, to create custom dashboards, alerts, and improve investigation. This gives you more insight into your organization's endpoints and improves your security operation capabilities.<p><span style='color:red; font-weight:bold;'>NOTE:</span> This data connector has been deprecated, consider moving to the CCP data connector available in the solution which replaces ingestion via the <a href='https://learn.microsoft.com/en-us/azure/azure-monitor/logs/custom-logs-migrate' style='color:#1890F1;'>deprecated HTTP Data Collector API</a>.</p>",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CrowdStrikeFalconEventStream",
        "baseQuery": "CommonSecurityLog \n| where DeviceVendor == \"CrowdStrike\" and DeviceProduct == \"FalconHost\""
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Hosts with Detections",
        "query": "CrowdStrikeFalconEventStream \n | where EventType == \"DetectionSummaryEvent\" \n| summarize count() by DstHostName \n | top 10 by count_"
      },
      {
        "description": "Top 10 Users with Detections",
        "query": "CrowdStrikeFalconEventStream \n | where EventType == \"DetectionSummaryEvent\" \n| summarize count() by DstUserName \n | top 10 by count_"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog \n| where DeviceVendor == \"CrowdStrike\" and DeviceProduct == \"FalconHost\"\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(3d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (CrowdStrikeFalconEventStream)",
        "lastDataReceivedQuery": "CommonSecurityLog \n| where DeviceVendor == \"CrowdStrike\" and DeviceProduct == \"FalconHost\"\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias Crowd Strike Falcon Endpoint Protection and load the function code or click [here](https://aka.ms/sentinel-crowdstrikefalconendpointprotection-parser), on the second line of the query, enter the hostname(s) of your CrowdStrikeFalcon device(s) and any other unique identifiers for the logstream. The function usually takes 10-15 minutes to activate after solution installation/update.",
        "instructions": []
      },
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward CrowdStrike Falcon Event Stream logs to a Syslog agent",
        "description": "Deploy the CrowdStrike Falcon SIEM Collector to forward Syslog messages in CEF format to your Microsoft Sentinel workspace via the Syslog agent.\n1. [Follow these instructions](https://www.crowdstrike.com/blog/tech-center/integrate-with-your-siem/) to deploy the SIEM Collector and forward syslog\n2. Use the IP address or hostname for the Linux device with the Linux agent installed as the Destination IP address."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "CrowdStrikeFalconEndpointProtectionAma",
    "title": "[Deprecated] CrowdStrike Falcon Endpoint Protection via AMA",
    "publisher": "CrowdStrike",
    "descriptionMarkdown": "The [CrowdStrike Falcon Endpoint Protection](https://www.crowdstrike.com/endpoint-security-products/) connector allows you to easily connect your CrowdStrike Falcon Event Stream with Microsoft Sentinel, to create custom dashboards, alerts, and improve investigation. This gives you more insight into your organization's endpoints and improves your security operation capabilities.<p><span style='color:red; font-weight:bold;'>NOTE:</span> This data connector has been deprecated, consider moving to the CCP data connector available in the solution which replaces ingestion via the <a href='https://learn.microsoft.com/en-us/azure/azure-monitor/logs/custom-logs-migrate' style='color:#1890F1;'>deprecated HTTP Data Collector API</a>.</p>",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CrowdStrikeFalconEventStream",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'CrowdStrike'\n |where DeviceProduct =~ 'FalconHost'\n |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Hosts with Detections",
        "query": "CrowdStrikeFalconEventStream \n | where EventType == \"DetectionSummaryEvent\" \n| summarize count() by DstHostName \n | top 10 by count_"
      },
      {
        "description": "Top 10 Users with Detections",
        "query": "CrowdStrikeFalconEventStream \n | where EventType == \"DetectionSummaryEvent\" \n| summarize count() by DstUserName \n | top 10 by count_"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'CrowdStrike'\n |where DeviceProduct =~ 'FalconHost'\n |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (CrowdStrikeFalconEventStream)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'CrowdStrike'\n |where DeviceProduct =~ 'FalconHost'\n |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias Crowd Strike Falcon Endpoint Protection and load the function code or click [here](https://aka.ms/sentinel-crowdstrikefalconendpointprotection-parser), on the second line of the query, enter the hostname(s) of your CrowdStrikeFalcon device(s) and any other unique identifiers for the logstream. The function usually takes 10-15 minutes to activate after solution installation/update.",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine",
                  "instructions": []
                },
                {
                  "title": "Step B. Forward CrowdStrike Falcon Event Stream logs to a Syslog agent",
                  "description": "Deploy the CrowdStrike Falcon SIEM Collector to forward Syslog messages in CEF format to your Microsoft Sentinel workspace via the Syslog agent.\n1. [Follow these instructions](https://www.crowdstrike.com/blog/tech-center/integrate-with-your-siem/) to deploy the SIEM Collector and forward syslog\n2. Use the IP address or hostname for the Linux device with the Linux agent installed as the Destination IP address.",
                  "instructions": []
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "CrowdStrikeFalconS3CCPDefinition",
    "title": "CrowdStrike Falcon Data Replicator (AWS S3) (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The Crowdstrike Falcon Data Replicator (S3) connector provides the capability to ingest FDR event datainto Microsoft Sentinel from the AWS S3 bucket where the FDR logs have been streamed. The connector provides ability to get events from Falcon Agents which helps to examine potential security risks, analyze your team's use of collaboration, diagnose configuration problems and more.<p><span style='color:red; font-weight:bold;'>NOTE:</span></p><div style='margin-left:20px;'><p>1. CrowdStrike FDR license must be available & enabled.</p><p>2. The connector requires an IAM role to be configured on AWS to allow access to the AWS S3 bucket and may not be suitable for environments that leverage CrowdStrike - managed buckets.</p><p>3. For environments that leverage CrowdStrike-managed buckets, please configure the <strong>CrowdStrike Falcon Data Replicator (CrowdStrike-Managed AWS S3)</strong> connector.</p></div>",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "CrowdStrike Falcon S3 User Logs",
        "baseQuery": "CrowdStrike_User_Events_CL"
      },
      {
        "metricName": "Total events received",
        "legend": "CrowdStrike Falcon S3 Secondary Logs",
        "baseQuery": "CrowdStrike_Secondary_Data_CL"
      },
      {
        "metricName": "Total events received",
        "legend": "CrowdStrike Falcon S3 Additional Logs",
        "baseQuery": "CrowdStrike_Additional_Events_CL"
      },
      {
        "metricName": "Total events received",
        "legend": "CrowdStrike Falcon S3 Auth Logs",
        "baseQuery": "CrowdStrike_Auth_Events_CL"
      },
      {
        "metricName": "Total events received",
        "legend": "CrowdStrike Falcon S3 Registry Logs ",
        "baseQuery": "CrowdStrike_Registry_Events_CL"
      },
      {
        "metricName": "Total events received",
        "legend": "CrowdStrike Falcon S3 Process Logs",
        "baseQuery": "CrowdStrike_Process_Events_CL"
      },
      {
        "metricName": "Total events received",
        "legend": "CrowdStrike Falcon S3 Network Logs",
        "baseQuery": "CrowdStrike_Network_Events_CL"
      },
      {
        "metricName": "Total events received",
        "legend": "CrowdStrike Falcon S3 File Logs",
        "baseQuery": "CrowdStrike_File_Events_CL"
      },
      {
        "metricName": "Total events received",
        "legend": "CrowdStrike Falcon S3 Audit Logs",
        "baseQuery": "CrowdStrike_Audit_Events_CL"
      },
      {
        "metricName": "Total events received",
        "legend": "CrowdStrike Falcon S3 Logs Test",
        "baseQuery": "CrowdStrike_DNS_Events_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of CrowdStrike Falcon S3 Logs",
        "query": "CrowdStrike_User_Events_CL\n | take 10"
      },
      {
        "description": "Get Sample of CrowdStrike Falcon S3 Logs",
        "query": "CrowdStrike_Additional_Events_CL\n | take 10"
      },
      {
        "description": "Get Sample of CrowdStrike Falcon S3 Logs",
        "query": "CrowdStrike_Registry_Events_CL\n | take 10"
      },
      {
        "description": "Get Sample of CrowdStrike Falcon S3 Logs",
        "query": "CrowdStrike_Process_Events_CL\n | take 10"
      },
      {
        "description": "Get Sample of CrowdStrike Falcon S3 Logs",
        "query": "CrowdStrike_Network_Events_CL\n | take 10"
      },
      {
        "description": "Get Sample of CrowdStrike Falcon S3 Logs",
        "query": "CrowdStrike_Audit_Events_CL\n | take 10"
      },
      {
        "description": "Get Sample of CrowdStrike Falcon S3 Logs",
        "query": "CrowdStrike_Auth_Events_CL\n | take 10"
      },
      {
        "description": "Get Sample of CrowdStrike Falcon S3 Logs",
        "query": "CrowdStrike_File_Events_CL\n | take 10"
      },
      {
        "description": "Get Sample of CrowdStrike Falcon S3 Logs",
        "query": "CrowdStrike_Secondary_Data_CL\n | take 10"
      },
      {
        "description": "Get Sample of CrowdStrike Falcon S3 Logs",
        "query": "CrowdStrike_DNS_Events_CL\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "CrowdStrike_User_Events_CL",
        "lastDataReceivedQuery": "CrowdStrike_User_Events_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CrowdStrike_Additional_Events_CL",
        "lastDataReceivedQuery": "CrowdStrike_Additional_Events_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CrowdStrike_Registry_Events_CL",
        "lastDataReceivedQuery": "CrowdStrike_Registry_Events_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CrowdStrike_Process_Events_CL",
        "lastDataReceivedQuery": "CrowdStrike_Process_Events_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CrowdStrike_Network_Events_CL",
        "lastDataReceivedQuery": "CrowdStrike_Network_Events_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CrowdStrike_File_Events_CL",
        "lastDataReceivedQuery": "CrowdStrike_File_Events_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CrowdStrike_DNS_Events_CL",
        "lastDataReceivedQuery": "CrowdStrike_DNS_Events_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CrowdStrike_Auth_Events_CL",
        "lastDataReceivedQuery": "CrowdStrike_Auth_Events_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CrowdStrike_Secondary_Data_CL",
        "lastDataReceivedQuery": "CrowdStrike_Secondary_Data_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CrowdStrike_Audit_Events_CL",
        "lastDataReceivedQuery": "CrowdStrike_Audit_Events_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "CrowdstrikeReplicatorv2",
    "title": "CrowdStrike Falcon Data Replicator (CrowdStrike Managed AWS-S3)",
    "publisher": "Crowdstrike",
    "descriptionMarkdown": "This connector enables the ingestion of FDR data into Microsoft Sentinel using Azure Functions to support the assessment of potential security risks, analysis of collaboration activities, identification of configuration issues, and other operational insights.<p><span style='color:red; font-weight:bold;'>NOTE:</span></p><div style='margin-left:20px;'><p>1. CrowdStrike FDR license must be available & enabled.</p><p>2. The connector uses a Key & Secret based authentication and is suitable for CrowdStrike Managed buckets.</p><p>3. For environments that use a fully owned AWS S3 bucket, Microsoft recommends using the <strong>CrowdStrike Falcon Data Replicator (AWS S3)</strong> connector.</p></div>",
    "additionalRequirementBanner": "These queries and workbooks are dependent on a parser based on Kusto to work as expected. Follow the steps to use this Kusto functions alias **CrowdstrikeReplicator** in queries and workbooks [Follow steps to get this Kusto functions>](https://aka.ms/sentinel-crowdstrikereplicator-parser).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CrowdStrikeReplicatorV2",
        "baseQuery": "CrowdStrikeReplicatorV2"
      }
    ],
    "sampleQueries": [
      {
        "description": "Data Replicator - All Activities",
        "query": "CrowdStrikeReplicatorV2 \n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "CrowdStrike_Additional_Events_CL",
        "lastDataReceivedQuery": "CrowdStrike_Additional_Events_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ASimNetworkSessionLogs",
        "lastDataReceivedQuery": "ASimNetworkSessionLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ASimDnsActivityLogs",
        "lastDataReceivedQuery": "ASimDnsActivityLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ASimAuditEventLogs",
        "lastDataReceivedQuery": "ASimAuditEventLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ASimFileEventLogs",
        "lastDataReceivedQuery": "ASimFileEventLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ASimAuthenticationEventLogs",
        "lastDataReceivedQuery": "ASimAuthenticationEventLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ASimProcessEventLogs",
        "lastDataReceivedQuery": "ASimProcessEventLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ASimRegistryEventLogs",
        "lastDataReceivedQuery": "ASimRegistryEventLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ASimUserManagementActivityLogs",
        "lastDataReceivedQuery": "ASimUserManagementActivityLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CrowdStrike_Secondary_Data_CL",
        "lastDataReceivedQuery": "CrowdStrike_Secondary_Data_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CrowdStrikeReplicatorV2(starttime=ago(3d)) \n    |take 1\n   | project IsConnected = true  "
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "SQS and AWS S3 account credentials/permissions",
          "description": "**AWS_SECRET**, **AWS_REGION_NAME**, **AWS_KEY**, **QUEUE_URL** is required.  [See the documentation to learn more about data pulling](https://www.crowdstrike.com/blog/tech-center/intro-to-falcon-data-replicator/). To start, contact CrowdStrike support. At your request they will create a CrowdStrike managed Amazon Web Services (AWS) S3 bucket for short term storage purposes as well as a SQS (simple queue service) account for monitoring changes to the S3 bucket."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the AWS SQS / S3 to pull logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details.\n\n>**(Optional Step)** Securely store API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "Prerequisites",
        "description": "1. Configure FDR in CrowdStrike - You must contact the [CrowdStrike support team](https://supportportal.crowdstrike.com/) to enable CrowdStrike FDR.\n\t - Once CrowdStrike FDR is enabled,  from the CrowdStrike console, navigate to Support --> API Clients and Keys. \n\t - You need to Create new credentials to copy the AWS Access Key ID, AWS Secret Access Key, SQS Queue URL and AWS Region. \n2.  Register AAD application - For DCR to authentiate to ingest data into log analytics, you must use AAD application. \n\t - [Follow the instructions here](https://learn.microsoft.com/en-us/azure/azure-monitor/logs/tutorial-logs-ingestion-portal#create-azure-ad-application) (steps 1-5) to get **AAD Tenant Id**, **AAD Client Id** and **AAD Client Secret**. \n\t - For **AAD Principal** Id of this application, access the AAD App through [AAD Portal](https://aad.portal.azure.com/#view/Microsoft_AAD_IAM/StartboardApplicationsMenuBlade/~/AppAppsPreview/menuId/) and capture Object Id from the application overview page."
      },
      {
        "title": "Deployment Options",
        "description": "Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function"
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the Crowdstrike Falcon Data Replicator connector V2 using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-CrowdstrikeReplicatorV2-azuredeploy) [![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://aka.ms/sentinel-CrowdstrikeReplicatorV2-azuredeploy-gov) \t\t\t\n2. Provide the required details such as Microsoft Sentinel Workspace, CrowdStrike AWS credentials, Azure AD Application details and ingestion configurations \n> **NOTE:** Within the same resource group, you can't mix Windows and Linux apps in the same region. Select existing resource group without Windows apps in it or create new resource group. It is recommended to create a new Resource Group for deployment of function app and associated resources.\n3. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n4. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the Crowdstrike Falcon Data Replicator connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy DCE, DCR and Custom Tables for data ingestion**\n\n1. Deploy the required DCE,  DCR(s) and the Custom Tables by using the [Data Collection Resource ARM template](https://aka.ms/sentinel-CrowdstrikeReplicatorV2-azuredeploy-data-resource) \n2. After successful deployment of DCE and DCR(s), get the below information and keep it handy (required during Azure Functions app deployment).\n\t - DCE log ingestion - Follow the instructions available at [Create data collection endpoint](https://learn.microsoft.com/en-us/azure/azure-monitor/logs/tutorial-logs-ingestion-portal#create-data-collection-endpoint) (Step 3).\n\t - Immutable Ids of one or more DCRs (as applicable) - Follow the instructions available at [Collect information from the DCR](https://learn.microsoft.com/en-us/azure/azure-monitor/logs/tutorial-logs-ingestion-portal#collect-information-from-the-dcr) (Stpe 2)."
      },
      {
        "title": "",
        "description": "**2. Deploy a Function App**\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-CrowdstrikeReplicatorV2-functionapp) file. Extract archive to your local development computer.\n2. Follow the [function app manual deployment instructions](https://github.com/Azure/Azure-Sentinel/blob/master/DataConnectors/AzureFunctionsManualDeployment.md#function-app-manual-deployment-instructions) to deploy the Azure Functions app using VSCode.\n3. After successful deployment of the function app, follow next steps for configuring it."
      },
      {
        "title": "",
        "description": "**3. Configure the Function App**\n\n1. Go to Azure Portal for the Function App configuration.\n2. In the Function App, select the Function App Name and select **Configuration**.\n3. In the **Application settings** tab, select ** New application setting**.\n4. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tAWS_KEY\n\t\tAWS_SECRET\n\t\tAWS_REGION_NAME\n\t\tQUEUE_URL\n\t\tUSER_SELECTION_REQUIRE_RAW //True if raw data is required\n\t\tUSER_SELECTION_REQUIRE_SECONDARY //True if secondary data is required\n\t\tMAX_QUEUE_MESSAGES_MAIN_QUEUE // 100 for consumption and 150 for Premium\n\t\tMAX_SCRIPT_EXEC_TIME_MINUTES // add the value of 10 here\n\t\tAZURE_TENANT_ID\n\t\tAZURE_CLIENT_ID\n\t\tAZURE_CLIENT_SECRET\n\t\tDCE_INGESTION_ENDPOINT\n\t\tNORMALIZED_DCR_ID\n\t\tRAW_DATA_DCR_ID\n\t\tEVENT_TO_TABLE_MAPPING_LINK // File is present on github. Add if the file can be accessed using internet\n\t\tREQUIRED_FIELDS_SCHEMA_LINK //File is present on github. Add if the file can be accessed using internet\n\t\tSchedule //Add value as '0 */1 * * * *' to ensure the function runs every minute.\n5. Once all application settings have been entered, click **Save**."
      }
    ],
    "metadata": {
      "version": "1.0.1"
    }
  },
  {
    "id": "CTERA",
    "title": "CTERA Syslog",
    "publisher": "CTERA Networks Ltd",
    "descriptionMarkdown": "The CTERA Data Connector for Microsoft Sentinel offers monitoring and threat detection capabilities for your CTERA solution.\n It includes a workbook visualizing the sum of all operations per type, deletions, and denied access operations.\n It also provides analytic rules which detects ransomware incidents and alert you when a user is blocked due to suspicious ransomware activity.\n Additionally, it helps you identify critical patterns such as mass access denied events, mass deletions, and mass permission changes, enabling proactive threat management and response.",
    "additionalRequirementBanner": "None",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "CTERA Events",
        "baseQuery": "Syslog"
      }
    ],
    "sampleQueries": [
      {
        "description": "Query to find all denied operations.",
        "query": "Syslog\n| where ProcessName == 'gw-audit'\n| extend TenantName = extract(\"(\\\"vportal\\\":\\\"[^\\\"]*\\\")\", 1, SyslogMessage), UserName = extract(\"(user=[^|]*)\", 1, SyslogMessage)\n| extend Permission = extract(\"(op=[^|]*)\", 1, SyslogMessage)\n| where Permission matches regex @\"(?i).*denied.*\"\n| summarize Count = count() by Permission"
      },
      {
        "description": "Query to find all delete operations.",
        "query": "Syslog\n| where ProcessName == 'gw-audit'\n| extend TenantName = extract(\"(\\\"vportal\\\":\\\"[^\\\"]*\\\")\", 1, SyslogMessage), UserName = extract(\"(user=[^|]*)\", 1, SyslogMessage)\n| extend Permission = extract(\"(op=[^|]*)\", 1, SyslogMessage)\n| where Permission == \"op=delete\"\n| summarize Count = count() by Permission"
      },
      {
        "description": "Query to summarize operations by user.",
        "query": "Syslog\n| where ProcessName == 'gw-audit'\n| extend TenantName = extract(\"(\\\"vportal\\\":\\\"[^\\\"]*\\\")\", 1, SyslogMessage), UserName = extract(\"(user=[^|]*)\", 1, SyslogMessage)\n| extend Permission = extract(\"(op=[^|]*)\", 1, SyslogMessage)\n| summarize Count = count() by UserName, Permission"
      },
      {
        "description": "Query to summarize operations by a portal tenant.",
        "query": "Syslog\n| where ProcessName == 'gw-audit'\n| extend TenantName = extract(\"(\\\"vportal\\\":\\\"[^\\\"]*\\\")\", 1, SyslogMessage), UserName = extract(\"(user=[^|]*)\", 1, SyslogMessage)\n| extend Permission = extract(\"(op=[^|]*)\", 1, SyslogMessage)\n| summarize Count = count() by TenantName, Permission"
      },
      {
        "description": "Query to find operations performed by a specific user.",
        "query": "Syslog\n| where ProcessName == 'gw-audit'\n| extend TenantName = extract(\"(\\\"vportal\\\":\\\"[^\\\"]*\\\")\", 1, SyslogMessage), UserName = extract(\"(user=[^|]*)\", 1, SyslogMessage)\n| extend Permission = extract(\"(op=[^|]*)\", 1, SyslogMessage)\n| where UserName == 'user=specific_user'\n| summarize Count = count() by Permission"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Syslog\n   | where TimeGenerated > ago(3d)\n   | where SyslogMessage contains \"gw-audit[-]:\" or SyslogMessage contains \"portal portal[-]:\"\n   | take 1\n   | project IsConnected = true"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog (CTERA)",
        "lastDataReceivedQuery": "Syslog\n   | where SyslogMessage contains \"gw-audit[-]:\" or SyslogMessage contains \"portal portal[-]:\"\n   | summarize Time = max(TimeGenerated)\n   | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "write permission is required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Step 1: Connect CTERA Platform to Syslog",
        "description": "Set up your CTERA portal syslog connection and Edge-Filer Syslog connector",
        "instructions": [
          {
            "parameters": {
              "title": "CTERA Syslog Configuration",
              "instructionSteps": [
                {
                  "title": "Portal Syslog connection",
                  "description": "Connect CTERA Portal to syslog server, see instructions https://kb.ctera.com/v1/docs/en/managing-log-settings?highlight=logg"
                },
                {
                  "title": "Edge Filer Audit logs",
                  "description": "Enable Audit logs on the desired Edge-filers"
                },
                {
                  "title": "Edge-Filer Syslog Service",
                  "description": "Enable Edge-Filer Syslog service, see instructions https://kb.ctera.com/v1/docs/en/setting-up-the-edge-filer-syslog-service-2?highlight=Edge%20Filer%20Syslog"
                }
              ]
            }
          }
        ]
      },
      {
        "title": "Step 2: Install Azure Monitor Agent (AMA) on Syslog Server",
        "description": "Install the Azure Monitor Agent (AMA) on your syslog server to enable data collection.",
        "instructions": [
          {
            "parameters": {
              "title": "Install Azure Monitor Agent",
              "instructionSteps": [
                {
                  "title": "Log in to Azure Portal",
                  "description": "Use your Azure credentials to log in to the Azure Portal."
                },
                {
                  "title": "Navigate to Azure Arc",
                  "description": "In the Azure Portal, go to 'Azure Arc' and select your connected syslog server."
                },
                {
                  "title": "Select Extensions",
                  "description": "In the Azure Arc settings for your syslog server, navigate to the 'Extensions' section."
                },
                {
                  "title": "Add Extension",
                  "description": "Click on 'Add' and select 'Azure Monitor Agent' from the list of available extensions."
                },
                {
                  "title": "Install AMA",
                  "description": "Follow the prompts to install the Azure Monitor Agent on your syslog server. For detailed instructions, refer to the official documentation: [Install Azure Monitor Agent](https://learn.microsoft.com/en-us/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal)"
                }
              ]
            }
          }
        ]
      }
    ]
  },
  {
    "id": "CyberArk",
    "title": "[Deprecated] CyberArk Enterprise Password Vault (EPV) Events via Legacy Agent",
    "publisher": "Cyber-Ark",
    "descriptionMarkdown": "CyberArk Enterprise Password Vault generates an xml Syslog message for every action taken against the Vault.  The EPV will send the xml messages through the Microsoft Sentinel.xsl translator to be converted into CEF standard format and sent to a syslog staging server of your choice (syslog-ng, rsyslog). The Log Analytics agent installed on your syslog staging server will import the messages into Microsoft Log Analytics. Refer to the [CyberArk documentation](https://docs.cyberark.com/Product-Doc/OnlineHelp/PAS/Latest/en/Content/PASIMP/DV-Integrating-with-SIEM-Applications.htm) for more guidance on SIEM integrations.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CyberArk",
        "baseQuery": "CommonSecurityLog\n| where DeviceVendor == \"Cyber-Ark\"\n| where DeviceProduct == \"Vault\""
      }
    ],
    "sampleQueries": [
      {
        "description": "CyberArk Alerts",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"Cyber-Ark\"\n| where DeviceProduct == \"Vault\"\n| where LogSeverity == \"7\" or LogSeverity == \"10\"\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (CyberArk)",
        "lastDataReceivedQuery": "CommonSecurityLog\n| where DeviceVendor == \"Cyber-Ark\"\n| where DeviceProduct == \"Vault\"\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n| where DeviceVendor == \"Cyber-Ark\"\n| where DeviceProduct == \"Vault\"\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python installed on your machine.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Common Event Format (CEF) logs to Syslog agent",
        "description": "On the EPV configure the dbparm.ini to send Syslog messages in CEF format to the proxy machine. Make sure you to send the logs to port 514 TCP on the machines IP address."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python installed on your machine using the following command: python -version\n\n>\n\n> 2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machines security according to your organizations security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "1c45e738-21dd-4fcd-9449-e2c9478e9552",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Cyberark"
      },
      "support": {
        "name": "Cyberark",
        "link": "https://www.cyberark.com/customer-support/",
        "tier": "developer"
      }
    }
  },
  {
    "id": "CyberArkAma",
    "title": "[Deprecated] CyberArk Privilege Access Manager (PAM) Events via AMA",
    "publisher": "Cyber-Ark",
    "descriptionMarkdown": "CyberArk Privilege Access Manager generates an xml Syslog message for every action taken against the Vault.  The PAM will send the xml messages through the Microsoft Sentinel.xsl translator to be converted into CEF standard format and sent to a syslog staging server of your choice (syslog-ng, rsyslog). The Log Analytics agent installed on your syslog staging server will import the messages into Microsoft Log Analytics. Refer to the [CyberArk documentation](https://docs.cyberark.com/privilege-cloud-standard/Latest/en/Content/Privilege%20Cloud/privCloud-connect-siem.htm) for more guidance on SIEM integrations.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CyberArk",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Cyber-Ark'\n |where DeviceProduct =~ 'Vault'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "CyberArk Alerts",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"Cyber-Ark\"\n| where DeviceProduct == \"Vault\"\n| where LogSeverity == \"7\" or LogSeverity == \"10\"\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (CyberArk)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Cyber-Ark'\n |where DeviceProduct =~ 'Vault'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'Cyber-Ark'\n |where DeviceProduct =~ 'Vault'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine",
                  "instructions": []
                },
                {
                  "title": "Step B. Forward Common Event Format (CEF) logs to Syslog agent",
                  "description": "On the EPV configure the dbparm.ini to send Syslog messages in CEF format to the proxy machine. Make sure you to send the logs to port 514 TCP on the machines IP address.",
                  "instructions": []
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machines security according to your organizations security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "1c45e738-21dd-4fcd-9449-e2c9478e9552",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Cyberark"
      },
      "support": {
        "name": "Cyberark",
        "link": "https://www.cyberark.com/customer-support/",
        "tier": "developer"
      }
    }
  },
  {
    "id": "CyberArkAudit",
    "title": "CyberArkAudit",
    "publisher": "CyberArk",
    "descriptionMarkdown": "The [CyberArk Audit](https://docs.cyberark.com/Audit/Latest/en/Content/Resources/_TopNav/cc_Home.htm) data connector provides the capability to retrieve security event logs of the CyberArk Audit service and more events into Microsoft Sentinel through the REST API. The connector provides ability to get events which helps to examine potential security risks, analyze your team's use of collaboration, diagnose configuration problems and more.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CyberArk_AuditEvents_CL",
        "baseQuery": "CyberArk_AuditEvents_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "CyberArk Audit Events - All Activities.",
        "query": "CyberArkAudit\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "CyberArk_AuditEvents_CL",
        "lastDataReceivedQuery": "CyberArk_AuditEvents_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CyberArk_AuditEvents_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Audit REST API Connections details and Credentials",
          "description": "**OauthUsername**, **OauthPassword**, **WebAppID**, **AuditApiKey**, **IdentityEndpoint** and **AuditApiBaseUrl** are required for making API calls."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Azure Blob Storage API to pull logs into Microsoft Sentinel. This might result in additional costs for data ingestion and for storing data in Azure Blob Storage costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) and [Azure Blob Storage pricing page](https://azure.microsoft.com/pricing/details/storage/blobs/) for details."
      },
      {
        "title": "",
        "description": ">**NOTE:** API authorization key(s) or token(s) are securely stored in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the CyberArk Audit SIEM Integration**\n\n Follow the [instructions](https://docs.cyberark.com/audit/latest/en/Content/Audit/isp_Microsoft_Sentinel.htm?tocpath=SIEM%20integrations%7C_____3) to obtain connection details and credentials."
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the CyberArk Audit data connector, have the Workspace Name and Workspace Location (can be copied from the following).",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceName"
              ],
              "label": "Workspace Name"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "WorkspaceLocation"
              ],
              "label": "Workspace Location"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the CyberArk Audit data connector using an ARM Template.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-CyberArkAuditAPI-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n> **NOTE:** Within the same resource group, you can't mix Windows and Linux apps in the same region. Select existing resource group without Windows apps in it or create new resource group.\n3. Enter the **CyberArkAuditUsername**, **CyberArkAuditPassword**, **CyberArkAuditServerURL**  and deploy. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the CyberArk Audit data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-CyberArkAudit-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. CyberArkXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.10.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select ** New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tCyberArkAuditUsername\n\t\tCyberArkAuditPassword\n\t\tCyberArkAuditServerURL\n\t\tWorkspaceID\n\t\tWorkspaceKey\n\t\tlogAnalyticsUri (optional)\n> - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n4. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "CyberpionSecurityLogs",
    "title": "IONIX Security Logs",
    "publisher": "IONIX",
    "descriptionMarkdown": "The IONIX Security Logs data connector, ingests logs from the IONIX system directly into Sentinel. The connector allows users to visualize their data, create alerts and incidents and improve security investigations.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CyberpionActionItems_CL",
        "baseQuery": "CyberpionActionItems_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Fetch latest Action Items that are currently open",
        "query": "let lookbackTime = 14d;\nlet maxTimeGeneratedBucket = toscalar(\n   CyberpionActionItems_CL \n   | where TimeGenerated > ago(lookbackTime)\n   | summarize max(bin(TimeGenerated, 1h))\n   );\nCyberpionActionItems_CL\n | where TimeGenerated > ago(lookbackTime) and is_open_b == true\n | where bin(TimeGenerated, 1h) == maxTimeGeneratedBucket\n "
      }
    ],
    "dataTypes": [
      {
        "name": "CyberpionActionItems_CL",
        "lastDataReceivedQuery": "CyberpionActionItems_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CyberpionActionItems_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "IONIX Subscription",
          "description": "a subscription and account is required for IONIX logs. [One can be acquired here.](https://azuremarketplace.microsoft.com/en/marketplace/apps/cyberpion1597832716616.cyberpion)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "Follow the [instructions](https://www.ionix.io/integrations/azure-sentinel/) to integrate IONIX Security Alerts into Sentinel.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ]
  },
  {
    "id": "CybersixgillActionableAlerts",
    "title": "Cybersixgill Actionable Alerts",
    "publisher": "Cybersixgill",
    "descriptionMarkdown": "Actionable alerts provide customized alerts based on configured assets",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CyberSixgill_Alerts_CL",
        "baseQuery": "CyberSixgill_Alerts_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Alerts",
        "query": "CyberSixgill_Alerts_CL"
      }
    ],
    "dataTypes": [
      {
        "name": "CyberSixgill_Alerts_CL",
        "lastDataReceivedQuery": "CyberSixgill_Alerts_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CyberSixgill_Alerts_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "**Client_ID** and **Client_Secret** are required for making API calls."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Cybersixgill API to pull Alerts into Microsoft Sentinel. This might result in additional costs for data ingestion and for storing data in Azure Blob Storage costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) and [Azure Blob Storage pricing page](https://azure.microsoft.com/pricing/details/storage/blobs/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the Cybersixgill Actionable Alerts data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/senitnel-cybersixgill-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace ID**, **Workspace Key**, **Client ID**, **Client Secret**, **TimeInterval** and deploy. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the Cybersixgill Actionable Alerts data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> NOTE:You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Cybersixgill-Actionable-Alerts/Data%20Connectors/CybersixgillAlerts.zip?raw=true) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. CybersixgillAlertsXXX).\n\n\te. **Select a runtime:** Choose Python 3.11.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tClientID\n\t\tClientSecret\n\t\tPolling\n\t\tWorkspaceID\n\t\tWorkspaceKey\n\t\tlogAnalyticsUri (optional)\n - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`\n3. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "CyborgSecurity_HUNTER",
    "title": "Cyborg Security HUNTER Hunt Packages",
    "publisher": "Cyborg Security",
    "descriptionMarkdown": "Cyborg Security is a leading provider of advanced threat hunting solutions, with a mission to empower organizations with cutting-edge technology and collaborative tools to proactively detect and respond to cyber threats. Cyborg Security's flagship offering, the HUNTER Platform, combines powerful analytics, curated threat hunting content, and comprehensive hunt management capabilities to create a dynamic ecosystem for effective threat hunting operations.\n\nFollow the steps to gain access to Cyborg Security's Community and setup the 'Open in Tool' capabilities in the HUNTER Platform.",
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "graphQueries": [
      {
        "metricName": "Total SecurityEvents received",
        "legend": "SecurityEvent",
        "baseQuery": "SecurityEvent"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Alerts",
        "query": "SecurityEvent"
      }
    ],
    "dataTypes": [
      {
        "name": "SecurityEvents",
        "lastDataReceivedQuery": "SecurityEvent\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "SecurityEvent\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "instructions": [
          {
            "parameters": {
              "text": "Use the following link to find your Azure Tentant ID <a href=\"https://learn.microsoft.com/en-us/azure/active-directory/fundamentals/how-to-find-tenant\">How to find your Azure Active Directory tenant ID</a>",
              "visible": true,
              "inline": true
            },
            "type": "InfoMessage"
          },
          {
            "parameters": {
              "fillWith": [
                "workspaceName"
              ],
              "label": "ResourceGroupName & WorkspaceName",
              "value": "{0}"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "WorkspaceID",
              "value": "{0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "1. Sign up for Cyborg Security's HUNTER Community Account",
        "description": "Cyborg Security offers Community Memebers access to a subset of the Emerging Threat Collections and hunt packages.\n\nCreate a Free Commuinity Account to get access to Cyborg Security's Hunt Packages: [Sign Up Now!](https://www.cyborgsecurity.com/user-account-creation/)"
      },
      {
        "title": "2. Configure the Open in Tool Feature",
        "description": "\n\n1.  Navigate to the [Environment](https://hunter.cyborgsecurity.io/environment) section of the HUNTER Platform.\n2.  Fill in te **Root URI** of your environment in the section labeled **Microsoft Sentinel**. Replace the <bolded items> with the IDs and Names of your Subscription, Resource Groups and Workspaces.\n\n    https[]()://portal.azure.com#@**AzureTenantID**/blade/Microsoft_OperationsManagementSuite_Workspace/Logs.ReactView/resourceId/%2Fsubscriptions%2F**AzureSubscriptionID**%2Fresourcegroups%2F**ResourceGroupName**%2Fproviders%2Fmicrosoft.operationalinsights%2Fworkspaces%2F<**WorkspaceName**>/\n3.  Click **Save**."
      },
      {
        "title": "3. Execute a HUNTER hunt pacakge in Microsoft Sentinel",
        "description": "\n\nIdentify a Cyborg Security HUNTER hunt package to deploy and use the **Open In Tool** button to quickly open Microsoft Sentinel and stage the hunting content.\n\n![image](https://7924572.fs1.hubspotusercontent-na1.net/hubfs/7924572/HUNTER/Screenshots/openintool-ms-new.png)"
      }
    ]
  },
  {
    "id": "CyeraDSPMCCF",
    "title": "Cyera DSPM Azure Sentinel Data Connector",
    "publisher": "Cyera Inc",
    "descriptionMarkdown": "The [Cyera DSPM](https://api.cyera.io/) data connector allows you to connect to your Cyera's DSPM tenant and ingesting Classifications, Assets, Issues, and Identity Resources/Definitions into Microsoft Sentinel. The data connector is built on Microsoft Sentinel's Codeless Connector Framework and uses the Cyera's API to fetch Cyera's [DSPM Telemetry](https://www.cyera.com/) once recieced can be correlated with security events creating custom columns so that queries don't need to parse it again, thus resulting in better performance.",
    "graphQueries": [
      {
        "baseQuery": "CyeraClassifications_CL",
        "legend": "Total Cyera Classification Records",
        "metricName": "cyera_functions_classifications"
      },
      {
        "baseQuery": "CyeraAssets_CL",
        "legend": "Total Cyera Assets Records",
        "metricName": "cyera_functions_assets"
      },
      {
        "baseQuery": "CyeraAssets_MS_CL",
        "legend": "Total Cyera Asset MS Records",
        "metricName": "cyera_functions_assets_ms"
      },
      {
        "baseQuery": "CyeraIssues_CL",
        "legend": "Total Cyera Issue Records",
        "metricName": "cyera_functions_issues"
      },
      {
        "baseQuery": "CyeraIdentities_CL",
        "legend": "Total Cyera Identities Records",
        "metricName": "cyera_functions_identities"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of Cyera DSPM Classification Definitions",
        "query": "CyeraClassifications_CL | take 10"
      },
      {
        "description": "Get Sample of Cyera DSPM Datastore Assets",
        "query": "CyeraAssets_CL | take 10"
      },
      {
        "description": "Get Sample of Cyera DSPM Table Assets",
        "query": "CyeraAssets_MS_CL | take 10"
      },
      {
        "description": "Get Sample of Cyera DSPM Issues Identified",
        "query": "CyeraIssues_CL | take 10"
      },
      {
        "description": "Get Sample of Cyera DSPM Identities",
        "query": "CyeraIdentities_CL | take 10"
      }
    ],
    "dataTypes": [
      {
        "lastDataReceivedQuery": "CyeraClassifications_CL\n       | where TimeGenerated > ago(48h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)",
        "name": "CyeraClassifications_CL"
      },
      {
        "lastDataReceivedQuery": "CyeraAssets_CL\n       | where TimeGenerated > ago(48h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)",
        "name": "CyeraAssets_CL"
      },
      {
        "lastDataReceivedQuery": "CyeraAssets_MS_CL\n       | where TimeGenerated > ago(48h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)",
        "name": "CyeraAssets_MS_CL"
      },
      {
        "lastDataReceivedQuery": "CyeraIssues_CL\n       | where TimeGenerated > ago(48h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)",
        "name": "CyeraIssues_CL"
      },
      {
        "lastDataReceivedQuery": "CyeraIdentities_CL\n       | where TimeGenerated > ago(48h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)",
        "name": "CyeraIdentities_CL"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "isPreview": false,
      "status": 1
    },
    "metadata": null
  },
  {
    "id": "CyeraFunctionsConnector",
    "title": "Cyera DSPM Azure Functions Sentinel Data Connector",
    "publisher": "Cyera Inc",
    "logo": "{{icon-url}}",
    "descriptionMarkdown": "The **Cyera DSPM Azure Function Connector** enables seamless ingestion of Cyeras **Data Security Posture Management (DSPM)** telemetry  *Assets*, *Identities*, *Issues*, and *Classifications*  into **Microsoft Sentinel**.\\n\\nThis connector uses an **Azure Function App** to call Cyeras REST API on a schedule, fetch the latest DSPM telemetry, and send it to Sentinel through the **Azure Monitor Logs Ingestion API** via a **Data Collection Endpoint (DCE)** and **Data Collection Rule (DCR, kind: Direct)**  no agents required.\\n\\n**Tables created/used**\\n\\n| Entity | Table | Purpose |\\n|---|---|---|\\n| Assets | `CyeraAssets_CL` | Raw asset metadata and data-store context |\\n| Identities | `CyeraIdentities_CL` | Identity definitions and sensitivity context |\\n| Issues | `CyeraIssues_CL` | Findings and remediation details |\\n| Classifications | `CyeraClassifications_CL` | Data class & sensitivity definitions |\\n| MS View | `CyeraAssets_MS_CL` | Normalized asset view for dashboards |\\n\\n> **Note:** This v7 connector supersedes the earlier CCF-based approach and aligns with Microsofts recommended Direct ingestion path for Sentinel.",
    "additionalRequirementBanner": "This connector deploys KQL transforms in the DCR. No parser function is required.",
    "graphQueries": [
      {
        "metricName": "cyera_functions_classifications",
        "legend": "Total Cyera Classification Records",
        "baseQuery": "CyeraClassifications_CL"
      },
      {
        "metricName": "cyera_functions_assets",
        "legend": "Total Cyera Assets Records",
        "baseQuery": "CyeraAssets_CL"
      },
      {
        "metricName": "cyera_functions_assets_ms",
        "legend": "Total Cyera Asset MS Records",
        "baseQuery": "CyeraAssets_MS_CL"
      },
      {
        "metricName": "cyera_functions_issues",
        "legend": "Total Cyera Issue Records",
        "baseQuery": "CyeraIssues_CL"
      },
      {
        "metricName": "cyera_functions_identities",
        "legend": "Total Cyera Identities Records",
        "baseQuery": "CyeraIdentities_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of Cyera DSPM Classification Definitions",
        "query": "CyeraClassifications_CL | take 10"
      },
      {
        "description": "Get Sample of Cyera DSPM Datastore Assets",
        "query": "CyeraAssets_CL | take 10"
      },
      {
        "description": "Get Sample of Cyera DSPM Table Assets",
        "query": "CyeraAssets_MS_CL | take 10"
      },
      {
        "description": "Get Sample of Cyera DSPM Issues Identified",
        "query": "CyeraIssues_CL | take 10"
      },
      {
        "description": "Get Sample of Cyera DSPM Identities",
        "query": "CyeraIdentities_CL | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "CyeraClassifications_CL",
        "lastDataReceivedQuery": "CyeraClassifications_CL\n       | where TimeGenerated > ago(48h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CyeraAssets_CL",
        "lastDataReceivedQuery": "CyeraAssets_CL\n       | where TimeGenerated > ago(48h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CyeraAssets_MS_CL",
        "lastDataReceivedQuery": "CyeraAssets_MS_CL\n       | where TimeGenerated > ago(48h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CyeraIssues_CL",
        "lastDataReceivedQuery": "CyeraIssues_CL\n       | where TimeGenerated > ago(48h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CyeraIdentities_CL",
        "lastDataReceivedQuery": "CyeraIdentities_CL\n       | where TimeGenerated > ago(48h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "ConnectivityCriteria": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CyeraClassifications_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "CyeraAssets_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "CyeraAssets_MS_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "CyeraIssues_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "CyeraIdentities_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "Read and Write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true,
            "action": false
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Note",
        "description": ">**NOTE:** This connector uses an **Azure Function App** and the **Azure Monitor Logs Ingestion API** (DCE + DCR, kind: Direct). Function runtime and data egress may incur charges. See [Azure Functions pricing](https://azure.microsoft.com/pricing/details/functions/)."
      },
      {
        "title": "Optional Step",
        "description": ">**(Optional)** Store Cyera API credentials in **Azure Key Vault** and reference them from the Function App. See [Key Vault references](https://learn.microsoft.com/azure/app-service/app-service-key-vault-references)."
      },
      {
        "title": "STEP 1  Prepare Cyera API Access",
        "description": "1) Generate a **Personal Access Token** [Generating Personal Access Token](https://support.cyera.io/hc/en-us/articles/19446274608919-Personal-and-API-Tokens) in your Cyera tenant.\\n2) Note **API Base URL**, **Client ID**, and **Client Secret**."
      },
      {
        "title": "STEP 2  Choose ONE deployment option",
        "description": "> Before deploying, have these values handy:",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "CyeraDSPMConnector"
              ],
              "label": "Cyera Function Connector Name"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "{{workspace}}"
              ],
              "label": "Workspace Name"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "{{workspace-location}}"
              ],
              "label": "Workspace Location"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "https://api.cyera.io"
              ],
              "label": "Cyera Base URL"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "CyeraClientID"
              ],
              "label": "Cyera Personal Access Token Client ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "CyeraSecret"
              ],
              "label": "Cyera Personal Access Token Secret"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1",
        "description": "**Option 1 - Azure Resource Manager (ARM) Template**\n\nUse this method for automated deployment of the Cyera DSPM Functions and all required resources to support the connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/{{deployment-template-uri)\n2. Select the preferred **FunctionName** and **Workspace Name**. \n3. Enter the **Workspace Location**, **Cyera API Base Url**, **Personal Access Token Client ID**, and **Personal Access Token Secret**. \n>Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2  Manual Deployment",
        "description": "Follow the [install packs step-by-step guide]({{userguide-url}}.\\n\\n1) Create/update the 5 custom tables, data collection rule with format `sentinel-dce-<functuion_name>`, and data collection endpoint with format `sentinel-dcr-<functuion_name>` using the scripts in [install-pack-v0_7_0/scripts]({{deployment-script-zip-url}}).\\n2) Deploy the Azure Function from the repo`s Function folder (Timer-trigger; schedule typically 515 minutes).\\n3) Configure Function App settings:\\n   - `CyeraBaseUrl`  Cyera API Base URL\\n   - `CyeraClientId`  Client ID (PAT)\\n   - `CyeraSecret`  Client Secret (PAT)\\n   - `DCR_IMMUTABLE_ID`  DCR immutable ID\\n   - `DCE_ENDPOINT`  Logs ingestion endpoint URL\\n   - `STREAM_ASSETS`=`Custom-CyeraAssets`, `STREAM_IDENTITIES`=`Custom-CyeraIdentities`, `STREAM_ISSUES`=`Custom-CyeraIssues`, `STREAM_CLASSIFICATIONS`=`Custom-CyeraClassifications`\\n4) Save and Start the Function App."
      }
    ]
  },
  {
    "id": "CyfirmaAttackSurfaceAlertsConnector",
    "title": "CYFIRMA Attack Surface",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The CYFIRMA Attack Surface Alerts data connector enables seamless log ingestion from the DeCYFIR/DeTCT API into Microsoft Sentinel. Built on the Microsoft Sentinel Codeless Connector Platform, it leverages the DeCYFIR Alerts API to retrieve logs. Additionally, it supports DCR-based [ingestion time transformations](https://docs.microsoft.com/azure/azure-monitor/logs/custom-logs-overview), which parse security data into a custom table during ingestion. This eliminates the need for query-time parsing, enhancing performance and efficiency.",
    "graphQueries": [
      {
        "metricName": "Total Certificates Alerts logs received",
        "legend": "Certificates Alerts Logs",
        "baseQuery": "CyfirmaASCertificatesAlerts_CL"
      },
      {
        "metricName": "Total Configuration Alerts logs received",
        "legend": "Configuration Alerts Logs",
        "baseQuery": "CyfirmaASConfigurationAlerts_CL"
      },
      {
        "metricName": "Total Domain-IP Reputation Alerts logs received",
        "legend": "Domain-IP Reputation Logs",
        "baseQuery": "CyfirmaASDomainIPReputationAlerts_CL"
      },
      {
        "metricName": "Total Open ports Alerts logs received",
        "legend": "Open Ports Alerts Logs",
        "baseQuery": "CyfirmaASOpenPortsAlerts_CL"
      },
      {
        "metricName": "Total CloudWeakness Alerts logs received",
        "legend": "CloudWeakness Logs",
        "baseQuery": "CyfirmaASCloudWeaknessAlerts_CL"
      },
      {
        "metricName": "Total Domain/IP Vulnerability Alerts logs received",
        "legend": "Domain/IP Vulnerability Alerts Logs",
        "baseQuery": "CyfirmaASDomainIPVulnerabilityAlerts_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of Attack Surface Certificates Alerts logs",
        "query": "CyfirmaASCertificatesAlerts_CL| take 10"
      },
      {
        "description": "Get Sample of Attack Surface Configuration Alerts logs",
        "query": "CyfirmaASConfigurationAlerts_CL| take 10"
      },
      {
        "description": "Get Sample of Attack Surface Domain IP Reputation Alerts logs",
        "query": "CyfirmaASDomainIPReputationAlerts_CL| take 10"
      },
      {
        "description": "Get Sample of Attack Surface Open Ports Alerts logs",
        "query": "CyfirmaASOpenPortsAlerts_CL| take 10"
      },
      {
        "description": "Get Sample of Attack Surface CloudWeakness Alerts logs",
        "query": "CyfirmaASCloudWeaknessAlerts_CL| take 10"
      },
      {
        "description": "Get Sample of Attack Surface Domain IP Vulnerability Alerts logs",
        "query": "CyfirmaASDomainIPVulnerabilityAlerts_CL| take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "CyfirmaASCertificatesAlerts_CL",
        "lastDataReceivedQuery": "CyfirmaASCertificatesAlerts_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CyfirmaASConfigurationAlerts_CL",
        "lastDataReceivedQuery": "CyfirmaASConfigurationAlerts_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CyfirmaASDomainIPReputationAlerts_CL",
        "lastDataReceivedQuery": "CyfirmaASDomainIPReputationAlerts_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CyfirmaASOpenPortsAlerts_CL",
        "lastDataReceivedQuery": "CyfirmaASOpenPortsAlerts_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CyfirmaASCloudWeaknessAlerts_CL",
        "lastDataReceivedQuery": "CyfirmaASCloudWeaknessAlerts_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CyfirmaASDomainIPVulnerabilityAlerts_CL",
        "lastDataReceivedQuery": "CyfirmaASDomainIPVulnerabilityAlerts_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "CyfirmaBrandIntelligenceAlertsDC",
    "title": "CYFIRMA Brand Intelligence",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The CYFIRMA Brand Intelligence data connector enables seamless log ingestion from the DeCYFIR/DeTCT API into Microsoft Sentinel. Built on the Microsoft Sentinel Codeless Connector Platform, it leverages the DeCYFIR/DeTCT Alerts API to retrieve logs. Additionally, it supports DCR-based [ingestion time transformations](https://docs.microsoft.com/azure/azure-monitor/logs/custom-logs-overview), which parse security data into a custom table during ingestion. This eliminates the need for query-time parsing, enhancing performance and efficiency.",
    "graphQueries": [
      {
        "metricName": "Total Domain IT Asset Alerts logs received",
        "legend": "Domain IT Asset Alerts Logs",
        "baseQuery": "CyfirmaBIDomainITAssetAlerts_CL"
      },
      {
        "metricName": "Total Executive People Alerts logs received",
        "legend": "Executive People Alerts Logs",
        "baseQuery": "CyfirmaBIExecutivePeopleAlerts_CL"
      },
      {
        "metricName": "Total Product Solution Alerts logs received",
        "legend": "Product Solution Alerts Logs",
        "baseQuery": "CyfirmaBIProductSolutionAlerts_CL"
      },
      {
        "metricName": "Total Social Handlers Alerts logs received",
        "legend": "Social Handlers Alerts Logs",
        "baseQuery": "CyfirmaBISocialHandlersAlerts_CL"
      },
      {
        "metricName": "Total Malicious Mobile Apps Alerts logs received",
        "legend": "Malicious Mobile Apps Alerts Logs",
        "baseQuery": "CyfirmaBIMaliciousMobileAppsAlerts_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of Domain IT Asset Alerts logs",
        "query": "CyfirmaBIDomainITAssetAlerts_CL| take 10"
      },
      {
        "description": "Get Sample of Executive People Alerts logs",
        "query": "CyfirmaBIExecutivePeopleAlerts_CL| take 10"
      },
      {
        "description": "Get Sample of Product Solution Alerts logs",
        "query": "CyfirmaBIProductSolutionAlerts_CL| take 10"
      },
      {
        "description": "Get Sample of Social Handlers Alerts logs",
        "query": "CyfirmaBISocialHandlersAlerts_CL| take 10"
      },
      {
        "description": "Get Sample of Malicious Mobile Apps Alerts logs",
        "query": "CyfirmaBIMaliciousMobileAppsAlerts_CL| take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "CyfirmaBIDomainITAssetAlerts_CL",
        "lastDataReceivedQuery": "CyfirmaBIDomainITAssetAlerts_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CyfirmaBIExecutivePeopleAlerts_CL",
        "lastDataReceivedQuery": "CyfirmaBIExecutivePeopleAlerts_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CyfirmaBIProductSolutionAlerts_CL",
        "lastDataReceivedQuery": "CyfirmaBIProductSolutionAlerts_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CyfirmaBISocialHandlersAlerts_CL",
        "lastDataReceivedQuery": "CyfirmaBISocialHandlersAlerts_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CyfirmaBIMaliciousMobileAppsAlerts_CL",
        "lastDataReceivedQuery": "CyfirmaBIMaliciousMobileAppsAlerts_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "CyfirmaCompromisedAccountsDataConnector",
    "title": "CYFIRMA Compromised Accounts",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The CYFIRMA Compromised Accounts data connector enables seamless log ingestion from the DeCYFIR/DeTCT API into Microsoft Sentinel. Built on the Microsoft Sentinel Codeless Connector Platform, it leverages the DeCYFIR/DeTCT API to retrieve logs. Additionally, it supports DCR-based [ingestion time transformations](https://docs.microsoft.com/azure/azure-monitor/logs/custom-logs-overview), which parse security data into a custom table during ingestion. This eliminates the need for query-time parsing, enhancing performance and efficiency.",
    "graphQueries": [
      {
        "metricName": "Total Compromised Accounts logs received",
        "legend": "Compromised Accounts Logs",
        "baseQuery": "CyfirmaCompromisedAccounts_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of Compromised Accounts logs",
        "query": "CyfirmaCompromisedAccounts_CL| take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "CyfirmaCompromisedAccounts_CL",
        "lastDataReceivedQuery": "CyfirmaCompromisedAccounts_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "CyfirmaCyberIntelligenceDC",
    "title": "CYFIRMA Cyber Intelligence",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The CYFIRMA Cyber Intelligence data connector enables seamless log ingestion from the DeCYFIR API into Microsoft Sentinel. Built on the Microsoft Sentinel Codeless Connector Platform, it leverages the DeCYFIR Alerts API to retrieve logs. Additionally, it supports DCR-based [ingestion time transformations](https://docs.microsoft.com/azure/azure-monitor/logs/custom-logs-overview), which parse security data into a custom table during ingestion. This eliminates the need for query-time parsing, enhancing performance and efficiency.",
    "graphQueries": [
      {
        "metricName": "Total Indicators logs received",
        "legend": "Indicators Logs",
        "baseQuery": "CyfirmaIndicators_CL"
      },
      {
        "metricName": "Total Threat Actors logs received",
        "legend": "Threat Actors Logs",
        "baseQuery": "CyfirmaThreatActors_CL"
      },
      {
        "metricName": "Total Campaigns logs received",
        "legend": "Campaigns Logs",
        "baseQuery": "CyfirmaCampaigns_CL"
      },
      {
        "metricName": "Total Malware logs received",
        "legend": "Malware Logs",
        "baseQuery": "CyfirmaMalware_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of Indicators logs",
        "query": "CyfirmaIndicators_CL | take 10"
      },
      {
        "description": "Get Sample of Threat Actors logs",
        "query": "CyfirmaThreatActors_CL | take 10"
      },
      {
        "description": "Get Sample of Campaigns logs",
        "query": "CyfirmaCampaigns_CL | take 10"
      },
      {
        "description": "Get Sample of Malware logs",
        "query": "CyfirmaMalware_CL | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "CyfirmaIndicators_CL",
        "lastDataReceivedQuery": "CyfirmaIndicators_CL\n | where TimeGenerated > ago(5m) | summarize Time = max(TimeGenerated)\n  | where isnotempty(Time)"
      },
      {
        "name": "CyfirmaThreatActors_CL",
        "lastDataReceivedQuery": "CyfirmaThreatActors_CL\n | where TimeGenerated > ago(5m) | summarize Time = max(TimeGenerated)\n  | where isnotempty(Time)"
      },
      {
        "name": "CyfirmaCampaigns_CL",
        "lastDataReceivedQuery": "CyfirmaCampaigns_CL\n | where TimeGenerated > ago(5m) | summarize Time = max(TimeGenerated)\n  | where isnotempty(Time)"
      },
      {
        "name": "CyfirmaMalware_CL",
        "lastDataReceivedQuery": "CyfirmaMalware_CL\n | where TimeGenerated > ago(5m) | summarize Time = max(TimeGenerated)\n  | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "CyfirmaDigitalRiskAlertsConnector",
    "title": "CYFIRMA Digital Risk",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The CYFIRMA Digital Risk Alerts data connector enables seamless log ingestion from the DeCYFIR/DeTCT API into Microsoft Sentinel. Built on the Microsoft Sentinel Codeless Connector Platform, it leverages the DeCYFIR Alerts API to retrieve logs. Additionally, it supports DCR-based [ingestion time transformations](https://docs.microsoft.com/azure/azure-monitor/logs/custom-logs-overview), which parse security data into a custom table during ingestion. This eliminates the need for query-time parsing, enhancing performance and efficiency.",
    "graphQueries": [
      {
        "metricName": "Total Phishing Alerts logs received",
        "legend": "Phishing Alerts Logs",
        "baseQuery": "CyfirmaDBWMPhishingAlerts_CL"
      },
      {
        "metricName": "Total Ransomware Alerts logs received",
        "legend": "Ransomware Alerts Logs",
        "baseQuery": "CyfirmaDBWMRansomwareAlerts_CL"
      },
      {
        "metricName": "Total DarkWeb Alerts logs received",
        "legend": "DarkWeb Alerts Logs",
        "baseQuery": "CyfirmaDBWMDarkWebAlerts_CL"
      },
      {
        "metricName": "Total SourceCode Alerts logs received",
        "legend": "SourceCode Alerts Logs",
        "baseQuery": "CyfirmaSPESourceCodeAlerts_CL"
      },
      {
        "metricName": "Total ConfidentialFiles Alerts logs received",
        "legend": "ConfidentialFiles Alerts Logs",
        "baseQuery": "CyfirmaSPEConfidentialFilesAlerts_CL"
      },
      {
        "metricName": "Total PII-CII Alerts logs received",
        "legend": "PII-CII Alerts Logs",
        "baseQuery": "CyfirmaSPEPIIAndCIIAlerts_CL"
      },
      {
        "metricName": "Total Social Threat Alerts logs received",
        "legend": "SocialThreat Alerts Logs",
        "baseQuery": "CyfirmaSPESocialThreatAlerts_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of Phishing Alerts logs",
        "query": "CyfirmaDBWMPhishingAlerts_CL| take 10"
      },
      {
        "description": "Get Sample of Ransomware Alerts logs",
        "query": "CyfirmaDBWMRansomwareAlerts_CL| take 10"
      },
      {
        "description": "Get Sample of DarkWeb Alerts logs",
        "query": "CyfirmaDBWMDarkWebAlerts_CL| take 10"
      },
      {
        "description": "Get Sample of SourceCode Alerts logs",
        "query": "CyfirmaSPESourceCodeAlerts_CL| take 10"
      },
      {
        "description": "Get Sample of ConfidentialFiles Alerts logs",
        "query": "CyfirmaSPEConfidentialFilesAlerts_CL| take 10"
      },
      {
        "description": "Get Sample of PIIAndCII Alerts logs",
        "query": "CyfirmaSPEPIIAndCIIAlerts_CL| take 10"
      },
      {
        "description": "Get Sample of Social Threats Alerts logs",
        "query": "CyfirmaSPESocialThreatAlerts_CL| take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "CyfirmaDBWMPhishingAlerts_CL",
        "lastDataReceivedQuery": "CyfirmaDBWMPhishingAlerts_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CyfirmaDBWMRansomwareAlerts_CL",
        "lastDataReceivedQuery": "CyfirmaDBWMRansomwareAlerts_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CyfirmaDBWMDarkWebAlerts_CL",
        "lastDataReceivedQuery": "CyfirmaDBWMDarkWebAlerts_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CyfirmaSPESourceCodeAlerts_CL",
        "lastDataReceivedQuery": "CyfirmaSPESourceCodeAlerts_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CyfirmaSPEConfidentialFilesAlerts_CL",
        "lastDataReceivedQuery": "CyfirmaSPEConfidentialFilesAlerts_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CyfirmaSPEPIIAndCIIAlerts_CL",
        "lastDataReceivedQuery": "CyfirmaSPEPIIAndCIIAlerts_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CyfirmaSPESocialThreatAlerts_CL",
        "lastDataReceivedQuery": "CyfirmaSPESocialThreatAlerts_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "CyfirmaVulnerabilitiesIntelDC",
    "title": "CYFIRMA Vulnerabilities Intelligence",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The CYFIRMA Vulnerabilities Intelligence data connector enables seamless log ingestion from the DeCYFIR API into Microsoft Sentinel. Built on the Microsoft Sentinel Codeless Connector Platform, it leverages the CYFIRMA API's to retrieve logs. Additionally, it supports DCR-based [ingestion time transformations](https://docs.microsoft.com/azure/azure-monitor/logs/custom-logs-overview), which parse security data into a custom table during ingestion. This eliminates the need for query-time parsing, enhancing performance and efficiency.",
    "graphQueries": [
      {
        "metricName": "Total Vulnerabilities logs received",
        "legend": "Vulnerabilities Logs",
        "baseQuery": "CyfirmaVulnerabilities_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of Vulnerabilities logs",
        "query": "CyfirmaVulnerabilities_CL | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "CyfirmaVulnerabilities_CL",
        "lastDataReceivedQuery": "CyfirmaVulnerabilities_CL\n | where TimeGenerated > ago(5m) | summarize Time = max(TimeGenerated)\n  | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "CynerioSecurityEvents",
    "title": "Cynerio Security Events",
    "publisher": "Cynerio",
    "descriptionMarkdown": "The [Cynerio](https://www.cynerio.com/) connector allows you to easily connect your Cynerio Security Events with Microsoft Sentinel, to view IDS Events. This gives you more insight into your organization network security posture and improves your security operation capabilities. ",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CynerioEvent_CL",
        "baseQuery": "CynerioEvent_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "SSH Connections events in the last 24 hours",
        "query": "CynerioEvent_CL\n | where date_t > ago(24h) and title_s == 'SSH Connection'"
      }
    ],
    "dataTypes": [
      {
        "name": "CynerioEvent_CL",
        "lastDataReceivedQuery": "CynerioEvent_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CynerioEvent_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Configure and connect Cynerio",
        "description": "Cynerio can integrate with and export events directly to Microsoft Sentinel via Azure Server. Follow these steps to establish integration:\n\n1. In the Cynerio console, go to Settings > Integrations tab (default), and click on the **+Add Integration** button at the top right.\n\n2. Scroll down to the **SIEM** section.\n\n3. On the Microsoft Sentinel card, click the Connect button.\n\n4. The Integration Details window opens. Use the parameters below to fill out the form and set up the connection.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ],
    "metadata": {
      "id": "Unique Identifier (GUID) used to identify dependencies and content from solutions or community.",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "Cynerio"
      },
      "author": {
        "name": "Cynerio"
      },
      "support": {
        "tier": "Type of support for content item: microsoft | developer | community",
        "name": "Name of support contact or company",
        "email": "Optional: Email of support contact",
        "link": "Optional: Link for support help, like to support page to open a ticket etc"
      }
    }
  },
  {
    "id": "Darktrace",
    "title": "[Deprecated] AI Analyst Darktrace via Legacy Agent",
    "publisher": "Darktrace",
    "descriptionMarkdown": "The Darktrace connector lets users connect Darktrace Model Breaches in real-time with Microsoft Sentinel, allowing creation of custom Dashboards, Workbooks, Notebooks and Custom Alerts to improve investigation.  Microsoft Sentinel's enhanced visibility into Darktrace logs enables monitoring and mitigation of security threats.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Darktrace",
        "baseQuery": "CommonSecurityLog\n| where DeviceVendor == \"Darktrace\" "
      }
    ],
    "sampleQueries": [
      {
        "description": "first 10 most recent data breaches",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"Darktrace\"\n| order by TimeGenerated desc \n| limit 10"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (Darktrace)",
        "lastDataReceivedQuery": "CommonSecurityLog\n| where DeviceVendor == \"Darktrace\"\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n| where DeviceVendor == \"Darktrace\"\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Common Event Format (CEF) logs to Syslog agent",
        "description": "Configure Darktrace to forward Syslog messages in CEF format to your Azure workspace via the Syslog agent. \n\n 1) Within the Darktrace Threat Visualizer, navigate to the System Config page in the main menu under Admin. \n\n  2) From the left-hand menu, select Modules and choose Microsoft Sentinel from the available Workflow Integrations.\\n 3) A configuration window will open. Locate Microsoft Sentinel Syslog CEF and click New to reveal the configuration settings, unless already exposed. \n\n 4) In the Server configuration field, enter the location of the log forwarder and optionally modify the communication port. Ensure that the port selected is set to 514 and is allowed by any intermediary firewalls. \n\n 5) Configure any alert thresholds, time offsets or additional settings as required. \n\n 6) Review any additional configuration options you may wish to enable that alter the Syslog syntax.\n\n 7) Enable Send Alerts and save your changes."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "DarktraceAma",
    "title": "[Deprecated] AI Analyst Darktrace via AMA",
    "publisher": "Darktrace",
    "descriptionMarkdown": "The Darktrace connector lets users connect Darktrace Model Breaches in real-time with Microsoft Sentinel, allowing creation of custom Dashboards, Workbooks, Notebooks and Custom Alerts to improve investigation.  Microsoft Sentinel's enhanced visibility into Darktrace logs enables monitoring and mitigation of security threats.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Darktrace",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Darktrace'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "first 10 most recent data breaches",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"Darktrace\"\n| order by TimeGenerated desc \n| limit 10"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (Darktrace)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Darktrace'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'Darktrace'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine"
                },
                {
                  "title": "Step B. Forward Common Event Format (CEF) logs to Syslog agent",
                  "description": "Configure Darktrace to forward Syslog messages in CEF format to your Azure workspace via the Syslog agent. \n\n 1) Within the Darktrace Threat Visualizer, navigate to the System Config page in the main menu under Admin. \n\n  2) From the left-hand menu, select Modules and choose Microsoft Sentinel from the available Workflow Integrations.\\n 3) A configuration window will open. Locate Microsoft Sentinel Syslog CEF and click New to reveal the configuration settings, unless already exposed. \n\n 4) In the Server configuration field, enter the location of the log forwarder and optionally modify the communication port. Ensure that the port selected is set to 514 and is allowed by any intermediary firewalls. \n\n 5) Configure any alert thresholds, time offsets or additional settings as required. \n\n 6) Review any additional configuration options you may wish to enable that alter the Syslog syntax.\n\n 7) Enable Send Alerts and save your changes."
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "DarktraceRESTConnector",
    "title": "Darktrace Connector for Microsoft Sentinel REST API",
    "publisher": "Darktrace",
    "descriptionMarkdown": "The Darktrace REST API connector pushes real-time events from Darktrace to Microsoft Sentinel and is designed to be used with the Darktrace Solution for Sentinel. The connector writes logs to a custom log table titled \"darktrace_model_alerts_CL\"; Model Breaches, AI Analyst Incidents, System Alerts and Email Alerts can be ingested - additional filters can be set up on the Darktrace System Configuration page. Data is pushed to Sentinel from Darktrace masters.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "darktrace_model_alerts_CL",
        "baseQuery": "darktrace_model_alerts_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Look for Test Alerts",
        "query": "darktrace_model_alerts_CL\n            | where modelName_s == \"Unrestricted Test Model\""
      },
      {
        "description": "Return Top Scoring Darktrace Model Breaches",
        "query": "darktrace_model_alerts_CL\n            | where dtProduct_s ==\"Policy Breach\"\n            | project-rename SrcIpAddr=SourceIP\n            | project-rename SrcHostname=hostname_s\n            | project-rename DarktraceLink=breachUrl_s\n           | project-rename ThreatRiskLevel=score_d\n            | project-rename NetworkRuleName=modelName_s\n            | project TimeGenerated, NetworkRuleName, SrcHostname, SrcIpAddr, ThreatRiskLevel\n            | top 10 by ThreatRiskLevel desc"
      },
      {
        "description": "Return AI Analyst Incidents",
        "query": "darktrace_model_alerts_CL\n            | where dtProduct_s == \"AI Analyst\"\n            | project-rename  EventStartTime=startTime_s\n            | project-rename EventEndTime = endTime_s\n            | project-rename NetworkRuleName=title_s\n            | project-rename CurrentGroup=externalId_g //externalId is the Current Group ID from Darktrace\n            | project-rename ThreatCategory=dtProduct_s\n            | extend ThreatRiskLevel=score_d //This is the event score, which is different from the GroupScore\n            | project-rename SrcHostname=hostname_s\n            | project-rename DarktraceLink=url_s\n            | project-rename Summary=summary_s\n            | project-rename GroupScore=groupScore_d\n            | project-rename GroupCategory=groupCategory_s\n            | project-rename SrcDeviceName=bestDeviceName_s"
      },
      {
        "description": "Return System Health Alerts",
        "query": "  darktrace_model_alerts_CL\n            | where dtProduct_s == \"System Alert\""
      },
      {
        "description": "Return email Logs for a specific external sender (example@test.com)",
        "query": "darktrace_model_alerts_CL\n             | where dtProduct_s == 'Antigena Email'\n        | where from_s == 'example@test.com'"
      }
    ],
    "dataTypes": [
      {
        "name": "darktrace_model_alerts_CL",
        "lastDataReceivedQuery": "darktrace_model_alerts_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "darktrace_model_alerts_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Darktrace Prerequisites",
          "description": "To use this Data Connector a Darktrace master running v5.2+ is required.\n Data is sent to the [Azure Monitor HTTP Data Collector API](https://docs.microsoft.com/azure/azure-monitor/logs/data-collector-api) over HTTPs from Darktrace masters, therefore outbound connectivity from the Darktrace master to Microsoft Sentinel REST API is required."
        },
        {
          "name": "Filter Darktrace Data",
          "description": "During configuration it is possible to set up additional filtering on the Darktrace System Configuration page to constrain the amount or types of data sent."
        },
        {
          "name": "Try the Darktrace Sentinel Solution",
          "description": "You can get the most out of this connector by installing the Darktrace Solution for Microsoft Sentinel. This will provide workbooks to visualise alert data and analytics rules to automatically create alerts and incidents from Darktrace Model Breaches and AI Analyst incidents."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "1. Detailed setup instructions can be found on the Darktrace Customer Portal: https://customerportal.darktrace.com/product-guides/main/microsoft-sentinel-introduction\n 2. Take note of the Workspace ID and the Primary key. You will need to enter these details on your Darktrace System Configuration page.\n ",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Darktrace Configuration",
        "description": "1. Perform the following steps on the Darktrace System Configuration page:\n 2. Navigate to the System Configuration Page (Main Menu > Admin > System Config)\n 3. Go into Modules configuration and click on the \"Microsoft Sentinel\" configuration card\n 4. Select \"HTTPS (JSON)\" and hit \"New\"\n 5. Fill in the required details and select appropriate filters\n 6. Click \"Verify Alert Settings\" to attempt authentication and send out a test alert\n 7. Run a \"Look for Test Alerts\" sample query to validate that the test alert has been received",
        "instructions": ""
      }
    ],
    "metadata": {
      "id": "169a86e6-a4e2-4abc-a5c0-eece5d013204",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "Darktrace"
      },
      "author": {
        "name": "Darktrace"
      },
      "support": {
        "tier": "developer",
        "name": "Darktrace",
        "link": "customerportal.darktrace.com"
      }
    }
  },
  {
    "id": "Datalake2SentinelConnector",
    "title": "Datalake2Sentinel",
    "publisher": "Orange Cyberdefense",
    "descriptionMarkdown": "This solution installs the Datalake2Sentinel connector which is built using the Codeless Connector Platform and allows you to automatically ingest threat intelligence indicators from **Datalake Orange Cyberdefense's CTI platform** into Microsoft Sentinel via the Upload Indicators REST API. After installing the solution, configure and enable this data connector by following guidance in Manage solution view.",
    "graphQueries": [
      {
        "metricName": "Total indicators received",
        "legend": "Connection Events",
        "baseQuery": "ThreatIntelligenceIndicator | where SourceSystem == 'Datalake - OrangeCyberdefense'"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Threat Intelligence APIs Indicators",
        "query": "ThreatIntelligenceIndicator | where SourceSystem == 'Datalake - OrangeCyberdefense'| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "ThreatIntelligenceIndicator",
        "lastDataReceivedQuery": "ThreatIntelligenceIndicator| where isnotempty(TimeGenerated) and SourceSystem == 'Datalake - OrangeCyberdefense' | summarize Time = max(TimeGenerated)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ThreatIntelligenceIndicator| where SourceSystem == 'Datalake - OrangeCyberdefense' | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "Read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Installation and setup instructions",
        "description": "Use the documentation from this Github repository to install and configure the Datalake to Microsoft Sentinel connector. \n\nhttps://github.com/cert-orangecyberdefense/datalake2sentinel"
      }
    ]
  },
  {
    "id": "DataminrPulseAlerts",
    "title": "Dataminr Pulse Alerts Data Connector",
    "publisher": "Dataminr",
    "descriptionMarkdown": "Dataminr Pulse Alerts Data Connector brings our AI-powered real-time intelligence into Microsoft Sentinel for faster threat detection and response.",
    "graphQueries": [
      {
        "metricName": "Total Alerts data received",
        "legend": "DataminrPulse_Alerts_CL",
        "baseQuery": "DataminrPulse_Alerts_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Dataminr Pulse Alerts Data for all alertTypes",
        "query": "DataminrPulse_Alerts_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "DataminrPulse_Alerts_CL",
        "lastDataReceivedQuery": "DataminrPulse_Alerts_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "DataminrPulse_Alerts_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Azure Subscription",
          "description": "Azure Subscription with owner role is required to register an application in Microsoft Entra ID and assign role of contributor to app in resource group."
        },
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Required Dataminr Credentials/permissions",
          "description": "\n\na. Users must have a valid Dataminr Pulse API **client ID** and **secret** to use this data connector.\n\n b. One or more Dataminr Pulse Watchlists must be configured in the Dataminr Pulse website."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the DataminrPulse in which logs are pushed via Dataminr RTAP and it will ingest logs into Microsoft Sentinel. Furthermore, the connector will fetch the ingested data from the custom logs table and create Threat Intelligence Indicators into Microsoft Sentinel Threat Intelligence. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1- Credentials for the Dataminr Pulse Client ID and Client Secret**\n\n * Obtain Dataminr Pulse user ID/password and API client ID/secret from your Dataminr Customer Success Manager (CSM)."
      },
      {
        "title": "",
        "description": "**STEP 2- Configure Watchlists in Dataminr Pulse portal.**\n\n Follow the steps in this section to configure watchlists in portal:\n\n 1. **Login** to the Dataminr Pulse [website](https://app.dataminr.com).\n\n 2. Click on the settings gear icon, and select **Manage Lists**.\n\n 3. Select the type of Watchlist you want to create (Cyber, Topic, Company, etc.) and click the **New List** button.\n\n 4. Provide a **name** for your new Watchlist, and select a highlight color for it, or keep the default color.\n\n 5. When you are done configuring the Watchlist, click **Save** to save it."
      },
      {
        "title": "",
        "description": "**STEP 3 - App Registration steps for the Application in Microsoft Entra ID**\n\n This integration requires an App registration in the Azure portal. Follow the steps in this section to create a new application in Microsoft Entra ID:\n 1. Sign in to the [Azure portal](https://portal.azure.com/).\n 2. Search for and select **Microsoft Entra ID**.\n 3. Under **Manage**, select **App registrations > New registration**.\n 4. Enter a display **Name** for your application.\n 5. Select **Register** to complete the initial app registration.\n 6. When registration finishes, the Azure portal displays the app registration's Overview pane. You see the **Application (client) ID** and **Tenant ID**. The client ID and Tenant ID is required as configuration parameters for the execution of DataminrPulse Data Connector. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app)"
      },
      {
        "title": "",
        "description": "**STEP 4 - Add a client secret for application in Microsoft Entra ID**\n\n Sometimes called an application password, a client secret is a string value required for the execution of DataminrPulse Data Connector. Follow the steps in this section to create a new Client Secret:\n 1. In the Azure portal, in **App registrations**, select your application.\n 2. Select **Certificates & secrets > Client secrets > New client secret**.\n 3. Add a description for your client secret.\n 4. Select an expiration for the secret or specify a custom lifetime. Limit is 24 months.\n 5. Select **Add**. \n 6. *Record the secret's value for use in your client application code. This secret value is never displayed again after you leave this page.* The secret value is required as configuration parameter for the execution of DataminrPulse Data Connector. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret)"
      },
      {
        "title": "",
        "description": "**STEP 5 - Assign role of Contributor to application in Microsoft Entra ID**\n\n Follow the steps in this section to assign the role:\n 1. In the Azure portal, Go to **Resource Group** and select your resource group.\n 2. Go to **Access control (IAM)** from left panel.\n 3. Click on **Add**, and then select **Add role assignment**.\n 4. Select **Contributor** as role and click on next.\n 5. In **Assign access to**, select `User, group, or service principal`.\n 6. Click on **add members** and type **your app name** that you have created and select it.\n 7. Now click on **Review + assign** and then again click on **Review + assign**. \n\n> **Reference link:** [https://learn.microsoft.com/azure/role-based-access-control/role-assignments-portal](https://learn.microsoft.com/azure/role-based-access-control/role-assignments-portal)"
      },
      {
        "title": "",
        "description": "**STEP 6 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Dataminr Pulse Microsoft Sentinel data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following) readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the DataminrPulse connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-DataminrPulseAlerts-azuredeploy) [![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://aka.ms/sentinel-DataminrPulseAlerts-azuredeploy-gov)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the below information : \n\n\t a. **Function Name** \n\n\t b. **Location**: The location in which the data collection rules and data collection endpoints should be deployed. \n\n\t c. **Workspace**: Enter Workspace ID of log analytics Workspace ID \n\n\t d. **Workspace Key**: Enter Primary Key of log analytics Workspace \n\n\t e. **DataminrBaseURL**: Enter Base URL starting with \"https://\" followed by hostname (Example: https://gateway.dataminr.com/) \n\n\t f. **ClientId**: Enter your Dataminr account Client ID \n\n\t g. **ClientSecret**: Enter your Dataminr account Client Secret \n\n\t h. **AzureEntraObjectID**: Enter Object id of your Microsoft Entra App \n\n\t i. **AlertsTableName**: Enter name of the table used to store Dataminr Alerts logs. Default is 'DataminrPulse_Alerts' \n\n\t j. **AzureClientId**: Enter Azure Client ID that you have created during app registration \n\n\t k. **AzureClientSecret**: Enter Azure Client Secret that you have created during creating the client secret \n\n\t l. **AzureTenantId**: Enter Azure Tenant ID of your Azure Active Directory \n\n\t m. **AzureResourceGroupName**: Enter Azure Resource Group Name in which you want deploy the data connector \n\n\t n. **AzureWorkspaceName**: Enter Microsoft Sentinel Workspace Name of Log Analytics workspace \n\n\t o. **AzureSubscriptionId**: Enter Azure Subscription Id which is present in the subscription tab in Microsoft Sentinel \n\n\t p. **LogLevel**: Add log level or log severity value. Default is 'INFO' \n\n\t q. **Schedule**: Enter a valid Quartz Cron-Expression (Example: 0 0 0 * * *) \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the Dataminr Pulse Microsoft Sentinel data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "1) Deploy a Function App",
        "description": "> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-DataminrPulseAlerts-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. DmPulseXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.8 or above.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "2) Configure the Function App",
        "description": "1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following application settings individually, with their respective values (case-sensitive):   \n\n\t a. **Function Name** \n\n\t b. **Location**: The location in which the data collection rules and data collection endpoints should be deployed. \n\n\t c. **Workspace**: Enter Workspace ID of log analytics Workspace ID \n\n\t d. **Workspace Key**: Enter Primary Key of log analytics Workspace \n\n\t e. **DataminrBaseURL**: Enter Base URL starting with \"https://\" followed by hostname (Example: https://gateway.dataminr.com/) \n\n\t f. **ClientId**: Enter your Dataminr account Client ID \n\n\t g. **ClientSecret**: Enter your Dataminr account Client Secret \n\n\t h. **AzureEntraObjectID**: Enter Object id of your Microsoft Entra App \n\n\t i. **AlertsTableName**: Enter name of the table used to store Dataminr Alerts logs. Default is 'DataminrPulse_Alerts' \n\n\t j. **AzureClientId**: Enter Azure Client ID that you have created during app registration \n\n\t k. **AzureClientSecret**: Enter Azure Client Secret that you have created during creating the client secret \n\n\t l. **AzureTenantId**: Enter Azure Tenant ID of your Azure Active Directory \n\n\t m. **AzureResourceGroupName**: Enter Azure Resource Group Name in which you want deploy the data connector \n\n\t n. **AzureWorkspaceName**: Enter Microsoft Sentinel Workspace Name of Log Analytics workspace \n\n\t o. **AzureSubscriptionId**: Enter Azure Subscription Id which is present in the subscription tab in Microsoft Sentinel \n\n\t p. **LogLevel**: Add log level or log severity value. Default is 'INFO' \n\n\t q. **Schedule**: Enter a valid Quartz Cron-Expression (Example: 0 0 0 * * *) \n\n\t r. **logAnalyticsUri** (optional) \n - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n4. Once all application settings have been entered, click **Save**."
      },
      {
        "title": "",
        "description": "**STEP 7 - Post Deployment steps**\n\n"
      },
      {
        "title": "1) Get the Function app endpoint",
        "description": "1. Go to Azure function Overview page and Click on **\"Functions\"** in the left blade.\n2. Click on the function called **\"DataminrPulseAlertsHttpStarter\"**.\n3. Go to **\"GetFunctionurl\"** and copy the function url.\n4. Replace **{functionname}**  with **\"DataminrPulseAlertsSentinelOrchestrator\"** in copied function url."
      },
      {
        "title": "2) To add integration settings in Dataminr RTAP using the function URL",
        "description": "1. Open any API request tool like Postman.\n2. Click on '+' to create a new request.\n3. Select HTTP request method as **'POST'**.\n4. Enter the url prepapred in **point 1)**, in the request URL part.\n5. In Body, select raw JSON and provide request body as below(case-sensitive): \n\t\t{ \n\t\t \"integration-settings\": \"ADD\", \n\t\t \"url\": \"`(URL part from copied Function-url)`\", \n\t\t \"token\": \"`(value of code parameter from copied Function-url)`\" \n\t\t}\n6. After providing all required details, click **Send**.\n7. You will receive an integration setting ID in the HTTP response with a status code of 200.\n8. Save **Integration ID** for future reference."
      },
      {
        "title": "",
        "description": "*Now we are done with the adding integration settings for Dataminr RTAP. Once the Dataminr RTAP send an alert data, Function app is triggered and you should be able to see the Alerts data from the Dataminr Pulse into LogAnalytics workspace table called \"DataminrPulse_Alerts_CL\".*\n\n"
      }
    ]
  },
  {
    "id": "DDOS",
    "title": "Azure DDoS Protection",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Connect to Azure DDoS Protection Standard logs via Public IP Address Diagnostic Logs. In addition to the core DDoS protection in the platform, Azure DDoS Protection Standard provides advanced DDoS mitigation capabilities against network attacks. It's automatically tuned to protect your specific Azure resources. Protection is simple to enable during the creation of new virtual networks. It can also be done after creation and requires no application or resource changes. For more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2219760&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "lastDataReceivedInfoBalloon": "If no new data has been received in the last 14 days, the connector will display as being \"not connected.\" When the connector will recive data , the \"connected\" status will return.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "AzureDiagnostics",
        "baseQuery": "AzureDiagnostics | where ResourceType == \"PUBLICIPADDRESSES\""
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "AzureDiagnostics | where ResourceType == \"PUBLICIPADDRESSES\"\n            | sort by TimeGenerated"
      },
      {
        "description": "DDoS Mitigation Reports",
        "query": "AzureDiagnostics | where ResourceType == \"PUBLICIPADDRESSES\"\n            | where Category == \"DDoSMitigationReports\""
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "AzureDiagnostics | where ResourceType == \"PUBLICIPADDRESSES\"\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "AzureDiagnostics (Public IP Addresses)",
        "lastDataReceivedQuery": "AzureDiagnostics | where ResourceType == \"PUBLICIPADDRESSES\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 2,
      "featureFlag": {
        "feature": "DDOSConnector",
        "featureStates": {
          "1": 3,
          "2": 3,
          "3": 3,
          "4": 3,
          "5": 2,
          "6": 2,
          "7": 2
        }
      }
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "Azure DDoS protection plan",
          "description": "A configured Azure DDoS Standard protection plan [read more about Azure DDoS protection plans](https://docs.microsoft.com/azure/virtual-network/manage-ddos-protection#create-a-ddos-protection-plan)."
        },
        {
          "name": "Enabled Azure DDoS for virtual network",
          "description": "A configured virtual network with Azure DDoS Standard enabled [read more about configuring virtual network with Azure DDoS](https://docs.microsoft.com/azure/virtual-network/manage-ddos-protection#enable-ddos-for-an-existing-virtual-network)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Connect Azure DDoS Protection to Microsoft Sentinel",
        "description": "Enable Diagnostic Logs on All Public IP Addresses.",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenMicrosoftAzureMonitoring"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "Inside your Diagnostics settings portal, select your Public IP Address resource:",
        "description": "Inside your Public IP Address resource:\n    \n1.  Select **+ Add diagnostic setting.**\n2.  In the **Diagnostic setting** blade:\n  -   Type a **Name**, within the **Diagnostics settings** name field.\n  -   Select **Send to Log Analytics**.\n  -   Choose the log destination workspace.\n  -   Select the categories that you want to analyze (recommended: DDoSProtectionNotifications, DDoSMitigationFlowLogs, DDoSMitigationReports)\n  -   Click **Save**."
      }
    ]
  },
  {
    "id": "DelineaSecretServer_CEF",
    "title": "[Deprecated] Delinea Secret Server via Legacy Agent",
    "publisher": "Delinea, Inc",
    "descriptionMarkdown": "Common Event Format (CEF) from Delinea Secret Server ",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CommonSecurityLog(DelineaSecretServer)",
        "baseQuery": "\nCommonSecurityLog\n| where DeviceVendor == \"Delinea Software\" or DeviceVendor == \"Thycotic Software\"\n| where DeviceProduct == \"Secret Server\"\n"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get records create new secret",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"Delinea Software\" or DeviceVendor == \"Thycotic Software\"\n| where DeviceProduct == \"Secret Server\"\n| where Activity has \"SECRET - CREATE\""
      },
      {
        "description": "Get records where view secret",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"Delinea Software\" or DeviceVendor == \"Thycotic Software\"\n| where DeviceProduct == \"Secret Server\"\n| where Activity has \"SECRET - VIEW\""
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog(DelineaSecretServer)",
        "lastDataReceivedQuery": "\nCommonSecurityLog\n| where DeviceVendor == \"Delinea Software\" or DeviceVendor == \"Thycotic Software\"\n| where DeviceProduct == \"Secret Server\"\n\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "\nCommonSecurityLog\n| where DeviceVendor == \"Delinea Software\" or DeviceVendor == \"Thycotic Software\"\n| where DeviceProduct == \"Secret Server\"\n\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Delinea Secret Server",
          "description": "must be configured to export logs via Syslog \n\n   [Learn more about configure Secret Server](https://thy.center/ss/link/syslog)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Common Event Format (CEF) logs to Syslog agent",
        "description": "Set your security solution to send Syslog messages in CEF format to the proxy machine. Make sure you to send the logs to port 514 TCP on the machine's IP address."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "DelineaSecretServerAma",
    "title": "[Deprecated] Delinea Secret Server via AMA",
    "publisher": "Delinea, Inc",
    "descriptionMarkdown": "Common Event Format (CEF) from Delinea Secret Server ",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CommonSecurityLog(DelineaSecretServer)",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Delinea Software' or DeviceVendor =~ 'Thycotic Software' \n |where DeviceProduct =~ 'Secret Server'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get records create new secret",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"Delinea Software\" or DeviceVendor == \"Thycotic Software\"\n| where DeviceProduct == \"Secret Server\"\n| where Activity has \"SECRET - CREATE\""
      },
      {
        "description": "Get records where view secret",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"Delinea Software\" or DeviceVendor == \"Thycotic Software\"\n| where DeviceProduct == \"Secret Server\"\n| where Activity has \"SECRET - VIEW\""
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog(DelineaSecretServer)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Delinea Software' or DeviceVendor =~ 'Thycotic Software' \n |where DeviceProduct =~ 'Secret Server'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'Delinea Software' or DeviceVendor =~ 'Thycotic Software' \n |where DeviceProduct =~ 'Secret Server'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine"
                },
                {
                  "title": "Step B. Forward Common Event Format (CEF) logs to Syslog agent",
                  "description": "Set your security solution to send Syslog messages in CEF format to the proxy machine. Make sure you to send the logs to port 514 TCP on the machine's IP address."
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "DerdackSIGNL4",
    "title": "Derdack SIGNL4",
    "publisher": "Derdack",
    "descriptionMarkdown": "When critical systems fail or security incidents happen, SIGNL4 bridges the last mile to your staff, engineers, IT admins and workers in the field. It adds real-time mobile alerting to your services, systems, and processes in no time. SIGNL4 notifies through persistent mobile push, SMS text and voice calls with acknowledgement, tracking and escalation. Integrated duty and shift scheduling ensure the right people are alerted at the right time.\n\n[Learn more >](https://www.signl4.com)",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "SIGNL4_CL",
        "baseQuery": "SecurityIncident"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get SIGNL4 alert and status information.",
        "query": "SecurityIncident\n | where Labels contains \"SIGNL4\""
      }
    ],
    "dataTypes": [
      {
        "name": "SIGNL4_CL",
        "lastDataReceivedQuery": "SecurityIncident\n | where Labels contains \"SIGNL4\" | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "SecurityIncident\n | where Labels contains \"SIGNL4\""
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector is mainly configured on the SIGNL4 side. You can find a description video here: [**Integrate SIGNL4 with Microsoft Sentinel**](https://www.signl4.com/blog/portfolio_item/azure-sentinel-mobile-alert-notification-duty-schedule-escalation/).",
        "instructions": []
      },
      {
        "title": "",
        "description": ">**SIGNL4 Connector:** The SIGNL4 connector for Microsoft Sentinel, Azure Security Center and other Azure Graph Security API providers provides seamless 2-way integration with your Azure Security solutions. Once added to your SIGNL4 team, the connector will read security alerts from Azure Graph Security API and fully automatically and trigger alert notifications to your team members on duty. It will also synchronize the alert status from SIGNL4 to Graph Security API, so that if alerts are acknowledged or closed, this status is also updated on the according Azure Graph Security API alert or the corresponding security provider. As mentioned, the connector mainly uses Azure Graph Security API, but for some security providers, such as Microsoft Sentinel, it also uses dedicated REST APIs from according Azure solutions.",
        "instructions": []
      },
      {
        "title": "Microsoft Sentinel Features",
        "description": "Microsoft Sentinel is a cloud native SIEM solution from Microsoft and a security alert provider in Azure Graph Security API. However, the level of alert details available with the Graph Security API is limited for Microsoft Sentinel. The connector can therefore augment alerts with further details (insights rule search results), from the underlying Microsoft Sentinel Log Analytics workspace. To be able to do that, the connector communicates with Azure Log Analytics REST API and needs according permissions (see below). Furthermore, the app can also update the status of Microsoft Sentinel incidents, when all related security alerts are e.g. in progress or resolved. In order to be able to do that, the connector needs to be a member of the 'Microsoft Sentinel Contributors' group in your Azure Subscription.\n **Automated deployment in Azure**\n The credentials required to access the beforementioned APIs, are generated by a small PowerShell script that you can download below. The script performs the following tasks for you:\n - Logs you on to your Azure Subscription (please login with an administrator account)\n - Creates a new enterprise application for this connector in your Azure AD, also referred to as service principal\n - Creates a new role in your Azure IAM that grants read/query permission to only Azure Log Analytics workspaces.\n - Joins the enterprise application to that user role\n - Joins the enterprise application to the 'Microsoft Sentinel Contributors' role\n - Outputs some data that you need to configure app (see below)",
        "instructions": []
      },
      {
        "title": "Deployment procedure",
        "description": "1. Download the PowerShell deployment script from [here](https://github.com/signl4/signl4-integration-azuresentinel/blob/master/registerSIGNL4Client.ps1).\n2. Review the script and the roles and permission scopes it deploys for the new app registration. If you don't want to use the connector with Microsoft Sentinel, you could remove all role creation and role assignment code and only use it to create the app registration (SPN) in your Azure Active Directory.\n3. Run the script. At the end it outputs information that you need to enter in the connector app configuration.\n4. In Azure AD, click on 'App Registrations'. Find the app with the name 'SIGNL4AzureSecurity' and open its details\n5. On the left menu blade click 'API Permissions'. Then click 'Add a permission'.\n6. On the blade that loads, under 'Microsoft APIs' click on the 'Microsoft Graph' tile, then click 'App permission'.\n7. In the table that is displayed expand 'SecurityEvents' and check 'SecurityEvents.Read.All' and 'SecurityEvents.ReadWrite.All'.\n8. Click 'Add permissions'.",
        "instructions": []
      },
      {
        "title": "Configuring the SIGNL4 connector app",
        "description": "Finally, enter the IDs, that the script has outputted in the connector configuration:\n - Azure Tenant ID\n - Azure Subscription ID\n - Client ID (of the enterprise application)\n - Client Secret (of the enterprise application)\n Once the app is enabled, it will start reading your Azure Graph Security API alerts.\n\n>**NOTE:** It will initially only read the alerts that have occurred within the last 24 hours.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ]
  },
  {
    "id": "DigitalGuardianDLP",
    "title": "[Deprecated] Digital Guardian Data Loss Prevention",
    "publisher": "Digital Guardian",
    "descriptionMarkdown": "[Digital Guardian Data Loss Prevention (DLP)](https://digitalguardian.com/platform-overview) data connector provides the capability to ingest Digital Guardian DLP logs into Microsoft Sentinel.",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected [**DigitalGuardianDLPEvent**](https://aka.ms/sentinel-DigitalGuardianDLP-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "DigitalGuardianDLPEvent",
        "baseQuery": "DigitalGuardianDLPEvent"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Clients (Source IP)",
        "query": "DigitalGuardianDLPEvent\n | where notempty(SrcIpAddr)\n | summarize count() by SrcIpAddr\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog (DigitalGuardianDLPEvent)",
        "lastDataReceivedQuery": "DigitalGuardianDLPEvent\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "DigitalGuardianDLPEvent\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "write permission is required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key)",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**DigitalGuardianDLPEvent**](https://aka.ms/sentinel-DigitalGuardianDLP-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "1. Configure Digital Guardian to forward logs via Syslog to remote server where you will install the agent.",
        "description": "Follow these steps to configure Digital Guardian to forward logs via Syslog:\n\n1.1. Log in to the Digital Guardian Management Console.\n\n1.2. Select **Workspace** > **Data Export** > **Create Export**.\n\n1.3. From the **Data Sources** list, select **Alerts** or **Events** as the data source.\n\n1.4. From the **Export type** list, select **Syslog**.\n\n1.5. From the **Type list**, select **UDP** or **TCP** as the transport protocol.\n\n1.6. In the **Server** field, type the IP address of your Remote Syslog server.\n\n1.7. In the **Port** field, type 514 (or other port if your Syslog server was configured to use non-default port).\n\n1.8. From the **Severity Level** list, select a severity level.\n\n1.9. Select the **Is Active** check box.\n\n1.9. Click **Next**.\n\n1.10. From the list of available fields, add Alert or Event fields for your data export.\n\n1.11. Select a Criteria for the fields in your data export and click **Next**.\n\n1.12. Select a group for the criteria and click **Next**.\n\n1.13. Click **Test Query**.\n\n1.14. Click **Next**.\n\n1.15. Save the data export."
      },
      {
        "title": "2. Install and onboard the agent for Linux or Windows",
        "description": "Install the agent on the Server to which the logs will be forwarded.\n\n> Logs on Linux or Windows servers are collected by **Linux** or **Windows** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Linux agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Windows agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Windows Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Windows Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "3. Check logs in Microsoft Sentinel",
        "description": "Open Log Analytics to check if the logs are received using the Syslog schema.\n\n>**NOTE:** It may take up to 15 minutes before new logs will appear in Syslog table.",
        "instructions": []
      }
    ]
  },
  {
    "id": "DigitalShadowsSearchlightAzureFunctions",
    "title": "Digital Shadows Searchlight",
    "publisher": "Digital Shadows",
    "descriptionMarkdown": "The Digital Shadows data connector provides ingestion of the incidents and alerts from Digital Shadows Searchlight into the Microsoft Sentinel using the REST API. The connector will provide the incidents and alerts information such that it helps to examine, diagnose and analyse the potential security risks and threats.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "DigitalShadows_CL",
        "baseQuery": "DigitalShadows_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Digital Shadows incidents and alerts ordered by time most recently raised",
        "query": "DigitalShadows_CL | order by raised_t desc"
      }
    ],
    "dataTypes": [
      {
        "name": "DigitalShadows_CL",
        "lastDataReceivedQuery": "DigitalShadows_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "DigitalShadows_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "**Digital Shadows account ID, secret and key** is required.  See the documentation to learn more about API on the `https://portal-digitalshadows.com/learn/searchlight-api/overview/description`."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to a 'Digital Shadows Searchlight' to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the 'Digital Shadows Searchlight' API**\n\nThe provider should provide or link to detailed steps to configure the 'Digital Shadows Searchlight' API endpoint so that the Azure Function can authenticate to it successfully, get its authorization key or token, and pull the appliance's logs into Microsoft Sentinel."
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the 'Digital Shadows Searchlight' connector, have the Workspace ID  and Workspace Primary Key (can be copied from the following), as well as the 'Digital Shadows Searchlight' API authorization key(s) or Token, readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "",
        "description": "**Option 1 - Azure Resource Manager (ARM) Template**\n\nUse this method for automated deployment of the 'Digital Shadows Searchlight' connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-Digitalshadows-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace ID**, **Workspace Key**, **API Username**, **API Password**, 'and/or Other required fields'. \n>Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "",
        "description": "**Option 2 - Manual Deployment of Azure Functions**\n\n Use the following step-by-step instructions to deploy the 'Digital Shadows Searchlight' connector manually with Azure Functions."
      },
      {
        "title": "1. Create a Function App",
        "description": "1.  From the Azure Portal, navigate to [Function App](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Web%2Fsites/kind/functionapp).\n2. Click **+ Create** at the top.\n3. In the **Basics** tab, ensure Runtime stack is set to **python 3.11**. \n4. In the **Hosting** tab, ensure **Plan type** is set to **'Consumption (Serverless)'**.\n5.select Storage account\n6. 'Add other required configurations'. \n5. 'Make other preferable configuration changes', if needed, then click **Create**."
      },
      {
        "title": "2. Import Function App Code(Zip deployment)",
        "description": "1. Install Azure CLI\n2. From terminal type **az functionapp deployment source config-zip -g <ResourceGroup> -n <FunctionApp> --src <Zip File>** and hit enter. Set the `ResourceGroup` value to: your resource group name. Set the `FunctionApp` value to: your newly created function app name. Set the `Zip File` value to: `digitalshadowsConnector.zip`(path to your zip file). Note:- Download the zip file from the link - [Function App Code](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Digital%20Shadows/Data%20Connectors/Digital%20Shadows/digitalshadowsConnector.zip)"
      },
      {
        "title": "3. Configure the Function App",
        "description": "1. In the Function App screen, click the Function App name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following 'x (number of)' application settings individually, under Name, with their respective string values (case-sensitive) under Value: \n\t\tDigitalShadowsAccountID\n\t\tWorkspaceID\n\t\tWorkspaceKey\n\t\tDigitalShadowsKey\n\t\tDigitalShadowsSecret\n\t\tHistoricalDays\n\t\tDigitalShadowsURL\n\t\tClassificationFilterOperation\n\t\tHighVariabilityClassifications\n\t\tFUNCTION_NAME\n\t\tlogAnalyticsUri (optional)\n(add any other settings required by the Function App)\nSet the `DigitalShadowsURL` value to: `https://api.searchlight.app/v1`\nSet the `HighVariabilityClassifications` value to: `exposed-credential,marked-document`\nSet the `ClassificationFilterOperation` value to: `exclude` for exclude function app or `include` for include function app \n>Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Azure Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details.\n - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: https://<CustomerId>.ods.opinsights.azure.us. \n4. Once all application settings have been entered, click **Save**."
      }
    ],
    "metadata": {
      "id": "c3b8e8cd-8e7e-4381-99da-3a158c502749",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "Digital Shadows Searchlight"
      },
      "author": {
        "name": "Digital Shadows"
      },
      "support": {
        "tier": "developer",
        "name": "Digital Shadows",
        "email": "support@digitalshadows.com",
        "link": "https://www.digitalshadows.com/"
      }
    }
  },
  {
    "id": "DNS",
    "title": "DNS",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The DNS log connector allows you to easily connect your DNS analytic and audit logs with Microsoft Sentinel, and other related data, to improve investigation.\n\n**When you enable DNS log collection you can:**\n-   Identify clients that try to resolve malicious domain names.\n-   Identify stale resource records.\n-   Identify frequently queried domain names and talkative DNS clients.\n-   View request load on DNS servers.\n-   View dynamic DNS registration failures.\n\nFor more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2220127&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "logo": "DNS.svg",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "DnsEvents",
        "baseQuery": "DnsEvents"
      },
      {
        "metricName": "Total data received",
        "legend": "DnsInventory",
        "baseQuery": "DnsInventory"
      }
    ],
    "sampleQueries": [
      {
        "description": "All events logs",
        "query": "DnsEvents\n            | sort by TimeGenerated"
      },
      {
        "description": "All inventory logs",
        "query": "DnsInventory\n            | sort by TimeGenerated"
      }
    ],
    "dataTypes": [
      {
        "name": "DnsEvents",
        "lastDataReceivedQuery": "DnsEvents\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "DnsInventory",
        "lastDataReceivedQuery": "DnsInventory\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "OmsSolutions",
        "value": [
          "DnsAnalytics"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/solutions",
          "permissionsDisplayText": "[read and write permissions](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles#log-analytics-contributor).",
          "providerDisplayName": "Solutions",
          "scope": "ResourceGroup",
          "requiredPermissions": {
            "read": true,
            "write": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Download and install the agent",
        "description": ">  DNS logs are collected only from **Windows** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Windows Virtual Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on non-Azure Windows Machine",
                  "description": "Select the machine to install the agent and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Install DNS solution",
        "instructions": [
          {
            "parameters": {
              "solutionName": "DnsAnalytics"
            },
            "type": "OmsSolutions"
          }
        ]
      }
    ]
  },
  {
    "id": "Doppel_DataConnector",
    "title": "Doppel Data Connector",
    "publisher": "Doppel",
    "descriptionMarkdown": "The data connector is built on Microsoft Sentinel for Doppel events and alerts and supports DCR-based [ingestion time transformations](https://learn.microsoft.com/en-us/azure/azure-monitor/logs/ingestion-time-transformations) that parses the received security event data into a custom columns so that queries don't need to parse it again, thus resulting in better performance.",
    "graphQueriesTableName": "DoppelTable_CL",
    "graphQueries": [
      {
        "metricName": "Events received",
        "legend": "Data connector events",
        "baseQuery": "DoppelTable_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "One event log",
        "query": "DoppelTable_CL | take 1"
      }
    ],
    "dataTypes": [
      {
        "name": "DoppelTable_CL",
        "lastDataReceivedQuery": "DoppelTable_CL | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "DoppelTable_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required.",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": false
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft Entra Tenant ID, Client ID and Client Secret",
          "description": "Microsoft Entra ID requires a Client ID and Client Secret to authenticate your application. Additionally, Global Admin/Owner level access is required to assign the Entra-registered application a Resource Group Monitoring Metrics Publisher role."
        },
        {
          "name": "Requires Workspace ID, DCE-URI, DCR-ID",
          "description": "You will need to get the Log Analytics Workspace ID, DCE Logs Ingestion URI and DCR Immutable ID for the configuration."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Configure Doppel Webhook",
        "description": "Configure the Webhook in Doppel and Endpoint with permissions in Microsoft Sentinel to send data.",
        "instructions": [
          {
            "type": "InstructionStepsGroup",
            "parameters": {
              "enable": true,
              "userRequestPlaceHolder": "",
              "instructionSteps": [
                {
                  "title": "Register the Application in Microsoft Entra ID",
                  "description": "1. **Open the [Microsoft Entra ID page](https://entra.microsoft.com/)**:\n   - Click the provided link to open the **Microsoft Entra ID** registration page in a new tab.\n   - Ensure you are logged in with an account that has **Admin level** permissions.\n\n2. **Create a New Application**:\n   - In the **Microsoft Entra ID portal**, select **App registrations** mentioned on the left-hand side tab.\n   - Click on **+ New registration**.\n   - Fill out the following fields:\n     - **Name**: Enter a name for the app (e.g., Doppel App).\n     - **Supported account types**: Choose **Accounts in this organizational directory only** (Default Directory only - Single tenant).\n     - **Redirect URI**: Leave this blank unless required otherwise.\n   - Click **Register** to create the application.\n\n3. **Copy Application and Tenant IDs**:\n   - Once the app is registered, note the **Application (client) ID** and **Directory (tenant) ID** from the **Overview** page. Youll need these for the integration.\n\n4. **Create a Client Secret**:\n   - In the **Certificates & secrets** section, click **+ New client secret**.\n   - Add a description (e.g., 'Doppel Secret') and set an expiration (e.g., 1 year).\n   - Click **Add**.\n   - **Copy the client secret value immediately**, as it will not be shown again."
                },
                {
                  "title": "Assign the \"Monitoring Metrics Publisher\" Role to the App",
                  "description": "1. **Open the Resource Group in Azure Portal**:\n   - Navigate to the **Resource Group** that contains the **Log Analytics Workspace** and **Data Collection Rules (DCRs)** where you want the app to push data.\n\n2. **Assign the Role**:\n   - In the **Resource Group** menu, click on **Access control (IAM)** mentioned on the left-hand side tab ..\n   - Click on **+ Add** and select **Add role assignment**.\n   - In the **Role** dropdown, search for and select the **Monitoring Metrics Publisher** role.\n   - Under **Assign access to**, choose **Azure AD user, group, or service principal**.\n   - In the **Select** field, search for your registered app by **name** or **client ID**.\n   - Click **Save** to assign the role to the application."
                },
                {
                  "title": "Deploy the ARM Template",
                  "description": "1. **Retrieve the Workspace ID**:\n   - After assigning the role, you will need the **Workspace ID**.\n   - Navigate to the **Log Analytics Workspace** within the **Resource Group**.\n   - In the **Overview** section, locate the **Workspace ID** field under **Workspace details**.\n   - **Copy the Workspace ID** and keep it handy for the next steps.\n\n2. **Click the Deploy to Azure Button**:\n   - [![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmetron-labs%2FAzure-Sentinel%2Frefs%2Fheads%2FDoppelSolution%2FSolutions%2FDoppel%2FData%2520Connectors%2FDeployToAzure.json).\n   - This will take you directly to the Azure portal to start the deployment.\n\n3. **Review and Customize Parameters**:\n   - On the custom deployment page, ensure youre deploying to the correct **subscription** and **resource group**.\n   - Fill in the parameters like **workspace name**, **workspace ID**, and **workspace location**.\n\n4. **Click Review + Create** and then **Create** to deploy the resources."
                },
                {
                  "title": "Verify DCE, DCR, and Log Analytics Table Setup",
                  "description": "1. **Check the Data Collection Endpoint (DCE)**:\n   - After deploying, go to **Azure Portal > Data Collection Endpoints**.\n   - Verify that the **DoppelDCE** endpoint has been created successfully.\n   - **Copy the DCE Logs Ingestion URI**, as youll need this for generating the webhook URL.\n\n2. **Confirm Data Collection Rule (DCR) Setup**:\n   - Go to **Azure Portal > Data Collection Rules**.\n   - Ensure the **DoppelDCR** rule is present.\n   - **Copy the Immutable ID** of the DCR from the Overview page, as youll need it for the webhook URL.\n\n3. **Validate Log Analytics Table**:\n   - Navigate to your **Log Analytics Workspace** (linked to Microsoft Sentinel).\n   - Under the **Tables** section, verify that the **DoppelTable_CL** table has been created successfully and is ready to receive data."
                },
                {
                  "title": "Integrate Doppel Alerts with Microsoft Sentinel",
                  "description": "1. **Gather Necessary Information**:\n   - Collect the following details required for integration:\n     - **Data Collection Endpoint ID (DCE-ID)**\n     - **Data Collection Rule ID (DCR-ID)**\n     - **Microsoft Entra Credentials**: Tenant ID, Client ID, and Client Secret.\n\n2. **Coordinate with Doppel Support**:\n   - Share the collected DCE-ID, DCR-ID, and Microsoft Entra credentials with Doppel support.\n   - Request assistance to configure these details in the Doppel tenant to enable webhook setup.\n\n3. **Webhook Setup by Doppel**:\n   - Doppel will use the provided Resource IDs and credentials to configure a webhook.\n   - This webhook will facilitate the forwarding of alerts from Doppel to Microsoft Sentinel.\n\n4. **Verify Alert Delivery in Microsoft Sentinel**:\n   - Check that alerts from Doppel are successfully forwarded to Microsoft Sentinel.\n   - Validate that the **Workbook** in Microsoft Sentinel is updated with the alert statistics, ensuring seamless data integration."
                }
              ]
            }
          }
        ]
      }
    ]
  },
  {
    "id": "DragosSitestoreCCP",
    "title": " Dragos Notifications via Cloud Sitestore",
    "publisher": "Dragos",
    "descriptionMarkdown": "The [Dragos Platform](https://www.dragos.com/) is the leading Industrial Cyber Security platform it offers a comprehensive Operational Technology (OT) cyber threat detection built by unrivaled industrial cybersecurity expertise. This solution enables Dragos Platform notification data to be viewed in Microsoft Sentinel so that security analysts are able to triage potential cyber security events occurring in their industrial environments.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Dragos Sitestore Alerts",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Dragos Sitestore alerts",
        "query": "{{graphQueriesTableName}}\n| sort by TimeGenerated desc"
      },
      {
        "description": "Total Alerts",
        "query": "{{graphQueriesTableName}}\n | summarize count() by id"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}|summarize Time = max  (TimeGenerated)\n|where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "DruvaEventCCPDefinition",
    "title": "Druva Events Connector",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Provides capability to ingest the Druva events from Druva APIs",
    "graphQueries": [
      {
        "metricName": "Total Security Events",
        "legend": "Druva Security events received",
        "baseQuery": "{{graphQueriesTableName}}"
      },
      {
        "metricName": "Total Platform events",
        "legend": "Druva Platform events received",
        "baseQuery": "DruvaPlatformEvents_CL"
      },
      {
        "metricName": "Total inSync events",
        "legend": "Druva inSync events received",
        "baseQuery": "DruvaInsyncEvents_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Sample of Druva Security events",
        "query": "{{graphQueriesTableName}}\n| take 10"
      },
      {
        "description": "Sample of Druva Platform events",
        "query": "DruvaPlatformEvents_CL\n| take 10"
      },
      {
        "description": "Sample of Druva inSync events",
        "query": "DruvaInsyncEvents_CL\n| take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | summarize Time=max(TimeGenerated) \n | where isnotempty(Time)"
      },
      {
        "name": "DruvaPlatformEvents_CL",
        "lastDataReceivedQuery": "DruvaPlatformEvents_CL\n | summarize Time=max(TimeGenerated) \n | where isnotempty(Time)"
      },
      {
        "name": "DruvaInsyncEvents_CL",
        "lastDataReceivedQuery": "DruvaInsyncEvents_CL\n | summarize Time=max(TimeGenerated) \n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": null,
    "metadata": null
  },
  {
    "id": "Dynamics365",
    "title": "Dynamics 365",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The Dynamics 365 Common Data Service (CDS) activities connector provides insight into admin, user, and support activities, as well as Microsoft Social Engagement logging events. By connecting Dynamics 365 CRM logs into Microsoft Sentinel, you can view this data in workbooks, use it to create custom alerts, and improve your investigation process. For more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com//fwlink/p/?linkid=2226719&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "logo": "DynamicsLogo.svg",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Dynamics365",
        "baseQuery": "Dynamics365Activity\n| where OfficeWorkload == \"CRM\""
      }
    ],
    "sampleQueries": [
      {
        "description": "Dynamics365 logs",
        "query": "Dynamics365Activity\n| where OfficeWorkload == \"CRM\"\n            | sort by TimeGenerated"
      }
    ],
    "dataTypes": [
      {
        "name": "Dynamics365Activity",
        "lastDataReceivedQuery": "Dynamics365Activity\n| where OfficeWorkload == \"CRM\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "SentinelKinds",
        "value": [
          "Dynamics365"
        ]
      }
    ],
    "availability": {
      "status": 2,
      "isPreview": false,
      "availableInDoDCloud": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "Tenant Permissions",
          "description": "'Security Administrator' or 'Global Administrator' on the workspace's tenant."
        },
        {
          "name": "License",
          "description": "[Microsoft Dynamics 365 production license](https://docs.microsoft.com/office365/servicedescriptions/microsoft-dynamics-365-online-service-description) (This connector is available for production environments only, not for sandbox). Also, a Microsoft 365 Enterprise [E3 or E5](https://docs.microsoft.com/power-platform/admin/enable-use-comprehensive-auditing#requirements) subscription is required for Activity Logging."
        }
      ]
    },
    "instructionSteps": [
      {
        "description": "Connect [Dynamics 365 CRM](https://aka.ms/Sentinel/Dynamics365) activity logs to your Microsoft Sentinel workspace.",
        "instructions": [
          {
            "parameters": {
              "connectorKind": "Dynamics365",
              "title": "Dynamics365",
              "enable": true
            },
            "type": "SentinelResourceProvider"
          }
        ]
      }
    ]
  },
  {
    "id": "Dynamics365Finance",
    "title": "Dynamics 365 Finance and Operations",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Dynamics 365 for Finance and Operations is a comprehensive Enterprise Resource Planning (ERP) solution that combines financial and operational capabilities to help businesses manage their day-to-day operations. It offers a range of features that enable businesses to streamline workflows, automate tasks, and gain insights into operational performance.\n\nThe Dynamics 365 Finance and Operations data connector ingests Dynamics 365 Finance and Operations admin activities and audit logs as well as user business process and application activities logs into Microsoft Sentinel.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "{{graphQueriesTableName}}",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Finance and Operations Audited Tables",
        "query": "{{graphQueriesTableName}}\n            | summarize by TableName"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "ElasticAgent",
    "title": "Elastic Agent",
    "publisher": "Elastic",
    "descriptionMarkdown": "The [Elastic Agent](https://www.elastic.co/security) data connector provides the capability to ingest Elastic Agent logs, metrics, and security data into Microsoft Sentinel.",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected [**ElasticAgentEvent**](https://aka.ms/sentinel-ElasticAgent-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Elastic Agent Events",
        "baseQuery": "ElasticAgentEvent"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Devices",
        "query": "ElasticAgentEvent\n | summarize count() by DvcIpAddr\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "ElasticAgentLogs_CL",
        "lastDataReceivedQuery": "ElasticAgentEvent\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ElasticAgentEvent\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Include custom pre-requisites if the connectivity requires - else delete customs",
          "description": "Description for any custom pre-requisite"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**ElasticAgentEvent**](https://aka.ms/sentinel-ElasticAgent-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "",
        "description": ">**NOTE:** This data connector has been developed using **Elastic Agent 7.14**.",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux or Windows",
        "description": "Install the agent on the Server where the Elastic Agent logs are forwarded.\n\n> Logs from Elastic Agents deployed on Linux or Windows servers are collected by **Linux** or **Windows** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Linux agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Windows agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Windows Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Windows Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure Elastic Agent (Standalone)",
        "description": "[Follow the instructions](https://www.elastic.co/guide/en/fleet/current/elastic-agent-configuration.html) to configure Elastic Agent to output to Logstash"
      },
      {
        "title": "3. Configure Logstash to use Microsoft Logstash Output Plugin",
        "description": "Follow the steps to configure Logstash to use microsoft-logstash-output-azure-loganalytics plugin:\n\n3.1) Check if the plugin is already installed:\n> ./logstash-plugin list | grep 'azure-loganalytics'\n**(if the plugin is installed go to step 3.3)**\n\n3.2) Install plugin:\n> ./logstash-plugin install microsoft-logstash-output-azure-loganalytics\n\n3.3) [Configure Logstash](https://github.com/Azure/Azure-Sentinel/tree/master/DataConnectors/microsoft-logstash-output-azure-loganalytics) to use the plugin"
      },
      {
        "title": "4. Validate log ingestion",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using custom table specified in step 3.3 (e.g. ElasticAgentLogs_CL).\n\n>It may take about 30 minutes until the connection streams data to your workspace."
      }
    ]
  },
  {
    "id": "EntraIDAssets",
    "title": "Microsoft Entra ID Assets",
    "publisher": "Microsoft",
    "logo": "AADCloudSync.svg",
    "descriptionMarkdown": "Entra ID assets data connector gives richer insights into activity data by supplementing details with asset information. Data from this connector is used to build data risk graphs in Purview. If you have enabled those graphs, deactivating this Connector will prevent the graphs from being built. [Learn about the data risk graph.](https://go.microsoft.com/fwlink/?linkid=2320023)",
    "graphQueries": [],
    "sampleQueries": [],
    "dataTypes": [],
    "connectivityCriterias": [
      {
        "type": "EntraIDAssets"
      }
    ],
    "permissions": {
      "tenant": [
        "GlobalAdmin",
        "SecurityAdmin"
      ]
    },
    "availability": {
      "status": 2
    },
    "instructionSteps": [
      {
        "instructions": [
          {
            "parameters": {
              "type": "EntraIDAssets",
              "description": "1. Connect Microsoft Entra ID assets to ingest into Microsoft Sentinel Lake.",
              "items": [
                {
                  "label": "Applications"
                },
                {
                  "label": "Group Memberships"
                },
                {
                  "label": "Groups"
                },
                {
                  "label": "Members"
                },
                {
                  "label": "Organizations"
                },
                {
                  "label": "Service Principals"
                },
                {
                  "label": "Users"
                }
              ]
            },
            "type": "MSG"
          }
        ]
      }
    ]
  },
  {
    "id": "ErmesBrowserSecurityEvents",
    "title": "Ermes Browser Security Events",
    "publisher": "Ermes Cyber Security S.p.A.",
    "descriptionMarkdown": "Ermes Browser Security Events",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "Ermes Events",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of Ermes Events",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | where TimeGenerated > ago(12h) | where name_s == \"no data test\" | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "ESETInspect",
    "title": "ESET Inspect",
    "publisher": "ESET Netherlands",
    "descriptionMarkdown": "This connector will ingest detections from [ESET Inspect](https://www.eset.com/int/business/solutions/xdr-extended-detection-and-response/) using the provided [REST API](https://help.eset.com/ei_navigate/latest/en-US/api.html). This API is present in ESET Inspect version 1.4 and later.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ESETInspect_CL",
        "baseQuery": "ESETInspect_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 rules triggered",
        "query": "ESETInspect_CL\n | where type_s == \"RuleActivated\"\n | summarize count() by ruleName_s\n | top 10 by count_"
      },
      {
        "description": "Detection totals by type",
        "query": "ESETInspect_CL\n | summarize count() by type_s"
      },
      {
        "description": "Top 10 users with detections",
        "query": "ESETInspect_CL\n | extend Username = tolower(processUser_s)\n | where Username !contains \"nt authority\"\n | summarize count() by Username\n | top 10 by count_"
      },
      {
        "description": "Top 10 systems with detections",
        "query": "ESETInspect_CL\n | extend System = tolower(computerName_s)\n | summarize count() by System\n | top 10 by count_"
      },
      {
        "description": "High severity detections",
        "query": "ESETInspect_CL\n | where severityScore_d >= 80\n | order by id_d desc"
      },
      {
        "description": "Top 10 threats",
        "query": "ESETInspect_CL\n | where isnotempty(threatName_s)\n | summarize count() by threatName_s, type_s\n | top 10 by count_"
      },
      {
        "description": "Detections on new executables",
        "query": "ESETInspect_CL\n | where moduleLgAge_d <= 7"
      },
      {
        "description": "User login outside regular office hours",
        "query": "let startOfDay = datetime_part(\"Hour\", datetime(\"09:00\"));\n let endOfDay = datetime_part(\"Hour\", datetime(\"17:00\"));\n let saturday = time(6);\n let sunday = time(0);\n ESETInspect_CL\n | where tolower(ruleName_s) contains \"remote user login\" or tolower(ruleName_s) contains \"detected rdp communication\"\n | where datetime_part(\"Hour\", creationTime_t) !between(startOfDay .. endOfDay)\n or dayofweek(creationTime_t) == saturday or dayofweek(creationTime_t) == sunday"
      }
    ],
    "dataTypes": [
      {
        "name": "ESETInspect_CL",
        "lastDataReceivedQuery": "ESETInspect_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ESETInspect_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Access to the ESET PROTECT console",
          "description": "Permissions to add users"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to ESET Inspect to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "Step 1 -  Create an API user",
        "description": "1. Log into the ESET PROTECT console with an administrator account, select the **More** tab and the **Users** subtab. \n2. Click on the **ADD NEW** button and add a **native user**.\n3. Create a new user for the API account. **Optional:** Select a **Home group** other than **All** to limit what detections are ingested. \n4. Under the **Permission Sets** tab, assign the **Inspect reviewer permission set**.\n4. Log out of the administrator account and log into the console with the new API credentials for validation, then log out of the API account. \n5."
      },
      {
        "title": "Step 2 - Copy Workspace ID and Key",
        "description": ">**IMPORTANT:** Before deploying the ESET Inspect connector, have the Workspace ID and Workspace Primary Key (can be copied from the following) readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Step 3 - Deploy the Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the ESET Inspect connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-ESETInspect-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace ID**, **Workspace Key**, **API Username**, **API Password** , enter the **Inspect base URL** and the **first ID** to start ingesting detections from.\n - The defailt starting ID is **0**. This means that all detections will be ingested. \n - Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details. \n4. Mark the checkbox labelled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      }
    ],
    "metadata": {
      "id": "c3968094-03b7-43cc-b27e-de8fae820ef0",
      "version": "1.1.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "ESET Inspect"
      },
      "author": {
        "name": "Donny Maasland | ESET Netherlands"
      },
      "support": {
        "tier": "developer",
        "name": "ESET Netherlands",
        "link": "https://techcenter.eset.nl/"
      }
    }
  },
  {
    "id": "ESETPROTECT",
    "title": "[Deprecated] ESET PROTECT",
    "publisher": "ESET",
    "descriptionMarkdown": "This connector gathers all events generated by ESET software through the central management solution ESET PROTECT (formerly ESET Security Management Center). This includes Anti-Virus detections, Firewall detections but also more advanced EDR detections. For a complete list of events please refer to [the documentation](https://help.eset.com/protect_admin/latest/en-US/events-exported-to-json-format.html).",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ESETPROTECT",
        "baseQuery": "ESETPROTECT"
      }
    ],
    "sampleQueries": [
      {
        "description": "ESET threat events",
        "query": "ESETPROTECT\n| where EventType == 'Threat_Event'\n| sort by TimeGenerated desc"
      },
      {
        "description": "Top 10 detected threats",
        "query": "ESETPROTECT\n| where EventType == 'Threat_Event'\n| summarize ThreatCount = count() by tostring(ThreatName)\n| top 10 by ThreatCount"
      },
      {
        "description": "ESET firewall events",
        "query": "ESETPROTECT\n| where EventType == 'FirewallAggregated_Event'\n| sort by TimeGenerated desc"
      },
      {
        "description": "ESET threat events",
        "query": "ESETPROTECT\n| where EventType == 'Threat_Event'\n| sort by TimeGenerated desc"
      },
      {
        "description": "ESET threat events from Real-time file system protection",
        "query": "ESETPROTECT\n| where EventType == 'Threat_Event'\n| where ScanId == 'Real-time file system protection'\n| sort by TimeGenerated desc"
      },
      {
        "description": "Query ESET threat events from On-demand scanner",
        "query": "ESETPROTECT\n| where EventType == 'Threat_Event'\n| where ScanId == 'On-demand scanner'\n| sort by TimeGenerated desc"
      },
      {
        "description": "Top hosts by number of threat events",
        "query": "ESETPROTECT\n| where EventType == 'Threat_Event'\n| summarize threat_events_count = count() by HostName\n| sort by threat_events_count desc"
      },
      {
        "description": "ESET web sites filter",
        "query": "ESETPROTECT\n| where EventType == 'FilteredWebsites_Event'\n| sort by TimeGenerated desc"
      },
      {
        "description": "ESET audit events",
        "query": "ESETPROTECT\n| where EventType == 'Audit_Event'\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog (ESETPROTECT)",
        "lastDataReceivedQuery": "ESETPROTECT\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ESETPROTECT\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "write permission is required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias ESETPROTECT and load the function code or click [here](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/ESETPROTECT/Parsers/ESETPROTECT.txt).The function usually takes 10-15 minutes to activate after solution installation/update.",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux",
        "description": "Typically, you should install the agent on a different computer from the one on which the logs are generated.\n\n>  Syslog logs are collected only from **Linux** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Configure the facilities you want to collect and their severities.\n\n1.  Under workspace advanced settings **Configuration**, select **Data** and then **Syslog**.\n2.  Select **Apply below configuration to my machines** and select the facilities and severities. The default ESET PROTECT facility is **user**.\n3.  Click **Save**.",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenSyslogSettings"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "3. Configure ESET PROTECT",
        "description": "Configure ESET PROTECT to send all events through Syslog.\n\n1.  Follow [these instructions](https://help.eset.com/protect_admin/latest/en-US/admin_server_settings_syslog.html) to configure syslog output. Make sure to select **BSD** as the format and **TCP** as the transport.\n\n2.  Follow [these instructions](https://help.eset.com/protect_admin/latest/en-US/admin_server_settings_export_to_syslog.html) to export all logs to syslog. Select **JSON** as the output format.\n\nNote:- Refer to the [documentation](https://learn.microsoft.com/en-us/azure/sentinel/connect-log-forwarder?tabs=rsyslog#security-considerations) for setting up the log forwarder for both local and cloud storage.",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenSyslogSettings"
            },
            "type": "InstallAgent"
          }
        ]
      }
    ],
    "metadata": {
      "id": "eca50d7c-3058-4c91-89cf-bd34c391b12e",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "ESET Netherlands"
      },
      "support": {
        "tier": "developer",
        "name": "ESET Netherlands",
        "link": "https://techcenter.eset.nl/en/"
      }
    }
  },
  {
    "id": "ESETProtectPlatform",
    "title": "ESET Protect Platform",
    "publisher": "ESET",
    "descriptionMarkdown": "The ESET Protect Platform data connector enables users to inject detections data from [ESET Protect Platform](https://www.eset.com/int/business/protect-platform/) using the provided [Integration REST API](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/ESET%20Protect%20Platform/Data%20Connectors). Integration REST API runs as scheduled Azure Function App.",
    "graphQueries": [
      {
        "metricName": "Total detections received",
        "legend": "IntegrationTable_CL",
        "baseQuery": "IntegrationTable_CL"
      },
      {
        "metricName": "New incidents received",
        "legend": "IntegrationTableIncidents_CL",
        "baseQuery": "IntegrationTableIncidents_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All detections sorted by time",
        "query": "IntegrationTable_CL\n| sort by TimeGenerated desc"
      },
      {
        "description": "All incidents sorted by time",
        "query": "IntegrationTableIncidents_CL\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "IntegrationTable_CL",
        "lastDataReceivedQuery": "IntegrationTable_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "IntegrationTableIncidents_CL",
        "lastDataReceivedQuery": "IntegrationTableIncidents_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "IntegrationTable_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "IntegrationTableIncidents_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Permission to register an application in Microsoft Entra ID",
          "description": "Sufficient permissions to register an application with your Microsoft Entra tenant are required."
        },
        {
          "name": "Permission to assign a role to the registered application",
          "description": "Permission to assign the Monitoring Metrics Publisher role to the registered application in Microsoft Entra ID is required."
        }
      ]
    },
    "instructionSteps": [
      {
        "description": ">**NOTE:** The ESET Protect Platform data connector uses Azure Functions to connect to the ESET Protect Platform via Eset Connect API to pull detections logs into Microsoft Sentinel. This process might result in additional data ingestion costs. See details on the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/)."
      },
      {
        "description": ">**NOTE:** The newest version of the ESET PROTECT Platform and Microsoft Sentinel integration pulls not only detections logs but also newly created incidents. If your integration was set up before 20.06.2025, please follow [these steps](https://help.eset.com/eset_connect/en-US/update_ms_sentinel_integration.html) to update it."
      },
      {
        "title": "Step 1 -  Create an API user",
        "description": "Use this [instruction](https://help.eset.com/eset_connect/en-US/create_api_user_account.html) to create an ESET Connect API User account with **Login** and **Password**."
      },
      {
        "title": "Step 2 -  Create a registered application",
        "description": "Create a Microsoft Entra ID registered application by following the steps in the [Register a new application instruction.](https://learn.microsoft.com/en-us/entra/identity-platform/quickstart-register-app)"
      },
      {
        "title": "Step 3 - Deploy the ESET Protect Platform data connector using the Azure Resource Manager (ARM) template",
        "description": "\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-EsetProtectionPlatform-azuredeploy)\n\n2. Select the name of the **Log Analytics workspace** associated with your Microsoft Sentinel. Select the same **Resource Group** as the Resource Group of the Log Analytics workspace.\n\n3. Type the parameters of the registered application in Microsoft Entra ID: **Azure Client ID**, **Azure Client Secret**, **Azure Tenant ID**, **Object ID**. You can find the **Object ID** on Azure Portal by following this path \n> Microsoft Entra ID -> Manage (on the left-side menu) -> Enterprise applications -> Object ID column (the value next to your registered application name).\n\n4. Provide the ESET Connect API user account **Login** and **Password** obtained in **Step 1**.\n\n5. Select one or more ESET products (ESET PROTECT, ESET Inspect, ESET Cloud Office Security) from which detections are retrieved."
      }
    ]
  },
  {
    "id": "EsetSMC",
    "title": "Eset Security Management Center",
    "publisher": "Eset",
    "descriptionMarkdown": "Connector for [Eset SMC](https://help.eset.com/esmc_admin/72/en-US/) threat events, audit logs, firewall events and web sites filter.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "eset_CL",
        "baseQuery": "eset_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Query Eset firewall events",
        "query": "eset_CL\r\n| where event_type_s == 'FirewallAggregated_Event'\r\n| sort by TimeGenerated desc"
      },
      {
        "description": "Query Eset threat events",
        "query": "eset_CL\r\n| where event_type_s == 'Threat_Event'\r\n| sort by TimeGenerated desc"
      },
      {
        "description": "Query Eset threat events from Real-time file system protection",
        "query": "eset_CL\r\n| where event_type_s == 'Threat_Event'\r\n| where scanner_id_s == 'Real-time file system protection'\r\n| sort by TimeGenerated desc"
      },
      {
        "description": "Query Eset threat events from On-demand scanner",
        "query": "eset_CL\r\n| where event_type_s == 'Threat_Event'\r\n| where scanner_id_s == 'On-demand scanner'\r\n| sort by TimeGenerated desc"
      },
      {
        "description": "Top hosts by number of threat events",
        "query": "eset_CL\r\n| where event_type_s == 'Threat_Event'\r\n| summarize threat_events_count = count() by hostname_s\r\n| sort by threat_events_count desc"
      },
      {
        "description": "Top threats",
        "query": "eset_CL\r\n| where event_type_s == 'Threat_Event'\r\n| summarize threat_events_count = count() by threat_name_s\r\n| sort by threat_events_count desc"
      },
      {
        "description": "Query Eset web sites filter",
        "query": "eset_CL\r\n| where event_type_s == 'FilteredWebsites_Event'\r\n| sort by TimeGenerated desc"
      },
      {
        "description": "Query Eset audit events",
        "query": "eset_CL\r\n| where event_type_s == 'Audit_Event'\r\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "eset_CL",
        "lastDataReceivedQuery": "eset_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "eset_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Access to Eset SMC console",
          "description": "Permissions to configure log export"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Install and onboard the agent for Linux",
        "description": "Typically, you should install the agent on a different computer from the one on which the logs are generated.\n\n>  Syslog logs are collected only from **Linux** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Configure rsyslog to accept logs from your Eset SMC IP address.\n\n```\nsudo -i\r\n\r\n# Set ESET SMC source IP address\r\nexport ESETIP={Enter your IP address}\r\n\r\n# Create rsyslog configuration file\r\ncat > /etc/rsyslog.d/80-remote.conf << EOF\r\n\\$ModLoad imudp\r\n\\$UDPServerRun 514\r\n\\$ModLoad imtcp\r\n\\$InputTCPServerRun 514\r\n\\$AllowedSender TCP, 127.0.0.1, $ESETIP\r\n\\$AllowedSender UDP, 127.0.0.1, $ESETIP\r\nuser.=alert;user.=crit;user.=debug;user.=emerg;user.=err;user.=info;user.=notice;user.=warning  @127.0.0.1:25224\r\nEOF\r\n\r\n# Restart rsyslog\r\nsystemctl restart rsyslog```"
      },
      {
        "title": "3. Configure OMS agent to pass Eset SMC data in API format",
        "description": "In order to easily recognize Eset data we will push it to separate table and parse at agent so query in Azure Sentinel is easier and fast. To make it simple we will just modify ```match oms.**``` section to send data as API objects by changing type to out_oms_api. Modify file on /etc/opt/microsoft/omsagent/{REPLACEyourworkspaceid}/conf/omsagent.conf. Full ```match oms.**``` section looks like this:\r\n\r\n```\r\n<match oms.** docker.**>\r\n  type out_oms_api\r\n  log_level info\r\n  num_threads 5\r\n  run_in_background false\r\n\r\n  omsadmin_conf_path /etc/opt/microsoft/omsagent/{REPLACEyourworkspaceid}/conf/omsadmin.conf\r\n  cert_path /etc/opt/microsoft/omsagent/{REPLACEyourworkspaceid}/certs/oms.crt\r\n  key_path /etc/opt/microsoft/omsagent/{REPLACEyourworkspaceid}/certs/oms.key\r\n\r\n  buffer_chunk_limit 15m\r\n  buffer_type file\r\n  buffer_path /var/opt/microsoft/omsagent/{REPLACEyourworkspaceid}/state/out_oms_common*.buffer\r\n\r\n  buffer_queue_limit 10\r\n  buffer_queue_full_action drop_oldest_chunk\r\n  flush_interval 20s\r\n  retry_limit 10\r\n  retry_wait 30s\r\n  max_retry_wait 9m\r\n</match>\r\n```\r\n"
      },
      {
        "title": "4. Change OMS agent configuration to catch tag oms.api.eset and parse structured data",
        "description": "Modify file /etc/opt/microsoft/omsagent/{REPLACEyourworkspaceid}/conf/omsagent.d/syslog.conf\n```\r\n<source>\r\n  type syslog\r\n  port 25224\r\n  bind 127.0.0.1\r\n  protocol_type udp\r\n  tag oms.api.eset\r\n</source>\r\n\r\n<filter oms.api.**>\r\n  @type parser\r\n  key_name message\r\n  format /(?<message>.*?{.*})/\r\n</filter>\r\n\r\n<filter oms.api.**>\r\n  @type parser\r\n  key_name message\r\n  format json\r\n</filter>\r\n```"
      },
      {
        "title": "5. Disable automatic configuration and restart agent",
        "description": "```bash\r\n# Disable changes to configuration files from Portal\r\nsudo su omsagent -c 'python /opt/microsoft/omsconfig/Scripts/OMS_MetaConfigHelper.py --disable'\r\n\r\n# Restart agent\r\nsudo /opt/microsoft/omsagent/bin/service_control restart\r\n\r\n# Check agent logs\r\ntail -f /var/opt/microsoft/omsagent/log/omsagent.log\r\n```"
      },
      {
        "title": "6. Configure Eset SMC to send logs to connector",
        "description": "Configure Eset Logs using BSD style and JSON format.\r\n- Go to Syslog server configuration as described in [Eset documentation](https://help.eset.com/esmc_admin/72/en-US/admin_server_settings.html?admin_server_settings_syslog.html) and configure Host (your connector), Format BSD, Transport TCP\r\n- Go to Logging section as described in [Eset documentation](https://help.eset.com/esmc_admin/72/en-US/admin_server_settings.html?admin_server_settings_export_to_syslog.html) and enable JSON"
      }
    ]
  },
  {
    "id": "ESI-ExchangeAdminAuditLogEvents",
    "title": "[Deprecated] Microsoft Exchange Logs and Events",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Deprecated, use the 'ESI-Opt' dataconnectors. You can stream all Exchange Audit events, IIS Logs, HTTP Proxy logs and Security Event logs from the Windows machines connected to your Microsoft Sentinel workspace using the Windows agent. This connection enables you to view dashboards, create custom alerts, and improve investigation. This is used by Microsoft Exchange Security Workbooks to provide security insights of your On-Premises Exchange environment",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "[Option1] ExchangeAuditLogs",
        "baseQuery": "Event | where EventLog == 'MSExchange Management'"
      },
      {
        "metricName": "Total data received",
        "legend": "[Option 2] Exchange Eventlogs",
        "baseQuery": "Event | where EventLog == 'Application'"
      },
      {
        "metricName": "Total data received",
        "legend": "[Option 3 & 4] Domain Controllers Security Logs",
        "baseQuery": "SecurityEvent"
      },
      {
        "metricName": "Total data received",
        "legend": "[Option 5] Exchange IIS logs",
        "baseQuery": "W3CIISLog"
      },
      {
        "metricName": "Total data received",
        "legend": "[Option 6] Exchange Message Tracking logs",
        "baseQuery": "MessageTrackingLog_CL"
      },
      {
        "metricName": "Total data received",
        "legend": "[Option 7] Exchange HTTPProxy logs",
        "baseQuery": "ExchangeHttpProxy_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Audit logs",
        "query": "Event | where EventLog == 'MSExchange Management' | sort by TimeGenerated"
      }
    ],
    "dataTypes": [
      {
        "name": "Event",
        "lastDataReceivedQuery": "Event | where EventLog in ('MSExchange Management', 'Application', 'System')  | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
      },
      {
        "name": "W3CIISLog",
        "lastDataReceivedQuery": "W3CIISLog  | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
      },
      {
        "name": "MessageTrackingLog_CL",
        "lastDataReceivedQuery": "MessageTrackingLog_CL  | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
      },
      {
        "name": "ExchangeHttpProxy_CL",
        "lastDataReceivedQuery": "ExchangeHttpProxy_CL  | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Event | where EventLog in ('MSExchange Management', 'Application', 'System')  | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(7d)",
          "W3CIISLog  | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(7d)",
          "MessageTrackingLog_CL  | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(7d)",
          "ExchangeHttpProxy_CL  | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "Azure Log Analytics will be deprecated, to collect data from non-Azure VMs, Azure Arc is recommended. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "name": "Detailled documentation",
          "description": ">**NOTE:** Detailled documentation on Installation procedure and usage can be found [here](https://aka.ms/MicrosoftExchangeSecurityGithub)"
        }
      ]
    },
    "instructionSteps": [
      {
        "description": ">**NOTE:** This solution is based on options. This allows you to choose which data will be ingest as some options can generate a very high volume of data. Depending on what you want to collect, track in your Workbooks, Analytics Rules, Hunting capabilities you will choose the option(s) you will deploy. Each options are independant for one from the other. To learn more about each option: ['Microsoft Exchange Security' wiki](https://aka.ms/ESI_DataConnectorOptions)"
      },
      {
        "title": "1.  Download and install the agents needed to collect logs for Microsoft Sentinel",
        "description": "Type of servers (Exchange Servers, Domain Controllers linked to Exchange Servers or all Domain Controllers) depends on the option you want to deploy.",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Deploy Monitor Agents",
                  "description": "This step is required only if it's the first time you onboard your Exchange Servers/Domain Controllers",
                  "instructions": [
                    {
                      "parameters": {
                        "title": "Select which agent you want to install in your servers to collect logs:",
                        "instructionSteps": [
                          {
                            "title": "[Prefered] Azure Monitor Agent via Azure Arc",
                            "description": "**Deploy the Azure Arc Agent**\n> [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
                          },
                          {
                            "title": "Install Azure Log Analytics Agent (Deprecated on 31/08/2024)",
                            "description": "1. Download the Azure Log Analytics Agent and choose the deployment method in the below link.",
                            "instructions": [
                              {
                                "parameters": {
                                  "linkType": "InstallAgentOnNonAzure"
                                },
                                "type": "InstallAgent"
                              }
                            ]
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2.  Deploy log injestion following choosed options",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "[Option 1] MS Exchange Management Log collection",
                  "description": "Select how to stream MS Exchange Admin Audit event logs",
                  "instructions": [
                    {
                      "parameters": {
                        "title": "MS Exchange Admin Audit event logs",
                        "instructionSteps": [
                          {
                            "title": "Data Collection Rules - When Azure Monitor Agent is used",
                            "description": "**Enable data collection rule**\n>  Microsoft Exchange Admin Audit Events logs are collected only from **Windows** agents.",
                            "instructions": [
                              {
                                "parameters": {
                                  "instructionSteps": [
                                    {
                                      "title": "Option 1 - Azure Resource Manager (ARM) Template",
                                      "description": "Use this method for automated deployment of the DCR.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-ESI-DCROption1-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace Name** 'and/or Other required fields'.\n>4.  Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5.  Click **Purchase** to deploy."
                                    },
                                    {
                                      "title": "Option 2 - Manual Deployment of Azure Automation",
                                      "description": "Use the following step-by-step instructions to deploy manually a Data Collection Rule.",
                                      "instructions": [
                                        {
                                          "parameters": {
                                            "instructionSteps": [
                                              {
                                                "title": "A. Create DCR, Type Event log",
                                                "description": "1.  From the Azure Portal, navigate to [Azure Data collection rules](https://portal.azure.com/#view/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/~/dataCollectionRules).\n2. Click **+ Create** at the top.\n3. In the **Basics** tab, fill the required fields, Select Windows as platform type and give a name to the DCR. \n4. In the **Resources** tab, enter you Exchange Servers.\n5. In 'Collect and deliver', add a Data Source type 'Windows Event logs' and select 'Custom' option, enter 'MSExchange Management' as expression and Add it.\n6. 'Make other preferable configuration changes', if needed, then click **Create**."
                                              }
                                            ]
                                          },
                                          "type": "InstructionStepsGroup"
                                        }
                                      ]
                                    },
                                    {
                                      "title": "Assign the DCR to all Exchange Servers",
                                      "description": "Add all your Exchange Servers to the DCR"
                                    }
                                  ]
                                },
                                "type": "InstructionStepsGroup"
                              }
                            ]
                          },
                          {
                            "title": "Data Collection Rules - When the legacy Azure Log Analytics Agent is used",
                            "description": "**Configure the logs to be collected**\n\nConfigure the Events you want to collect and their severities.\n\n1.  Under workspace **Legacy agents management**, select **Windows Event logs**.\n2.  Click **Add Windows event log** and enter **MSExchange Management** as log name.\n3.  Collect Error, Warning and Information types\n4.  Click **Save**.",
                            "instructions": [
                              {
                                "parameters": {
                                  "linkType": "OpenSyslogSettings"
                                },
                                "type": "InstallAgent"
                              }
                            ]
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          },
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "[Option 2] Security/Application/System logs of Exchange Servers",
                  "description": "Select how to stream Security/Application/System logs of Exchange Servers",
                  "instructions": [
                    {
                      "parameters": {
                        "title": "Security Event log collection",
                        "instructionSteps": [
                          {
                            "title": "Data Collection Rules - Security Event logs",
                            "description": "**Enable data collection rule for Security Logs**\nSecurity Events logs are collected only from **Windows** agents.\n1. Add Exchange Servers on *Resources* tab.\n2. Select Security log level\n\n>  **Common level** is the minimum required. Please select 'Common' or 'All Security Events' on DCR definition.",
                            "instructions": [
                              {
                                "parameters": {
                                  "linkType": "OpenCreateDataCollectionRule",
                                  "dataCollectionRuleType": 0
                                },
                                "type": "InstallAgent"
                              }
                            ]
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    },
                    {
                      "parameters": {
                        "title": "Application and System Event log collection",
                        "instructionSteps": [
                          {
                            "title": "Data Collection Rules - When Azure Monitor Agent is used",
                            "description": "**Enable data collection rule**\n>  Application and System Events logs are collected only from **Windows** agents.",
                            "instructions": [
                              {
                                "parameters": {
                                  "instructionSteps": [
                                    {
                                      "title": "Option 1 - Azure Resource Manager (ARM) Template",
                                      "description": "Use this method for automated deployment of the DCR.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-ESI-DCROption2-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace Name** 'and/or Other required fields'.\n>4.  Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5.  Click **Purchase** to deploy."
                                    },
                                    {
                                      "title": "Option 2 - Manual Deployment of Azure Automation",
                                      "description": "Use the following step-by-step instructions to deploy manually a Data Collection Rule.",
                                      "instructions": [
                                        {
                                          "parameters": {
                                            "instructionSteps": [
                                              {
                                                "title": "A. Create DCR, Type Event log",
                                                "description": "1.  From the Azure Portal, navigate to [Azure Data collection rules](https://portal.azure.com/#view/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/~/dataCollectionRules).\n2. Click **+ Create** at the top.\n3. In the **Basics** tab, fill the required fields, Select Windows as platform type and give a name to the DCR. \n4. In the **Resources** tab, enter you Exchange Servers.\n5. In 'Collect and deliver', add a Data Source type 'Windows Event logs' and select 'Basic' option.\n6. For Application, select 'Critical', 'Error' and 'Warning'. For System, select Critical/Error/Warning/Information. \n7. 'Make other preferable configuration changes', if needed, then click **Create**."
                                              }
                                            ]
                                          },
                                          "type": "InstructionStepsGroup"
                                        }
                                      ]
                                    },
                                    {
                                      "title": "Assign the DCR to all Exchange Servers",
                                      "description": "Add all your Exchange Servers to the DCR"
                                    }
                                  ]
                                },
                                "type": "InstructionStepsGroup"
                              }
                            ]
                          },
                          {
                            "title": "Data Collection Rules - When the legacy Azure Log Analytics Agent is used",
                            "description": "**Configure the logs to be collected**\n\nConfigure the Events you want to collect and their severities.\n\n1.  Under workspace advanced settings **Configuration**, select **Data** and then **Windows Event logs**.\n2.  Click **Add Windows event log** and search **Application** as log name.\n3.  Click **Add Windows event log** and search **System** as log name.\n4.  Collect Error (for all), Warning (for all) and Information (for System) types\n5.  Click **Save**.",
                            "instructions": [
                              {
                                "parameters": {
                                  "linkType": "OpenSyslogSettings"
                                },
                                "type": "InstallAgent"
                              }
                            ]
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          },
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "[Option 3 and 4] Security logs of Domain Controllers",
                  "description": "Select how to stream Security logs of Domain Controllers. If you want to implement Option 3, you just need to select DC on same site as Exchange Servers. If you want to implement Option 4, you can select all DCs of your forest.",
                  "instructions": [
                    {
                      "parameters": {
                        "instructionSteps": [
                          {
                            "title": "[Option 3] List only Domain Controllers on the same site as Exchange Servers for next step",
                            "description": "**This limits the quantity of data injested but some incident can't be detected.**"
                          },
                          {
                            "title": "[Option 4] List all Domain Controllers of your Active-Directory Forest for next step",
                            "description": "**This allows collecting all security events**"
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    },
                    {
                      "parameters": {
                        "title": "Security Event log collection",
                        "instructionSteps": [
                          {
                            "title": "Data Collection Rules - Security Event logs",
                            "description": "**Enable data collection rule for Security Logs**\nSecurity Events logs are collected only from **Windows** agents.\n1. Add chosen DCs on *Resources* tab.\n2. Select Security log level\n\n>  **Common level** is the minimum required. Please select 'Common' or 'All Security Events' on DCR definition.",
                            "instructions": [
                              {
                                "parameters": {
                                  "linkType": "OpenCreateDataCollectionRule",
                                  "dataCollectionRuleType": 0
                                },
                                "type": "InstallAgent"
                              }
                            ]
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          },
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "[Option 5] IIS logs of Exchange Servers",
                  "description": "Select how to stream IIS logs of Exchange Servers",
                  "instructions": [
                    {
                      "parameters": {
                        "instructionSteps": [
                          {
                            "title": "Data Collection Rules - When Azure Monitor Agent is used",
                            "description": "**Enable data collection rule**\n> IIS logs are collected only from **Windows** agents.",
                            "instructions": [
                              {
                                "type": "AdminAuditEvents"
                              },
                              {
                                "parameters": {
                                  "instructionSteps": [
                                    {
                                      "title": "Option 1 - Azure Resource Manager (ARM) Template",
                                      "description": "Use this method for automated deployment of the DCE and DCR.",
                                      "instructions": [
                                        {
                                          "parameters": {
                                            "instructionSteps": [
                                              {
                                                "title": "A. Create DCE (If not already created for Exchange Servers)",
                                                "description": "1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-ESI-DCEExchangeServers)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. You can change the proposed name of the DCE.\n5.  Click **Create** to deploy."
                                              },
                                              {
                                                "title": "B. Deploy Data Connection Rule",
                                                "description": "1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-ESI-DCROption5-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace ID** 'and/or Other required fields'.\n>4.  Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5.  Click **Purchase** to deploy."
                                              }
                                            ]
                                          },
                                          "type": "InstructionStepsGroup"
                                        }
                                      ]
                                    },
                                    {
                                      "title": "Option 2 - Manual Deployment of Azure Automation",
                                      "description": "Use the following step-by-step instructions to deploy manually a Data Collection Rule.",
                                      "instructions": [
                                        {
                                          "parameters": {
                                            "instructionSteps": [
                                              {
                                                "title": "A. Create DCE (If not already created for Exchange Servers)",
                                                "description": "1.  From the Azure Portal, navigate to [Azure Data collection Endpoint](https://portal.azure.com/#view/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/~/dataCollectionEndpoints).\n2. Click **+ Create** at the top.\n3. In the **Basics** tab, fill the required fields and give a name to the DCE. \n3. 'Make other preferable configuration changes', if needed, then click **Create**."
                                              },
                                              {
                                                "title": "B. Create DCR, Type IIS log",
                                                "description": "1.  From the Azure Portal, navigate to [Azure Data collection rules](https://portal.azure.com/#view/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/~/dataCollectionRules).\n2. Click **+ Create** at the top.\n3. In the **Basics** tab, fill the required fields, Select Windows as platform type and give a name to the DCR. Select the created DCE. \n4. In the **Resources** tab, enter you Exchange Servers.\n5. In 'Collect and deliver', add a Data Source type 'IIS logs' (Do not enter a path if IIS Logs path is configured by default). Click on 'Add data source'\n6. 'Make other preferable configuration changes', if needed, then click **Create**."
                                              }
                                            ]
                                          },
                                          "type": "InstructionStepsGroup"
                                        }
                                      ]
                                    },
                                    {
                                      "title": "Assign the DCR to all Exchange Servers",
                                      "description": "Add all your Exchange Servers to the DCR"
                                    }
                                  ]
                                },
                                "type": "InstructionStepsGroup"
                              }
                            ]
                          },
                          {
                            "title": "Data Collection Rules - When the legacy Azure Log Analytics Agent is used",
                            "description": "**Configure the logs to be collected**\n\nConfigure the Events you want to collect and their severities.\n\n1.  Under workspace advanced settings **Configuration**, select **Data** and then **IIS Logs**.\n2. Check **Collect W3C format IIS log files**\n5.  Click **Save**.",
                            "instructions": [
                              {
                                "parameters": {
                                  "linkType": "OpenSyslogSettings"
                                },
                                "type": "InstallAgent"
                              }
                            ]
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          },
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "[Option 6] Message Tracking of Exchange Servers",
                  "description": "Select how to stream Message Tracking of Exchange Servers",
                  "instructions": [
                    {
                      "parameters": {
                        "instructionSteps": [
                          {
                            "title": "Data Collection Rules - When Azure Monitor Agent is used",
                            "description": "**Enable data collection rule**\n> Message Tracking are collected only from **Windows** agents.",
                            "instructions": [
                              {
                                "parameters": {
                                  "text": "**Attention**, Custom logs in Monitor Agent is in Preview. The deployment doesn't work as expected for the moment (March 2023).",
                                  "inline": false
                                },
                                "type": "InfoMessage"
                              },
                              {
                                "parameters": {
                                  "instructionSteps": [
                                    {
                                      "title": "Option 1 - Azure Resource Manager (ARM) Template",
                                      "description": "Use this method for automated deployment of the DCE and DCR.",
                                      "instructions": [
                                        {
                                          "parameters": {
                                            "instructionSteps": [
                                              {
                                                "title": "A. Create DCE (If not already created for Exchange Servers)",
                                                "description": "1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-ESI-DCEExchangeServers)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. You can change the proposed name of the DCE.\n5.  Click **Create** to deploy."
                                              },
                                              {
                                                "title": "B. Deploy Data Connection Rule and Custom Table",
                                                "description": "1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-ESI-DCROption6-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace ID** 'and/or Other required fields'.\n>4.  Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5.  Click **Purchase** to deploy."
                                              }
                                            ]
                                          },
                                          "type": "InstructionStepsGroup"
                                        }
                                      ]
                                    },
                                    {
                                      "title": "Option 2 - Manual Deployment of Azure Automation",
                                      "description": "Use the following step-by-step instructions to deploy manually a Data Collection Rule.",
                                      "instructions": [
                                        {
                                          "parameters": {
                                            "instructionSteps": [
                                              {
                                                "title": "A. Create DCE (If not already created for Exchange Servers)",
                                                "description": "1.  From the Azure Portal, navigate to [Azure Data collection Endpoint](https://portal.azure.com/#view/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/~/dataCollectionEndpoints).\n2. Click **+ Create** at the top.\n3. In the **Basics** tab, fill the required fields and give a name to the DCE, like ESI-ExchangeServers. \n3. 'Make other preferable configuration changes', if needed, then click **Create**."
                                              },
                                              {
                                                "title": "B. Create Custom DCR Table",
                                                "description": "1. Download the Example file from [Microsoft Sentinel GitHub](https://aka.ms/Sentinel-Sample-ESI-MessageTrackingExampleFile).\n2.  From the Azure Portal, navigate to [Workspace Analytics](https://portal.azure.com/#view/HubsExtension/BrowseResource/resourceType/Microsoft.OperationalInsights%2Fworkspaces) and select your target Workspace.\n3. Click in 'Tables', click **+ Create** at the top and select **New Custom log (DCR-Based)**.\n4. In the **Basics** tab, enter **MessageTrackingLog** on the Table name, create a Data Collection rule with the name **DCR-Option6-MessageTrackingLogs** (for example) and select the previously created Data collection Endpoint.\n5. In the **Schema and Transformation** tab, choose the downloaded sample file and click on **Transformation Editor**.\n6. In the transformation field, enter the following KQL request :\n*source\n| extend TimeGenerated = todatetime(['date-time'])\n| extend\n    clientHostname = ['client-hostname'],\n    clientIP = ['client-ip'],\n    connectorId = ['connector-id'],\n    customData = ['custom-data'],\n    eventId = ['event-id'],\n    internalMessageId = ['internal-message-id'],\n    logId = ['log-id'],\n    messageId = ['message-id'],\n    messageInfo = ['message-info'],\n    messageSubject = ['message-subject'],\n    networkMessageId = ['network-message-id'],\n    originalClientIp =  ['original-client-ip'],\n    originalServerIp = ['original-server-ip'],\n    recipientAddress= ['recipient-address'],\n    recipientCount= ['recipient-count'],\n    recipientStatus= ['recipient-status'],\n    relatedRecipientAddress= ['related-recipient-address'],\n    returnPath= ['return-path'],\n    senderAddress= ['sender-address'],\n    senderHostname= ['server-hostname'],\n    serverIp= ['server-ip'],\n    sourceContext= ['source-context'],\n    schemaVersion=['schema-version'],\n    messageTrackingTenantId = ['tenant-id'],\n    totalBytes = ['total-bytes'],\n    transportTrafficType = ['transport-traffic-type']\n| project-away\n    ['client-ip'],\n    ['client-hostname'],\n    ['connector-id'],\n    ['custom-data'],\n    ['date-time'],\n    ['event-id'],\n    ['internal-message-id'],\n    ['log-id'],\n    ['message-id'],\n    ['message-info'],\n    ['message-subject'],\n    ['network-message-id'],\n    ['original-client-ip'],\n    ['original-server-ip'],\n    ['recipient-address'],\n    ['recipient-count'],\n    ['recipient-status'],\n    ['related-recipient-address'],\n    ['return-path'],\n    ['sender-address'],\n    ['server-hostname'],\n    ['server-ip'],\n    ['source-context'],\n    ['schema-version'],\n    ['tenant-id'],\n    ['total-bytes'],\n    ['transport-traffic-type']*\n\n8. Click 'Run' and after 'Apply'.\n9. Click **Next**, then click **Create**."
                                              },
                                              {
                                                "title": "C. Modify the created DCR, Type Custom log",
                                                "description": "1.  From the Azure Portal, navigate to [Azure Data collection rules](https://portal.azure.com/#view/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/~/dataCollectionRules).\n2. Select the previously created DCR, like **DCR-Option6-MessageTrackingLogs**.\n3. In the **Resources** tab, enter you Exchange Servers.\n4. In **Data Sources**, add a Data Source type 'Custom Text logs' and enter 'C:\\Program Files\\Microsoft\\Exchange Server\\V15\\TransportRoles\\Logs\\MessageTracking\\*.log' in file pattern, 'MessageTrackingLog_CL' in Table Name.\n6.in Transform field, enter the following KQL request :\n*source\n| extend TimeGenerated = todatetime(['date-time'])\n| extend\n    clientHostname = ['client-hostname'],\n    clientIP = ['client-ip'],\n    connectorId = ['connector-id'],\n    customData = ['custom-data'],\n    eventId = ['event-id'],\n    internalMessageId = ['internal-message-id'],\n    logId = ['log-id'],\n    messageId = ['message-id'],\n    messageInfo = ['message-info'],\n    messageSubject = ['message-subject'],\n    networkMessageId = ['network-message-id'],\n    originalClientIp =  ['original-client-ip'],\n    originalServerIp = ['original-server-ip'],\n    recipientAddress= ['recipient-address'],\n    recipientCount= ['recipient-count'],\n    recipientStatus= ['recipient-status'],\n    relatedRecipientAddress= ['related-recipient-address'],\n    returnPath= ['return-path'],\n    senderAddress= ['sender-address'],\n    senderHostname= ['server-hostname'],\n    serverIp= ['server-ip'],\n    sourceContext= ['source-context'],\n    schemaVersion=['schema-version'],\n    messageTrackingTenantId = ['tenant-id'],\n    totalBytes = ['total-bytes'],\n    transportTrafficType = ['transport-traffic-type']\n| project-away\n    ['client-ip'],\n    ['client-hostname'],\n    ['connector-id'],\n    ['custom-data'],\n    ['date-time'],\n    ['event-id'],\n    ['internal-message-id'],\n    ['log-id'],\n    ['message-id'],\n    ['message-info'],\n    ['message-subject'],\n    ['network-message-id'],\n    ['original-client-ip'],\n    ['original-server-ip'],\n    ['recipient-address'],\n    ['recipient-count'],\n    ['recipient-status'],\n    ['related-recipient-address'],\n    ['return-path'],\n    ['sender-address'],\n    ['server-hostname'],\n    ['server-ip'],\n    ['source-context'],\n    ['schema-version'],\n    ['tenant-id'],\n    ['total-bytes'],\n    ['transport-traffic-type']* \n7. Click on 'Add data source'."
                                              }
                                            ]
                                          },
                                          "type": "InstructionStepsGroup"
                                        }
                                      ]
                                    },
                                    {
                                      "title": "Assign the DCR to all Exchange Servers",
                                      "description": "Add all your Exchange Servers to the DCR"
                                    }
                                  ]
                                },
                                "type": "InstructionStepsGroup"
                              }
                            ]
                          },
                          {
                            "title": "Data Collection Rules - When the legacy Azure Log Analytics Agent is used",
                            "description": "**Configure the logs to be collected**\n\n1.  Under workspace **Settings** part, select **Tables**, click **+ Create** and click on **New custom log (MMA-Based)**.\n2.  Select Sample file **[MessageTracking Sample](https://aka.ms/Sentinel-Sample-ESI-MessageTrackingLogsSampleCSV)** and click Next\n3. Select type **Windows** and enter the path **C:\\Program Files\\Microsoft\\Exchange Server\\V15\\TransportRoles\\Logs\\MessageTracking\\*.log**. Click Next.\n4. Enter **MessageTrackingLog** as Table name and click Next.\n5.  Click **Save**.",
                            "instructions": [
                              {
                                "parameters": {
                                  "linkType": "OpenSyslogSettings"
                                },
                                "type": "InstallAgent"
                              }
                            ]
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          },
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "[Option 7] HTTP Proxy of Exchange Servers",
                  "description": "Select how to stream HTTP Proxy of Exchange Servers",
                  "instructions": [
                    {
                      "parameters": {
                        "instructionSteps": [
                          {
                            "title": "Data Collection Rules - When Azure Monitor Agent is used",
                            "description": "**Enable data collection rule**\n> Message Tracking are collected only from **Windows** agents.",
                            "instructions": [
                              {
                                "parameters": {
                                  "text": "**Attention**, Custom logs in Monitor Agent is in Preview. The deployment doesn't work as expected for the moment (March 2023).",
                                  "inline": false
                                },
                                "type": "InfoMessage"
                              },
                              {
                                "parameters": {
                                  "instructionSteps": [
                                    {
                                      "title": "Option 1 - Azure Resource Manager (ARM) Template",
                                      "description": "Use this method for automated deployment of the DCE and DCR.",
                                      "instructions": [
                                        {
                                          "parameters": {
                                            "instructionSteps": [
                                              {
                                                "title": "A. Create DCE (If not already created for Exchange Servers)",
                                                "description": "1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-ESI-DCEExchangeServers)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. You can change the proposed name of the DCE.\n5.  Click **Create** to deploy."
                                              },
                                              {
                                                "title": "B. Deploy Data Connection Rule",
                                                "description": "1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-ESI-DCROption7-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace ID** 'and/or Other required fields'.\n>4.  Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5.  Click **Purchase** to deploy."
                                              }
                                            ]
                                          },
                                          "type": "InstructionStepsGroup"
                                        }
                                      ]
                                    },
                                    {
                                      "title": "Option 2 - Manual Deployment of Azure Automation",
                                      "description": "Use the following step-by-step instructions to deploy manually a Data Collection Rule.",
                                      "instructions": [
                                        {
                                          "parameters": {
                                            "instructionSteps": [
                                              {
                                                "title": "A. Create DCE (If not already created for Exchange Servers)",
                                                "description": "1.  From the Azure Portal, navigate to [Azure Data collection Endpoint](https://portal.azure.com/#view/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/~/dataCollectionEndpoints).\n2. Click **+ Create** at the top.\n3. In the **Basics** tab, fill the required fields and give a name to the DCE. \n3. 'Make other preferable configuration changes', if needed, then click **Create**."
                                              },
                                              {
                                                "title": "B. Create Custom DCR Table",
                                                "description": "1. Download the Example file from [Microsoft Sentinel GitHub](https://aka.ms/Sentinel-Sample-ESI-HTTPProxyExampleFile).\n2.  From the Azure Portal, navigate to [Workspace Analytics](https://portal.azure.com/#view/HubsExtension/BrowseResource/resourceType/Microsoft.OperationalInsights%2Fworkspaces) and select your target Workspace.\n3. Click in 'Tables', click **+ Create** at the top and select **New Custom log (DCR-Based)**.\n4. In the **Basics** tab, enter **ExchangeHttpProxy** on the Table name, create a Data Collection rule with the name **DCR-Option7-HTTPProxyLogs** (for example) and select the previously created Data collection Endpoint.\n5. In the **Schema and Transformation** tab, choose the downloaded sample file and click on **Transformation Editor**.\n6. In the transformation field, enter the following KQL request :\n*source\n| extend TimeGenerated = todatetime(DateTime)\n| project-away DateTime\n*\n\n8. Click 'Run' and after 'Apply'.\n9. Click **Next**, then click **Create**."
                                              },
                                              {
                                                "title": "C. Modify the created DCR, Type Custom log",
                                                "description": "1.  From the Azure Portal, navigate to [Azure Data collection rules](https://portal.azure.com/#view/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/~/dataCollectionRules).\n2. Select the previously created DCR, like **DCR-Option7-HTTPProxyLogs**.\n3. In the **Resources** tab, enter you Exchange Servers.\n4. In **Data Sources**, add a Data Source type 'Custom Text logs' and enter 'C:\\Program Files\\Microsoft\\Exchange Server\\V15\\Logging\\HttpProxy\\Autodiscover\\*.log' in file pattern, 'ExchangeHttpProxy_CL' in Table Name.\n6.in Transform field, enter the following KQL request :\n*source\n| extend TimeGenerated = todatetime(DateTime)\n| project-away DateTime* \n7. Click on 'Add data source'."
                                              }
                                            ]
                                          },
                                          "type": "InstructionStepsGroup"
                                        }
                                      ]
                                    },
                                    {
                                      "title": "Assign the DCR to all Exchange Servers",
                                      "description": "Add all your Exchange Servers to the DCR"
                                    }
                                  ]
                                },
                                "type": "InstructionStepsGroup"
                              }
                            ]
                          },
                          {
                            "title": "Data Collection Rules - When the legacy Azure Log Analytics Agent is used",
                            "description": "**Configure the logs to be collected**\n\n1.  Under workspace **Settings** part, select **Tables**, click **+ Create** and click on **New custom log (MMA-Based)**.\n2.  Select Sample file **[MessageTracking Sample](https://aka.ms/Sentinel-Sample-ESI-HttpProxySampleCSV)** and click Next\n3. Select type **Windows** and enter all the following paths **C:\\Program Files\\Microsoft\\Exchange Server\\V15\\Logging\\HttpProxy\\Autodiscover\\*.log**, **C:\\Program Files\\Microsoft\\Exchange Server\\V15\\Logging\\HttpProxy\\Eas\\*.log**, **C:\\Program Files\\Microsoft\\Exchange Server\\V15\\Logging\\HttpProxy\\Ecp\\*.log**, **C:\\Program Files\\Microsoft\\Exchange Server\\V15\\Logging\\HttpProxy\\Ews\\*.log**, **C:\\Program Files\\Microsoft\\Exchange Server\\V15\\Logging\\HttpProxy\\Mapi\\*.log**, **C:\\Program Files\\Microsoft\\Exchange Server\\V15\\Logging\\HttpProxy\\Oab\\*.log**, **C:\\Program Files\\Microsoft\\Exchange Server\\V15\\Logging\\HttpProxy\\Owa\\*.log**, **C:\\Program Files\\Microsoft\\Exchange Server\\V15\\Logging\\HttpProxy\\OwaCalendar\\*.log**, **C:\\Program Files\\Microsoft\\Exchange Server\\V15\\Logging\\HttpProxy\\PowerShell\\*.log** and **C:\\Program Files\\Microsoft\\Exchange Server\\V15\\Logging\\HttpProxy\\RpcHttp\\*.log** . Click Next.\n4. Enter **ExchangeHttpProxy** as Table name and click Next.\n5.  Click **Save**.",
                            "instructions": [
                              {
                                "parameters": {
                                  "linkType": "OpenSyslogSettings"
                                },
                                "type": "InstallAgent"
                              }
                            ]
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected. Parsers are automatically deployed with the solution. Follow the steps to create the Kusto Functions alias : [**ExchangeAdminAuditLogs**](https://aka.ms/sentinel-ESI-ExchangeCollector-ExchangeAdminAuditLogs-parser)",
        "instructions": [
          {
            "parameters": {
              "title": "Parsers are automatically deployed during Solution deployment. If you want to deploy manually, follow the steps below",
              "instructionSteps": [
                {
                  "title": "Manual Parser Deployment",
                  "instructions": [
                    {
                      "parameters": {
                        "instructionSteps": [
                          {
                            "title": "1. Download the Parser file",
                            "description": "The latest version of the file [**ExchangeAdminAuditLogs**](https://aka.ms/sentinel-ESI-ExchangeCollector-ExchangeAdminAuditLogs-parser)"
                          },
                          {
                            "title": "2. Create Parser **ExchangeAdminAuditLogs** function",
                            "description": "In 'Logs' explorer of your Microsoft Sentinel's log analytics, copy the content of the file to Log explorer"
                          },
                          {
                            "title": "3. Save Parser **ExchangeAdminAuditLogs** function",
                            "description": "Click on save button.\n No parameter is needed for this parser.\nClick save again."
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ],
    "metadata": {
      "id": "5738bef7-b6c0-4fec-ba0b-ac728bef83a9",
      "version": "2.2.2",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "Microsoft Exchange Security - Exchange On-Premises"
      },
      "support": {
        "name": "Community",
        "tier": "Community",
        "link": "https://github.com/Azure/Azure-Sentinel/issues"
      },
      "author": {
        "name": "Microsoft"
      }
    }
  },
  {
    "id": "ESI-ExchangeOnlineCollector",
    "title": "Exchange Security Insights Online Collector",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Connector used to push Exchange Online Security configuration for Microsoft Sentinel Analysis",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ESIExchangeOnlineConfig_CL",
        "baseQuery": "ESIExchangeOnlineConfig_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "View how many Configuration entries exist on the table",
        "query": "ESIExchangeOnlineConfig_CL | summarize by GenerationInstanceID_g, EntryDate_s, ESIEnvironment_s"
      }
    ],
    "dataTypes": [
      {
        "name": "ESIExchangeOnlineConfig_CL",
        "lastDataReceivedQuery": "ESIExchangeOnlineConfig_CL | summarize Time = max(todatetime(EntryDate_s)) by GenerationInstanceID_g, ESIEnvironment_s  | where isnotempty(Time) |summarize Time = max(Time) | project Time"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ESIExchangeOnlineConfig_CL | summarize LastLogReceived = max(todatetime(EntryDate_s)) by GenerationInstanceID_g, ESIEnvironment_s |take 1  | project IsConnected = true"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "microsoft.automation/automationaccounts permissions",
          "description": "Read and write permissions to create an Azure Automation with a Runbook is required. [See the documentation to learn more about Automation Account](https://learn.microsoft.com/en-us/azure/automation/overview)."
        },
        {
          "name": "Microsoft.Graph permissions",
          "description": "Groups.Read, Users.Read and Auditing.Read permissions are required to retrieve user/group information linked to Exchange Online assignments. [See the documentation to learn more](https://aka.ms/sentinel-ESI-OnlineCollectorPermissions)."
        },
        {
          "name": "Exchange Online permissions",
          "description": "Exchange.ManageAsApp permission and **Global Reader** or **Security Reader** Role are needed to retrieve the Exchange Online Security Configuration.[See the documentation to learn more](https://aka.ms/sentinel-ESI-OnlineCollectorPermissions)."
        },
        {
          "name": "(Optional) Log Storage permissions",
          "description": "Storage Blob Data Contributor to a storage account linked to the Automation Account Managed identity or an Application ID is mandatory to store logs.[See the documentation to learn more](https://aka.ms/sentinel-ESI-OnlineCollectorPermissions)."
        }
      ]
    },
    "instructionSteps": [
      {
        "description": ">**NOTE - UPDATE**",
        "instructions": [
          {
            "parameters": {
              "text": "<H1><b><u>NOTE - UPDATE:</u></b></H1>We recommend to Update the Collector to Version <b>7.6.0.0</b> or highier. <br/>The Collector Script Update procedure could be found here : <a href='https://aka.ms/sentinel-ESI-OnlineCollectorUpdate'>ESI Online Collector Update</a>",
              "visible": true,
              "inline": false
            },
            "type": "InfoMessage"
          }
        ]
      },
      {
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected. Follow the steps for each Parser to create the Kusto Functions alias : [**ExchangeConfiguration**](https://aka.ms/sentinel-ESI-ExchangeConfiguration-Online-parser) and [**ExchangeEnvironmentList**](https://aka.ms/sentinel-ESI-ExchangeEnvironmentList-Online-parser) \n\n**STEP 1 - Parsers deployment**",
        "instructions": [
          {
            "parameters": {
              "title": "Parser deployment (When using Microsoft Exchange Security Solution, Parsers are automatically deployed)",
              "instructionSteps": [
                {
                  "title": "1. Download the Parser files",
                  "description": "The latest version of the 2 files [**ExchangeConfiguration.yaml**](https://aka.ms/sentinel-ESI-ExchangeConfiguration-Online-parser) and [**ExchangeEnvironmentList.yaml**](https://aka.ms/sentinel-ESI-ExchangeEnvironmentList-Online-parser)"
                },
                {
                  "title": "2. Create Parser **ExchangeConfiguration** function",
                  "description": "In 'Logs' explorer of your Microsoft Sentinel's log analytics, copy the content of the file to Log explorer"
                },
                {
                  "title": "3. Save Parser **ExchangeConfiguration** function",
                  "description": "Click on save button.\n Define the parameters as asked on the header of the parser file.\nClick save again."
                },
                {
                  "title": "4. Reproduce the same steps for Parser **ExchangeEnvironmentList**",
                  "description": "Reproduce the step 2 and 3 with the content of 'ExchangeEnvironmentList.yaml' file"
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "description": ">**NOTE:** This connector uses Azure Automation to connect to 'Exchange Online' to pull its Security analysis into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Automation pricing page](https://azure.microsoft.com/pricing/details/automation/) for details."
      },
      {
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Automation**\n\n>**IMPORTANT:** Before deploying the 'ESI Exchange Online Security Configuration' connector, have the Workspace ID and Workspace Primary Key (can be copied from the following), as well as the Exchange Online tenant name (contoso.onmicrosoft.com), readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "description": "**Option 1 - Azure Resource Manager (ARM) Template**\n\nUse this method for automated deployment of the 'ESI Exchange Online Security Configuration' connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-ESI-ExchangeCollector-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace ID**, **Workspace Key**, **Tenant Name**, 'and/or Other required fields'. \n>4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "description": "**Option 2 - Manual Deployment of Azure Automation**\n\n Use the following step-by-step instructions to deploy the 'ESI Exchange Online Security Configuration' connector manually with Azure Automation.",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "A. Create the Azure Automation Account",
                  "description": "1.  From the Azure Portal, navigate to [Azure Automation Account](https://portal.azure.com/#view/HubsExtension/BrowseResource/resourceType/Microsoft.Automation%2FAutomationAccounts).\n2. Click **+ Add** at the top.\n3. In the **Basics** tab, fill the required fields and give a name to the Azure Automation. \n4. In the **Advanced** and **Networking** and **Tags** Tabs, leave fields as default if you don't need to customize them.\n5. 'Make other preferable configuration changes', if needed, then click **Create**."
                },
                {
                  "title": "B. Add Exchange Online Management Module, Microsoft Graph (Authentication, User and Group) Modules",
                  "description": "1. On the Automation Account page, select **Modules**.\n2. Click on **Browse gallery** and search the **ExchangeOnlineManagement** module.\n3. Select it and click on **Select**.\n4. Choose Version **5.1** on Runtime version field and click on Import button.\nRepeat the step for the following modules : 'Microsoft.Graph.Authentication', 'Microsoft.Graph.Users' and 'Microsoft.Graph.Groups. **Attention, you need to wait for Microsoft.Graph.Authentication installation before processing next modules**"
                },
                {
                  "title": "C. Download the Runbook Content",
                  "description": "1. Download the latest version of ESI Collector. The latest version can be found here : https://aka.ms/ESI-ExchangeCollector-Script\n2. Unzip the file to find the JSON file and the PS1 file for next step.\n"
                },
                {
                  "title": "D. Create Runbook",
                  "description": "1. On the Automation Account page, select the **Runbooks** button.\n2. Click on **Create a runbook** and name it like 'ESI-Collector' with a runbook type **PowerShell**, Runtime Version **5.1** and click 'Create'.\n2. Import the content of the previous step's PS1 file in the Runbook window.\n3. Click on **Publish**"
                },
                {
                  "title": "E. Create GlobalConfiguration Variable",
                  "description": "1. On the Automation Account page, select the **Variables** button.\n2. Click on **Add a Variable** and name it exaclty 'GlobalConfiguration' with a type **String**.\n2. On 'Value' field, copy the content of the previous step's JSON file.\n3. Inside the content, replace the values of **WorkspaceID** and **WorkspaceKey**.\n4. Click on 'Create' button."
                },
                {
                  "title": "F. Create TenantName Variable",
                  "description": "1. On the Automation Account page, select the **Variables** button.\n2. Click on **Add a Variable** and name it exaclty 'TenantName' with a type **String**.\n3. On 'Value' field, write the tenant name of your Exchange Online.\n4. Click on 'Create' button."
                },
                {
                  "title": "G. Create LastDateTracking Variable",
                  "description": "1. On the Automation Account page, select the **Variables** button.\n2. Click on **Add a Variable** and name it exaclty 'LastDateTracking' with a type **String**.\n3. On 'Value' field, write 'Never'.\n4. Click on 'Create' button."
                },
                {
                  "title": "H. Create a Runbook Schedule",
                  "description": "1. On the Automation Account page, select the **Runbook** button and click on your created runbook.\n2. Click on **Schedules** and **Add a schedule** button.\n3. Click on **Schedule**, **Add a Schedule** and name it. Select **Recurring** value with a reccurence of every 1 day, click 'Create'.\n4. Click on 'Configure parameters and run settings'. Leave all empty and click on **OK** and **OK** again."
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "description": "**STEP 3 - Assign Microsoft Graph Permission and Exchange Online Permission to Managed Identity Account** \n\nTo be able to collect Exchange Online information and to be able to retrieve User information and memberlist of admin groups, the automation account need multiple permission.",
        "instructions": [
          {
            "parameters": {
              "title": "Assign Permissions by Script",
              "instructionSteps": [
                {
                  "title": "A. Download Permission Script",
                  "description": "[Permission Update script](https://aka.ms/ESI-ExchangeCollector-Permissions)"
                },
                {
                  "title": "B. Retrieve the Azure Automation Managed Identity GUID and insert it in the downloaded script",
                  "description": "1. Go to your Automation Account, in the **Identity** Section. You can find the Guid of your Managed Identity.\n2. Replace the GUID in $MI_ID = \"XXXXXXXXXXX\" with the GUID of your Managed Identity."
                },
                {
                  "title": "C. Launch the script with a **Global-Administrator** account",
                  "description": "**Attention this script requires MSGraph Modules and Admin Consent to access to your tenant with Microsoft Graph**.\n\tThe script will add 3 permissions to the Managed identity:\n\t1. Exchange Online ManageAsApp permission\n\t2. User.Read.All on Microsoft Graph API\n\t3. Group.Read.All on Microsoft Graph API"
                },
                {
                  "title": "D. Exchange Online Role Assignment",
                  "description": "1. As a **Global Administrator**, go to **Roles and Administrators**.\n2. Select **Global Reader** role or **Security Reader** and click to 'Add assignments'.\n3. Click on 'No member selected' and search your Managed Identity account Name beginning by **the name of your automation account** like 'ESI-Collector'. Select it and click on 'Select'.\n4. Click **Next** and validate the assignment by clicking **Assign**."
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ],
    "metadata": {
      "id": "fe7ccc48-e21b-4b90-b83e-9c8a6cb17d2f",
      "version": "1.1.1",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "ESI - Exchange Online Security Configuration Analyzer"
      },
      "support": {
        "name": "Community",
        "tier": "Community",
        "link": "https://github.com/Azure/Azure-Sentinel/issues"
      },
      "author": {
        "name": "Microsoft"
      }
    }
  },
  {
    "id": "ESI-ExchangeOnPremisesCollector",
    "title": "Exchange Security Insights On-Premises Collector",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Connector used to push Exchange On-Premises Security configuration for Microsoft Sentinel Analysis",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ESIExchangeConfig_CL",
        "baseQuery": "ESIExchangeConfig_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "View how many Configuration entries exist on the table",
        "query": "ESIExchangeConfig_CL | summarize by GenerationInstanceID_g, EntryDate_s, ESIEnvironment_s"
      }
    ],
    "dataTypes": [
      {
        "name": "ESIExchangeConfig_CL",
        "lastDataReceivedQuery": "ESIExchangeConfig_CL | summarize Time = max(todatetime(EntryDate_s)) by GenerationInstanceID_g, ESIEnvironment_s | where isnotempty(Time) |summarize Time = max(Time) | project Time"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ESIExchangeConfig_CL | summarize LastLogReceived = max(todatetime(EntryDate_s)) by GenerationInstanceID_g, ESIEnvironment_s |take 1 | project IsConnected = true"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Service Account with Organization Management role",
          "description": "The service Account that launch the script as scheduled task needs to be Organization Management to be able to retrieve all the needed security Information."
        },
        {
          "name": "Detailled documentation",
          "description": ">**NOTE:** Detailled documentation on Installation procedure and usage can be found [here](https://aka.ms/MicrosoftExchangeSecurityGithub)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Install the ESI Collector Script on a server with Exchange Admin PowerShell console",
        "description": "This is the script that will collect Exchange Information to push content in Microsoft Sentinel.\n ",
        "instructions": [
          {
            "parameters": {
              "title": "Script Deployment",
              "instructionSteps": [
                {
                  "title": "Download the latest version of ESI Collector",
                  "description": "The latest version can be found here : https://aka.ms/ESI-ExchangeCollector-Script. The file to download is CollectExchSecIns.zip"
                },
                {
                  "title": "Copy the script folder",
                  "description": "Unzip the content and copy the script folder on a server where Exchange PowerShell Cmdlets are present."
                },
                {
                  "title": "Unblock the PS1 Scripts",
                  "description": "Click right on each PS1 Script and go to Properties tab.\n If the script is marked as blocked, unblock it. You can also use the Cmdlet 'Unblock-File *.* in the unzipped folder using PowerShell."
                },
                {
                  "title": "Configure Network Access ",
                  "description": "Ensure that the script can contact Azure Analytics (*.ods.opinsights.azure.com)."
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the ESI Collector Script",
        "description": "Be sure to be local administrator of the server.\nIn 'Run as Administrator' mode, launch the 'setup.ps1' script to configure the collector.\n Fill the Log Analytics (Microsoft Sentinel) Workspace information.\n Fill the Environment name or leave empty. By default, choose 'Def' as Default analysis. The other choices are for specific usage.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "3. Schedule the ESI Collector Script (If not done by the Install Script due to lack of permission or ignored during installation)",
        "description": "The script needs to be scheduled to send Exchange configuration to Microsoft Sentinel.\n We recommend to schedule the script once a day.\n The account used to launch the Script needs to be member of the group Organization Management"
      },
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected. Parsers are automatically deployed with the solution. Follow the steps to create the Kusto Functions alias : [**ExchangeAdminAuditLogs**](https://aka.ms/sentinel-ESI-ExchangeCollector-ExchangeAdminAuditLogs-parser)",
        "instructions": [
          {
            "parameters": {
              "title": "Parsers are automatically deployed during Solution deployment. If you want to deploy manually, follow the steps below",
              "instructionSteps": [
                {
                  "title": "Manual Parser Deployment",
                  "instructions": [
                    {
                      "parameters": {
                        "instructionSteps": [
                          {
                            "title": "1. Download the Parser file",
                            "description": "The latest version of the file [**ExchangeAdminAuditLogs**](https://aka.ms/sentinel-ESI-ExchangeCollector-ExchangeAdminAuditLogs-parser)"
                          },
                          {
                            "title": "2. Create Parser **ExchangeAdminAuditLogs** function",
                            "description": "In 'Logs' explorer of your Microsoft Sentinel's log analytics, copy the content of the file to Log explorer"
                          },
                          {
                            "title": "3. Save Parser **ExchangeAdminAuditLogs** function",
                            "description": "Click on save button.\n No parameter is needed for this parser.\nClick save again."
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ],
    "metadata": {
      "id": "ed950fd7-e457-4a59-88f0-b9c949aa280d",
      "version": "1.2.2",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "ESI - Exchange Security Configuration Analyzer"
      },
      "support": {
        "name": "Community",
        "tier": "Community",
        "link": "https://github.com/Azure/Azure-Sentinel/issues"
      },
      "author": {
        "name": "Microsoft"
      }
    }
  },
  {
    "id": "ESI-Opt1ExchangeAdminAuditLogsByEventLogs",
    "title": "Microsoft Exchange Admin Audit Logs by Event Logs",
    "publisher": "Microsoft",
    "descriptionMarkdown": "[Option 1] - Using Azure Monitor Agent - You can stream all Exchange Audit events from the Windows machines connected to your Microsoft Sentinel workspace using the Windows agent. This connection enables you to view dashboards, create custom alerts, and improve investigation. This is used by Microsoft Exchange Security Workbooks to provide security insights of your On-Premises Exchange environment",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ExchangeAuditLogs",
        "baseQuery": "Event | where EventLog == 'MSExchange Management'"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Audit logs",
        "query": "Event | where EventLog == 'MSExchange Management' | sort by TimeGenerated"
      }
    ],
    "dataTypes": [
      {
        "name": "Event",
        "lastDataReceivedQuery": "Event | where EventLog == 'MSExchange Management'  | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Event | where EventLog == 'MSExchange Management'  | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(7h)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "Azure Log Analytics will be deprecated, to collect data from non-Azure VMs, Azure Arc is recommended. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "name": "Detailled documentation",
          "description": ">**NOTE:** Detailled documentation on Installation procedure and usage can be found [here](https://aka.ms/MicrosoftExchangeSecurityGithub)"
        }
      ]
    },
    "instructionSteps": [
      {
        "description": ">**NOTE:** This solution is based on options. This allows you to choose which data will be ingest as some options can generate a very high volume of data. Depending on what you want to collect, track in your Workbooks, Analytics Rules, Hunting capabilities you will choose the option(s) you will deploy. Each options are independant for one from the other. To learn more about each option: ['Microsoft Exchange Security' wiki](https://aka.ms/ESI_DataConnectorOptions)\n\n>This Data Connector is the **option 1** of the wiki."
      },
      {
        "title": "1. Download and install the agents needed to collect logs for Microsoft Sentinel",
        "description": "Type of servers (Exchange Servers, Domain Controllers linked to Exchange Servers or all Domain Controllers) depends on the option you want to deploy.",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Deploy Monitor Agents",
                  "description": "This step is required only if it's the first time you onboard your Exchange Servers/Domain Controllers\n**Deploy the Azure Arc Agent**\n> [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. [Option 1] MS Exchange Management Log collection - MS Exchange Admin Audit event logs by Data Collection Rules",
        "description": "The MS Exchange Admin Audit event logs are collected using Data Collection Rules (DCR) and allow to store all Administrative Cmdlets executed in an Exchange environment.",
        "instructions": [
          {
            "parameters": {
              "title": "DCR",
              "instructionSteps": [
                {
                  "title": "Data Collection Rules Deployment",
                  "description": "**Enable data collection rule**\n>  Microsoft Exchange Admin Audit Events logs are collected only from **Windows** agents.",
                  "instructions": [
                    {
                      "parameters": {
                        "instructionSteps": [
                          {
                            "title": "Option 1 - Azure Resource Manager (ARM) Template (Prefered)",
                            "description": "Use this method for automated deployment of the DCR.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-ESI-DCROption1-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace Name** 'and/or Other required fields'.\n>4.  Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5.  Click **Purchase** to deploy."
                          },
                          {
                            "title": "Option 2 - Manual Deployment of Azure Automation",
                            "description": "Use the following step-by-step instructions to deploy manually a Data Collection Rule.",
                            "instructions": [
                              {
                                "parameters": {
                                  "instructionSteps": [
                                    {
                                      "title": "A. Create DCR, Type Event log",
                                      "description": "1.  From the Azure Portal, navigate to [Azure Data collection rules](https://portal.azure.com/#view/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/~/dataCollectionRules).\n2. Click **+ Create** at the top.\n3. In the **Basics** tab, fill the required fields, Select Windows as platform type and give a name to the DCR. \n4. In the **Resources** tab, enter you Exchange Servers.\n5. In 'Collect and deliver', add a Data Source type 'Windows Event logs' and select 'Custom' option, enter 'MSExchange Management' as expression and Add it.\n6. 'Make other preferable configuration changes', if needed, then click **Create**."
                                    }
                                  ]
                                },
                                "type": "InstructionStepsGroup"
                              }
                            ]
                          },
                          {
                            "title": "Assign the DCR to all Exchange Servers",
                            "description": "Add all your Exchange Servers to the DCR"
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected. Parsers are automatically deployed with the solution. Follow the steps to create the Kusto Functions alias : [**ExchangeAdminAuditLogs**](https://aka.ms/sentinel-ESI-ExchangeCollector-ExchangeAdminAuditLogs-parser)",
        "instructions": [
          {
            "parameters": {
              "title": "Parsers are automatically deployed during Solution deployment. If you want to deploy manually, follow the steps below",
              "instructionSteps": [
                {
                  "title": "Manual Parser Deployment",
                  "instructions": [
                    {
                      "parameters": {
                        "instructionSteps": [
                          {
                            "title": "1. Download the Parser file",
                            "description": "The latest version of the file [**ExchangeAdminAuditLogs**](https://aka.ms/sentinel-ESI-ExchangeCollector-ExchangeAdminAuditLogs-parser)"
                          },
                          {
                            "title": "2. Create Parser **ExchangeAdminAuditLogs** function",
                            "description": "In 'Logs' explorer of your Microsoft Sentinel's log analytics, copy the content of the file to Log explorer"
                          },
                          {
                            "title": "3. Save Parser **ExchangeAdminAuditLogs** function",
                            "description": "Click on save button.\n No parameter is needed for this parser.\nClick save again."
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ],
    "metadata": {
      "id": "dfa2e270-b24f-4d76-b9a5-cd4a878596bf",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "Microsoft Exchange Security - Exchange On-Premises"
      },
      "support": {
        "name": "Community",
        "tier": "Community",
        "link": "https://github.com/Azure/Azure-Sentinel/issues"
      },
      "author": {
        "name": "Microsoft"
      }
    }
  },
  {
    "id": "ESI-Opt2ExchangeServersEventLogs",
    "title": "Microsoft Exchange Logs and Events",
    "publisher": "Microsoft",
    "descriptionMarkdown": "[Option 2] - Using Azure Monitor Agent - You can stream all Exchange Security & Application Event logs from the Windows machines connected to your Microsoft Sentinel workspace using the Windows agent. This connection enables you to create custom alerts, and improve investigation.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Exchange Eventlogs",
        "baseQuery": "Event | where EventLog == 'Application'"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Audit logs",
        "query": "Event | where EventLog == 'Application' | sort by TimeGenerated"
      }
    ],
    "dataTypes": [
      {
        "name": "Event",
        "lastDataReceivedQuery": "Event | where EventLog == 'Application'  | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Event | where EventLog == 'Application'  | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(7h)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Azure Log Analytics will be deprecated",
          "description": "Azure Log Analytics will be deprecated, to collect data from non-Azure VMs, Azure Arc is recommended. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "name": "Detailled documentation",
          "description": ">**NOTE:** Detailled documentation on Installation procedure and usage can be found [here](https://aka.ms/MicrosoftExchangeSecurityGithub)"
        }
      ]
    },
    "instructionSteps": [
      {
        "description": ">**NOTE:** This solution is based on options. This allows you to choose which data will be ingest as some options can generate a very high volume of data. Depending on what you want to collect, track in your Workbooks, Analytics Rules, Hunting capabilities you will choose the option(s) you will deploy. Each options are independant for one from the other. To learn more about each option: ['Microsoft Exchange Security' wiki](https://aka.ms/ESI_DataConnectorOptions)\n\n>This Data Connector is the **option 2** of the wiki."
      },
      {
        "title": "1.  Download and install the agents needed to collect logs for Microsoft Sentinel",
        "description": "Type of servers (Exchange Servers, Domain Controllers linked to Exchange Servers or all Domain Controllers) depends on the option you want to deploy.",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Deploy Monitor Agents",
                  "description": "This step is required only if it's the first time you onboard your Exchange Servers/Domain Controllers\n**Deploy the Azure Arc Agent**\n> [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. [Option 2] Security/Application/System logs of Exchange Servers",
        "description": "The Security/Application/System logs of Exchange Servers are collected using Data Collection Rules (DCR).",
        "instructions": [
          {
            "parameters": {
              "title": "Security Event log collection",
              "instructionSteps": [
                {
                  "title": "Data Collection Rules - Security Event logs",
                  "description": "**Enable data collection rule for Security Logs**\nSecurity Events logs are collected only from **Windows** agents.\n1. Add Exchange Servers on *Resources* tab.\n2. Select Security log level\n\n>  **Common level** is the minimum required. Please select 'Common' or 'All Security Events' on DCR definition.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "OpenCreateDataCollectionRule",
                        "dataCollectionRuleType": 0
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          },
          {
            "parameters": {
              "title": "Application and System Event log collection",
              "instructionSteps": [
                {
                  "title": "Enable data collection rule",
                  "description": ">  Application and System Events logs are collected only from **Windows** agents.",
                  "instructions": [
                    {
                      "parameters": {
                        "instructionSteps": [
                          {
                            "title": "Option 1 - Azure Resource Manager (ARM) Template (Prefered method)",
                            "description": "Use this method for automated deployment of the DCR.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-ESI-DCROption2-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace Name** 'and/or Other required fields'.\n>4.  Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5.  Click **Purchase** to deploy."
                          },
                          {
                            "title": "Option 2 - Manual Deployment of Azure Automation",
                            "description": "Use the following step-by-step instructions to deploy manually a Data Collection Rule.",
                            "instructions": [
                              {
                                "parameters": {
                                  "instructionSteps": [
                                    {
                                      "title": "A. Create DCR, Type Event log",
                                      "description": "1.  From the Azure Portal, navigate to [Azure Data collection rules](https://portal.azure.com/#view/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/~/dataCollectionRules).\n2. Click **+ Create** at the top.\n3. In the **Basics** tab, fill the required fields, Select Windows as platform type and give a name to the DCR. \n4. In the **Resources** tab, enter you Exchange Servers.\n5. In 'Collect and deliver', add a Data Source type 'Windows Event logs' and select 'Basic' option.\n6. For Application, select 'Critical', 'Error' and 'Warning'. For System, select Critical/Error/Warning/Information. \n7. 'Make other preferable configuration changes', if needed, then click **Create**."
                                    }
                                  ]
                                },
                                "type": "InstructionStepsGroup"
                              }
                            ]
                          },
                          {
                            "title": "Assign the DCR to all Exchange Servers",
                            "description": "Add all your Exchange Servers to the DCR"
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ],
    "metadata": {
      "id": "22e0234b-278d-40f4-8be8-c2968faeaf91",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "Microsoft Exchange Security - Exchange On-Premises"
      },
      "support": {
        "name": "Community",
        "tier": "Community",
        "link": "https://github.com/Azure/Azure-Sentinel/issues"
      },
      "author": {
        "name": "Microsoft"
      }
    }
  },
  {
    "id": "ESI-Opt34DomainControllersSecurityEventLogs",
    "title": " Microsoft Active-Directory Domain Controllers Security Event Logs",
    "publisher": "Microsoft",
    "descriptionMarkdown": "[Option 3 & 4] - Using Azure Monitor Agent -You can stream a part or all Domain Controllers Security Event logs from the Windows machines connected to your Microsoft Sentinel workspace using the Windows agent. This connection enables you to create custom alerts, and improve investigation.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Domain Controllers Security Logs",
        "baseQuery": "SecurityEvent"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Audit logs",
        "query": "SecurityEvent | sort by TimeGenerated"
      }
    ],
    "dataTypes": [
      {
        "name": "SecurityEvent",
        "lastDataReceivedQuery": "SecurityEvent | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "SecurityEvent | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(7h)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "Azure Log Analytics will be deprecated, to collect data from non-Azure VMs, Azure Arc is recommended. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "name": "Detailled documentation",
          "description": ">**NOTE:** Detailled documentation on Installation procedure and usage can be found [here](https://aka.ms/MicrosoftExchangeSecurityGithub)"
        }
      ]
    },
    "instructionSteps": [
      {
        "description": ">**NOTE:** This solution is based on options. This allows you to choose which data will be ingest as some options can generate a very high volume of data. Depending on what you want to collect, track in your Workbooks, Analytics Rules, Hunting capabilities you will choose the option(s) you will deploy. Each options are independant for one from the other. To learn more about each option: ['Microsoft Exchange Security' wiki](https://aka.ms/ESI_DataConnectorOptions)\n\n>This Data Connector is the **option 3 and 4** of the wiki."
      },
      {
        "title": "1.  Download and install the agents needed to collect logs for Microsoft Sentinel",
        "description": "Type of servers (Exchange Servers, Domain Controllers linked to Exchange Servers or all Domain Controllers) depends on the option you want to deploy.",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Deploy Monitor Agents",
                  "description": "This step is required only if it's the first time you onboard your Exchange Servers/Domain Controllers\n**Deploy the Azure Arc Agent**\n> [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "Security logs of Domain Controllers",
        "description": "Select how to stream Security logs of Domain Controllers. If you want to implement Option 3, you just need to select DC on same site as Exchange Servers. If you want to implement Option 4, you can select all DCs of your forest.",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "[Option 3] List only Domain Controllers on the same site as Exchange Servers for next step",
                  "description": "**This limits the quantity of data injested but some incident can't be detected.**"
                },
                {
                  "title": "[Option 4] List all Domain Controllers of your Active-Directory Forest for next step",
                  "description": "**This allows collecting all security events**"
                }
              ]
            },
            "type": "InstructionStepsGroup"
          },
          {
            "parameters": {
              "title": "Security Event log collection",
              "instructionSteps": [
                {
                  "title": "Data Collection Rules - Security Event logs",
                  "description": "**Enable data collection rule for Security Logs**\nSecurity Events logs are collected only from **Windows** agents.\n1. Add chosen DCs on *Resources* tab.\n2. Select Security log level\n\n>  **Common level** is the minimum required. Please select 'Common' or 'All Security Events' on DCR definition.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "OpenCreateDataCollectionRule",
                        "dataCollectionRuleType": 0
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ],
    "metadata": {
      "id": "036e16af-5a27-465a-8662-b7ac385a8d45",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "Microsoft Exchange Security - Exchange On-Premises"
      },
      "support": {
        "name": "Community",
        "tier": "Community",
        "link": "https://github.com/Azure/Azure-Sentinel/issues"
      },
      "author": {
        "name": "Microsoft"
      }
    }
  },
  {
    "id": "ESI-Opt5ExchangeIISLogs",
    "title": "IIS Logs of Microsoft Exchange Servers",
    "publisher": "Microsoft",
    "descriptionMarkdown": "[Option 5] - Using Azure Monitor Agent - You can stream all IIS Logs from the Windows machines connected to your Microsoft Sentinel workspace using the Windows agent. This connection enables you to create custom alerts, and improve investigation.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Exchange IIS logs",
        "baseQuery": "W3CIISLog"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Audit logs",
        "query": "W3CIISLog | sort by TimeGenerated"
      }
    ],
    "dataTypes": [
      {
        "name": "W3CIISLog",
        "lastDataReceivedQuery": "W3CIISLog  | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "W3CIISLog  | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(7h)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "Azure Log Analytics will be deprecated, to collect data from non-Azure VMs, Azure Arc is recommended. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "name": "Detailled documentation",
          "description": ">**NOTE:** Detailled documentation on Installation procedure and usage can be found [here](https://aka.ms/MicrosoftExchangeSecurityGithub)"
        }
      ]
    },
    "instructionSteps": [
      {
        "description": ">**NOTE:** This solution is based on options. This allows you to choose which data will be ingest as some options can generate a very high volume of data. Depending on what you want to collect, track in your Workbooks, Analytics Rules, Hunting capabilities you will choose the option(s) you will deploy. Each options are independant for one from the other. To learn more about each option: ['Microsoft Exchange Security' wiki](https://aka.ms/ESI_DataConnectorOptions)\n\n>This Data Connector is the **option 5** of the wiki."
      },
      {
        "title": "1.  Download and install the agents needed to collect logs for Microsoft Sentinel",
        "description": "Type of servers (Exchange Servers, Domain Controllers linked to Exchange Servers or all Domain Controllers) depends on the option you want to deploy.",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Deploy Monitor Agents",
                  "description": "This step is required only if it's the first time you onboard your Exchange Servers/Domain Controllers\n**Deploy the Azure Arc Agent**\n> [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "[Option 5] IIS logs of Exchange Servers",
        "description": "Select how to stream IIS logs of Exchange Servers",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Enable data collection rule",
                  "description": "> IIS logs are collected only from **Windows** agents.",
                  "instructions": [
                    {
                      "type": "AdminAuditEvents"
                    },
                    {
                      "parameters": {
                        "instructionSteps": [
                          {
                            "title": "Option 1 - Azure Resource Manager (ARM) Template (Preferred Method)",
                            "description": "Use this method for automated deployment of the DCE and DCR.",
                            "instructions": [
                              {
                                "parameters": {
                                  "instructionSteps": [
                                    {
                                      "title": "A. Create DCE (If not already created for Exchange Servers)",
                                      "description": "1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-ESI-DCEExchangeServers)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. You can change the proposed name of the DCE.\n5.  Click **Create** to deploy."
                                    },
                                    {
                                      "title": "B. Deploy Data Connection Rule",
                                      "description": "1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-ESI-DCROption5-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace ID** 'and/or Other required fields'.\n>4.  Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5.  Click **Purchase** to deploy."
                                    }
                                  ]
                                },
                                "type": "InstructionStepsGroup"
                              }
                            ]
                          },
                          {
                            "title": "Option 2 - Manual Deployment of Azure Automation",
                            "description": "Use the following step-by-step instructions to deploy manually a Data Collection Rule.",
                            "instructions": [
                              {
                                "parameters": {
                                  "instructionSteps": [
                                    {
                                      "title": "A. Create DCE (If not already created for Exchange Servers)",
                                      "description": "1.  From the Azure Portal, navigate to [Azure Data collection Endpoint](https://portal.azure.com/#view/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/~/dataCollectionEndpoints).\n2. Click **+ Create** at the top.\n3. In the **Basics** tab, fill the required fields and give a name to the DCE. \n3. 'Make other preferable configuration changes', if needed, then click **Create**."
                                    },
                                    {
                                      "title": "B. Create DCR, Type IIS log",
                                      "description": "1.  From the Azure Portal, navigate to [Azure Data collection rules](https://portal.azure.com/#view/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/~/dataCollectionRules).\n2. Click **+ Create** at the top.\n3. In the **Basics** tab, fill the required fields, Select Windows as platform type and give a name to the DCR. Select the created DCE. \n4. In the **Resources** tab, enter you Exchange Servers.\n5. In 'Collect and deliver', add a Data Source type 'IIS logs' (Do not enter a path if IIS Logs path is configured by default). Click on 'Add data source'\n6. 'Make other preferable configuration changes', if needed, then click **Create**."
                                    }
                                  ]
                                },
                                "type": "InstructionStepsGroup"
                              }
                            ]
                          },
                          {
                            "title": "Assign the DCR to all Exchange Servers",
                            "description": "Add all your Exchange Servers to the DCR"
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ],
    "metadata": {
      "id": "4b1075ed-80f5-4930-bfe1-877e86b48dc1",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "Microsoft Exchange Security - Exchange On-Premises"
      },
      "support": {
        "name": "Community",
        "tier": "Community",
        "link": "https://github.com/Azure/Azure-Sentinel/issues"
      },
      "author": {
        "name": "Microsoft"
      }
    }
  },
  {
    "id": "ESI-Opt6ExchangeMessageTrackingLogs",
    "title": "Microsoft Exchange Message Tracking Logs",
    "publisher": "Microsoft",
    "descriptionMarkdown": "[Option 6] - Using Azure Monitor Agent - You can stream all Exchange Message Tracking from the Windows machines connected to your Microsoft Sentinel workspace using the Windows agent. Those logs can be used to track the flow of messages in your Exchange environment. This data connector is based on the option 6 of the [Microsoft Exchange Security wiki](https://aka.ms/ESI_DataConnectorOptions).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Exchange Message Tracking logs",
        "baseQuery": "MessageTrackingLog_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Exchange Message Tracking logs",
        "query": "MessageTrackingLog_CL | sort by TimeGenerated"
      }
    ],
    "dataTypes": [
      {
        "name": "MessageTrackingLog_CL",
        "lastDataReceivedQuery": "MessageTrackingLog_CL  | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "MessageTrackingLog_CL  | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(7h)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Azure Log Analytics will be deprecated",
          "description": "Azure Log Analytics will be deprecated, to collect data from non-Azure VMs, Azure Arc is recommended. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "name": "Detailled documentation",
          "description": ">**NOTE:** Detailled documentation on Installation procedure and usage can be found [here](https://aka.ms/MicrosoftExchangeSecurityGithub)"
        }
      ]
    },
    "instructionSteps": [
      {
        "description": ">**NOTE:** This solution is based on options. This allows you to choose which data will be ingest as some options can generate a very high volume of data. Depending on what you want to collect, track in your Workbooks, Analytics Rules, Hunting capabilities you will choose the option(s) you will deploy. Each options are independant for one from the other. To learn more about each option: ['Microsoft Exchange Security' wiki](https://aka.ms/ESI_DataConnectorOptions)\n\n>This Data Connector is the **option 6** of the wiki."
      },
      {
        "title": "1.  Download and install the agents needed to collect logs for Microsoft Sentinel",
        "description": "Type of servers (Exchange Servers, Domain Controllers linked to Exchange Servers or all Domain Controllers) depends on the option you want to deploy.",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Deploy Monitor Agents",
                  "description": "This step is required only if it's the first time you onboard your Exchange Servers/Domain Controllers\n**Deploy the Azure Arc Agent**\n> [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Message Tracking of Exchange Servers",
        "description": "Select how to stream Message Tracking of Exchange Servers",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Data Collection Rules - When Azure Monitor Agent is used",
                  "description": "**Enable data collection rule**\n> Message Tracking are collected only from **Windows** agents.",
                  "instructions": [
                    {
                      "parameters": {
                        "instructionSteps": [
                          {
                            "title": "Option 1 - Azure Resource Manager (ARM) Template",
                            "description": "Use this method for automated deployment of the DCE and DCR.",
                            "instructions": [
                              {
                                "parameters": {
                                  "instructionSteps": [
                                    {
                                      "title": "A. Create DCE (If not already created for Exchange Servers)",
                                      "description": "1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-ESI-DCEExchangeServers)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. You can change the proposed name of the DCE.\n5.  Click **Create** to deploy."
                                    },
                                    {
                                      "title": "B. Deploy Data Connection Rule and Custom Table",
                                      "description": "1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-ESI-DCROption6-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace ID** 'and/or Other required fields'.\n>4.  Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5.  Click **Purchase** to deploy."
                                    }
                                  ]
                                },
                                "type": "InstructionStepsGroup"
                              }
                            ]
                          },
                          {
                            "title": "Option 2 - Manual Deployment of Azure Automation",
                            "description": "Use the following step-by-step instructions to deploy manually a Data Collection Rule.",
                            "instructions": [
                              {
                                "parameters": {
                                  "instructionSteps": [
                                    {
                                      "title": "Create Custom Table - Explanation",
                                      "description": "The Custom Table can't be created using the Azure Portal. You need to use an ARM template, a PowerShell Script or another method [described here](https://learn.microsoft.com/en-us/azure/azure-monitor/logs/create-custom-table?tabs=azure-powershell-1%2Cazure-portal-2%2Cazure-portal-3#create-a-custom-table)."
                                    },
                                    {
                                      "title": "Create Custom Table using an ARM Template",
                                      "description": "1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-ESI-MessageTrackingCustomTable)\n2. Select the preferred **Subscription**, **Resource Group**, **Location** and **Analytic Workspace Name**. \n3.  Click **Create** to deploy."
                                    },
                                    {
                                      "title": "Create Custom Table using PowerShell in Cloud Shell",
                                      "description": "1.  From the Azure Portal, open a Cloud Shell.\n2. Copy and paste and Execute the following script in the Cloud Shell to create the table.\n\t\t$tableParams = @'\n\t\t{\n\t\t\t\"properties\": {\n\t\t\t\t\"schema\": {\n\t\t\t\t\t   \"name\": \"MessageTrackingLog_CL\",\n\t\t\t\t\t   \"columns\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"directionality\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"reference\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"source\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"TimeGenerated\",\n\t\t\t\t\t\t\t\t\t\"type\": \"datetime\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"clientHostname\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"clientIP\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"connectorId\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"customData\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"eventId\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"internalMessageId\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"logId\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"messageId\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"messageInfo\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"messageSubject\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"networkMessageId\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"originalClientIp\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"originalServerIp\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"recipientAddress\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"recipientCount\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"recipientStatus\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"relatedRecipientAddress\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"returnPath\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"senderAddress\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"senderHostname\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"serverIp\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"sourceContext\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"schemaVersion\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"messageTrackingTenantId\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"totalBytes\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"transportTrafficType\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"FilePath\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t'@\n3.  Copy, Replace, Paste and execute the following parameters with your own values:\n\t\t$SubscriptionID = 'YourGUID'\n\t\t$ResourceGroupName = 'YourResourceGroupName'\n\t\t$WorkspaceName = 'YourWorkspaceName'\n4.  Execute the Following Cmdlet to create the table:\n\t\tInvoke-AzRestMethod -Path \"/subscriptions/$SubscriptionID/resourcegroups/$ResourceGroupName/providers/microsoft.operationalinsights/workspaces/$WorkspaceName/tables/MessageTrackingLog_CL?api-version=2021-12-01-preview\" -Method PUT -payload $tableParams"
                                    }
                                  ]
                                },
                                "type": "InstructionStepsGroup"
                              },
                              {
                                "parameters": {
                                  "instructionSteps": [
                                    {
                                      "title": "A. Create DCE (If not already created for Exchange Servers)",
                                      "description": "1.  From the Azure Portal, navigate to [Azure Data collection Endpoint](https://portal.azure.com/#view/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/~/dataCollectionEndpoints).\n2. Click **+ Create** at the top.\n3. In the **Basics** tab, fill the required fields and give a name to the DCE, like ESI-ExchangeServers. \n3. 'Make other preferable configuration changes', if needed, then click **Create**."
                                    },
                                    {
                                      "title": "B. Create a DCR, Type Custom log",
                                      "description": "1.  From the Azure Portal, navigate to [Azure Data collection rules](https://portal.azure.com/#view/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/~/dataCollectionRules).\n2. Click on 'Create' button.\n3. On 'Basics' tab, fill the Rule name like **DCR-Option6-MessageTrackingLogs**, select the 'Data Collection Endpoint' with the previously created endpoint and fill other parameters.\n4. In the **Resources** tab, add your Exchange Servers.\n5. In **Collect and Deliver**, add a Data Source type 'Custom Text logs' and enter 'C:\\Program Files\\Microsoft\\Exchange Server\\V15\\TransportRoles\\Logs\\MessageTracking\\*.log' in file pattern, 'MessageTrackingLog_CL' in Table Name.\n6.in Transform field, enter the following KQL request :\n\t\tsource | extend d = split(RawData,',') | extend TimeGenerated =todatetime(d[0]) ,clientIP =tostring(d[1]) ,clientHostname =tostring(d[2]) ,serverIp=tostring(d[3]) ,senderHostname=tostring(d[4]) ,sourceContext=tostring(d[5]) ,connectorId =tostring(d[6]) ,source=tostring(d[7]) ,eventId =tostring(d[8]) ,internalMessageId =tostring(d[9]) ,messageId =tostring(d[10]) ,networkMessageId =tostring(d[11]) ,recipientAddress=tostring(d[12]) ,recipientStatus=tostring(d[13]) ,totalBytes=tostring(d[14]) ,recipientCount=tostring(d[15]) ,relatedRecipientAddress=tostring(d[16]) ,reference=tostring(d[17]) ,messageSubject =tostring(d[18]) ,senderAddress=tostring(d[19]) ,returnPath=tostring(d[20]) ,messageInfo =tostring(d[21]) ,directionality=tostring(d[22]) ,messageTrackingTenantId =tostring(d[23]) ,originalClientIp =tostring(d[24]) ,originalServerIp =tostring(d[25]) ,customData=tostring(d[26]) ,transportTrafficType =tostring(d[27]) ,logId =tostring(d[28]) ,schemaVersion=tostring(d[29]) | project-away d,RawData\n and click on 'Destination'.\n6. In 'Destination', add a destination and select the Workspace where you have previously created the Custom Table \n7. Click on 'Add data source'.\n8. Fill other required parameters and tags and create the DCR"
                                    }
                                  ]
                                },
                                "type": "InstructionStepsGroup"
                              }
                            ]
                          },
                          {
                            "title": "Assign the DCR to all Exchange Servers",
                            "description": "Add all your Exchange Servers to the DCR"
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ],
    "metadata": {
      "id": "ababbb06-b977-4259-ab76-87874d353039",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "Microsoft Exchange Security - Exchange On-Premises"
      },
      "support": {
        "name": "Community",
        "tier": "Community",
        "link": "https://github.com/Azure/Azure-Sentinel/issues"
      },
      "author": {
        "name": "Microsoft"
      }
    }
  },
  {
    "id": "ESI-Opt7ExchangeHTTPProxyLogs",
    "title": "Microsoft Exchange HTTP Proxy Logs",
    "publisher": "Microsoft",
    "descriptionMarkdown": "[Option 7] - Using Azure Monitor Agent - You can stream HTTP Proxy logs and Security Event logs from the Windows machines connected to your Microsoft Sentinel workspace using the Windows agent. This connection enables you create custom alerts, and improve investigation. [Learn more](https://aka.ms/ESI_DataConnectorOptions)",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Exchange HTTPProxy logs",
        "baseQuery": "ExchangeHttpProxy_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Audit logs",
        "query": "ExchangeHttpProxy_CL | sort by TimeGenerated"
      }
    ],
    "dataTypes": [
      {
        "name": "ExchangeHttpProxy_CL",
        "lastDataReceivedQuery": "ExchangeHttpProxy_CL  | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ExchangeHttpProxy_CL  | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(7h)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Azure Log Analytics will be deprecated",
          "description": "Azure Log Analytics will be deprecated, to collect data from non-Azure VMs, Azure Arc is recommended. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "name": "Detailled documentation",
          "description": ">**NOTE:** Detailled documentation on Installation procedure and usage can be found [here](https://aka.ms/MicrosoftExchangeSecurityGithub)"
        }
      ]
    },
    "instructionSteps": [
      {
        "description": ">**NOTE:** This solution is based on options. This allows you to choose which data will be ingest as some options can generate a very high volume of data. Depending on what you want to collect, track in your Workbooks, Analytics Rules, Hunting capabilities you will choose the option(s) you will deploy. Each options are independant for one from the other. To learn more about each option: ['Microsoft Exchange Security' wiki](https://aka.ms/ESI_DataConnectorOptions)\n\n>This Data Connector is the **option 7** of the wiki."
      },
      {
        "title": "1.  Download and install the agents needed to collect logs for Microsoft Sentinel",
        "description": "Type of servers (Exchange Servers, Domain Controllers linked to Exchange Servers or all Domain Controllers) depends on the option you want to deploy.",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Deploy Monitor Agents",
                  "description": "This step is required only if it's the first time you onboard your Exchange Servers/Domain Controllers\n**Deploy the Azure Arc Agent**\n> [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. [Option 7] HTTP Proxy of Exchange Servers",
        "description": "Select how to stream HTTP Proxy of Exchange Servers",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Data Collection Rules - When Azure Monitor Agent is used",
                  "description": "**Enable data collection rule**\n> Message Tracking are collected only from **Windows** agents.",
                  "instructions": [
                    {
                      "parameters": {
                        "instructionSteps": [
                          {
                            "title": "Option 1 - Azure Resource Manager (ARM) Template (Prefered Method)",
                            "description": "Use this method for automated deployment of the DCE and DCR.",
                            "instructions": [
                              {
                                "parameters": {
                                  "instructionSteps": [
                                    {
                                      "title": "A. Create DCE (If not already created for Exchange Servers)",
                                      "description": "1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-ESI-DCEExchangeServers)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. You can change the proposed name of the DCE.\n5.  Click **Create** to deploy."
                                    },
                                    {
                                      "title": "B. Deploy Data Connection Rule",
                                      "description": "1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-ESI-DCROption7-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace ID** 'and/or Other required fields'.\n>4.  Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5.  Click **Purchase** to deploy."
                                    }
                                  ]
                                },
                                "type": "InstructionStepsGroup"
                              }
                            ]
                          },
                          {
                            "title": "Option 2 - Manual Deployment of Azure Automation",
                            "description": "Use the following step-by-step instructions to deploy manually a Data Collection Rule.",
                            "instructions": [
                              {
                                "parameters": {
                                  "instructionSteps": [
                                    {
                                      "title": "Create Custom Table - Explanation",
                                      "description": "The Custom Table can't be created using the Azure Portal. You need to use an ARM template, a PowerShell Script or another method [described here](https://learn.microsoft.com/en-us/azure/azure-monitor/logs/create-custom-table?tabs=azure-powershell-1%2Cazure-portal-2%2Cazure-portal-3#create-a-custom-table)."
                                    },
                                    {
                                      "title": "Create Custom Table using an ARM Template",
                                      "description": "1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-ESI-HTTPProxyCustomTable)\n2. Select the preferred **Subscription**, **Resource Group**, **Location** and **Analytic Workspace Name**. \n3.  Click **Create** to deploy."
                                    },
                                    {
                                      "title": "Create Custom Table using PowerShell in Cloud Shell",
                                      "description": "1.  From the Azure Portal, open a Cloud Shell.\n2. Copy and paste and Execute the following script in the Cloud Shell to create the table.\n\t\t$tableParams = @'\n\t\t{\n\t\t\t\"properties\": {\n\t\t\t\t \"schema\": {\n\t\t\t\t\t\t\"name\": \"ExchangeHttpProxy_CL\",\n\t\t\t\t\t\t\"columns\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"AccountForestLatencyBreakup\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"ActivityContextLifeTime\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"ADLatency\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"AnchorMailbox\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"AuthenticatedUser\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"AuthenticationType\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"AuthModulePerfContext\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"BackEndCookie\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"BackEndGenericInfo\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"BackendProcessingLatency\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"BackendReqInitLatency\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"BackendReqStreamLatency\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"BackendRespInitLatency\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"BackendRespStreamLatency\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"BackEndStatus\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"BuildVersion\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"CalculateTargetBackEndLatency\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"ClientIpAddress\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"ClientReqStreamLatency\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"ClientRequestId\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"ClientRespStreamLatency\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"CoreLatency\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"DatabaseGuid\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"EdgeTraceId\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"ErrorCode\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"GenericErrors\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"GenericInfo\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"GlsLatencyBreakup\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"HandlerCompletionLatency\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"HandlerToModuleSwitchingLatency\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"HttpPipelineLatency\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"HttpProxyOverhead\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"HttpStatus\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"IsAuthenticated\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"KerberosAuthHeaderLatency\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"MajorVersion\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"Method\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"MinorVersion\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"ModuleToHandlerSwitchingLatency\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"Organization\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"PartitionEndpointLookupLatency\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"Protocol\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"ProtocolAction\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"ProxyAction\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"ProxyTime\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"RequestBytes\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"RequestHandlerLatency\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"RequestId\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"ResourceForestLatencyBreakup\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"ResponseBytes\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"RevisionVersion\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"RouteRefresherLatency\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"RoutingHint\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"RoutingLatency\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"RoutingStatus\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"RoutingType\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"ServerHostName\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"ServerLocatorHost\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"ServerLocatorLatency\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"SharedCacheLatencyBreakup\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"TargetOutstandingRequests\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"TargetServer\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"TargetServerVersion\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"TotalAccountForestLatency\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"TotalGlsLatency\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"TotalRequestTime\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"TotalResourceForestLatency\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"TotalSharedCacheLatency\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"UrlHost\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"UrlQuery\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"UrlStem\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"UserADObjectGuid\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"UserAgent\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"TimeGenerated\",\n\t\t\t\t\t\t\t\t\t\"type\": \"datetime\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"name\": \"FilePath\",\n\t\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t }\n\t\t\t }\n\t\t }\n\t\t '@\n3.  Copy, Replace, Paste and execute the following parameters with your own values:\n\t\t$SubscriptionID = 'YourGUID'\n\t\t$ResourceGroupName = 'YourResourceGroupName'\n\t\t$WorkspaceName = 'YourWorkspaceName'\n4.  Execute the Following Cmdlet to create the table:\n\t\tInvoke-AzRestMethod -Path \"/subscriptions/$SubscriptionID/resourcegroups/$ResourceGroupName/providers/microsoft.operationalinsights/workspaces/$WorkspaceName/tables/ExchangeHttpProxy_CL?api-version=2021-12-01-preview\" -Method PUT -payload $tableParams"
                                    }
                                  ]
                                },
                                "type": "InstructionStepsGroup"
                              },
                              {
                                "parameters": {
                                  "instructionSteps": [
                                    {
                                      "title": "A. Create DCE (If not already created for Exchange Servers)",
                                      "description": "1.  From the Azure Portal, navigate to [Azure Data collection Endpoint](https://portal.azure.com/#view/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/~/dataCollectionEndpoints).\n2. Click **+ Create** at the top.\n3. In the **Basics** tab, fill the required fields and give a name to the DCE. \n3. 'Make other preferable configuration changes', if needed, then click **Create**."
                                    },
                                    {
                                      "title": "B. Create a DCR, Type Custom log",
                                      "description": "1.  From the Azure Portal, navigate to [Azure Data collection rules](https://portal.azure.com/#view/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/~/dataCollectionRules).\n2. Click on 'Create' button.\n3. On 'Basics' tab, fill the Rule name like **DCR-Option7-HTTPProxyLogs**, select the 'Data Collection Endpoint' with the previously created endpoint and fill other parameters.\n4. In the **Resources** tab, add your Exchange Servers.\n5. In **Collect and Deliver**, add a Data Source type 'Custom Text logs' and enter the following file pattern : \n\t\t'C:\\Program Files\\Microsoft\\Exchange Server\\V15\\Logging\\HttpProxy\\Autodiscover\\*.log','C:\\Program Files\\Microsoft\\Exchange Server\\V15\\Logging\\HttpProxy\\Eas\\*.log','C:\\Program Files\\Microsoft\\Exchange Server\\V15\\Logging\\HttpProxy\\Ecp\\*.log','C:\\Program Files\\Microsoft\\Exchange Server\\V15\\Logging\\HttpProxy\\Ews\\*.log','C:\\Program Files\\Microsoft\\Exchange Server\\V15\\Logging\\HttpProxy\\Mapi\\*.log','C:\\Program Files\\Microsoft\\Exchange Server\\V15\\Logging\\HttpProxy\\Oab\\*.log','C:\\Program Files\\Microsoft\\Exchange Server\\V15\\Logging\\HttpProxy\\Owa\\*.log','C:\\Program Files\\Microsoft\\Exchange Server\\V15\\Logging\\HttpProxy\\OwaCalendar\\*.log','C:\\Program Files\\Microsoft\\Exchange Server\\V15\\Logging\\HttpProxy\\PowerShell\\*.log','C:\\Program Files\\Microsoft\\Exchange Server\\V15\\Logging\\HttpProxy\\RpcHttp\\*.log'\n6. Put 'ExchangeHttpProxy_CL' in Table Name.\n7. in Transform field, enter the following KQL request :\n\t\tsource | extend d = split(RawData,',') | extend DateTime=todatetime(d[0]),RequestId=tostring(d[1]) ,MajorVersion=tostring(d[2]) ,MinorVersion=tostring(d[3]) ,BuildVersion=tostring(d[4]) ,RevisionVersion=tostring(d[5]) ,ClientRequestId=tostring(d[6]) ,Protocol=tostring(d[7]) ,UrlHost=tostring(d[8]) ,UrlStem=tostring(d[9]) ,ProtocolAction=tostring(d[10]) ,AuthenticationType=tostring(d[11]) ,IsAuthenticated=tostring(d[12]) ,AuthenticatedUser=tostring(d[13]) ,Organization=tostring(d[14]) ,AnchorMailbox=tostring(d[15]) ,UserAgent=tostring(d[16]) ,ClientIpAddress=tostring(d[17]) ,ServerHostName=tostring(d[18]) ,HttpStatus=tostring(d[19]) ,BackEndStatus=tostring(d[20]) ,ErrorCode=tostring(d[21]) ,Method=tostring(d[22]) ,ProxyAction=tostring(d[23]) ,TargetServer=tostring(d[24]) ,TargetServerVersion=tostring(d[25]) ,RoutingType=tostring(d[26]) ,RoutingHint=tostring(d[27]) ,BackEndCookie=tostring(d[28]) ,ServerLocatorHost=tostring(d[29]) ,ServerLocatorLatency=tostring(d[30]) ,RequestBytes=tostring(d[31]) ,ResponseBytes=tostring(d[32]) ,TargetOutstandingRequests=tostring(d[33]) ,AuthModulePerfContext=tostring(d[34]) ,HttpPipelineLatency=tostring(d[35]) ,CalculateTargetBackEndLatency=tostring(d[36]) ,GlsLatencyBreakup=tostring(d[37]) ,TotalGlsLatency=tostring(d[38]) ,AccountForestLatencyBreakup=tostring(d[39]) ,TotalAccountForestLatency=tostring(d[40]) ,ResourceForestLatencyBreakup=tostring(d[41]) ,TotalResourceForestLatency=tostring(d[42]) ,ADLatency=tostring(d[43]) ,SharedCacheLatencyBreakup=tostring(d[44]) ,TotalSharedCacheLatency=tostring(d[45]) ,ActivityContextLifeTime=tostring(d[46]) ,ModuleToHandlerSwitchingLatency=tostring(d[47]) ,ClientReqStreamLatency=tostring(d[48]) ,BackendReqInitLatency=tostring(d[49]) ,BackendReqStreamLatency=tostring(d[50]) ,BackendProcessingLatency=tostring(d[51]) ,BackendRespInitLatency=tostring(d[52]) ,BackendRespStreamLatency=tostring(d[53]) ,ClientRespStreamLatency=tostring(d[54]) ,KerberosAuthHeaderLatency=tostring(d[55]) ,HandlerCompletionLatency=tostring(d[56]) ,RequestHandlerLatency=tostring(d[57]) ,HandlerToModuleSwitchingLatency=tostring(d[58]) ,ProxyTime=tostring(d[59]) ,CoreLatency=tostring(d[60]) ,RoutingLatency=tostring(d[61]) ,HttpProxyOverhead=tostring(d[62]) ,TotalRequestTime=tostring(d[63]) ,RouteRefresherLatency=tostring(d[64]) ,UrlQuery=tostring(d[65]) ,BackEndGenericInfo=tostring(d[66]) ,GenericInfo=tostring(d[67]) ,GenericErrors=tostring(d[68]) ,EdgeTraceId=tostring(d[69]) ,DatabaseGuid=tostring(d[70]) ,UserADObjectGuid=tostring(d[71]) ,PartitionEndpointLookupLatency=tostring(d[72]) ,RoutingStatus=tostring(d[73]) | extend TimeGenerated = DateTime  | project-away d,RawData,DateTime | project-away d,RawData,DateTime\n and click on 'Destination'.\n8. In 'Destination', add a destination and select the Workspace where you have previously created the Custom Table \n9. Click on 'Add data source'.\n10. Fill other required parameters and tags and create the DCR"
                                    }
                                  ]
                                },
                                "type": "InstructionStepsGroup"
                              }
                            ]
                          },
                          {
                            "title": "Assign the DCR to all Exchange Servers",
                            "description": "Add all your Exchange Servers to the DCR"
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ],
    "metadata": {
      "id": "2e63ad0e-84e3-4f01-b210-9db0bc42b8ff",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "Microsoft Exchange Security - Exchange On-Premises"
      },
      "support": {
        "name": "Community",
        "tier": "Community",
        "link": "https://github.com/Azure/Azure-Sentinel/issues"
      },
      "author": {
        "name": "Microsoft"
      }
    }
  },
  {
    "id": "Exabeam",
    "title": "[Deprecated] Exabeam Advanced Analytics",
    "publisher": "Exabeam",
    "descriptionMarkdown": "The [Exabeam Advanced Analytics](https://www.exabeam.com/ueba/advanced-analytics-and-mitre-detect-and-stop-threats/) data connector provides the capability to ingest Exabeam Advanced Analytics events into Microsoft Sentinel. Refer to [Exabeam Advanced Analytics documentation](https://docs.exabeam.com/) for more information.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Exabeam",
        "baseQuery": "ExabeamEvent"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Clients (Source IP)",
        "query": "ExabeamEvent\n | summarize count() by SrcIpAddr\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog (Exabeam)",
        "lastDataReceivedQuery": "ExabeamEvent\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ExabeamEvent\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "write permission is required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias Exabeam Advanced Analytics and load the function code or click [here](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Exabeam%20Advanced%20Analytics/Parsers/ExabeamEvent.txt), on the second line of the query, enter the hostname(s) of your Exabeam Advanced Analytics device(s) and any other unique identifiers for the logstream. The function usually takes 10-15 minutes to activate after solution installation/update.",
        "instructions": []
      },
      {
        "title": "",
        "description": ">**NOTE:** This data connector has been developed using Exabeam Advanced Analytics i54 (Syslog)",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux or Windows",
        "description": "Install the agent on the server where the Exabeam Advanced Analytic logs are generated or forwarded.\n\n> Logs from Exabeam Advanced Analytic deployed on Linux or Windows servers are collected by **Linux** or **Windows** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Linux agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Windows agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Windows Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Windows Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Configure the custom log directory to be collected",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenCustomLogsSettings"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "3. Configure Exabeam event forwarding to Syslog",
        "description": "[Follow these instructions](https://docs.exabeam.com/en/advanced-analytics/i56/advanced-analytics-administration-guide/125351-advanced-analytics.html#UUID-7ce5ff9d-56aa-93f0-65de-c5255b682a08) to send Exabeam Advanced Analytics activity log data via syslog."
      }
    ]
  },
  {
    "id": "ExtraHop",
    "title": "ExtraHop Detections Data Connector",
    "publisher": "ExtraHop",
    "descriptionMarkdown": "The [ExtraHop](https://extrahop.com/) Detections Data Connector enables you to import detection data from ExtraHop RevealX to Microsoft Sentinel through webhook payloads.",
    "graphQueries": [
      {
        "metricName": "Total detections data received",
        "legend": "ExtraHop_Detections_CL",
        "baseQuery": "ExtraHop_Detections_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "ExtraHop detections data for all detection types",
        "query": "ExtraHop_Detections_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "ExtraHop_Detections_CL",
        "lastDataReceivedQuery": "ExtraHop_Detections_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ExtraHop_Detections_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Azure Subscription",
          "description": "Azure Subscription with owner role is required to register an application in Microsoft Entra ID and assign role of contributor to app in resource group."
        },
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "ExtraHop RevealX permissions",
          "description": "The following is required on your ExtraHop RevealX system:\n 1.Your RevealX system must be running firmware version 9.9.2 or later.\n 2.Your RevealX system must be connected to ExtraHop Cloud Services.\n 3.Your user account must have System Administratin privileges on RevealX 360 or Full Write privileges on RevealX Enterprise."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the ExtraHop in which logs are pushed via ExtraHop webhook and it will ingest logs into Microsoft Sentinel. Furthermore, the connector will fetch the ingested data from the custom logs table and create Threat Intelligence Indicators into Microsoft Sentinel Threat Intelligence. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "description": "**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias **ExtraHopDetections** and load the function code or click [here](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/ExtraHop/Parsers/ExtraHopDetections.yaml). The function usually takes 10-15 minutes to activate after solution installation/update."
      },
      {
        "title": "",
        "description": "**STEP 1 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the ExtraHop Microsoft Sentinel data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following) readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Complete the following steps for automated deployment of the ExtraHop Detections Data Connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-ExtraHop-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the values for the following parameters:\n\n\t a. **Function Name** - Enter the Function Name you want. \n\n\t b. **Workspace ID** - Enter the Workspace ID of the log analytics Workspace. \n\n\t c. **Workspace Key** - Enter the Workspace Key of the log analytics Workspace. \n\n\t d. **Detections Table Name** - Enter the name of the table used to store ExtraHop detection data. \n\n\t e. **LogLevel** - Select Debug, Info, Error, or Warning for the log level or log severity value. \n\n\t f. **AppInsightsWorkspaceResourceID** - Enter the value of the 'Log Analytic Workspace-->Properties-->Resource ID' property. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Complete the following steps to manually deploy the ExtraHop Detections Data Connector with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "1) Deploy a Function App",
        "description": "> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-ExtraHop-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. ExtraHopXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.11 or above.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "2) Configure the Function App",
        "description": "1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following application settings individually, with the following respective values (case-sensitive): \n\n\t a. **Function Name** - Enter the Function Name you want. \n\n\t b. **Workspace ID** - Enter the Workspace ID of the log analytics Workspace. \n\n\tc. **Workspace Key** - Enter the Workspace Key of the log analytics Workspace. \n\n\td. **Detections Table Name** - Enter the name of the table used to store ExtraHop detection data. \n\n\te. **LogLevel** - Select Debug, Info, Error, or Warning for the log level or log severity value. \n\n\t f. **logAnalyticsUri (optional)** - Configure this option to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n4. Once all application settings have been entered, click **Save**."
      },
      {
        "title": "",
        "description": "**STEP 2 - Post Deployment**\n\n"
      },
      {
        "title": "1) Get the Function App endpoint",
        "description": "1. Go to the Azure function overview page and click the **\"Functions\"** tab.\n2. Click on the function called **\"ExtraHopHttpStarter\"**.\n3. Go to **\"GetFunctionurl\"** and copy the function url available under **\"default (Function key)\"**.\n4. Replace **{functionname}**  with **\"ExtraHopDetectionsOrchestrator\"** in copied function url."
      },
      {
        "title": "2) Configure a connection to Microsoft Sentinel and specify webhook payload criteria from RevealX",
        "description": "From your ExtraHop system, configure the Microsoft Sentinel integration to establish a connection between Microsoft Sentinel and ExtraHop RevealX and to create detection notification rules that will send webhook data to Microsoft Sentinel. For detailed instructions, refer to [Integrate ExtraHop RevealX with Microsoft Sentinel SIEM](https://docs.extrahop.com/current/integrations-microsoft-sentinel-siem/)."
      },
      {
        "title": "",
        "description": "*After notification rules have been configured and Microsoft Sentinel is receiving webhook data, the Function App is triggered and you can view ExtraHop detections from the Log Analytics workspace table named \"ExtraHop_Detections_CL\".*\n\n"
      }
    ]
  },
  {
    "id": "ExtraHopNetworks",
    "title": "[Deprecated] ExtraHop Reveal(x) via Legacy Agent",
    "publisher": "ExtraHop Networks",
    "logo": "ExtraHopLogo.svg",
    "descriptionMarkdown": "The ExtraHop Reveal(x) data connector enables you to easily connect your Reveal(x) system with Microsoft Sentinel to view dashboards, create custom alerts, and improve investigation. This integration gives you the ability to gain insight into your organization's network and improve your security operation capabilities.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ExtraHop Networks",
        "baseQuery": "\nCommonSecurityLog\n| where DeviceVendor == \"ExtraHop\"\n"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"ExtraHop\"\n\n            | sort by TimeGenerated"
      },
      {
        "description": "All detections, de-duplicated",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"ExtraHop\"\n\n            | extend categories = iif(DeviceCustomString2 != \"\", split(DeviceCustomString2, \",\"),dynamic(null))\n            | extend StartTime = extract(\"start=([0-9-]+T[0-9:.]+Z)\", 1, AdditionalExtensions,typeof(datetime))\n            | extend EndTime = extract(\"end=([0-9-]+T[0-9:.]+Z)\", 1, AdditionalExtensions,typeof(datetime))\n            | project\n            DeviceEventClassID=\"ExtraHop Detection\",\n            Title=Activity,\n            Description=Message,\n            riskScore=DeviceCustomNumber2,\n            SourceIP,\n            DestinationIP,\n            detectionID=tostring(DeviceCustomNumber1),\n            updateTime=todatetime(ReceiptTime),\n            StartTime,\n            EndTime,\n            detectionURI=DeviceCustomString1,\n            categories,\n            Computer\n            | summarize arg_max(updateTime, *) by detectionID\n            | sort by detectionID desc"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "\nCommonSecurityLog\n| where DeviceVendor == \"ExtraHop\"\n\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (ExtraHop)",
        "lastDataReceivedQuery": "\nCommonSecurityLog\n| where DeviceVendor == \"ExtraHop\"\n\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "ExtraHop",
          "description": "ExtraHop Discover or Command appliance with firmware version 7.8 or later with a user account that has Unlimited (administrator) privileges."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python --version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward ExtraHop Networks logs to Syslog agent",
        "description": "1.  Set your security solution to send Syslog messages in CEF format to the proxy machine. Make sure to send the logs to port 514 TCP on the machine IP address.\n2. Follow the directions to install the [ExtraHop Detection SIEM Connector bundle](https://aka.ms/asi-syslog-extrahop-forwarding) on your Reveal(x) system. The SIEM Connector is required for this integration.\n3. Enable the trigger for **ExtraHop Detection SIEM Connector - CEF**\n4. Update the trigger with the ODS syslog targets you created\n5. The Reveal(x) system formats syslog messages in Common Event Format (CEF) and then sends data to Microsoft Sentinel."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python --version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "3c3af19d-b178-44cd-a130-c48b366758c4",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "ExtraHop Networks"
      },
      "support": {
        "name": "ExtraHop Networks",
        "link": "https://www.extrahop.com/support/",
        "tier": "developer"
      }
    }
  },
  {
    "id": "ExtraHopNetworksAma",
    "title": "[Deprecated] ExtraHop Reveal(x) via AMA",
    "publisher": "ExtraHop Networks",
    "logo": "ExtraHopLogo.svg",
    "descriptionMarkdown": "The ExtraHop Reveal(x) data connector enables you to easily connect your Reveal(x) system with Microsoft Sentinel to view dashboards, create custom alerts, and improve investigation. This integration gives you the ability to gain insight into your organization's network and improve your security operation capabilities.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ExtraHop Networks",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'ExtraHop'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"ExtraHop\"\n\n            | sort by TimeGenerated"
      },
      {
        "description": "All detections, de-duplicated",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"ExtraHop\"\n\n            | extend categories = iif(DeviceCustomString2 != \"\", split(DeviceCustomString2, \",\"),dynamic(null))\n            | extend StartTime = extract(\"start=([0-9-]+T[0-9:.]+Z)\", 1, AdditionalExtensions,typeof(datetime))\n            | extend EndTime = extract(\"end=([0-9-]+T[0-9:.]+Z)\", 1, AdditionalExtensions,typeof(datetime))\n            | project\n            DeviceEventClassID=\"ExtraHop Detection\",\n            Title=Activity,\n            Description=Message,\n            riskScore=DeviceCustomNumber2,\n            SourceIP,\n            DestinationIP,\n            detectionID=tostring(DeviceCustomNumber1),\n            updateTime=todatetime(ReceiptTime),\n            StartTime,\n            EndTime,\n            detectionURI=DeviceCustomString1,\n            categories,\n            Computer\n            | summarize arg_max(updateTime, *) by detectionID\n            | sort by detectionID desc"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'ExtraHop'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (ExtraHop)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'ExtraHop'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine"
                },
                {
                  "title": "Step B. Forward ExtraHop Networks logs to Syslog agent",
                  "description": "1.  Set your security solution to send Syslog messages in CEF format to the proxy machine. Make sure to send the logs to port 514 TCP on the machine IP address.\n2. Follow the directions to install the [ExtraHop Detection SIEM Connector bundle](https://aka.ms/asi-syslog-extrahop-forwarding) on your Reveal(x) system. The SIEM Connector is required for this integration.\n3. Enable the trigger for **ExtraHop Detection SIEM Connector - CEF**\n4. Update the trigger with the ODS syslog targets you created\n5. The Reveal(x) system formats syslog messages in Common Event Format (CEF) and then sends data to Microsoft Sentinel."
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "3c3af19d-b178-44cd-a130-c48b366758c4",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "ExtraHop Networks"
      },
      "support": {
        "name": "ExtraHop Networks",
        "link": "https://www.extrahop.com/support/",
        "tier": "developer"
      }
    }
  },
  {
    "id": "F5",
    "title": "[Deprecated] F5 Networks via Legacy Agent",
    "publisher": "F5 Networks",
    "descriptionMarkdown": "The F5 firewall connector allows you to easily connect your F5 logs with Microsoft Sentinel, to view dashboards, create custom alerts, and improve investigation. This gives you more insight into your organization's network and improves your security operation capabilities.",
    "logo": "ffive_logo.png",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "F5",
        "baseQuery": "\nCommonSecurityLog\n| where DeviceVendor == \"F5\"\n"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"F5\"\n\n            | sort by TimeGenerated"
      },
      {
        "description": "Summarize by time",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"F5\"\n\n            | summarize count() by TimeGenerated\n            | sort by TimeGenerated"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "\nCommonSecurityLog\n| where DeviceVendor == \"F5\"\n\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (F5)",
        "lastDataReceivedQuery": "\nCommonSecurityLog\n| where DeviceVendor == \"F5\"\n\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python --version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Common Event Format (CEF) logs to Syslog agent",
        "description": "Configure F5 to forward Syslog messages in CEF format to your Microsoft Sentinel workspace via the Syslog agent.\n\nGo to [F5 Configuring Application Security Event Logging](https://aka.ms/asi-syslog-f5-forwarding), follow the instructions to set up remote logging, using the following guidelines:\n\n1.  Set the  **Remote storage type**  to CEF.\n2.  Set the  **Protocol setting**  to UDP.\n3.  Set the  **IP address**  to the Syslog server IP address.\n4.  Set the  **port number**  to 514, or the port your agent uses.\n5.  Set the  **facility**  to the one that you configured in the Syslog agent (by default, the agent sets this to local4).\n6.  You can set the  **Maximum Query String Size**  to be the same as you configured."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python --version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "1109b34a-a461-433e-a446-081658cd4264",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "F5"
      },
      "support": {
        "name": "F5",
        "link": "https://www.f5.com/services/support",
        "tier": "developer"
      }
    }
  },
  {
    "id": "F5Ama",
    "title": "[Deprecated] F5 Networks via AMA",
    "publisher": "F5 Networks",
    "descriptionMarkdown": "The F5 firewall connector allows you to easily connect your F5 logs with Microsoft Sentinel, to view dashboards, create custom alerts, and improve investigation. This gives you more insight into your organization's network and improves your security operation capabilities.",
    "logo": "ffive_logo.png",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "F5",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'F5'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"F5\"\n\n            | sort by TimeGenerated"
      },
      {
        "description": "Summarize by time",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"F5\"\n\n            | summarize count() by TimeGenerated\n            | sort by TimeGenerated"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'F5'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (F5)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'F5'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine"
                },
                {
                  "title": "Step B. Forward Common Event Format (CEF) logs to Syslog agent",
                  "description": "Configure F5 to forward Syslog messages in CEF format to your Microsoft Sentinel workspace via the Syslog agent.\n\nGo to [F5 Configuring Application Security Event Logging](https://aka.ms/asi-syslog-f5-forwarding), follow the instructions to set up remote logging, using the following guidelines:\n\n1.  Set the  **Remote storage type**  to CEF.\n2.  Set the  **Protocol setting**  to UDP.\n3.  Set the  **IP address**  to the Syslog server IP address.\n4.  Set the  **port number**  to 514, or the port your agent uses.\n5.  Set the  **facility**  to the one that you configured in the Syslog agent (by default, the agent sets this to local4).\n6.  You can set the  **Maximum Query String Size**  to be the same as you configured."
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "1109b34a-a461-433e-a446-081658cd4264",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "F5"
      },
      "support": {
        "name": "F5",
        "link": "https://www.f5.com/services/support",
        "tier": "developer"
      }
    }
  },
  {
    "id": "F5BigIp",
    "title": "F5 BIG-IP",
    "publisher": "F5 Networks",
    "descriptionMarkdown": "The F5 firewall connector allows you to easily connect your F5 logs with Microsoft Sentinel, to view dashboards, create custom alerts, and improve investigation. This gives you more insight into your organization's network and improves your security operation capabilities.",
    "logo": "ffive_logo.png",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "F5Telemetry_LTM_CL",
        "baseQuery": "F5Telemetry_LTM_CL"
      },
      {
        "metricName": "Total data received",
        "legend": "F5Telemetry_system_CL",
        "baseQuery": "F5Telemetry_system_CL"
      },
      {
        "metricName": "Total data received",
        "legend": "F5Telemetry_ASM_CL",
        "baseQuery": "F5Telemetry_ASM_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Count how many LTM logs have been generated from different client IP addresses over time",
        "query": "F5Telemetry_LTM_CL\n            | summarize count() by client_ip_s, TimeGenerated\n            | sort by TimeGenerated"
      },
      {
        "description": "Present the System Telemetry host names",
        "query": "F5Telemetry_system_CL\n            | project hostname_s, TimeGenerated\n            | sort by TimeGenerated"
      },
      {
        "description": "Count how many ASM logs have been generated from different locations",
        "query": "F5Telemetry_ASM_CL\n            | summarize count() by geo_location_s"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "F5Telemetry_system_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "F5Telemetry_LTM_CL",
        "lastDataReceivedQuery": "F5Telemetry_LTM_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "F5Telemetry_system_CL",
        "lastDataReceivedQuery": "F5Telemetry_system_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "F5Telemetry_ASM_CL",
        "lastDataReceivedQuery": "F5Telemetry_ASM_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Configure and connect F5 BIGIP",
        "description": "To connect your F5 BIGIP, you have to post a JSON declaration to the systems API endpoint. For instructions on how to do this, see [Integrating the F5 BGIP with Microsoft Sentinel](https://aka.ms/F5BigIp-Integrate).",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ],
    "metadata": {
      "id": "bf5e4cc6-398a-48a0-a75b-a072362ff27a",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "F5"
      },
      "support": {
        "name": "F5",
        "link": "https://support.f5.com/csp/home",
        "tier": "developer"
      }
    }
  },
  {
    "id": "Feedly",
    "title": "Feedly",
    "publisher": "Feedly",
    "descriptionMarkdown": "This connector allows you to ingest IoCs from Feedly.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "feedly_indicators_CL",
        "baseQuery": "feedly_indicators_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All IoCs collected",
        "query": "feedly_indicators_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Ip addresses",
        "query": "feedly_indicators_CL\n | where type_s == \"ip\"\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "feedly_indicators_CL",
        "lastDataReceivedQuery": "feedly_indicators_CL\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "feedly_indicators_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Azure AD Application Registration",
          "description": "An Azure AD App Registration with client credentials and permissions to write to the Data Collection Rule. The application must be granted 'Monitoring Metrics Publisher' role on the DCR."
        },
        {
          "name": "Data Collection Endpoint and Rule",
          "description": "A Data Collection Endpoint (DCE) and Data Collection Rule (DCR) must be created before deploying this connector. [See the documentation to learn more](https://learn.microsoft.com/azure/azure-monitor/logs/custom-logs-migrate)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions and the Logs Ingestion API to pull IoCs from Feedly into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "Step 1 - Prepare Your Environment",
        "description": "The Feedly connector will automatically create:\n\n- **Custom Table**: `feedly_indicators_CL` with the required schema\n- **Data Collection Endpoint (DCE)**: For ingesting data\n- **Data Collection Rule (DCR)**: For processing and routing data\n\nNo manual resource creation is required - everything will be created during deployment!\n\nFor detailed instructions, see: [Migrate from HTTP Data Collector API to Logs Ingestion API](https://learn.microsoft.com/azure/azure-monitor/logs/custom-logs-migrate)"
      },
      {
        "title": "Step 2 - Deploy the Connector",
        "description": "The ARM template will automatically:\n\n1. Create a managed identity for the Azure Function\n2. Assign the **Monitoring Metrics Publisher** role to the Function App on the DCR\n3. Configure all necessary permissions for data ingestion\n\nNo manual role assignments are required - everything is handled automatically during deployment!"
      },
      {
        "title": "Step 3 - Get your Feedly API token",
        "description": "Go to https://feedly.com/i/team/api and generate a new API token for the connector."
      },
      {
        "title": "(Optional Step) Securely store credentials in Azure Key Vault",
        "description": "Azure Key Vault provides a secure mechanism to store and retrieve secrets. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App by using the `@Microsoft.KeyVault(SecretUri={Security Identifier})` schema."
      },
      {
        "title": "Step 4 - Deploy the connector",
        "description": "Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function\n\n>**IMPORTANT:** Before deploying, gather the following information:\n- Feedly API Token and Stream IDs\n\nAll Azure Monitor resources (DCE, DCR, custom table, and role assignments) will be created automatically during deployment.",
        "instructions": [],
        "innerSteps": [
          {
            "title": "Option 1 - Azure Resource Manager (ARM) Template",
            "description": "Use this method for automated deployment of the Feedly connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-Feedly-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the required parameters:\n   - **TableName**: Name for the custom table (default: `feedly_indicators_CL`)\n   - **FeedlyApiKey**: Your Feedly API token from Step 3\n   - **FeedlyStreamIds**: Comma-separated list of Feedly stream IDs\n   - **DaysToBackfill**: Number of days to backfill (default: 7)\n\n>**Note**: If using Azure Key Vault secrets, use the `@Microsoft.KeyVault(SecretUri={Security Identifier})` schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
          },
          {
            "title": "Option 2 - Manual Deployment of Azure Functions",
            "description": "Use the following step-by-step instructions to deploy the Feedly connector manually with Azure Functions (Deployment via Visual Studio Code).",
            "innerSteps": [
              {
                "title": "1. Deploy a Function App",
                "description": "**NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://github.com/Azure/Azure-Sentinel/raw/refs/heads/master/Solutions/Feedly/Data%20Connectors/FeedlyAzureFunction.zip) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity Bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. FeedlyXXXX).\n\n\te. **Select a runtime:** Choose Python 3.10.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
              },
              {
                "title": "2. Configure the Function App",
                "description": "1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **New application setting**.\n3. Add each of the following application settings individually, with their respective values (case-sensitive):\n\t\t- `DataCollectionEndpoint`: Will be populated automatically after DCE creation\n\t\t- `DcrImmutableId`: Will be populated automatically after DCR creation\n\t\t- `DcrStreamName`: `feedly_indicators_CL`\n\t\t- `FeedlyApiKey`: Your Feedly API token\n\t\t- `FeedlyStreamIds`: Comma-separated Feedly stream IDs\n\t\t- `DaysToBackfill`: Number of days to backfill (e.g., 7)\n\n**Note**: The Function App uses managed identity for authentication to Azure Monitor, so no Azure AD credentials are needed.\n\n>**Note**: Use Azure Key Vault references for sensitive values: `@Microsoft.KeyVault(SecretUri={Security Identifier})`\n\n4. Once all application settings have been entered, click **Save**."
              }
            ]
          }
        ]
      }
    ]
  },
  {
    "id": "FireEyeNX",
    "title": "[Deprecated] FireEye Network Security (NX) via Legacy Agent",
    "publisher": "FireEye",
    "descriptionMarkdown": "The [FireEye Network Security (NX)](https://www.fireeye.com/products/network-security.html) data connector provides the capability to ingest FireEye Network Security logs into Microsoft Sentinel.",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected [**FireEyeNXEvent**](https://aka.ms/sentinel-FireEyeNX-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "FireEyeNX",
        "baseQuery": "FireEyeNXEvent"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Sources",
        "query": "FireEyeNXEvent\n | where isnotempty(SrcIpAddr)\n    | summarize count() by SrcIpAddr\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (FireEyeNX)",
        "lastDataReceivedQuery": "FireEyeNXEvent\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "FireEyeNXEvent\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**FireEyeNXEvent**](https://aka.ms/sentinel-FireEyeNX-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "",
        "description": ">**NOTE:** This data connector has been developed using FEOS release v9.0",
        "instructions": []
      },
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2.  Configure FireEye NX to send logs using CEF",
        "description": "Complete the following steps to send data using CEF:\n\n2.1. Log into the FireEye appliance with an administrator account\n\n2.2. Click **Settings**\n\n2.3. Click **Notifications**\n\nClick **rsyslog**\n\n2.4. Check the **Event type** check box\n\n2.5. Make sure Rsyslog settings are:\n\n- Default format: CEF\n\n- Default delivery: Per event\n\n- Default send as: Alert"
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "FireEyeNXAma",
    "title": "[Deprecated] FireEye Network Security (NX) via AMA",
    "publisher": "FireEye",
    "descriptionMarkdown": "The [FireEye Network Security (NX)](https://www.fireeye.com/products/network-security.html) data connector provides the capability to ingest FireEye Network Security logs into Microsoft Sentinel.",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected [**FireEyeNXEvent**](https://aka.ms/sentinel-FireEyeNX-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "FireEyeNX",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'FireEye'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Sources",
        "query": "FireEyeNXEvent\n | where isnotempty(SrcIpAddr)\n    | summarize count() by SrcIpAddr\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (FireEyeNX)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'FireEye'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'FireEye'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**FireEyeNXEvent**](https://aka.ms/sentinel-FireEyeNX-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine",
                  "instructions": []
                },
                {
                  "title": "Step B. Configure FireEye NX to send logs using CEF",
                  "description": "Complete the following steps to send data using CEF:\n\n2.1. Log into the FireEye appliance with an administrator account\n\n2.2. Click **Settings**\n\n2.3. Click **Notifications**\n\nClick **rsyslog**\n\n2.4. Check the **Event type** check box\n\n2.5. Make sure Rsyslog settings are:\n\n- Default format: CEF\n\n- Default delivery: Per event\n\n- Default send as: Alert",
                  "instructions": []
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "Flare",
    "title": "Flare",
    "publisher": "Flare",
    "descriptionMarkdown": "[Flare](https://flare.systems/platform/) connector allows you to receive data and intelligence from Flare on Microsoft Sentinel.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Firework_CL",
        "baseQuery": "Firework_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Flare Activities -- All",
        "query": "Firework_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Firework_CL",
        "lastDataReceivedQuery": "Firework_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Firework_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Required Flare permissions",
          "description": "only Flare organization administrators may configure the Microsoft Sentinel integration."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Creating an Alert Channel for Microsoft Sentinel",
        "description": "",
        "innerSteps": [
          {
            "description": "As an organization administrator, authenticate on [Flare](https://app.flare.systems) and access the [team page](https://app.flare.systems#/team) to create a new alert channel."
          },
          {
            "description": "Click on 'Create a new alert channel' and select 'Microsoft Sentinel'. Enter your Shared Key And WorkspaceID. Save the Alert Channel. \n For more help and details, see our [Azure configuration documentation](https://docs.microsoft.com/azure/sentinel/connect-data-sources).",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId"
                  ],
                  "label": "Workspace ID",
                  "value": "{0}"
                },
                "type": "CopyableLabel"
              },
              {
                "parameters": {
                  "fillWith": [
                    "PrimaryKey"
                  ],
                  "label": "Primary key",
                  "value": "{0} "
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Associating your alert channel to an alert feed",
        "innerSteps": [
          {
            "description": "At this point, you may configure alerts to be sent to Microsoft Sentinel the same way that you would configure regular email alerts."
          },
          {
            "description": "For a more detailed guide, refer to the Flare documentation."
          }
        ]
      }
    ],
    "metadata": {
      "id": "c3f2c642-54a5-49b4-b135-e05506720765",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "Flare"
      },
      "author": {
        "name": "Flare"
      },
      "support": {
        "tier": "developer",
        "name": "Flare",
        "email": "contact@flare.systems",
        "link": "https://flare.systems/company/contact/"
      }
    }
  },
  {
    "id": "Forcepoint_DLP",
    "title": "Forcepoint DLP",
    "publisher": "Forcepoint",
    "descriptionMarkdown": "The Forcepoint DLP (Data Loss Prevention) connector allows you to automatically export DLP incident data from Forcepoint DLP into Microsoft Sentinel in real-time. This enriches visibility into user activities and data loss incidents, enables further correlation with data from Azure workloads and other feeds, and improves monitoring capability with Workbooks inside Microsoft Sentinel.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ForcepointDLPEvents_CL",
        "baseQuery": "ForcepointDLPEvents_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Rules triggered in the last three days",
        "query": "ForcepointDLPEvents_CL\n | where TimeGenerated > ago(3d)\n | summarize count() by RuleName_1_s, SourceIpV4_s\n | render barchart"
      },
      {
        "description": "Rules triggered over time (90 days)",
        "query": "ForcepointDLPEvents_CL\n | where TimeGenerated > ago(90d)\n | sort by CreatedAt_t asc nulls last\n | summarize count()  by  CreatedAt_t, RuleName_1_s\n | render linechart"
      },
      {
        "description": "Count of High, Medium and Low rules triggered over 90 days",
        "query": "ForcepointDLPEvents_CL\n | where TimeGenerated > ago(90d)\n | sort by CreatedAt_t asc nulls last\n | summarize count()  by  CreatedAt_t, Severity_s\n | render barchart"
      }
    ],
    "dataTypes": [
      {
        "name": "ForcepointDLPEvents_CL",
        "lastDataReceivedQuery": "ForcepointDLPEvents_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ForcepointDLPEvents_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "Follow step by step instructions in the [Forcepoint DLP documentation for Microsoft Sentinel](https://frcpnt.com/dlp-sentinel) to configure this connector.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ],
    "metadata": {
      "id": "c4961e1e-45b1-4565-a096-6e14561c90b6",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Forcepoint"
      },
      "support": {
        "name": "Forcepoint",
        "link": "https://support.forcepoint.com/",
        "tier": "developer"
      }
    }
  },
  {
    "id": "ForcepointCasb",
    "title": "[Deprecated] Forcepoint CASB via Legacy Agent",
    "publisher": "Forcepoint CASB",
    "descriptionMarkdown": "The Forcepoint CASB (Cloud Access Security Broker) Connector allows you to automatically export CASB logs and events into Microsoft Sentinel in real-time. This enriches visibility into user activities across locations and cloud applications, enables further correlation with data from Azure workloads and other feeds, and improves monitoring capability with Workbooks inside Microsoft Sentinel.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ForcepointCASB",
        "baseQuery": "\nCommonSecurityLog\n| where DeviceVendor == \"Forcepoint CASB\"\n"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 5 Users With The Highest Number Of Logs",
        "query": "CommonSecurityLog \n| summarize Count = count() by DestinationUserName\n| top 5 by DestinationUserName\n| render barchart"
      },
      {
        "description": "Top 5 Users by Number of Failed Attempts ",
        "query": "CommonSecurityLog \n| extend outcome = coalesce(column_ifexists(\"EventOutcome\", \"\"), tostring(split(split(AdditionalExtensions, \";\", 2)[0], \"=\", 1)[0]), \"\")\n| extend reason = coalesce(column_ifexists(\"Reason\", \"\"), tostring(split(split(AdditionalExtensions, \";\", 3)[0], \"=\", 1)[0]), \"\")\n| where outcome ==\"Failure\"\n| summarize Count= count() by DestinationUserName\n| render barchart"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (ForcepointCASB)",
        "lastDataReceivedQuery": "\nCommonSecurityLog\n| where DeviceVendor == \"Forcepoint CASB\"\n   | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "\nCommonSecurityLog\n| where DeviceVendor == \"Forcepoint CASB\"\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel. This machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Common Event Format (CEF) logs to Syslog agent",
        "description": "Set your security solution to send Syslog messages in CEF format to the proxy machine. Make sure you to send the logs to port 514 TCP on the machine's IP address."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version \n \n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      },
      {
        "title": "5. Forcepoint integration installation guide ",
        "description": "To complete the installation of this Forcepoint product integration, follow the guide linked below.\n\n[Installation Guide >](https://frcpnt.com/casb-sentinel)"
      }
    ],
    "metadata": {
      "id": "04f93db2-8f2a-4edc-bb78-9e1e7587faff",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Forcepoint"
      },
      "support": {
        "name": "Forcepoint",
        "link": "https://support.forcepoint.com",
        "tier": "developer"
      }
    }
  },
  {
    "id": "ForcepointCasbAma",
    "title": "[Deprecated] Forcepoint CASB via AMA",
    "publisher": "Forcepoint CASB",
    "descriptionMarkdown": "The Forcepoint CASB (Cloud Access Security Broker) Connector allows you to automatically export CASB logs and events into Microsoft Sentinel in real-time. This enriches visibility into user activities across locations and cloud applications, enables further correlation with data from Azure workloads and other feeds, and improves monitoring capability with Workbooks inside Microsoft Sentinel.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ForcepointCASB",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Forcepoint CASB'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 5 Users With The Highest Number Of Logs",
        "query": "CommonSecurityLog \n| summarize Count = count() by DestinationUserName\n| top 5 by DestinationUserName\n| render barchart"
      },
      {
        "description": "Top 5 Users by Number of Failed Attempts ",
        "query": "CommonSecurityLog \n| extend outcome = coalesce(column_ifexists(\"EventOutcome\", \"\"), tostring(split(split(AdditionalExtensions, \";\", 2)[0], \"=\", 1)[0]), \"\")\n| extend reason = coalesce(column_ifexists(\"Reason\", \"\"), tostring(split(split(AdditionalExtensions, \";\", 3)[0], \"=\", 1)[0]), \"\")\n| where outcome ==\"Failure\"\n| summarize Count= count() by DestinationUserName\n| render barchart"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (ForcepointCASB)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Forcepoint CASB'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'Forcepoint CASB'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine."
                },
                {
                  "title": "Step B. Forward Common Event Format (CEF) logs to Syslog agent",
                  "description": "Set your security solution to send Syslog messages in CEF format to the proxy machine. Make sure you to send the logs to port 514 TCP on the machine's IP address."
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      },
      {
        "title": "3. Forcepoint integration installation guide ",
        "description": "To complete the installation of this Forcepoint product integration, follow the guide linked below.\n\n[Installation Guide >](https://frcpnt.com/casb-sentinel)"
      }
    ],
    "metadata": {
      "id": "04f93db2-8f2a-4edc-bb78-9e1e7587faff",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Forcepoint"
      },
      "support": {
        "name": "Forcepoint",
        "link": "https://support.forcepoint.com",
        "tier": "developer"
      }
    }
  },
  {
    "id": "ForcepointCSG",
    "title": "[Deprecated] Forcepoint CSG via Legacy Agent",
    "publisher": "Forcepoint",
    "descriptionMarkdown": "Forcepoint Cloud Security Gateway is a converged cloud security service that provides visibility, control, and threat protection for users and data, wherever they are. For more information visit: https://www.forcepoint.com/product/cloud-security-gateway",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Forcepoint CSG",
        "baseQuery": "\nCommonSecurityLog\n| where DeviceVendor == \"Forcepoint CSG\"\n"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 5 Web requested Domains with log severity equal to 6 (Medium)",
        "query": "CommonSecurityLog\n| where TimeGenerated <= ago(0m)\n| where DeviceVendor == \"Forcepoint CSG\"\n| where DeviceProduct == \"Web\"\n| where LogSeverity == 6\n| where DeviceCustomString2 != \"\"\n| summarize Count=count() by DeviceCustomString2\n| top 5 by Count\n| render piechart"
      },
      {
        "description": "Top 5 Web Users with 'Action' equal to 'Blocked'",
        "query": "CommonSecurityLog\n| where TimeGenerated <= ago(0m)\n| where DeviceVendor == \"Forcepoint CSG\"\n| where DeviceProduct == \"Web\"\n| where Activity == \"Blocked\"\n| where SourceUserID != \"Not available\"\n| summarize Count=count() by SourceUserID\n| top 5 by Count\n| render piechart"
      },
      {
        "description": "Top 5 Sender Email Addresses Where Spam Score Greater Than 10.0",
        "query": "CommonSecurityLog\n| where TimeGenerated <= ago(0m)\n| where DeviceVendor == \"Forcepoint CSG\"\n| where DeviceProduct == \"Email\"\n| where DeviceCustomFloatingPoint1 > 10.0\n| summarize Count=count() by SourceUserName\n| top 5 by Count\n| render barchart"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (Forcepoint CSG)",
        "lastDataReceivedQuery": "\nCommonSecurityLog\n| where DeviceVendor == \"Forcepoint CSG\"\n| where  DeviceProduct == \"Web\"\n  | summarize Time = max(TimeGenerated)\n  | where isnotempty(Time)"
      },
      {
        "name": "CommonSecurityLog (Forcepoint CSG)",
        "lastDataReceivedQuery": "\nCommonSecurityLog\n| where DeviceVendor == \"Forcepoint CSG\"\n| where  DeviceProduct == \"Email\"\n  | summarize Time = max(TimeGenerated)\n  | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "\nCommonSecurityLog\n| where DeviceVendor == \"Forcepoint CSG\"\n| where  DeviceProduct == \"Web\"\n  | summarize LastLogReceived = max(TimeGenerated)\n  | project IsConnected = LastLogReceived > ago(30d)",
          "\nCommonSecurityLog\n| where DeviceVendor == \"Forcepoint CSG\"\n| where  DeviceProduct == \"Email\"\n  | summarize LastLogReceived = max(TimeGenerated)\n  | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "This integration requires the Linux Syslog agent to collect your Forcepoint Cloud Security Gateway Web/Email logs on port 514 TCP as Common Event Format (CEF) and forward them to Microsoft Sentinel.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId",
                "PrimaryKey"
              ],
              "label": "Your Data Connector Syslog Agent Installation Command is:",
              "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "2. Implementation options",
        "description": "The integration is made available with two implementations options.",
        "innerSteps": [
          {
            "title": "2.1  Docker Implementation",
            "description": "Leverages docker images where the integration component is already installed with all necessary dependencies.\n\nFollow the instructions provided in the Integration Guide linked below.\n\n[Integration Guide >](https://frcpnt.com/csg-sentinel)"
          },
          {
            "title": "2.2  Traditional Implementation",
            "description": "Requires the manual deployment of the integration component inside a clean Linux machine.\n\nFollow the instructions provided in the Integration Guide  linked below.\n\n[Integration Guide >](https://frcpnt.com/csg-sentinel)"
          }
        ]
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version \n \n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)."
      }
    ]
  },
  {
    "id": "ForcepointCSGAma",
    "title": "[Deprecated] Forcepoint CSG via AMA",
    "publisher": "Forcepoint",
    "descriptionMarkdown": "Forcepoint Cloud Security Gateway is a converged cloud security service that provides visibility, control, and threat protection for users and data, wherever they are. For more information visit: https://www.forcepoint.com/product/cloud-security-gateway",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Forcepoint CSG",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Forcepoint CSG'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 5 Web requested Domains with log severity equal to 6 (Medium)",
        "query": "CommonSecurityLog\n| where TimeGenerated <= ago(0m)\n| where DeviceVendor == \"Forcepoint CSG\"\n| where DeviceProduct == \"Web\"\n| where LogSeverity == 6\n| where DeviceCustomString2 != \"\"\n| summarize Count=count() by DeviceCustomString2\n| top 5 by Count\n| render piechart"
      },
      {
        "description": "Top 5 Web Users with 'Action' equal to 'Blocked'",
        "query": "CommonSecurityLog\n| where TimeGenerated <= ago(0m)\n| where DeviceVendor == \"Forcepoint CSG\"\n| where DeviceProduct == \"Web\"\n| where Activity == \"Blocked\"\n| where SourceUserID != \"Not available\"\n| summarize Count=count() by SourceUserID\n| top 5 by Count\n| render piechart"
      },
      {
        "description": "Top 5 Sender Email Addresses Where Spam Score Greater Than 10.0",
        "query": "CommonSecurityLog\n| where TimeGenerated <= ago(0m)\n| where DeviceVendor == \"Forcepoint CSG\"\n| where DeviceProduct == \"Email\"\n| where DeviceCustomFloatingPoint1 > 10.0\n| summarize Count=count() by SourceUserName\n| top 5 by Count\n| render barchart"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (Forcepoint CSG)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Forcepoint CSG'\n  |where DeviceProduct =~ 'Web'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CommonSecurityLog (Forcepoint CSG)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Forcepoint CSG'\n  |where DeviceProduct =~ 'Email'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'Forcepoint CSG'\n  |where DeviceProduct =~ 'Web'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)",
          "CommonSecurityLog\n |where DeviceVendor =~ 'Forcepoint CSG'\n  |where DeviceProduct =~ 'Email'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine."
                },
                {
                  "title": "Step B. Implementation options",
                  "description": "The integration is made available with two implementations options.",
                  "innerSteps": [
                    {
                      "title": "1.  Docker Implementation",
                      "description": "Leverages docker images where the integration component is already installed with all necessary dependencies.\n\nFollow the instructions provided in the Integration Guide linked below.\n\n[Integration Guide >](https://frcpnt.com/csg-sentinel)"
                    },
                    {
                      "title": "2.  Traditional Implementation",
                      "description": "Requires the manual deployment of the integration component inside a clean Linux machine.\n\nFollow the instructions provided in the Integration Guide  linked below.\n\n[Integration Guide >](https://frcpnt.com/csg-sentinel)"
                    }
                  ]
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)."
      }
    ]
  },
  {
    "id": "ForcepointNgfw",
    "title": "[Deprecated] Forcepoint NGFW via Legacy Agent",
    "publisher": "Forcepoint",
    "descriptionMarkdown": "The Forcepoint NGFW (Next Generation Firewall) connector allows you to automatically export user-defined Forcepoint NGFW logs into Microsoft Sentinel in real-time. This enriches visibility into user activities recorded by NGFW, enables further correlation with data from Azure workloads and other feeds, and improves monitoring capability with Workbooks inside Microsoft Sentinel.",
    "graphQueries": [
      {
        "metricName": "Forcepoint NGFW log results",
        "legend": "CommonSecurityLog",
        "baseQuery": "\nCommonSecurityLog\n| where DeviceVendor == \"Forcepoint\"\n| where DeviceProduct == \"NGFW\"\n"
      }
    ],
    "sampleQueries": [
      {
        "description": "Show all terminated actions from the Forcepoint NGFW",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"Forcepoint\"\n| where DeviceProduct == \"NGFW\"\n| where DeviceAction == \"Terminate\"\n"
      },
      {
        "description": "Show all Forcepoint NGFW with suspected compromise behaviour",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"Forcepoint\"\n| where DeviceProduct == \"NGFW\"\n| where Activity contains \"compromise\"\n"
      },
      {
        "description": "Show chart grouping all Forcepoint NGFW events by Activity type",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"Forcepoint\"\n| where DeviceProduct == \"NGFW\"\n| summarize count=count() by Activity\n | render barchart\n"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (ForcePointNGFW)",
        "lastDataReceivedQuery": "\nCommonSecurityLog\n| where DeviceVendor == \"Forcepoint\"\n| where DeviceProduct == \"NGFW\"\n\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "\nCommonSecurityLog\n| where DeviceVendor == \"Forcepoint\"\n| where DeviceProduct == \"NGFW\"\n\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Common Event Format (CEF) logs to Syslog agent",
        "description": "Set your security solution to send Syslog messages in CEF format to the proxy machine. Make sure you to send the logs to port 514 TCP on the machine's IP address."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python - version \n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      },
      {
        "title": "5. Forcepoint integration installation guide ",
        "description": "To complete the installation of this Forcepoint product integration, follow the guide linked below.\n\n[Installation Guide >](https://frcpnt.com/ngfw-sentinel)"
      }
    ],
    "metadata": {
      "id": "e002d400-e0b0-4673-959a-eec31378d17c",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Forcepoint"
      },
      "support": {
        "name": "Forcepoint",
        "link": "https://support.forcepoint.com/",
        "tier": "developer"
      }
    }
  },
  {
    "id": "ForcepointNgfwAma",
    "title": "[Deprecated] Forcepoint NGFW via AMA",
    "publisher": "Forcepoint",
    "descriptionMarkdown": "The Forcepoint NGFW (Next Generation Firewall) connector allows you to automatically export user-defined Forcepoint NGFW logs into Microsoft Sentinel in real-time. This enriches visibility into user activities recorded by NGFW, enables further correlation with data from Azure workloads and other feeds, and improves monitoring capability with Workbooks inside Microsoft Sentinel.",
    "graphQueries": [
      {
        "metricName": "Forcepoint NGFW log results",
        "legend": "CommonSecurityLog",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Forcepoint'\n |where DeviceProduct =~ 'NGFW'\n |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "Show all terminated actions from the Forcepoint NGFW",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"Forcepoint\"\n| where DeviceProduct == \"NGFW\"\n| where DeviceAction == \"Terminate\"\n"
      },
      {
        "description": "Show all Forcepoint NGFW with suspected compromise behaviour",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"Forcepoint\"\n| where DeviceProduct == \"NGFW\"\n| where Activity contains \"compromise\"\n"
      },
      {
        "description": "Show chart grouping all Forcepoint NGFW events by Activity type",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"Forcepoint\"\n| where DeviceProduct == \"NGFW\"\n| summarize count=count() by Activity\n | render barchart\n"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (ForcePointNGFW)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Forcepoint'\n |where DeviceProduct =~ 'NGFW'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'Forcepoint'\n |where DeviceProduct =~ 'NGFW'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine."
                },
                {
                  "title": "Step B. Forward Common Event Format (CEF) logs to Syslog agent",
                  "description": "Set your security solution to send Syslog messages in CEF format to the proxy machine. Make sure you to send the logs to port 514 TCP on the machine's IP address."
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ],
        "customs": [
          {
            "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
          },
          {
            "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      },
      {
        "title": "3. Forcepoint integration installation guide ",
        "description": "To complete the installation of this Forcepoint product integration, follow the guide linked below.\n\n[Installation Guide >](https://frcpnt.com/ngfw-sentinel)"
      }
    ],
    "metadata": {
      "id": "e002d400-e0b0-4673-959a-eec31378d17c",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Forcepoint"
      },
      "support": {
        "name": "Forcepoint",
        "link": "https://support.forcepoint.com/",
        "tier": "developer"
      }
    }
  },
  {
    "id": "Forescout",
    "title": "Forescout",
    "publisher": "Forescout",
    "descriptionMarkdown": "The [Forescout](https://www.forescout.com/) data connector provides the capability to ingest [Forescout events](https://docs.forescout.com/bundle/syslog-3-6-1-h/page/syslog-3-6-1-h.How-to-Work-with-the-Syslog-Plugin.html) into Microsoft Sentinel. Refer to [Forescout documentation](https://docs.forescout.com/bundle/syslog-msg-3-6-tn/page/syslog-msg-3-6-tn.About-Syslog-Messages-in-Forescout.html) for more information.",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected [**ForescoutEvent**](https://aka.ms/sentinel-forescout-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Forescout",
        "baseQuery": "ForescoutEvent"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Sources",
        "query": "ForescoutEvent\n | summarize count() by tostring(SrcIpAddr)\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog(ForescoutEvent)",
        "lastDataReceivedQuery": "ForescoutEvent\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ForescoutEvent\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**ForescoutEvent**](https://aka.ms/sentinel-forescout-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "",
        "description": ">**NOTE:** This data connector has been developed using Forescout Syslog Plugin version: v3.6",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux or Windows",
        "description": "Install the agent on the Server where the Forescout logs are forwarded.\n\n> Logs from Forescout Server deployed on Linux or Windows servers are collected by **Linux** or **Windows** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Linux agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Windows agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Windows Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Windows Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Configure the facilities you want to collect and their severities.\n 1. Under workspace advanced settings **Configuration**, select **Data** and then **Syslog**.\n 2. Select **Apply below configuration to my machines** and select the facilities and severities.\n 3.  Click **Save**.",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenSyslogSettings"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "3. Configure Forescout event forwarding",
        "description": "Follow the configuration steps below to get Forescout logs into Microsoft Sentinel.\n1. [Select an Appliance to Configure.](https://docs.forescout.com/bundle/syslog-3-6-1-h/page/syslog-3-6-1-h.Select-an-Appliance-to-Configure.html)\n2. [Follow these instructions](https://docs.forescout.com/bundle/syslog-3-6-1-h/page/syslog-3-6-1-h.Send-Events-To-Tab.html#pID0E0CE0HA) to forward alerts from the Forescout platform to a syslog server.\n3. [Configure](https://docs.forescout.com/bundle/syslog-3-6-1-h/page/syslog-3-6-1-h.Syslog-Triggers.html) the settings in the Syslog Triggers tab."
      }
    ]
  },
  {
    "id": "Forescout_eyeInspect_for_OT_Security",
    "title": "Forescout eyeInspect for OT Security",
    "publisher": "Forescout",
    "descriptionMarkdown": "Forescout eyeInspect for OT Security connector allows you to connect Asset/Alert information from Forescout eyeInspect OT platform with Microsoft Sentinel, to view and analyze data using Log Analytics Tables and Workbooks. This gives you more insight into OT organization network and improves security operation capabilities.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ForescoutOtAsset_CL",
        "baseQuery": "ForescoutOtAsset_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get 5 latest OT Assets",
        "query": "ForescoutOtAsset_CL\n | sort by TimeGenerated | take 5"
      },
      {
        "description": "Get 5 latest OT Alerts",
        "query": "ForescoutOtAlert_CL\n | sort by TimeGenerated | take 5"
      }
    ],
    "dataTypes": [
      {
        "name": "ForescoutOtAsset_CL",
        "lastDataReceivedQuery": "ForescoutOtAsset_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ForescoutOtAlert_CL",
        "lastDataReceivedQuery": "ForescoutOtAlert_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ForescoutOtAsset_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "ForescoutOtAlert_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Forescout eyeInspect OT Microsoft Sentinel Integration",
        "description": "Instructions on how to configure Forescout eyeInspect Microsoft Sentinel Integration are provided at Forescout eyeInspect Documentation Portal",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ]
  },
  {
    "id": "ForescoutHostPropertyMonitor",
    "title": "Forescout Host Property Monitor",
    "publisher": "Forescout",
    "descriptionMarkdown": "The Forescout Host Property Monitor connector allows you to connect host/policy/compliance properties from Forescout platform with Microsoft Sentinel, to view, create custom incidents, and improve investigation. This gives you more insight into your organization network and improves your security operation capabilities.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ForescoutHostProperties_CL",
        "baseQuery": "ForescoutHostProperties_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get 5 latest host property entries",
        "query": "ForescoutHostProperties_CL | take 5"
      },
      {
        "description": "Get 5 latest host policy entries",
        "query": "ForescoutPolicyStatus_CL | take 5"
      },
      {
        "description": "Get 5 latest host compliance entries",
        "query": "ForescoutComplianceStatus_CL | take 5"
      }
    ],
    "dataTypes": [
      {
        "name": "ForescoutHostProperties_CL",
        "lastDataReceivedQuery": "ForescoutHostProperties_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ForescoutPolicyStatus_CL",
        "lastDataReceivedQuery": "ForescoutPolicyStatus_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ForescoutComplianceStatus_CL",
        "lastDataReceivedQuery": "ForescoutComplianceStatus_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ForescoutHostProperties_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "ForescoutPolicyStatus_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "ForescoutComplianceStatus_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Forescout Plugin requirement",
          "description": "Please make sure Forescout Microsoft Sentinel plugin is running on Forescout platform"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "Instructions on how to configure Forescout Microsoft Sentinel plugin are provided at Forescout Documentation Portal (https://docs.forescout.com/bundle/microsoft-sentinel-module-v2-0-0-h)",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ],
    "metadata": {
      "id": "1430b3a9-a48c-40d5-bb81-029f6c63c2ad",
      "version": "3.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Forescout Technologies"
      },
      "support": {
        "tier": "developer",
        "name": "Forescout Technologies",
        "link": "https://www.forescout.com/support"
      }
    }
  },
  {
    "id": "ForgeRock",
    "title": "[Deprecated] ForgeRock Identity Platform",
    "publisher": "ForgeRock Inc",
    "descriptionMarkdown": "The ForgeRock Identity Platform provides a single common auditing framework. Extract and aggregate log data across the entire platform with common audit (CAUD) event handlers and unique IDs so that it can be tracked holistically. Open and extensible, you can leverage audit logging and reporting capabilities for integration with Microsoft Sentinel via this CAUD for CEF connector.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ForgeRock",
        "baseQuery": "CommonSecurityLog\n| where DeviceVendor == \"ForgeRock Inc\""
      }
    ],
    "sampleQueries": [
      {
        "description": "Total failed login attempts to the ForgeRock Platform",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"ForgeRock Inc\"\n| where DeviceProduct in (\"IDM\") // can be ANY ForgeRock product (AM, IG, Etc)\n| where DeviceAction =~ \"FAILED\"\n| extend user = split(split(AdditionalExtensions, \";\", 3)[0], \"=\", 1)[0] // extract userID from 3rd field in json payload\n| where strlen(user) > 2 // if this field is null, it is not a user logon attempt"
      },
      {
        "description": "Autocluster failed logins by IP addresses ",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"ForgeRock Inc\"\n| where DeviceProduct in (\"IDM\") // can be ANY ForgeRock product (AM, IG, Etc)\n| where DeviceAction =~ \"FAILED\"\n| project SourceIP \n| evaluate autocluster(0.6)"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (ForgeRock)",
        "lastDataReceivedQuery": "CommonSecurityLog\n| where DeviceVendor == \"ForgeRock Inc\"\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n| where DeviceVendor == \"ForgeRock Inc\"\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Configuration for the ForgeRock Common Audit (CAUD) for Microsoft Sentinel",
        "description": "In ForgeRock, install and configure this Common Audit (CAUD) for Microsoft Sentinel per the documentation at https://github.com/javaservlets/SentinelAuditEventHandler. Next, in Azure, follow the below CEF steps."
      },
      {
        "title": "\n\n\n1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Common Event Format (CEF) logs to Syslog agent",
        "description": "Set your security solution to send Syslog messages in CEF format to the proxy machine. Make sure you to send the logs to port 514 TCP on the machine's IP address."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "cb5b9a69-5ab1-445c-8491-6b96a2ea3100",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "ForgeRock"
      },
      "support": {
        "name": "ForgeRock",
        "link": "https://www.forgerock.com/support",
        "tier": "developer"
      }
    }
  },
  {
    "id": "Fortinet",
    "title": "[Deprecated] Fortinet via Legacy Agent",
    "publisher": "Fortinet",
    "logo": "FortinetLogo.svg",
    "descriptionMarkdown": "The Fortinet firewall connector allows you to easily connect your Fortinet logs with Microsoft Sentinel, to view dashboards, create custom alerts, and improve investigation. This gives you more insight into your organization's network and improves your security operation capabilities.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Fortinet",
        "baseQuery": "\nCommonSecurityLog\n| where DeviceVendor == \"Fortinet\"\n| where DeviceProduct startswith \"Fortigate\"\n"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"Fortinet\"\n| where DeviceProduct startswith \"Fortigate\"\n\n            | sort by TimeGenerated"
      },
      {
        "description": "Summarize by destination IP and port",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"Fortinet\"\n| where DeviceProduct startswith \"Fortigate\"\n\n            | summarize count() by DestinationIP, DestinationPort, TimeGenerated\n            | sort by TimeGenerated"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "\nCommonSecurityLog\n| where DeviceVendor == \"Fortinet\"\n| where DeviceProduct startswith \"Fortigate\"\n\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (Fortinet)",
        "lastDataReceivedQuery": "\nCommonSecurityLog\n| where DeviceVendor == \"Fortinet\"\n| where DeviceProduct startswith \"Fortigate\"\n\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 2,
      "isPreview": true,
      "featureFlag": {
        "feature": "FortinetConnector",
        "featureStates": {
          "1": 2,
          "2": 2,
          "3": 2,
          "4": 2,
          "5": 2,
          "6": 1,
          "7": 1
        }
      }
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python --version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py &&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Fortinet logs to Syslog agent",
        "description": "Set your Fortinet to send Syslog messages in CEF format to the proxy machine. Make sure you to send the logs to port 514 TCP on the machines IP address.\n\n\nCopy the CLI commands below and:\n-   Replace \"server &lt;ip address&gt;\" with the Syslog agent's IP address.\n-   Set the \"&lt;facility_name&gt;\" to use the facility you configured in the Syslog agent (by default, the agent sets this to local4).\n-   Set the Syslog port to 514, the port your agent uses.\n-   To enable CEF format in early FortiOS versions, you may need to run the command \"set csv disable\".\n\nFor more information, go to the  [Fortinet Document Library](https://aka.ms/asi-syslog-fortinet-fortinetdocumentlibrary), choose your version, and use the \"Handbook\" and \"Log Message Reference\" PDFs.\n\n[Learn more >](https://aka.ms/CEF-Fortinet)",
        "instructions": [
          {
            "parameters": {
              "label": "Set up the connection using the CLI to run the following commands:",
              "value": "config log syslogd setting\n    set status enable\nset format cef\nset port 514\nset server <ip_address_of_Receiver>\nend",
              "rows": 8
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python --version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py &&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "19ecaeff-8959-4cb8-a11e-a150ecd5a494",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Fortinet"
      },
      "support": {
        "name": "Fortinet",
        "link": "https://www.fortinet.com/support/contact",
        "tier": "developer"
      }
    }
  },
  {
    "id": "FortinetAma",
    "title": "[Deprecated] Fortinet via AMA",
    "publisher": "Fortinet",
    "logo": "FortinetLogo.svg",
    "descriptionMarkdown": "The Fortinet firewall connector allows you to easily connect your Fortinet logs with Microsoft Sentinel, to view dashboards, create custom alerts, and improve investigation. This gives you more insight into your organization's network and improves your security operation capabilities.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Fortinet",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Fortinet'\n |where DeviceProduct =~ 'Fortigate'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"Fortinet\"\n| where DeviceProduct startswith \"Fortigate\"\n\n            | sort by TimeGenerated"
      },
      {
        "description": "Summarize by destination IP and port",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"Fortinet\"\n| where DeviceProduct startswith \"Fortigate\"\n\n            | summarize count() by DestinationIP, DestinationPort, TimeGenerated\n            | sort by TimeGenerated"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'Fortinet'\n |where DeviceProduct =~ 'Fortigate'\n   |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (Fortinet)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Fortinet'\n |where DeviceProduct =~ 'Fortigate'\n |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true,
      "featureFlag": {
        "feature": "FortinetConnector",
        "featureStates": {
          "1": 2,
          "2": 2,
          "3": 2,
          "4": 2,
          "5": 2,
          "6": 1,
          "7": 1
        }
      }
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine"
                },
                {
                  "title": "Step B. Forward Fortinet logs to Syslog agent",
                  "description": "Set your Fortinet to send Syslog messages in CEF format to the proxy machine. Make sure you to send the logs to port 514 TCP on the machines IP address.\n\n\nCopy the CLI commands below and:\n-   Replace \"server &lt;ip address&gt;\" with the Syslog agent's IP address.\n-   Set the \"&lt;facility_name&gt;\" to use the facility you configured in the Syslog agent (by default, the agent sets this to local4).\n-   Set the Syslog port to 514, the port your agent uses.\n-   To enable CEF format in early FortiOS versions, you may need to run the command \"set csv disable\".\n\nFor more information, go to the  [Fortinet Document Library](https://aka.ms/asi-syslog-fortinet-fortinetdocumentlibrary), choose your version, and use the \"Handbook\" and \"Log Message Reference\" PDFs.\n\n[Learn more >](https://aka.ms/CEF-Fortinet)",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Set up the connection using the CLI to run the following commands:",
                        "value": "config log syslogd setting\n    set status enable\nset format cef\nset port 514\nset server <ip_address_of_Receiver>\nend",
                        "rows": 8
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "19ecaeff-8959-4cb8-a11e-a150ecd5a494",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Fortinet"
      },
      "support": {
        "name": "Fortinet",
        "link": "https://www.fortinet.com/support/contact",
        "tier": "developer"
      }
    }
  },
  {
    "id": "FortinetFortiNdrCloudDataConnector",
    "title": "Fortinet FortiNDR Cloud",
    "publisher": "Fortinet",
    "descriptionMarkdown": "The Fortinet FortiNDR Cloud data connector provides the capability to ingest [Fortinet FortiNDR Cloud](https://docs.fortinet.com/product/fortindr-cloud) data into Microsoft Sentinel using the FortiNDR Cloud API",
    "additionalRequirementBanner": "These queries and workbooks are dependent on a parser based on Kusto to work as expected. Follow the steps to use this Kusto functions alias **Fortinet_FortiNDR_Cloud** in queries and workbooks. [Follow steps to get this Kusto functions>](https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Fortinet%20FortiNDR%20Cloud/Parsers/Fortinet_FortiNDR_Cloud.md) ",
    "graphQueries": [
      {
        "metricName": "Fortinet FortiNDR Cloud Suricata Logs",
        "legend": "FncEventsSuricata_CL",
        "baseQuery": "FncEventsSuricata_CL"
      },
      {
        "metricName": "Fortinet FortiNDR Cloud Observation Logs",
        "legend": "FncEventsObservation_CL",
        "baseQuery": "FncEventsObservation_CL"
      },
      {
        "metricName": "Fortinet FortiNDR Cloud Detections Logs",
        "legend": "FncEventsDetections_CL",
        "baseQuery": "FncEventsDetections_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Fortinet FortiNDR Cloud Suricata Logs",
        "query": "FncEventsSuricata_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Fortinet FortiNDR Cloud Observation Logs",
        "query": "FncEventsObservation_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Fortinet FortiNDR Cloud Detections Logs",
        "query": "FncEventsDetections_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "FncEventsSuricata_CL",
        "lastDataReceivedQuery": "FncEventsSuricata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "FncEventsObservation_CL",
        "lastDataReceivedQuery": "FncEventsObservation_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "FncEventsDetections_CL",
        "lastDataReceivedQuery": "FncEventsDetections_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "FncEventsSuricata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)",
          "FncEventsObservation_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)",
          "FncEventsDetections_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "MetaStream Credentials",
          "description": "**AWS Access Key Id**, **AWS Secret Access Key**, **FortiNDR Cloud Account Code** are required to retrieve event data."
        },
        {
          "name": "API Credentials",
          "description": "**FortiNDR Cloud API Token**, **FortiNDR Cloud Account UUID** are required to retrieve detection data."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the FortiNDR Cloud API to pull logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": ">**NOTE:** This connector uses a parser based on a Kusto Function to normalize fields. [Follow these steps](https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Fortinet%20FortiNDR%20Cloud/Parsers/Fortinet_FortiNDR_Cloud.md) to create the Kusto function alias **Fortinet_FortiNDR_Cloud**."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the Fortinet FortiNDR Cloud Logs Collection**\n\nThe provider should provide or link to detailed steps to configure the 'PROVIDER NAME APPLICATION NAME' API endpoint so that the Azure Function can authenticate to it successfully, get its authorization key or token, and pull the appliance's logs into Microsoft Sentinel."
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Fortinet FortiNDR Cloud connector, have the Workspace ID  and Workspace Primary Key (can be copied from the following), as well as the as well as the FortiNDR Cloud API credentials (available in FortiNDR Cloud account management), readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "",
        "description": "**Azure Resource Manager (ARM) Template**\n\nUse this method for automated deployment of the Fortinet FortiNDR Cloud connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-FortinetFortiNDR-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**(Make sure using the same location as your Resource Group, and got the location supports Flex Consumption. \n3. Enter the **Workspace ID**, **Workspace Key**, **AwsAccessKeyId**, **AwsSecretAccessKey**, and/or Other required fields. \n4. Click **Create** to deploy."
      }
    ]
  },
  {
    "id": "FortinetFortiWeb",
    "title": "[Deprecated] Fortinet FortiWeb Web Application Firewall via Legacy Agent",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The [fortiweb](https://www.fortinet.com/products/web-application-firewall/fortiweb) data connector provides the capability to ingest Threat Analytics and events into Microsoft Sentinel.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "FortiWeb",
        "baseQuery": "Fortiweb"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Threats",
        "query": "Fortiweb\n | where isnotempty(EventType)\n    | summarize count() by EventType\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (Fortiweb)",
        "lastDataReceivedQuery": "CommonSecurityLog\n| where DeviceVendor == \"Fortinet\"\n| where DeviceProduct == \"Fortiweb\"\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n| where DeviceVendor == \"Fortinet\"\n| where DeviceProduct == \"Fortiweb\"\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Common Event Format (CEF) logs to Syslog agent",
        "description": "Set your security solution to send Syslog messages in CEF format to the proxy machine. Make sure you to send the logs to port 514 TCP on the machine's IP address."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "6rcd2f13-ret9-46a7-8c6e-aa5d86b8f1g9",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution"
      },
      "author": {
        "name": "Microsoft"
      },
      "support": {
        "tier": "developer",
        "name": "Microsoft"
      }
    }
  },
  {
    "id": "FortinetFortiWebAma",
    "title": "Fortinet FortiWeb Web Application Firewall via AMA",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The [fortiweb](https://www.fortinet.com/products/web-application-firewall/fortiweb) data connector provides the capability to ingest Threat Analytics and events into Microsoft Sentinel.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "FortiWeb",
        "baseQuery": "CommonSecurityLog\n |where (DeviceVendor contains 'Fortinet' and DeviceProduct contains 'Fortiweb') or Computer contains 'Fortiweb' \n |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Threats",
        "query": "Fortiweb\n | where isnotempty(EventType)\n    | summarize count() by EventType\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (Fortiweb)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where (DeviceVendor contains 'Fortinet' and DeviceProduct contains 'Fortiweb') or Computer contains 'Fortiweb' \n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where (DeviceVendor contains 'Fortinet' and DeviceProduct contains 'Fortiweb') or Computer contains 'Fortiweb'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine"
                },
                {
                  "title": "Step B. Forward Common Event Format (CEF) logs to Syslog agent",
                  "description": "Set your security solution to send Syslog messages in CEF format to the proxy machine. Make sure you to send the logs to port 514 TCP on the machine's IP address."
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "6rcd2f13-ret9-46a7-8c6e-aa5d86b8f1g9",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution"
      },
      "author": {
        "name": "Microsoft"
      },
      "support": {
        "tier": "developer",
        "name": "Microsoft"
      }
    }
  },
  {
    "id": "GarrisonULTRARemoteLogs",
    "title": "Garrison ULTRA Remote Logs",
    "publisher": "Garrison",
    "descriptionMarkdown": "The [Garrison ULTRA](https://www.garrison.com/en/garrison-ultra-cloud-platform) Remote Logs connector allows you to ingest Garrison ULTRA Remote Logs into Microsoft Sentinel.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Garrison_ULTRARemoteLogs_CL",
        "baseQuery": "Garrison_ULTRARemoteLogs_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Last 10 logs",
        "query": "Garrison_ULTRARemoteLogs_CL\n | top 10 by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Garrison_ULTRARemoteLogs_CL",
        "lastDataReceivedQuery": "Garrison_ULTRARemoteLogs_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Garrison_ULTRARemoteLogs_CL \n    |take 1\n   | project IsConnected = true  "
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Garrison ULTRA",
          "description": "To use this data connector you must have an active [Garrison ULTRA](https://www.garrison.com/en/garrison-ultra-cloud-platform) license."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Deployment - Azure Resource Manager (ARM) Template",
        "description": "These steps outline the automated deployment of the Garrison ULTRA Remote Logs data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2FAzure-Sentinel%2Frefs%2Fheads%2Fmaster%2FSolutions%2FGarrison%2520ULTRA%2FData%2520Connectors%2FGarrisonULTRARemoteLogs%2Fazuredeploy_DataCollectionResources.json) \t\t\t\n2. Provide the required details such as Resource Group, Microsoft Sentinel Workspace and ingestion configurations \n> **NOTE:** It is recommended to create a new Resource Group for deployment of these resources.\n3. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n4. Click **Purchase** to deploy."
      }
    ],
    "metadata": {
      "id": "919e2355-136a-4bbd-ade7-1956e5f61f83",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "Garrison ULTRA Remote Logs"
      },
      "author": {
        "name": "Garrison"
      },
      "support": {
        "tier": "developer",
        "name": "Garrison"
      }
    }
  },
  {
    "id": "GCPAuditLogsDefinition",
    "title": "GCP Pub/Sub Audit Logs",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The Google Cloud Platform (GCP) audit logs, ingested from Microsoft Sentinel's connector, enables you to capture three types of audit logs: admin activity logs, data access logs, and access transparency logs. Google cloud audit logs record a trail that practitioners can use to monitor access and detect potential threats across Google Cloud Platform (GCP) resources.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "GCP Audit Logs",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of GCP Audit Logs",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "GCPCDNLogsCCPDefinition",
    "title": "Google Cloud Platform CDN (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The Google Cloud Platform CDN data connector provides the capability to ingest Cloud CDN Audit logs and Cloud CDN Traffic logs into Microsoft Sentinel using the Compute Engine API. Refer the [Product overview](https://cloud.google.com/cdn/docs/overview) document for more details.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "GCP CDN Logs",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of GCP CDN logs",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "GCPCLOUDIDSLogsCCPDefinition",
    "title": "Google Cloud Platform Cloud IDS (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The Google Cloud Platform IDS data connector provides the capability to ingest Cloud IDS Traffic logs, Threat logs and Audit logs into Microsoft Sentinel using the Google Cloud IDS API. Refer to [Cloud IDS API](https://cloud.google.com/intrusion-detection-system/docs/audit-logging#google.cloud.ids.v1.IDS) documentation for more information.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "GCP CLOUDIDS Logs",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of GCPCLOUDIDS logs",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "GCPCloudRunLogs_ConnectorDefinition",
    "title": "GCP Cloud Run (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The GCP Cloud Run data connector provides the capability to ingest Cloud Run request logs into Microsoft Sentinel using Pub/Sub. Refer the [Cloud Run Overview](https://cloud.google.com/run/docs/logging) for more details.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "GCP Cloud Run Request Logs",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get sample of GCP Cloud Run request logs",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "GCPCloudSQLCCFDefinition",
    "title": "GCP Cloud SQL (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The GCP Cloud SQL data connector provides the capability to ingest Audit logs into Microsoft Sentinel using the GCP Cloud SQL API. Refer to [GCP cloud SQL Audit Logs](https://cloud.google.com/sql/docs/mysql/audit-logging) documentation for more information.",
    "graphQueries": [
      {
        "metricName": "Total incident logs received",
        "legend": "GCP CloudSQL logs",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get sample of GCP CloudSQL logs",
        "query": "{{graphQueriesTableName}}\n| take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | summarize Time = max(TimeGenerated)\n  | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "GCPComputeEngineLogsCCPDefinition",
    "title": "Google Cloud Platform Compute Engine (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The Google Cloud Platform Compute Engine data connector provides the capability to ingest Compute Engine Audit logs into Microsoft Sentinel using the Google Cloud Compute Engine API. Refer to [Cloud Compute Engine API](https://cloud.google.com/compute/docs/reference/rest/v1) documentation for more information.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "GCP Compute Engine Logs",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of GCP Compute Engine logs",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "GCPDNSDataConnector",
    "title": "[DEPRECATED] Google Cloud Platform DNS",
    "publisher": "Google",
    "descriptionMarkdown": "The Google Cloud Platform DNS data connector provides the capability to ingest [Cloud DNS query logs](https://cloud.google.com/dns/docs/monitoring#using_logging) and [Cloud DNS audit logs](https://cloud.google.com/dns/docs/audit-logging) into Microsoft Sentinel using the GCP Logging API. Refer to [GCP Logging API documentation](https://cloud.google.com/logging/docs/api) for more information.\n\n<p><span style='color:red; font-weight:bold;'>NOTE</span>: This data connector has been deprecated, consider moving to the CCF data connector available in the solution which replaces ingestion via the <a href='https://learn.microsoft.com/en-us/azure/azure-monitor/logs/custom-logs-migrate' style='color:#1890F1;'>deprecated HTTP Data Collector API</a>.</p>",
    "additionalRequirementBanner": ">This data connector depends on a parser based on a Kusto Function to work as expected [**GCPCloudDNS**](https://aka.ms/sentinel-GCPDNSDataConnector-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "GCP DNS logs",
        "legend": "GCP_DNS_CL",
        "baseQuery": "GCP_DNS_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All GCP DNS logs",
        "query": "GCP_DNS_CL\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "GCP_DNS_CL",
        "lastDataReceivedQuery": "GCP_DNS_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "GCP_DNS_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "GCP service account",
          "description": "GCP service account with permissions to read logs (with \"logging.logEntries.list\" permission) is required for GCP Logging API. Also json file with service account key is required. See the documentation to learn more about [permissions](https://cloud.google.com/logging/docs/access-control#permissions_and_roles), [creating service account](https://cloud.google.com/iam/docs/creating-managing-service-accounts) and [creating service account key](https://cloud.google.com/iam/docs/creating-managing-service-account-keys)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the GCP API to pull logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**GCPCloudDNS**](https://aka.ms/sentinel-GCPDNSDataConnector-parser) which is deployed with the Microsoft Sentinel Solution."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuring GCP and obtaining credentials**\n\n1. Make sure that Logging API is [enabled](https://cloud.google.com/apis/docs/getting-started#enabling_apis). \n\n2. [Create service account](https://cloud.google.com/iam/docs/creating-managing-service-accounts) with Logs Viewer role (or at least with \"logging.logEntries.list\" permission) and [get service account key json file](https://cloud.google.com/iam/docs/creating-managing-service-account-keys).\n\n3. Prepare the list of GCP resources (organizations, folders, projects) to get logs from. [Learn more about GCP resources](https://cloud.google.com/resource-manager/docs/cloud-platform-resource-hierarchy)."
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following), as well as Azure Blob Storage connection string and container name, readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the data connector using an ARM Template.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-GCPDNSDataConnector-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Google Cloud Platform Resource Names**, **Google Cloud Platform Credentials File Content**, **Microsoft Sentinel Workspace Id**, **Microsoft Sentinel Shared Key**\n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**.\n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/create-first-function-vs-code-python) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-GCPDNSDataConnector-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions.\n\n\te. **Select a runtime:** Choose Python 3.11.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tRESOURCE_NAMES\n\t\tCREDENTIALS_FILE_CONTENT\n\t\tWORKSPACE_ID\n\t\tSHARED_KEY\n\t\tlogAnalyticsUri (Optional)\n - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://WORKSPACE_ID.ods.opinsights.azure.us`. \n4. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "GCPDNSLogsCCPDefinition",
    "title": "Google Cloud Platform DNS (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The Google Cloud Platform DNS data connector provides the capability to ingest Cloud DNS Query logs and Cloud DNS Audit logs into Microsoft Sentinel using the Google Cloud DNS API. Refer to [Cloud DNS API](https://cloud.google.com/dns/docs/reference/rest/v1) documentation for more information.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "GCP DNS Logs",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of GCPDNS logs",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "GCPFirewallLogsCCPDefinition",
    "title": "GCP Pub/Sub Firewall Logs",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The Google Cloud Platform (GCP) firewall logs, enable you to capture network inbound and outbound activity to monitor access and detect potential threats across Google Cloud Platform (GCP) resources.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "GCP Pub/Sub Firewall Logs",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of GCP Firewall Logs",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "GCPFLoadBalancerLogsCCPDefinition",
    "title": "GCP Pub/Sub Load Balancer Logs (via Codeless Connector Platform).",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Google Cloud Platform (GCP) Load Balancer logs provide detailed insights into network traffic, capturing both inbound and outbound activities. These logs are used for monitoring access patterns and identifying potential security threats across GCP resources. Additionally, these logs also include GCP Web Application Firewall (WAF) logs, enhancing the ability to detect and mitigate risks effectively.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "GCP Pub/Sub Load Balancer Logs",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of GCP Load Balancer Logs",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "GCPIAMCCPDefinition",
    "title": "Google Cloud Platform IAM (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The Google Cloud Platform IAM data connector provides the capability to ingest the Audit logs relating to Identity and Access Management (IAM) activities within Google Cloud into Microsoft Sentinel using the Google IAM API. Refer to [GCP IAM API](https://cloud.google.com/iam/docs/reference/rest) documentation for more information.",
    "graphQueries": [
      {
        "metricName": "Total incident logs received",
        "legend": "GCP IAM logs",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get sample of GcpIAM logs",
        "query": "{{graphQueriesTableName}}\n| take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | summarize Time = max(TimeGenerated)\n  | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "GCPIAMDataConnector",
    "title": "[DEPRECATED] Google Cloud Platform IAM",
    "publisher": "Google",
    "descriptionMarkdown": "The Google Cloud Platform Identity and Access Management (IAM) data connector provides the capability to ingest [GCP IAM logs](https://cloud.google.com/iam/docs/audit-logging) into Microsoft Sentinel using the GCP Logging API. Refer to [GCP Logging API documentation](https://cloud.google.com/logging/docs/api) for more information.\n\n<p><span style='color:red; font-weight:bold;'>NOTE</span>: This data connector has been deprecated, consider moving to the CCF data connector available in the solution which replaces ingestion via the <a href='https://learn.microsoft.com/en-us/azure/azure-monitor/logs/custom-logs-migrate' style='color:#1890F1;'>deprecated HTTP Data Collector API</a>.</p>",
    "additionalRequirementBanner": ">This data connector depends on a parser based on a Kusto Function to work as expected [**GCP_IAM**](https://aka.ms/sentinel-GCPIAMDataConnector-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "GCP IAM logs",
        "legend": "GCP_IAM_CL",
        "baseQuery": "GCP_IAM_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All GCP IAM logs",
        "query": "GCP_IAM_CL\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "GCP_IAM_CL",
        "lastDataReceivedQuery": "GCP_IAM_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "GCP_IAM_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "GCP service account",
          "description": "GCP service account with permissions to read logs is required for GCP Logging API. Also json file with service account key is required. See the documentation to learn more about [required permissions](https://cloud.google.com/iam/docs/audit-logging#audit_log_permissions), [creating service account](https://cloud.google.com/iam/docs/creating-managing-service-accounts) and [creating service account key](https://cloud.google.com/iam/docs/creating-managing-service-account-keys)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the GCP API to pull logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**GCP_IAM**](https://aka.ms/sentinel-GCPIAMDataConnector-parser) which is deployed with the Microsoft Sentinel Solution."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuring GCP and obtaining credentials**\n\n1. Make sure that Logging API is [enabled](https://cloud.google.com/apis/docs/getting-started#enabling_apis). \n\n2. (Optional) [Enable Data Access Audit logs](https://cloud.google.com/logging/docs/audit/configure-data-access#config-console-enable).\n\n3. [Create service account](https://cloud.google.com/iam/docs/creating-managing-service-accounts) with [required permissions](https://cloud.google.com/iam/docs/audit-logging#audit_log_permissions) and [get service account key json file](https://cloud.google.com/iam/docs/creating-managing-service-account-keys).\n\n4. Prepare the list of GCP resources (organizations, folders, projects) to get logs from. [Learn more about GCP resources](https://cloud.google.com/resource-manager/docs/cloud-platform-resource-hierarchy)."
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following), as well as Azure Blob Storage connection string and container name, readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-GCPIAMDataConnector-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Google Cloud Platform Resource Names**, **Google Cloud Platform Credentials File Content**, **Microsoft Sentinel Workspace Id**, **Microsoft Sentinel Shared Key**\n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**.\n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/create-first-function-vs-code-python) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-GCPIAMDataConnector-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions.\n\n\te. **Select a runtime:** Choose Python 3.11.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tRESOURCE_NAMES\n\t\tCREDENTIALS_FILE_CONTENT\n\t\tWORKSPACE_ID\n\t\tSHARED_KEY\n\t\tlogAnalyticsUri (Optional)\n - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://WORKSPACE_ID.ods.opinsights.azure.us`. \n4. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "GCPMonitorCCPDefinition",
    "title": "Google Cloud Platform Cloud Monitoring (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The Google Cloud Platform Cloud Monitoring data connector ingests Monitoring logs from Google Cloud into Microsoft Sentinel using the Google Cloud Monitoring API. Refer to [Cloud Monitoring API](https://cloud.google.com/monitoring/api/v3) documentation for more details.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "Google Cloud Platform Cloud Monitoring Events",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get a sample of Google Cloud Platform Cloud Monitoring logs",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "GCPMonitorDataConnector",
    "title": "[DEPRECATED] Google Cloud Platform Cloud Monitoring",
    "publisher": "Google",
    "descriptionMarkdown": "The Google Cloud Platform Cloud Monitoring data connector provides the capability to ingest [GCP Monitoring metrics](https://cloud.google.com/monitoring/api/metrics_gcp) into Microsoft Sentinel using the GCP Monitoring API. Refer to [GCP Monitoring API documentation](https://cloud.google.com/monitoring/api/v3) for more information.\n\n<p><span style='color:red; font-weight:bold;'>NOTE</span>: This data connector has been deprecated, consider moving to the CCF data connector available in the solution which replaces ingestion via the <a href='https://learn.microsoft.com/en-us/azure/azure-monitor/logs/custom-logs-migrate' style='color:#1890F1;'>deprecated HTTP Data Collector API</a>.</p>",
    "additionalRequirementBanner": ">This data connector depends on a parser based on a Kusto Function to work as expected [**GCP_MONITORING**](https://aka.ms/sentinel-GCPMonitorDataConnector-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "GCP Monitoring logs",
        "legend": "GCP_MONITORING_CL",
        "baseQuery": "GCP_MONITORING_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All GCP Monitoring logs",
        "query": "GCP_MONITORING_CL\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "GCP_MONITORING_CL",
        "lastDataReceivedQuery": "GCP_MONITORING_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "GCP_MONITORING_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "GCP service account",
          "description": "GCP service account with permissions to read Cloud Monitoring metrics is required for GCP Monitoring API (required *Monitoring Viewer* role). Also json file with service account key is required. See the documentation to learn more about [creating service account](https://cloud.google.com/iam/docs/creating-managing-service-accounts) and [creating service account key](https://cloud.google.com/iam/docs/creating-managing-service-account-keys)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the GCP API to pull logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**GCP_MONITORING**](https://aka.ms/sentinel-GCPMonitorDataConnector-parser) which is deployed with the Microsoft Sentinel Solution."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuring GCP and obtaining credentials**\n\n1. [Create service account](https://cloud.google.com/iam/docs/creating-managing-service-accounts) with Monitoring Viewer role and [get service account key json file](https://cloud.google.com/iam/docs/creating-managing-service-account-keys).\n\n2. Prepare the list of GCP projects to get metrics from. [Learn more about GCP projects](https://cloud.google.com/resource-manager/docs/cloud-platform-resource-hierarchy).\n\n3. Prepare the list of [GCP metric types](https://cloud.google.com/monitoring/api/metrics_gcp)"
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following), as well as Azure Blob Storage connection string and container name, readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the data connector using an ARM Template.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-GCPMonitorDataConnector-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Google Cloud Platform Project Id List**, **Google Cloud Platform Metric Types List**, **Google Cloud Platform Credentials File Content**, **Microsoft Sentinel Workspace Id**, **Microsoft Sentinel Shared Key**\n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**.\n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/create-first-function-vs-code-python) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-GCPMonitorDataConnector-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions.\n\n\te. **Select a runtime:** Choose Python 3.11.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tGCP_PROJECT_ID\n\t\tGCP_METRICS\n\t\tGCP_CREDENTIALS_FILE_CONTENT\n\t\tWORKSPACE_ID\n\t\tSHARED_KEY\n\t\tlogAnalyticsUri (Optional)\n - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://WORKSPACE_ID.ods.opinsights.azure.us`. \n4. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "GCPNATLogsCCPDefinition",
    "title": "Google Cloud Platform NAT (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The Google Cloud Platform NAT data connector provides the capability to ingest Cloud NAT Audit logs and Cloud NAT Traffic logs into Microsoft Sentinel using the Compute Engine API. Refer the [Product overview](https://cloud.google.com/nat/docs/overview) document for more details.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "GCP NAT Audit Logs",
        "baseQuery": "GCPNATAudit"
      },
      {
        "metricName": "Total events received",
        "legend": "GCP NAT Logs",
        "baseQuery": "GCPNAT"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of GCP NAT logs",
        "query": "GCPNAT\n | take 10"
      },
      {
        "description": "Get Sample of GCP NAT Audit logs",
        "query": "GCPNATAudit\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "GCPNAT",
        "lastDataReceivedQuery": "GCPNAT\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      },
      {
        "name": "GCPNATAudit",
        "lastDataReceivedQuery": "GCPNATAudit\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "GCPResourceManagerLogsCCFDefinition",
    "title": "Google Cloud Platform Resource Manager (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The Google Cloud Platform Resource Manager data connector provides the capability to ingest Resource Manager [Admin Activity and Data Access Audit logs](https://cloud.google.com/resource-manager/docs/audit-logging) into Microsoft Sentinel using the Cloud Resource Manager API. Refer the [Product overview](https://cloud.google.com/resource-manager/docs/cloud-platform-resource-hierarchy) document for more details.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "GCP RM Audit Logs",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of GCP RM Audit logs",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "GCPVPCFlowLogsCCPDefinition",
    "title": "GCP Pub/Sub VPC Flow Logs (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The Google Cloud Platform (GCP) VPC Flow Logs enable you to capture network traffic activity at the VPC level, allowing you to monitor access patterns, analyze network performance, and detect potential threats across GCP resources.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "GCP Pub/Sub VPC Flow Logs",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of GCP VPC Flow Logs",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "GigamonDataConnector",
    "title": "Gigamon AMX Data Connector",
    "publisher": "Gigamon",
    "descriptionMarkdown": "Use this data connector to integrate with Gigamon Application Metadata Exporter (AMX) and get data sent directly to Microsoft Sentinel. ",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Gigamon_CL",
        "baseQuery": "Gigamon_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "List all artifacts",
        "query": "Gigamon_CL"
      }
    ],
    "dataTypes": [
      {
        "name": "Gigamon_CL",
        "lastDataReceivedQuery": "Gigamon_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Gigamon_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Gigamon Data Connector",
        "description": "1. Application Metadata Exporter (AMX) application converts the output from the Application Metadata Intelligence (AMI) in CEF format into JSON format and sends it to the cloud tools and Kafka.\n 2. The AMX application can be deployed only on a V Series Node and can be connected to Application Metadata Intelligence running on a physical node or a virtual machine.\n 3. The AMX application and the AMI are managed by GigaVUE-FM. This application is supported on VMware ESXi, VMware NSX-T, AWS and Azure.\n  ",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ],
    "metadata": {
      "id": " ",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "GigamonSolution"
      },
      "author": {
        "name": "Gigamon"
      },
      "support": {
        "tier": "developer",
        "name": "Gigamon"
      }
    }
  },
  {
    "id": "GitHubAuditDefinitionV2",
    "title": "GitHub Enterprise Audit Log (via Codeless Connector Framework) (Preview)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The GitHub audit log connector provides the capability to ingest GitHub logs into Microsoft Sentinel. By connecting GitHub audit logs into Microsoft Sentinel, you can view this data in workbooks, use it to create custom alerts, and improve your investigation process. \n\n **Note:** If you intended to ingest GitHub subscribed events into Microsoft Sentinel, please refer to GitHub (using Webhooks) Connector from \"**Data Connectors**\" gallery.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "GitHubAuditLogEvents",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "GitHub Audit Logs",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n|summarize Time = max  (TimeGenerated)\n|where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "GitHubWebhook",
    "title": "GitHub (using Webhooks)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The [GitHub](https://www.github.com) webhook data connector provides the capability to ingest GitHub subscribed events into Microsoft Sentinel using [GitHub webhook events](https://docs.github.com/en/developers/webhooks-and-events/webhooks/webhook-events-and-payloads). The connector provides ability to get events into Microsoft Sentinel which helps to examine potential security risks, analyze your team's use of collaboration, diagnose configuration problems and more. \n\n **Note:** If you are intended to ingest Github Audit logs, Please refer to GitHub Enterprise Audit Log Connector from \"**Data Connectors**\" gallery.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "githubscanaudit_CL",
        "baseQuery": "githubscanaudit_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "GitHub Events - All Activities.",
        "query": "githubscanaudit_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "githubscanaudit_CL",
        "lastDataReceivedQuery": "githubscanaudit_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "githubscanaudit_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(3d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector has been built on http trigger based Azure Function. And it provides an endpoint to which github will be connected through it's webhook capability and posts the subscribed events into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Github Webhook connector, have the Workspace ID  and Workspace Primary Key (can be copied from the following).",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Option 1 - Azure Resource Manager (ARM) Template",
                  "description": "Use this method for automated deployment of the GitHub data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-GitHubwebhookAPI-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n> **NOTE:** Within the same resource group, you can't mix Windows and Linux apps in the same region and deploy. \n3. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
                },
                {
                  "title": "Option 2 - Manual Deployment of Azure Functions",
                  "description": "Use the following step-by-step instructions to deploy the GitHub webhook data connector manually with Azure Functions (Deployment via Visual Studio Code).",
                  "instructions": [
                    {
                      "parameters": {
                        "instructionSteps": [
                          {
                            "title": "Step 1 - Deploy a Function App",
                            "description": "1. Download the [Azure Function App](https://aka.ms/sentinel-GitHubWebhookAPI-functionapp) file. Extract archive to your local development computer.\n2. Follow the [function app manual deployment instructions](https://github.com/Azure/Azure-Sentinel/blob/master/DataConnectors/AzureFunctionsManualDeployment.md#function-app-manual-deployment-instructions) to deploy the Azure Functions app using VSCode.\n3. After successful deployment of the function app, follow next steps for configuring it."
                          },
                          {
                            "title": "Step 2 - Configure the Function App",
                            "description": "1. Go to Azure Portal for the Function App configuration. \n2. In the Function App, select the Function App Name and select **Configuration**.\n3. In the **Application settings** tab, select ** New application setting**.\n4. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tWorkspaceID\n\t\tWorkspaceKey\n\t\tlogAnalyticsUri (optional) - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n4. Once all application settings have been entered, click **Save**."
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "",
        "description": "**Post Deployment steps**\n\n"
      },
      {
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "STEP 1 - To get the Azure Function url",
                  "description": " 1. Go to Azure function Overview page and Click on \"Functions\" in the left blade.\n 2. Click on the function called \"GithubwebhookConnector\".\n 3. Go to \"GetFunctionurl\" and copy the function url."
                },
                {
                  "title": "STEP 2 - Configure Webhook to Github Organization",
                  "description": "1. Go to [GitHub](https://www.github.com) and open your account and click on \"Your Organizations.\"\n 2. Click on Settings.\n 3. Click on \"Webhooks\" and enter the function app url which was copied from above STEP 1 under payload URL textbox. \n 4. Choose content type as \"application/json\". \n 5. Subscribe for events and Click on \"Add Webhook\""
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "",
        "description": "*Now we are done with the github Webhook configuration. Once the github events triggered and after the delay of 20 to 30 mins (As there will be a dealy for LogAnalytics to spin up the resources for the first time), you should be able to see all the transactional events from the Github into LogAnalytics workspace table called \"githubscanaudit_CL\".*\n\n For more details, Click [here](https://aka.ms/sentinel-gitHubwebhooksteps)"
      }
    ],
    "metadata": {
      "id": "40c0d851-9873-4db5-92a1-078b3e82b1b7",
      "version": "1.0.1",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Microsoft"
      },
      "support": {
        "tier": "community",
        "name": "Microsoft",
        "link": "https://github.com/Azure/Azure-Sentinel/issues"
      }
    }
  },
  {
    "id": "GitLab",
    "title": "[Deprecated] GitLab",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The [GitLab](https://about.gitlab.com/solutions/devops-platform/) connector allows you to easily connect your GitLab (GitLab Enterprise Edition - Standalone) logs with Microsoft Sentinel. This gives you more security insight into your organization's DevOps pipelines.",
    "additionalRequirementBanner": "This data connector depends on three parsers based on a Kusto Function to work as expected [**GitLab Access Logs**](https://aka.ms/sentinel-GitLabAccess-parser), [**GitLab Audit Logs**](https://aka.ms/sentinel-GitLabAudit-parser) and [**GitLab Application Logs**](https://aka.ms/sentinel-GitLabApp-parser) which are deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "GitLabApp",
        "baseQuery": "GitLabApp"
      },
      {
        "metricName": "Total data received",
        "legend": "GitLabAudit",
        "baseQuery": "GitLabAudit"
      },
      {
        "metricName": "Total data received",
        "legend": "GitLabAccess",
        "baseQuery": "GitLabAccess"
      }
    ],
    "sampleQueries": [
      {
        "description": "GitLab Application Logs",
        "query": "GitLabApp | sort by TimeGenerated"
      },
      {
        "description": "GitLab Audit Logs",
        "query": "GitLabAudit | sort by TimeGenerated"
      },
      {
        "description": "GitLab Access Logs",
        "query": "GitLabAccess | sort by TimeGenerated"
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog (GitlabAccess)",
        "lastDataReceivedQuery": "GitLabAccess\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Syslog (GitlabAudit)",
        "lastDataReceivedQuery": "GitLabAudit\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Syslog (GitlabApp)",
        "lastDataReceivedQuery": "GitLabApp\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "GitLabApp\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "GitLabAudit\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "GitLabAccess\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "write permission is required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Configuration",
        "description": ">This data connector depends on three parsers based on a Kusto Function to work as expected [**GitLab Access Logs**](https://aka.ms/sentinel-GitLabAccess-parser), [**GitLab Audit Logs**](https://aka.ms/sentinel-GitLabAudit-parser) and [**GitLab Application Logs**](https://aka.ms/sentinel-GitLabApp-parser) which are deployed with the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux",
        "description": "Typically, you should install the agent on a different computer from the one on which the logs are generated.\n\n>  Syslog logs are collected only from **Linux** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Configure the facilities you want to collect and their severities.\n\n1.  Under workspace advanced settings **Configuration**, select **Data** and then **Syslog**.\n2.  Select **Apply below configuration to my machines** and select the facilities and severities.\n3.  Click **Save**.",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenSyslogSettings"
            },
            "type": "InstallAgent"
          }
        ]
      }
    ],
    "metadata": {
      "id": "Unique Identifier (GUID) used to identify dependencies and content from solutions or community.",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Guillaume Benats"
      },
      "support": {
        "tier": "community",
        "name": "Guillaume Benats",
        "link": "https://github.com/Azure/Azure-Sentinel/issues"
      }
    }
  },
  {
    "id": "GKECCPDefinition",
    "title": "Google Kubernetes Engine (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The Google Kubernetes Engine (GKE) Logs enable you to capture cluster activity, workload behavior, and security events, allowing you to monitor Kubernetes workloads, analyze performance, and detect potential threats across GKE clusters.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "GKEAuditLogs",
        "baseQuery": "GKEAudit"
      },
      {
        "metricName": "Total API Server logs received",
        "legend": "GKEAPIServerLogs",
        "baseQuery": "GKEAPIServer"
      },
      {
        "metricName": "Total Scheduler logs received",
        "legend": "GKESchedulerLogs",
        "baseQuery": "GKEScheduler"
      },
      {
        "metricName": "Total Controller Manager logs received",
        "legend": "GKEControllerManagerLogs",
        "baseQuery": "GKEControllerManager"
      },
      {
        "metricName": "Total HPA Decision logs received",
        "legend": "GKEHPADecisionLogs",
        "baseQuery": "GKEHPADecision"
      },
      {
        "metricName": "Total Application logs received",
        "legend": "GKEApplicationLogs",
        "baseQuery": "GKEApplication"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of GKE Logs",
        "query": "GKEAudit\n | take 10"
      },
      {
        "description": "Get Sample of GKE API Server Logs",
        "query": "GKEAPIServer\n | take 10"
      },
      {
        "description": "Get Sample of GKE Scheduler Logs",
        "query": "GKEScheduler\n | take 10"
      },
      {
        "description": "Get Sample of GKE Controller Manager Logs",
        "query": "GKEControllerManager\n | take 10"
      },
      {
        "description": "Get Sample of GKE HPA Decision Logs",
        "query": "GKEHPADecision\n | take 10"
      },
      {
        "description": "Get Sample of GKE Application Logs",
        "query": "GKEApplication\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "GKEAudit",
        "lastDataReceivedQuery": "GKEAudit\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "GKEAPIServer",
        "lastDataReceivedQuery": "GKEAPIServer\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "GKEScheduler",
        "lastDataReceivedQuery": "GKEScheduler\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "GKEHPADecision",
        "lastDataReceivedQuery": "GKEHPADecision\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "GKEApplication",
        "lastDataReceivedQuery": "GKEApplication\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "GKEControllerManager",
        "lastDataReceivedQuery": "GKEControllerManager\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "GoogleApigeeXLogsCCPDefinition",
    "title": "Google ApigeeX (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The Google ApigeeX data connector provides the capability to ingest Audit logs into Microsoft Sentinel using the Google Apigee API. Refer to [Google Apigee API](https://cloud.google.com/apigee/docs/reference/apis/apigee/rest/?apix=true) documentation for more information.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "Google ApigeeX Logs",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of Google ApigeeX logs",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "GoogleSCCDefinition",
    "title": "Google Security Command Center",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The Google Cloud Platform (GCP) Security Command Center is a comprehensive security and risk management platform for Google Cloud, ingested from Sentinel's connector. It offers features such as asset inventory and discovery, vulnerability and threat detection, and risk mitigation and remediation to help you gain insight into your organization's security and data attack surface. This integration enables you to perform tasks related to findings and assets more effectively.",
    "graphQueriesTableName": "GoogleCloudSCC",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "Google Security Command Center",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of Google SCC",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n            | where TimeGenerated > ago(12h)      | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriteria": [
      {
        "type": "HasDataConnectors",
        "value": null
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "tenant": null,
      "licenses": null,
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "Read and Write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true,
            "action": false
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "Read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key)",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": false,
            "write": false,
            "delete": false,
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "instructions": [
          {
            "type": "Markdown",
            "parameters": {
              "content": "#### 1. Set up your GCP environment \n You must have the following GCP resources defined and configured: topic, subscription for the topic, workload identity pool, workload identity provider and service account with permissions to get and consume from subscription. \n Terraform provides API for the IAM that creates the resources. [Link to Terraform scripts](https://github.com/Azure/Azure-Sentinel/tree/master/DataConnectors/GCP/Terraform/sentinel_resources_creation)."
            }
          },
          {
            "type": "CopyableLabel",
            "parameters": {
              "label": "Tenant ID: A unique identifier that is used as an input in the Terraform configuration within a GCP environment.",
              "fillWith": [
                "TenantId"
              ],
              "name": "PoolId",
              "disabled": true
            }
          },
          {
            "type": "Markdown",
            "parameters": {
              "content": "#### 2. Connect new collectors \n To enable GCP SCC for Microsoft Sentinel, click the Add new collector button, fill the required information in the context pane and click on Connect."
            }
          },
          {
            "type": "GCPGrid",
            "parameters": {}
          },
          {
            "type": "GCPContextPane",
            "parameters": {}
          }
        ]
      }
    ]
  },
  {
    "id": "GoogleWorkspaceCCPDefinition",
    "title": "Google Workspace Activities (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The [Google Workspace](https://workspace.google.com/) Activities data connector provides the capability to ingest Activity Events from [Google Workspace API](https://developers.google.com/admin-sdk/reports/reference/rest/v1/activities/list) into Microsoft Sentinel.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Google Workspace Activity Logs",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Google Workspace Events - All Activities",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "isPreview": true
    },
    "metadata": null
  },
  {
    "id": "GoogleWorkspaceReportsAPI",
    "title": "[DEPRECATED] Google Workspace (G Suite)",
    "publisher": "Google",
    "descriptionMarkdown": "The [Google Workspace](https://workspace.google.com/) data connector provides the capability to ingest Google Workspace Activity events into Microsoft Sentinel through the REST API. The connector provides ability to get [events](https://developers.google.com/admin-sdk/reports/v1/reference/activities) which helps to examine potential security risks, analyze your team's use of collaboration, diagnose configuration problems, track who signs in and when, analyze administrator activity, understand how users create and share content, and more review events in your org.\n\n<p><span style='color:red; font-weight:bold;'>NOTE</span>: This data connector has been deprecated, consider moving to the CCF data connector available in the solution which replaces ingestion via the <a href='https://learn.microsoft.com/en-us/azure/azure-monitor/logs/custom-logs-migrate' style='color:#1890F1;'>deprecated HTTP Data Collector API</a>.</p>",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "GWorkspace_ReportsAPI_admin_CL",
        "baseQuery": "GWorkspace_ReportsAPI_admin_CL"
      },
      {
        "metricName": "Total data received",
        "legend": "GWorkspace_ReportsAPI_calendar_CL",
        "baseQuery": "GWorkspace_ReportsAPI_calendar_CL"
      },
      {
        "metricName": "Total data received",
        "legend": "GWorkspace_ReportsAPI_drive_CL",
        "baseQuery": "GWorkspace_ReportsAPI_drive_CL"
      },
      {
        "metricName": "Total data received",
        "legend": "GWorkspace_ReportsAPI_login_CL",
        "baseQuery": "GWorkspace_ReportsAPI_login_CL"
      },
      {
        "metricName": "Total data received",
        "legend": "GWorkspace_ReportsAPI_mobile_CL",
        "baseQuery": "GWorkspace_ReportsAPI_mobile_CL"
      },
      {
        "metricName": "Total data received",
        "legend": "GWorkspace_ReportsAPI_token_CL",
        "baseQuery": "GWorkspace_ReportsAPI_token_CL"
      },
      {
        "metricName": "Total data received",
        "legend": "GWorkspace_ReportsAPI_user_accounts_CL",
        "baseQuery": "GWorkspace_ReportsAPI_user_accounts_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Google Workspace Events - All Activities",
        "query": "GWorkspaceActivityReports\n | sort by TimeGenerated desc"
      },
      {
        "description": "Google Workspace Events - Admin Activity",
        "query": "GWorkspace_ReportsAPI_admin_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Google Workspace Events - Calendar Activity",
        "query": "GWorkspace_ReportsAPI_calendar_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Google Workspace Events - Drive Activity",
        "query": "GWorkspace_ReportsAPI_drive_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Google Workspace Events - Login Activity",
        "query": "GWorkspace_ReportsAPI_login_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Google Workspace Events - Mobile Activity",
        "query": "GWorkspace_ReportsAPI_mobile_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Google Workspace Events - Token Activity",
        "query": "GWorkspace_ReportsAPI_token_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Google Workspace Events - User Accounts Activity",
        "query": "GWorkspace_ReportsAPI_user_accounts_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "GWorkspace_ReportsAPI_admin_CL",
        "lastDataReceivedQuery": "GWorkspace_ReportsAPI_admin_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "GWorkspace_ReportsAPI_calendar_CL",
        "lastDataReceivedQuery": "GWorkspace_ReportsAPI_calendar_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "GWorkspace_ReportsAPI_drive_CL",
        "lastDataReceivedQuery": "GWorkspace_ReportsAPI_drive_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "GWorkspace_ReportsAPI_login_CL",
        "lastDataReceivedQuery": "GWorkspace_ReportsAPI_login_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "GWorkspace_ReportsAPI_mobile_CL",
        "lastDataReceivedQuery": "GWorkspace_ReportsAPI_mobile_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "GWorkspace_ReportsAPI_token_CL",
        "lastDataReceivedQuery": "GWorkspace_ReportsAPI_token_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "GWorkspace_ReportsAPI_user_accounts_CL",
        "lastDataReceivedQuery": "GWorkspace_ReportsAPI_user_accounts_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "GWorkspace_ReportsAPI_admin_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "GWorkspace_ReportsAPI_calendar_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "GWorkspace_ReportsAPI_drive_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "GWorkspace_ReportsAPI_login_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "GWorkspace_ReportsAPI_mobile_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "GWorkspace_ReportsAPI_token_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "GWorkspace_ReportsAPI_user_accounts_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "**GooglePickleString** is required for REST API. [See the documentation to learn more about API](https://developers.google.com/admin-sdk/reports/v1/reference/activities). Please find the instructions to obtain the credentials in the configuration section below. You can check all [requirements and follow the instructions](https://developers.google.com/admin-sdk/reports/v1/quickstart/python) from here as well."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Google Reports API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "description": "**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias GWorkspaceReports and load the function code or click [here](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/GoogleWorkspaceReports/Parsers/GWorkspaceActivityReports.yaml), on the second line of the query, enter the hostname(s) of your GWorkspaceReports device(s) and any other unique identifiers for the logstream. The function usually takes 10-15 minutes to activate after solution installation/update."
      },
      {
        "title": "",
        "description": "**STEP 1 - Ensure the prerequisites to obtain the Google Pickel String**\n\n"
      },
      {
        "title": "",
        "description": "1. [Python 3 or above](https://www.python.org/downloads/) is installed.\n2. The [pip package management tool](https://www.geeksforgeeks.org/download-and-install-pip-latest-version/) is available.\n3. A Google Workspace domain with [API access enabled](https://support.google.com/a/answer/7281227?visit_id=637889155425319296-3895555646&rd=1).\n4. A Google account in that domain with administrator privileges."
      },
      {
        "title": "",
        "description": "**STEP 2 - Configuration steps for the Google Reports API**\n\n1. Login to Google cloud console with your Workspace Admin credentials https://console.cloud.google.com.\n2. Using the search option (available at the top middle), Search for ***APIs & Services***\n3. From ***APIs & Services*** -> ***Enabled APIs & Services***, enable **Admin SDK API** for this project.\n 4. Go to ***APIs & Services*** -> ***OAuth Consent Screen***. If not already configured, create a OAuth Consent Screen with the following steps:\n\t 1. Provide App Name and other mandatory information.\n\t 2. Add authorized domains with API Access Enabled.\n\t 3. In Scopes section, add **Admin SDK API** scope.\n\t 4. In Test Users section, make sure the domain admin account is added.\n 5. Go to ***APIs & Services*** -> ***Credentials*** and create OAuth 2.0 Client ID\n\t 1. Click on Create Credentials on the top and select Oauth client Id.\n\t 2. Select Web Application from the Application Type drop down.\n\t 3. Provide a suitable name to the Web App and add http://localhost:8081/ as one of the Authorized redirect URIs.\n\t 4. Once you click Create, download the JSON from the pop-up that appears. Rename this file to \"**credentials.json**\".\n 6. To fetch Google Pickel String, run the [python script](https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/GoogleWorkspaceReports/Data%20Connectors/get_google_pickle_string.py) from the same folder where credentials.json is saved.\n\t 1. When popped up for sign-in, use the domain admin account credentials to login.\n>**Note:** This script is supported only on Windows operating system.\n 7. From the output of the previous step, copy Google Pickle String (contained within single quotation marks) and keep it handy. It will be needed on Function App deployment step."
      },
      {
        "title": "",
        "description": "**STEP 3 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Workspace data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following), as well as the Workspace GooglePickleString readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the Google Workspace data connector using an ARM Template.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinelgworkspaceazuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace ID**, **Workspace Key**, **GooglePickleString** and deploy. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the Google Workspace data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-GWorkspaceReportsAPI-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. GWorkspaceXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.11.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select ** New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tGooglePickleString\n\t\tWorkspaceID\n\t\tWorkspaceKey\n\t\tlogAnalyticsUri (optional)\n4. (Optional) Change the default delays if required. \n\n\t> **NOTE:** The following default values for ingestion delays have been added for different set of logs from Google Workspace based on Google [documentation](https://support.google.com/a/answer/7061566). These can be modified based on environmental requirements. \n\t\t Fetch Delay - 10 minutes \n\t\t Calendar Fetch Delay - 6 hours \n\t\t Chat Fetch Delay - 1 day \n\t\t User Accounts Fetch Delay - 3 hours \n\t\t Login Fetch Delay - 6 hours  \n\n5. Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`. \n6. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "GreyNoise2SentinelAPI",
    "title": "GreyNoise Threat Intelligence",
    "publisher": "GreyNoise, Inc. and BlueCycle LLC",
    "descriptionMarkdown": "This Data Connector installs an Azure Function app to download GreyNoise indicators once per day and inserts them into the ThreatIntelligenceIndicator table in Microsoft Sentinel.",
    "graphQueries": [
      {
        "metricName": "Total indicators received",
        "legend": "Connection Events",
        "baseQuery": "ThreatIntelligenceIndicator | where SourceSystem == 'GreyNoise'"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Threat Intelligence APIs Indicators",
        "query": "ThreatIntelligenceIndicator | where SourceSystem == 'GreyNoise'| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "ThreatIntelligenceIndicator",
        "lastDataReceivedQuery": "ThreatIntelligenceIndicator| where isnotempty(TimeGenerated) and SourceSystem == 'GreyNoise' | summarize Time = max(TimeGenerated)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ThreatIntelligenceIndicator| where SourceSystem == 'GreyNoise' | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.SecurityInsights/threatintelligence/write",
          "permissionsDisplayText": "write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "GreyNoise API Key",
          "description": "Retrieve your GreyNoise API Key [here](https://viz.greynoise.io/account/api-key)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "You can connect GreyNoise Threat Intelligence to Microsoft Sentinel by following the below steps: ",
        "description": "\n> The following steps create an Azure AAD application, retrieves a GreyNoise API key, and saves the values in an Azure Function App Configuration."
      },
      {
        "title": "1. Retrieve your API Key from GreyNoise Visualizer.",
        "description": "Generate an API key from GreyNoise Visualizer https://docs.greynoise.io/docs/using-the-greynoise-api"
      },
      {
        "title": "2. In your Azure AD tenant, create an Azure Active Directory (AAD) application and acquire Tenant ID and Client ID. Also, get the Log Analytics Workspace ID associated with your Microsoft Sentinel instance (it should display below).",
        "description": "Follow the instructions here to create your Azure AAD app and save your Client ID and Tenant ID: https://learn.microsoft.com/en-us/azure/sentinel/connect-threat-intelligence-upload-api#instructions\n NOTE: Wait until step 5 to generate your client secret.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "3. Assign the AAD application the Microsoft Sentinel Contributor Role.",
        "description": "Follow the instructions here to add the Microsoft Sentinel Contributor Role: https://learn.microsoft.com/en-us/azure/sentinel/connect-threat-intelligence-upload-api#assign-a-role-to-the-application"
      },
      {
        "title": "4. Specify the AAD permissions to enable MS Graph API access to the upload-indicators API.",
        "description": "Follow this section here to add **'ThreatIndicators.ReadWrite.OwnedBy'** permission to the AAD App: https://learn.microsoft.com/en-us/azure/sentinel/connect-threat-intelligence-tip#specify-the-permissions-required-by-the-application. \n Back in your AAD App, ensure you grant admin consent for the permissions you just added. \n Finally, in the 'Tokens and APIs' section, generate a client secret and save it. You will need it in Step 6. "
      },
      {
        "title": "5. Deploy the Threat Intelligence (Preview) Solution, which includes the Threat Intelligence Upload Indicators API (Preview)",
        "description": "See Microsoft Sentinel Content Hub for this Solution, and install it in the Microsoft Sentinel instance."
      },
      {
        "title": "6. Deploy the Azure Function",
        "description": "Click the Deploy to Azure button.\n\n  [![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-GreyNoise-azuredeploy)\n\n Fill in the appropriate values for each parameter. **Be aware** that the only valid values for the **GREYNOISE_CLASSIFICATIONS** parameter are **benign**, **malicious** and/or **unknown**, which must be comma-separated."
      },
      {
        "title": "7. Send indicators to Sentinel",
        "description": "The function app installed in Step 6 queries the GreyNoise GNQL API once per day, and submits each indicator found in STIX 2.1 format to the [Microsoft Upload Threat Intelligence Indicators API](https://learn.microsoft.com/en-us/azure/sentinel/upload-indicators-api). \n Each indicator expires in ~24 hours from creation unless found on the next day's query. In this case the TI Indicator's **Valid Until** time is extended for another 24 hours, which keeps it active in Microsoft Sentinel.  \n\n For more information on the GreyNoise API and the GreyNoise Query Language (GNQL), [click here](https://developer.greynoise.io/docs/using-the-greynoise-api)."
      }
    ],
    "metadata": {
      "id": "27dc60cc-758b-566e-93ce-932560a6ff81",
      "version": "1.0.1",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "GreyNoise Intelligence Solution for Microsoft Sentinel"
      },
      "author": {
        "name": "Blue Cycle LLC | GreyNoise, Inc."
      },
      "support": {
        "tier": "developer",
        "name": "Support Team",
        "email": "support@greynoise.io",
        "link": "https://www.greynoise.io/contact/sales"
      }
    }
  },
  {
    "id": "HolmSecurityAssets",
    "title": "Holm Security Asset Data",
    "publisher": "Holm Security",
    "descriptionMarkdown": "The connector provides the capability to poll data from Holm Security Center into Microsoft Sentinel.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "net_assets_CL",
        "baseQuery": "net_assets_CL"
      },
      {
        "metricName": "Total data received",
        "legend": "web_assets_CL",
        "baseQuery": "web_assets_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All low net assets",
        "query": "net_assets_CL\n            | where severity_s  == 'low'"
      },
      {
        "description": "All low web assets",
        "query": "web_assets_CL\n            | where severity_s  == 'low'"
      }
    ],
    "dataTypes": [
      {
        "name": "net_assets_CL",
        "lastDataReceivedQuery": "net_assets_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "web_assets_CL",
        "lastDataReceivedQuery": "web_assets_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "net_assets_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "web_assets_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Holm Security API Token",
          "description": "Holm Security API Token is required. [Holm Security API Token](https://support.holmsecurity.com/)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to a Holm Security Assets to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the Holm Security API**\n\n [Follow these instructions](https://support.holmsecurity.com/knowledge/how-do-i-set-up-an-api-token) to create an API authentication token."
      },
      {
        "title": "",
        "description": "**STEP 2 - Use the below deployment option to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Holm Security connector, have the Workspace ID  and Workspace Primary Key (can be copied from the following), as well as the Holm Security API authorization Token, readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Azure Resource Manager (ARM) Template Deployment",
        "description": "**Option 1 - Azure Resource Manager (ARM) Template**\n\nUse this method for automated deployment of the Holm Security connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-holmsecurityassets-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace ID**, **Workspace Key**, **API Username**, **API Password**, 'and/or Other required fields'. \n>Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      }
    ],
    "metadata": {
      "id": "Unique Identifier (GUID) used to identify dependencies and content from solutions or community.",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community",
        "name": "Holm Security"
      },
      "author": {
        "name": "Holm Security"
      },
      "support": {
        "tier": "developer",
        "name": "Holm Security",
        "link": "https://support.holmsecurity.com/"
      }
    }
  },
  {
    "id": "HVPollingIDAzureFunctions",
    "title": "HackerView Intergration",
    "publisher": "CTM360",
    "descriptionMarkdown": "Through the API integration, you have the capability to retrieve all the issues related to your HackerView organizations via a RESTful interface.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "HV log events",
        "baseQuery": "HackerViewLog_Azure_1_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "HackerViewLog_Azure_1_CL \n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "HackerViewLog_Azure_1_CL",
        "lastDataReceivedQuery": "HackerViewLog_Azure_1_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "HackerViewLog_Azure_1_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to a '' to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the 'HackerView' API**\n\nThe provider should provide or link to detailed steps to configure the 'HackerView' API endpoint so that the Azure Function can authenticate to it successfully, get its authorization key or token, and pull the appliance's logs into Microsoft Sentinel."
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the 'HackerView' connector, have the Workspace ID  and Workspace Primary Key (can be copied from the following), as well as the 'HackerView' API authorization key(s) readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "",
        "description": "**Option 1 - Azure Resource Manager (ARM) Template**\n\nUse this method for automated deployment of the 'HackerView' connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-CTM360-HV-azuredeploy) [![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://aka.ms/sentinel-CTM360-HV-azuredeploy-gov)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace ID**, **Workspace Key**, **API **, 'and/or Other required fields'. \n>Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "",
        "description": "**Option 2 - Manual Deployment of Azure Functions**\n\n Use the following step-by-step instructions to deploy the 'HackerView' connector manually with Azure Functions."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the CTM360 CBS data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/create-first-function-vs-code-python) for Azure function development.\n\n1. Download the [Azure Function App](https://raw.githubusercontent.com/CTM360-Integrations/Azure-Sentinel/ctm360-HV-CBS-azurefunctionapp/Solutions/CTM360/Data%20Connectors/HackerView/AzureFunctionCTM360_HV.zip) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. CTIXYZ).\n\n\te. **Select a runtime:** Choose Python 3.11.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive):  \n\t\tCTM360AccountID\n\t\tWorkspaceID\n\t\tWorkspaceKey\n\t\tCTM360Key\n\t\tFUNCTION_NAME\n\t\tlogAnalyticsUri  - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n3. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "HYASProtect",
    "title": "HYAS Protect",
    "publisher": "HYAS",
    "descriptionMarkdown": "HYAS Protect provide logs based on reputation values - Blocked, Malicious, Permitted, Suspicious.",
    "graphQueries": [
      {
        "metricName": "Total logs received",
        "legend": "HYASProtectDnsSecurityLogs",
        "baseQuery": "HYASProtectDnsSecurityLogs_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Logs",
        "query": "HYASProtectDnsSecurityLogs_CL"
      }
    ],
    "dataTypes": [
      {
        "name": "HYASProtectDnsSecurityLogs_CL",
        "lastDataReceivedQuery": "HYASProtectDnsSecurityLogs_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "HYASProtectDnsSecurityLogs_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "**HYAS API Key** is required for making API calls."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the HYAS API to pull Logs into Microsoft Sentinel. This might result in additional costs for data ingestion and for storing data in Azure Blob Storage costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) and [Azure Blob Storage pricing page](https://azure.microsoft.com/pricing/details/storage/blobs/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the HYAS Protect data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-HYASProtect-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Function Name**, **Table Name**, **Workspace ID**, **Workspace Key**, **API Key**, **TimeInterval**, **FetchBlockedDomains**, **FetchMaliciousDomains**, **FetchSuspiciousDomains**, **FetchPermittedDomains** and deploy. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the HYAS Protect Logs data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> NOTE:You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-HYASProtect-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. HyasProtectLogsXXX).\n\n\te. **Select a runtime:** Choose Python 3.8.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tAPIKey\n\t\tPolling\n\t\tWorkspaceID\n\t\tWorkspaceKey\n. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "iboss",
    "title": "[Deprecated] iboss via Legacy Agent",
    "publisher": "iboss",
    "descriptionMarkdown": "The [iboss](https://www.iboss.com) data connector enables you to seamlessly connect your Threat Console to Microsoft Sentinel and enrich your instance with iboss URL event logs. Our logs are forwarded in Common Event Format (CEF) over Syslog and the configuration required can be completed on the iboss platform without the use of a proxy. Take advantage of our connector to garner critical data points and gain insight into security threats.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ibossUrlEvent",
        "baseQuery": "CommonSecurityLog | where DeviceVendor =~ 'iboss' and AdditionalExtensions !contains 'amaExternalLogService=true'"
      }
    ],
    "sampleQueries": [
      {
        "description": "Logs Received from the past week",
        "query": "CommonSecurityLog | where DeviceVendor =~ 'iboss' and TimeGenerated > ago(7d) and AdditionalExtensions !contains 'amaExternalLogService=true'"
      }
    ],
    "dataTypes": [
      {
        "name": "ibossUrlEvent",
        "lastDataReceivedQuery": "CommonSecurityLog\n| where DeviceVendor =~ 'iboss' and AdditionalExtensions !contains 'amaExternalLogService=true'\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n | where DeviceVendor =~ 'iboss'\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Configure a dedicated proxy Linux machine",
        "description": "If using the iboss gov environment or there is a preference to forward the logs to a dedicated proxy Linux machine, proceed with this step. In all other cases, please advance to step two.",
        "innerSteps": [
          {
            "title": "1.1 Linux Syslog agent configuration",
            "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace"
          },
          {
            "title": "1.2 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the dedicated proxy Linux machine between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.3 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n> 2. You must have elevated permissions (sudo) on your machine",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Common Event Format (CEF) logs",
        "description": "Set your Threat Console to send Syslog messages in CEF format to your Azure workspace. Make note of your Workspace ID and Primary Key within your Log Analytics Workspace (Select the workspace from the Log Analytics workspaces menu in the Azure portal. Then select Agents management in the Settings section). \n\n>1. Navigate to Reporting & Analytics inside your iboss Console\n\n>2. Select Log Forwarding -> Forward From Reporter\n\n>3. Select Actions -> Add Service\n\n>4. Toggle to Microsoft Sentinel as a Service Type and input your Workspace ID/Primary Key along with other criteria. If a dedicated proxy Linux machine has been configured, toggle to Syslog as a Service Type and configure the settings to point to your dedicated proxy Linux machine\n\n>5. Wait one to two minutes for the setup to complete\n\n>6. Select your Microsoft Sentinel Service and verify the Microsoft Sentinel Setup Status is Successful. If a dedicated proxy Linux machine has been configured, you may proceed with validating your connection"
      },
      {
        "title": "3. Validate connection",
        "description": "Open Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace"
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy (Only applicable if a dedicated proxy Linux machine has been configured).\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "f8c448b1-3df4-444d-aded-63e4ad2aec08",
      "version": "1.0.1",
      "kind": "dataConnector",
      "author": {
        "name": "iboss"
      },
      "support": {
        "tier": "Type of support for content item: microsoft | developer | community",
        "name": "iboss",
        "link": "https://www.iboss.com/"
      }
    }
  },
  {
    "id": "ibossAma",
    "title": "iboss via AMA",
    "publisher": "iboss",
    "descriptionMarkdown": "The [iboss](https://www.iboss.com) data connector enables you to seamlessly connect your Threat Console to Microsoft Sentinel and enrich your instance with iboss URL event logs. Our logs are forwarded in Common Event Format (CEF) over Syslog and the configuration required can be completed on the iboss platform without the use of a proxy. Take advantage of our connector to garner critical data points and gain insight into security threats.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ibossUrlEvent",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'iboss' and AdditionalExtensions contains 'amaExternalLogService=true'"
      }
    ],
    "sampleQueries": [
      {
        "description": "Logs Received from the past week",
        "query": "CommonSecurityLog\n | where DeviceVendor =~ 'iboss' and TimeGenerated > ago(7d) and AdditionalExtensions contains 'amaExternalLogService=true'"
      }
    ],
    "dataTypes": [
      {
        "name": "ibossUrlEvent",
        "lastDataReceivedQuery": "CommonSecurityLog\n | where DeviceVendor =~ 'iboss' and AdditionalExtensions contains 'amaExternalLogService=true'\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n | where DeviceVendor =~ 'iboss'\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Configure AMA Data Connector",
        "description": "Steps to configure the iboss AMA Data Connector",
        "instructions": [
          {
            "parameters": {
              "title": "Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Gather Required Configuration Details in Azure Arc",
                  "description": "1. Navigate to Azure Arc ---> Azure Arc Resources ---> Machines.\n\n2. Add a machine ---> Add a single server ---> Generate script.\n\n3. Select the resource group, this should be the same group as the Log Analytics Workspace for your Microsoft Sentinel instance you will be using\n\n4. Select a region and ensure it is in the same region as your Log Analytics Workspace\n\n5. Select Linux as Operating System\n\n6. Click Next\n\n7. Download the script and use this information for the next step when configuring your Microsoft Sentinel AMA integration iboss side.\n\n8. Navigate to the Log Analytics Workspace of your Microsoft Sentinel instance and find it's resource group, workspace name, and workspace id"
                },
                {
                  "title": "Step B. Forward Common Event Format (CEF) logs",
                  "description": "Set your Threat Console to send Syslog messages in CEF format to your Azure workspace. (Ensure you have the information gathered from the previous section)\n\n>1. Navigate to the Integrations Marketplace inside your iboss Console\n\n>2. Select Microsoft Sentinel AMA Log Forwarding\n\n>3. Select Add Integration\n\n4. Use the information from the script and your log analytics workspace to configure the integration.\n\n5. Add the integration\n\n>6. An email with be sent to your iboss alerts email to authenticate. Please do so within five minutes\n\n7. After authenticating, wait 15 to 20 minutes and ensure the Microsoft Sentinel Status of your integration is successful."
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "1. Follow the instructions to validate your connectivity:\n\n2. Open Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n3. It may take about 20 minutes until the connection streams data to your workspace."
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ],
    "metadata": {
      "id": "f8c448b1-3df4-444d-aded-63e4ad2aec08",
      "version": "1.0.2",
      "kind": "dataConnector",
      "author": {
        "name": "iboss"
      },
      "support": {
        "tier": "Type of support for content item: microsoft | developer | community",
        "name": "iboss",
        "link": "https://www.iboss.com/"
      }
    }
  },
  {
    "id": "IllumioCore",
    "title": "[Deprecated] Illumio Core via Legacy Agent",
    "publisher": "Illumio",
    "descriptionMarkdown": "The [Illumio Core](https://www.illumio.com/products/) data connector provides the capability to ingest Illumio Core logs into Microsoft Sentinel.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "IllumioCore",
        "baseQuery": "IllumioCoreEvent"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Event Types",
        "query": "IllumioCoreEvent\n | where isnotempty(EventType)\n    | summarize count() by EventType\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (IllumioCore)",
        "lastDataReceivedQuery": "IllumioCoreEvent\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "IllumioCoreEvent\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias IllumioCoreEvent and load the function code or click [here](https://aka.ms/sentinel-IllumioCore-parser).The function usually takes 10-15 minutes to activate after solution installation/update and maps Illumio Core events to Microsoft Sentinel Information Model (ASIM)."
      },
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Configure Ilumio Core to send logs using CEF",
        "description": "2.1 Configure Event Format\n\n 1. From the PCE web console menu, choose **Settings > Event Settings** to view your current settings.\n\n 2. Click **Edit** to change the settings.\n\n 3. Set **Event Format** to CEF.\n\n 4. (Optional) Configure **Event Severity** and **Retention Period**.\n\n2.2 Configure event forwarding to an external syslog server\n\n 1. From the PCE web console menu, choose **Settings > Event Settings**.\n\n 2. Click **Add**.\n\n 3. Click **Add Repository**.\n\n 4. Complete the **Add Repository** dialog.\n\n 5. Click **OK** to save the event forwarding configuration."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "IllumioCoreAma",
    "title": "[Deprecated] Illumio Core via AMA",
    "publisher": "Illumio",
    "descriptionMarkdown": "The [Illumio Core](https://www.illumio.com/products/) data connector provides the capability to ingest Illumio Core logs into Microsoft Sentinel.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "IllumioCore",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Illumio'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Event Types",
        "query": "IllumioCoreEvent\n | where isnotempty(EventType)\n    | summarize count() by EventType\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (IllumioCore)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Illumio'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'Illumio'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias IllumioCoreEvent and load the function code or click [here](https://aka.ms/sentinel-IllumioCore-parser).The function usually takes 10-15 minutes to activate after solution installation/update and maps Illumio Core events to Microsoft Sentinel Information Model (ASIM).",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine."
                },
                {
                  "title": "Step B. Configure Ilumio Core to send logs using CEF",
                  "description": "Configure Event Format\n\n 1. From the PCE web console menu, choose **Settings > Event Settings** to view your current settings.\n\n 2. Click **Edit** to change the settings.\n\n 3. Set **Event Format** to CEF.\n\n 4. (Optional) Configure **Event Severity** and **Retention Period**.\n\nConfigure event forwarding to an external syslog server\n\n 1. From the PCE web console menu, choose **Settings > Event Settings**.\n\n 2. Click **Add**.\n\n 3. Click **Add Repository**.\n\n 4. Complete the **Add Repository** dialog.\n\n 5. Click **OK** to save the event forwarding configuration."
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "IllumioInsightsDefinition",
    "title": "Illumio Insights",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Illumio Insights Connector sends workload and security graph data from Illumio Insights into the Azure Microsoft Sentinel Data Lake, providing deep context for threat detection, lateral movement analysis, and real-time investigation.",
    "graphQueries": [
      {
        "metricName": "Total incident logs received",
        "legend": "Illumio Insights incident Logs",
        "baseQuery": "IllumioInsights_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of Illumio Insights logs",
        "query": "IllumioInsights_CL| take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "IllumioInsights_CL",
        "lastDataReceivedQuery": "IllumioInsights_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "IllumioInsightsSummaryCCP",
    "title": "Illumio Insights Summary",
    "publisher": "Illumio",
    "descriptionMarkdown": "The Illumio Insights Summary connector Publishes AI-powered threat discovery and anomaly reports generated by the Illumio Insights Agent. Leveraging the MITRE ATT&CK framework, these reports surface high-fidelity insights into emerging threats and risky behaviors, directly into the Data Lake.",
    "graphQueries": [
      {
        "metricName": "Total reports received",
        "legend": "Illumio Insights Summary Reports",
        "baseQuery": "{{graphQueriesTableName}}"
      },
      {
        "metricName": "Threat Hunter reports",
        "legend": "Threat Hunter Reports",
        "baseQuery": "{{graphQueriesTableName}} | where Persona == \"threat_hunter\""
      },
      {
        "metricName": "Compliance Manager reports",
        "legend": "Compliance Manager Reports",
        "baseQuery": "{{graphQueriesTableName}} | where Persona == \"compliance_manager\""
      }
    ],
    "sampleQueries": [
      {
        "description": "All Illumio insights summary reports",
        "query": "{{graphQueriesTableName}}\n| sort by TimeGenerated desc"
      },
      {
        "description": "Get sample of Illumio insights summary reports",
        "query": "{{graphQueriesTableName}}\n| take 10"
      },
      {
        "description": "Summary by persona type",
        "query": "{{graphQueriesTableName}}\n| summarize count() by Persona"
      }
    ],
    "dataTypes": [
      {
        "name": "IllumioInsightsSummary_CL",
        "lastDataReceivedQuery": "IllumioInsightsSummary_CL\n| where TimeGenerated > ago(12h)\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": null,
    "metadata": null
  },
  {
    "id": "IllumioSaasCCFDefinition",
    "title": "Illumio Saas",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The Illumio Saas Cloud data connector provides the capability to ingest Flow logs into Microsoft Sentinel using the Illumio Saas Log Integration through AWS S3 Bucket. Refer to [Illumio Saas Log Integration](https://product-docs-repo.illumio.com/Tech-Docs/CloudSecure/out/en/administer-cloudsecure/connector.html#UUID-c14edaab-9726-1f23-9c4c-bc2937be39ee_section-idm234556433515698) for more information.",
    "graphQueries": [
      {
        "metricName": "Total Illumio Flow events received",
        "legend": "Illumio Flow Logs",
        "baseQuery": "IllumioFlowEventsV2_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of Illumio Flow logs",
        "query": "IllumioFlowEventsV2_CL\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "IllumioFlowEventsV2_CL",
        "lastDataReceivedQuery": "IllumioFlowEventsV2_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "IllumioSaaSDataConnector",
    "title": "Illumio SaaS",
    "publisher": "Illumio",
    "descriptionMarkdown": "[Illumio](https://www.illumio.com/) connector provides the capability to ingest events into Microsoft Sentinel. The connector provides ability to ingest auditable and flow events from AWS S3 bucket.",
    "graphQueries": [
      {
        "metricName": "Total auditable events received",
        "legend": "Illumio auditable events",
        "baseQuery": "Illumio_Auditable_Events_CL"
      },
      {
        "metricName": "Total flow summaries received",
        "legend": "Illumio flow summaries",
        "baseQuery": "Illumio_Flow_Events_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Sample of auditable events",
        "query": "Illumio_Auditable_Events_CL \n | sort by TimeGenerated desc \n | limit 10"
      },
      {
        "description": "Sample of flow summaries",
        "query": "Illumio_Flow_Events_CL \n | sort by TimeGenerated desc \n | limit 10"
      }
    ],
    "dataTypes": [
      {
        "name": "Illumio_Auditable_Events_CL",
        "lastDataReceivedQuery": "Illumio_Auditable_Events_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Illumio_Flow_Events_CL",
        "lastDataReceivedQuery": "Illumio_Flow_Events_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Illumio_Flow_Events_CL            | summarize LastLogReceived = max(TimeGenerated)            | project IsConnected = LastLogReceived > ago(30d)",
          "Illumio_Auditable_Events_CL            | summarize LastLogReceived = max(TimeGenerated)            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "SQS and AWS S3 account credentials/permissions",
          "description": "**AWS_SECRET**, **AWS_REGION_NAME**, **AWS_KEY**, **QUEUE_URL** is required.  [See the documentation to learn more about data pulling](<Replace with an entry to documentation>). If you are using s3 bucket provided by Illumio, contact Illumio support. At your request they will provide you with the AWS S3 bucket name, AWS SQS url and AWS credentials to access them."
        },
        {
          "name": "Illumio API key and secret",
          "description": "**ILLUMIO_API_KEY**, **ILLUMIO_API_SECRET** is required for a workbook to make connection to SaaS PCE and fetch api responses."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the AWS SQS / S3 to pull logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details.\n\n>**(Optional Step)** Securely store API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "Prerequisites",
        "description": "1. Ensure AWS SQS is configured for the s3 bucket from which flow and auditable event logs are going to be pulled. In case, Illumio provides bucket, please contact Illumio support for sqs url, s3 bucket name and aws credentials. \n 2. Register AAD application - For DCR (Data collection rule) to authentiate to ingest data into log analytics, you must use Entra application. 1. [Follow the instructions here](https://learn.microsoft.com/en-us/azure/azure-monitor/logs/tutorial-logs-ingestion-portal#create-azure-ad-application) (steps 1-5) to get **AAD Tenant Id**, **AAD Client Id** and **AAD Client Secret**. \n 2. Ensure you have created a log analytics workspace. \nPlease keep note of the name and region where it has been deployed."
      },
      {
        "title": "Deployment",
        "description": "Choose one of the approaches from below options. Either use the below ARM template to deploy azure resources or deploy function app manually."
      },
      {
        "title": "1. Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of Azure resources using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-IllumioSaaS-FunctionApp) \t\t\t\n2. Provide the required details such as Microsoft Sentinel Workspace, AWS credentials, Azure AD Application details and ingestion configurations \n> **NOTE:** It is recommended to create a new Resource Group for deployment of function app and associated resources.\n3. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n4. Click **Purchase** to deploy."
      },
      {
        "title": "2. Deploy additional function apps to handle scale",
        "description": "Use this method for automated deployment of additional function apps using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-IllumioSaaS-QueueTriggerFunctionApp) \t\t\t\n"
      },
      {
        "title": "3. Manual Deployment of Azure Functions",
        "description": "Deployment via Visual Studio Code."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n1. Download the [Azure Function App](https://github.com/Azure/Azure-Sentinel/raw/master/Solutions/IllumioSaaS/Data%20Connectors/IllumioEventsConn.zip) file. Extract archive to your local development computer.\n2. Follow the [function app manual deployment instructions](https://github.com/Azure/Azure-Sentinel/blob/master/DataConnectors/AzureFunctionsManualDeployment.md#function-app-manual-deployment-instructions) to deploy the Azure Functions app using VSCode.\n3. After successful deployment of the function app, follow next steps for configuring it."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. Follow documentation <insert link> to set up all required environment variables and click **Save**. Ensure you restart the function app once settings are saved."
      }
    ],
    "metadata": {
      "version": "1.2.0"
    }
  },
  {
    "id": "illusiveAttackManagementSystem",
    "title": "[Deprecated] Illusive Platform via Legacy Agent",
    "publisher": "illusive",
    "descriptionMarkdown": "The Illusive Platform Connector allows you to share Illusive's attack surface analysis data and incident logs with Microsoft Sentinel and view this information in dedicated dashboards that offer insight into your organization's attack surface risk (ASM Dashboard) and track unauthorized lateral movement in your organization's network (ADS Dashboard).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "illusive",
        "baseQuery": "\nCommonSecurityLog\n| where DeviceVendor == \"illusive\"\n| where DeviceProduct == \"illusive\"\n"
      }
    ],
    "sampleQueries": [
      {
        "description": "Number of Incidents in in the last 30 days in which Trigger Type is found",
        "query": "union CommonSecurityLog\r\n| where (DeviceEventClassID == \"illusive:login\" or DeviceEventClassID == \"illusive:access\" or DeviceEventClassID == \"illusive:suspicious\")\r\n| where Message !contains \"hasForensics\" \r\n| where TimeGenerated > ago(30d) \r\n| extend DeviceCustomNumber2 = coalesce(column_ifexists(\"FieldDeviceCustomNumber2\", long(null)), DeviceCustomNumber2, long(null))\r\n| summarize by DestinationServiceName, DeviceCustomNumber2 \r\n| summarize incident_count=count() by DestinationServiceName"
      },
      {
        "description": "Top 10 alerting hosts in the last 30 days",
        "query": "union CommonSecurityLog \r\n| where (DeviceEventClassID == \"illusive:login\" or DeviceEventClassID == \"illusive:access\" or DeviceEventClassID == \"illusive:suspicious\")\r\n| where Message !contains \"hasForensics\" \r\n| where TimeGenerated > ago(30d) \r\n| extend DeviceCustomNumber2 = coalesce(column_ifexists(\"FieldDeviceCustomNumber2\", long(null)), DeviceCustomNumber2, long(null))  \r\n| summarize by AlertingHost=iff(SourceHostName != \"\" and SourceHostName != \"Failed to obtain\", SourceHostName, SourceIP)   ,DeviceCustomNumber2 \r\n| where AlertingHost != \"\" and AlertingHost != \"Failed to obtain\" \r\n| summarize incident_count=count() by AlertingHost \r\n| order by incident_count \r\n| limit 10"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (illusive)",
        "lastDataReceivedQuery": "\nCommonSecurityLog\n| where DeviceVendor == \"illusive\"\n| where DeviceProduct == \"illusive\"\n\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "\nCommonSecurityLog\n| where DeviceVendor == \"illusive\"\n| where DeviceProduct == \"illusive\"\n\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Illusive Common Event Format (CEF) logs to Syslog agent",
        "description": "1. Set your security solution to send Syslog messages in CEF format to the proxy machine. Make sure you to send the logs to port 514 TCP on the machine's IP address.\n> 2. Log onto the Illusive Console, and navigate to Settings->Reporting.\n> 3. Find Syslog Servers\n> 4. Supply the following information:\n>> 1. Host name: Linux Syslog agent IP address or FQDN host name\n>> 2. Port: 514\n>> 3. Protocol: TCP\n>> 4. Audit messages: Send audit messages to server\n> 5. To add the syslog server, click Add.\n> 6. For more information about how to add a new syslog server in the Illusive platform, please find the Illusive Networks Admin Guide in here: https://support.illusivenetworks.com/hc/en-us/sections/360002292119-Documentation-by-Version"
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "aa770f1e-4d05-477a-8dc1-b893772f3a46",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Illusive Networks"
      },
      "support": {
        "name": "Illusive Networks",
        "link": "https://www.illusivenetworks.com/technical-support/",
        "tier": "developer"
      }
    }
  },
  {
    "id": "illusiveAttackManagementSystemAma",
    "title": "[Deprecated] Illusive Platform via AMA",
    "publisher": "illusive",
    "descriptionMarkdown": "The Illusive Platform Connector allows you to share Illusive's attack surface analysis data and incident logs with Microsoft Sentinel and view this information in dedicated dashboards that offer insight into your organization's attack surface risk (ASM Dashboard) and track unauthorized lateral movement in your organization's network (ADS Dashboard).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "illusive",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'illusive'\n |where DeviceProduct =~ 'illusive'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "Number of Incidents in in the last 30 days in which Trigger Type is found",
        "query": "union CommonSecurityLog\r\n| where (DeviceEventClassID == \"illusive:login\" or DeviceEventClassID == \"illusive:access\" or DeviceEventClassID == \"illusive:suspicious\")\r\n| where Message !contains \"hasForensics\" \r\n| where TimeGenerated > ago(30d) \r\n| extend DeviceCustomNumber2 = coalesce(column_ifexists(\"FieldDeviceCustomNumber2\", long(null)), DeviceCustomNumber2, long(null))\r\n| summarize by DestinationServiceName, DeviceCustomNumber2 \r\n| summarize incident_count=count() by DestinationServiceName"
      },
      {
        "description": "Top 10 alerting hosts in the last 30 days",
        "query": "union CommonSecurityLog \r\n| where (DeviceEventClassID == \"illusive:login\" or DeviceEventClassID == \"illusive:access\" or DeviceEventClassID == \"illusive:suspicious\")\r\n| where Message !contains \"hasForensics\" \r\n| where TimeGenerated > ago(30d) \r\n| extend DeviceCustomNumber2 = coalesce(column_ifexists(\"FieldDeviceCustomNumber2\", long(null)), DeviceCustomNumber2, long(null))  \r\n| summarize by AlertingHost=iff(SourceHostName != \"\" and SourceHostName != \"Failed to obtain\", SourceHostName, SourceIP)   ,DeviceCustomNumber2 \r\n| where AlertingHost != \"\" and AlertingHost != \"Failed to obtain\" \r\n| summarize incident_count=count() by AlertingHost \r\n| order by incident_count \r\n| limit 10"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (illusive)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'illusive'\n |where DeviceProduct =~ 'illusive'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'illusive'\n |where DeviceProduct =~ 'illusive'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine"
                },
                {
                  "title": "Step B. Forward Illusive Common Event Format (CEF) logs to Syslog agent",
                  "description": "1. Set your security solution to send Syslog messages in CEF format to the proxy machine. Make sure you to send the logs to port 514 TCP on the machine's IP address.\n> 2. Log onto the Illusive Console, and navigate to Settings->Reporting.\n> 3. Find Syslog Servers\n> 4. Supply the following information:\n>> 1. Host name: Linux Syslog agent IP address or FQDN host name\n>> 2. Port: 514\n>> 3. Protocol: TCP\n>> 4. Audit messages: Send audit messages to server\n> 5. To add the syslog server, click Add.\n> 6. For more information about how to add a new syslog server in the Illusive platform, please find the Illusive Networks Admin Guide in here: https://support.illusivenetworks.com/hc/en-us/sections/360002292119-Documentation-by-Version"
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "aa770f1e-4d05-477a-8dc1-b893772f3a46",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Illusive Networks"
      },
      "support": {
        "name": "Illusive Networks",
        "link": "https://www.illusivenetworks.com/technical-support/",
        "tier": "developer"
      }
    }
  },
  {
    "id": "ImpervaCloudWAFLogsCCFDefinition",
    "title": "Imperva Cloud WAF",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The Imperva WAF Cloud data connector provides the capability to ingest logs into Microsoft Sentinel using the Imperva Log Integration through AWS S3 Bucket. Refer to [Imperva WAF Cloud Log Integration](https://docs.imperva.com/bundle/cloud-application-security/page/settings/log-integration.htm) for more information.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "ImpervaCloudWAF Logs",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of Imperva Cloud WAF logs",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "ImpervaWAFCloudAPI",
    "title": "Imperva Cloud WAF",
    "publisher": "Imperva",
    "descriptionMarkdown": "The [Imperva Cloud WAF](https://www.imperva.com/resources/resource-library/datasheets/imperva-cloud-waf/) data connector provides the capability to integrate and ingest Web Application Firewall events into Microsoft Sentinel through the REST API. Refer to Log integration [documentation](https://docs.imperva.com/bundle/cloud-application-security/page/settings/log-integration.htm#Download) for more information. The connector provides ability to get events which helps to examine potential security risks, analyze your team's use of collaboration, diagnose configuration problems and more.",
    "additionalRequirementBanner": ">This data connector depends on a parser based on a Kusto Function to work as expected [**ImpervaWAFCloud**](https://aka.ms/sentinel-impervawafcloud-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ImpervaWAFCloud_CL",
        "baseQuery": "ImpervaWAFCloud_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Imperva Cloud WAF Events - All Activities",
        "query": "ImpervaWAFCloud\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "ImpervaWAFCloud_CL",
        "lastDataReceivedQuery": "ImpervaWAFCloud_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ImpervaWAFCloud_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(3d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "**ImpervaAPIID**, **ImpervaAPIKey**, **ImpervaLogServerURI** are required for the API. [See the documentation to learn more about Setup Log Integration process](https://docs.imperva.com/bundle/cloud-application-security/page/settings/log-integration.htm#Setuplogintegration). Check all [requirements and follow  the instructions](https://docs.imperva.com/bundle/cloud-application-security/page/settings/log-integration.htm#Setuplogintegration) for obtaining credentials. Please note that this connector uses CEF log event format. [More information](https://docs.imperva.com/bundle/cloud-application-security/page/more/log-file-structure.htm#Logfilestructure) about log format."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Imperva Cloud API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Functions App."
      },
      {
        "description": ">**NOTE:**This data connector depends on a parser based on a Kusto Function to work as expected [**ImpervaWAFCloud**](https://aka.ms/sentinel-impervawafcloud-parser) which is deployed with the Microsoft Sentinel Solution."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the Log Integration**\n\n [Follow the instructions](https://docs.imperva.com/bundle/cloud-application-security/page/settings/log-integration.htm#Setuplogintegration) to obtain the credentials. \n"
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Functions**\n\n>**IMPORTANT:** Before deploying the Workspace data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following).",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the Imperva Cloud WAF data connector using an ARM Template.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-impervawafcloud-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n> **NOTE:** Within the same resource group, you can't mix Windows and Linux apps in the same region. Select existing resource group without Windows apps in it or create new resource group.\n3. Enter the **ImpervaAPIID**, **ImpervaAPIKey**, **ImpervaLogServerURI** and deploy. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the Imperva Cloud WAF data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure functions development.\n\n1. Download the [Azure Functions App](https://aka.ms/sentinel-impervawafcloud-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. ImpervaCloudXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.11.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select ** New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tImpervaAPIID\n\t\tImpervaAPIKey\n\t\tImpervaLogServerURI\n\t\tWorkspaceID\n\t\tWorkspaceKey\n\t\tlogAnalyticsUri (optional)\n> - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n3. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "ImpervaWAFGateway",
    "title": "Imperva WAF Gateway",
    "publisher": "Imperva",
    "descriptionMarkdown": "The [Imperva](https://www.imperva.com) connector will allow you to quickly connect your Imperva WAF Gateway alerts to Azure Sentinel. This provides you additional insight into your organization's WAF traffic and improves your security operation capabilities.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ImpervaWAFGateway",
        "baseQuery": "CommonSecurityLog\n | where DeviceVendor == \"Imperva Inc.\"\n | where DeviceProduct == \"WAF Gateway\""
      }
    ],
    "sampleQueries": [
      {
        "description": "Find all log events of high priority.",
        "query": "CommonSecurityLog\n | where DeviceVendor == \"Imperva Inc.\" | where DeviceProduct == \"WAF Gateway\" | where LogSeverity == \"High\""
      },
      {
        "description": "Find all events that were blocked.",
        "query": "CommonSecurityLog\n | where DeviceVendor == \"Imperva Inc.\" | where DeviceProduct == \"WAF Gateway\" | where DeviceAction == \"block\""
      },
      {
        "description": "Find all events that were SQL Injection alerts.",
        "query": "CommonSecurityLog\n | where DeviceVendor == \"Imperva Inc.\" | where DeviceProduct == \"WAF Gateway\" | where Activity == \"sql-injection\""
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (ImpervaWAFGateway)",
        "lastDataReceivedQuery": "CommonSecurityLog\n | where DeviceVendor == \"Imperva Inc.\"\n | where DeviceProduct == \"WAF Gateway\"\n | summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n| where DeviceVendor == \"Imperva\"\n | where DeviceProduct == \"WAF Gateway\"\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Azure Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Azure Sentinel will use as the proxy between your security solution and Azure Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Azure Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Common Event Format (CEF) logs to Syslog agent",
        "description": "Set your security solution to send Syslog messages in CEF format to the proxy machine. Make sure you to send the logs to port 514 TCP on the machine's IP address."
      },
      {
        "title": "3. SecureSphere MX Configuration",
        "description": "This connector requires an Action Interface and Action Set to be created on the Imperva SecureSphere MX.  [Follow the steps](https://community.imperva.com/blogs/craig-burlingame1/2020/11/13/steps-for-enabling-imperva-waf-gateway-alert) to create the requirements.",
        "innerSteps": [
          {
            "title": "3.1 Create the Action Interface",
            "description": "Create a new Action Interface that contains the required parameters to send WAF alerts to Azure Sentinel."
          },
          {
            "title": "3.2 Create the Action Set ",
            "description": "Create a new Action Set that uses the Action Interface configured."
          },
          {
            "title": "3.3 Apply the Action Set",
            "description": "Apply the Action Set to any Security Policies you wish to have alerts for sent to Azure Sentinel."
          }
        ]
      },
      {
        "title": "4. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n",
        "innerSteps": [
          {
            "title": "4.1 Check for logs in the past 5 minutes using the following command.\n\nCommonSecurityLog | where DeviceVendor == \"Imperva Inc.\" | where DeviceProduct == \"WAF Gateway\" | where TimeGenerated == ago(5m)"
          }
        ]
      },
      {
        "title": "5. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "f8699c9c-536c-4d28-9049-d0c555dd8c8c",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Imperva"
      },
      "support": {
        "name": "Imperva",
        "link": "https://www.imperva.com/support/technical-support/",
        "tier": "developer"
      }
    }
  },
  {
    "id": "InfobloxCloudDataConnector",
    "title": "[Deprecated] Infoblox Cloud Data Connector via Legacy Agent",
    "publisher": "Infoblox",
    "descriptionMarkdown": "The Infoblox Cloud Data Connector allows you to easily connect your Infoblox BloxOne data with Microsoft Sentinel. By connecting your logs to Microsoft Sentinel, you can take advantage of search & correlation, alerting, and threat intelligence enrichment for each log.",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected called [**InfobloxCDC**](https://aka.ms/sentinel-InfobloxCloudDataConnector-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "InfobloxCDC",
        "baseQuery": "CommonSecurityLog\n| where DeviceVendor == \"Infoblox\" and DeviceProduct == \"Data Connector\""
      }
    ],
    "sampleQueries": [
      {
        "description": "Return all BloxOne Threat Defense (TD) security events logs",
        "query": "InfobloxCDC\n| where DeviceEventClassID has_cs \"RPZ\""
      },
      {
        "description": "Return all BloxOne Query/Response logs",
        "query": "InfobloxCDC\n| where DeviceEventClassID has_cs \"DNS\""
      },
      {
        "description": "Return all Category Filters security events logs",
        "query": "InfobloxCDC\n| where DeviceEventClassID has_cs \"RPZ\"\n | where AdditionalExtensions has_cs \"InfobloxRPZ=CAT_\""
      },
      {
        "description": "Return all Application Filters security events logs",
        "query": "InfobloxCDC\n| where DeviceEventClassID has_cs \"RPZ\"\n | where AdditionalExtensions has_cs \"InfobloxRPZ=APP_\""
      },
      {
        "description": "Return Top 10 TD Domains Hit Count",
        "query": "InfobloxCDC\n| where DeviceEventClassID has_cs \"RPZ\" \n| summarize count() by DestinationDnsDomain \n| top 10 by count_ desc"
      },
      {
        "description": "Return Top 10 TD Source IPs Hit Count",
        "query": "InfobloxCDC\n| where DeviceEventClassID has_cs \"RPZ\" \n| summarize count() by SourceIP \n| top 10 by count_ desc"
      },
      {
        "description": "Return Recently Created DHCP Leases",
        "query": "InfobloxCDC\n| where DeviceEventClassID == \"DHCP-LEASE-CREATE\""
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (InfobloxCDC)",
        "lastDataReceivedQuery": "InfobloxCDC\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "InfobloxCDC\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(3d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**IMPORTANT:** This data connector depends on a parser based on a Kusto Function to work as expected called [**InfobloxCDC**](https://aka.ms/sentinel-InfobloxCloudDataConnector-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "",
        "description": ">**IMPORTANT:** This Microsoft Sentinel data connector assumes an Infoblox Data Connector host has already been created and configured in the Infoblox Cloud Services Portal (CSP). As the [**Infoblox Data Connector**](https://docs.infoblox.com/display/BloxOneThreatDefense/Deploying+the+Data+Connector+Solution) is a feature of BloxOne Threat Defense, access to an appropriate BloxOne Threat Defense subscription is required. See this [**quick-start guide**](https://www.infoblox.com/wp-content/uploads/infoblox-deployment-guide-data-connector.pdf) for more information and licensing requirements.",
        "instructions": []
      },
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Configure Infoblox BloxOne to send Syslog data to the Infoblox Cloud Data Connector to forward to the Syslog agent",
        "description": "Follow the steps below to configure the Infoblox CDC to send BloxOne data to Microsoft Sentinel via the Linux Syslog agent.\n1. Navigate to **Manage > Data Connector**.\n2. Click the **Destination Configuration** tab at the top.\n3. Click **Create > Syslog**. \n - **Name**: Give the new Destination a meaningful **name**, such as **Microsoft-Sentinel-Destination**.\n - **Description**: Optionally give it a meaningful **description**.\n - **State**: Set the state to **Enabled**.\n - **Format**: Set the format to **CEF**.\n - **FQDN/IP**: Enter the IP address of the Linux device on which the Linux agent is installed.\n - **Port**: Leave the port number at **514**.\n - **Protocol**: Select desired protocol and CA certificate if applicable.\n - Click **Save & Close**.\n4. Click the **Traffic Flow Configuration** tab at the top.\n5. Click **Create**.\n - **Name**: Give the new Traffic Flow a meaningful **name**, such as **Microsoft-Sentinel-Flow**.\n - **Description**: Optionally give it a meaningful **description**. \n - **State**: Set the state to **Enabled**. \n - Expand the **Service Instance** section. \n    - **Service Instance**: Select your desired Service Instance for which the Data Connector service is enabled. \n - Expand the **Source Configuration** section.  \n    - **Source**: Select **BloxOne Cloud Source**. \n    - Select all desired **log types** you wish to collect. Currently supported log types are:\n      - Threat Defense Query/Response Log\n      - Threat Defense Threat Feeds Hits Log\n      - DDI Query/Response Log\n      - DDI DHCP Lease Log\n - Expand the **Destination Configuration** section.  \n    - Select the **Destination** you just created. \n - Click **Save & Close**. \n6. Allow the configuration some time to activate."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "InfobloxCloudDataConnectorAma",
    "title": "[Deprecated] Infoblox Cloud Data Connector via AMA",
    "publisher": "Infoblox",
    "descriptionMarkdown": "The Infoblox Cloud Data Connector allows you to easily connect your Infoblox BloxOne data with Microsoft Sentinel. By connecting your logs to Microsoft Sentinel, you can take advantage of search & correlation, alerting, and threat intelligence enrichment for each log.",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected called [**InfobloxCDC**](https://aka.ms/sentinel-InfobloxCloudDataConnector-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "InfobloxCDC",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Infoblox'\n |where DeviceProduct =~ 'Data Connector'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "Return all BloxOne Threat Defense (TD) security events logs",
        "query": "InfobloxCDC\n| where DeviceEventClassID has_cs \"RPZ\""
      },
      {
        "description": "Return all BloxOne Query/Response logs",
        "query": "InfobloxCDC\n| where DeviceEventClassID has_cs \"DNS\""
      },
      {
        "description": "Return all Category Filters security events logs",
        "query": "InfobloxCDC\n| where DeviceEventClassID has_cs \"RPZ\"\n | where AdditionalExtensions has_cs \"InfobloxRPZ=CAT_\""
      },
      {
        "description": "Return all Application Filters security events logs",
        "query": "InfobloxCDC\n| where DeviceEventClassID has_cs \"RPZ\"\n | where AdditionalExtensions has_cs \"InfobloxRPZ=APP_\""
      },
      {
        "description": "Return Top 10 TD Domains Hit Count",
        "query": "InfobloxCDC\n| where DeviceEventClassID has_cs \"RPZ\" \n| summarize count() by DestinationDnsDomain \n| top 10 by count_ desc"
      },
      {
        "description": "Return Top 10 TD Source IPs Hit Count",
        "query": "InfobloxCDC\n| where DeviceEventClassID has_cs \"RPZ\" \n| summarize count() by SourceIP \n| top 10 by count_ desc"
      },
      {
        "description": "Return Recently Created DHCP Leases",
        "query": "InfobloxCDC\n| where DeviceEventClassID == \"DHCP-LEASE-CREATE\""
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (InfobloxCDC)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Infoblox'\n |where DeviceProduct =~ 'Data Connector'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'Infoblox'\n |where DeviceProduct =~ 'Data Connector'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**IMPORTANT:** This data connector depends on a parser based on a Kusto Function to work as expected called [**InfobloxCDC**](https://aka.ms/sentinel-InfobloxCloudDataConnector-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "",
        "description": ">**IMPORTANT:** This Microsoft Sentinel data connector assumes an Infoblox Data Connector host has already been created and configured in the Infoblox Cloud Services Portal (CSP). As the [**Infoblox Data Connector**](https://docs.infoblox.com/display/BloxOneThreatDefense/Deploying+the+Data+Connector+Solution) is a feature of BloxOne Threat Defense, access to an appropriate BloxOne Threat Defense subscription is required. See this [**quick-start guide**](https://www.infoblox.com/wp-content/uploads/infoblox-deployment-guide-data-connector.pdf) for more information and licensing requirements.",
        "instructions": [
          {
            "parameters": {
              "title": "1. Follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note: CEF logs are collected only from Linux Agents_\n\n1. Navigate to your **Microsoft Sentinel workspace > Data connectors** blade.\n\n2. Search for the **Common Event Format (CEF) via AMA** data connector and open it.\n\n3. Ensure there is no existing DCR configured to collect required facility of logs as it may cause log duplication. Create a new **DCR (Data Collection Rule)**.\n\n\t_Note: It is recommended to install the AMA agent v1.27 at minimum. [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplication._\n\n4. Run the command provided in the **CEF via AMA data connector** page to configure the CEF collector on the machine."
                },
                {
                  "title": "Step B. Configure Infoblox BloxOne to send Syslog data to the Infoblox Cloud Data Connector to forward to the Syslog agent",
                  "description": "Follow the steps below to configure the Infoblox CDC to send BloxOne data to Microsoft Sentinel via the Linux Syslog agent.\n1. Navigate to **Manage > Data Connector**.\n2. Click the **Destination Configuration** tab at the top.\n3. Click **Create > Syslog**. \n - **Name**: Give the new Destination a meaningful **name**, such as **Microsoft-Sentinel-Destination**.\n - **Description**: Optionally give it a meaningful **description**.\n - **State**: Set the state to **Enabled**.\n - **Format**: Set the format to **CEF**.\n - **FQDN/IP**: Enter the IP address of the Linux device on which the Linux agent is installed.\n - **Port**: Leave the port number at **514**.\n - **Protocol**: Select desired protocol and CA certificate if applicable.\n - Click **Save & Close**.\n4. Click the **Traffic Flow Configuration** tab at the top.\n5. Click **Create**.\n - **Name**: Give the new Traffic Flow a meaningful **name**, such as **Microsoft-Sentinel-Flow**.\n - **Description**: Optionally give it a meaningful **description**. \n - **State**: Set the state to **Enabled**. \n - Expand the **Service Instance** section. \n    - **Service Instance**: Select your desired Service Instance for which the Data Connector service is enabled. \n - Expand the **Source Configuration** section.  \n    - **Source**: Select **BloxOne Cloud Source**. \n    - Select all desired **log types** you wish to collect. Currently supported log types are:\n      - Threat Defense Query/Response Log\n      - Threat Defense Threat Feeds Hits Log\n      - DDI Query/Response Log\n      - DDI DHCP Lease Log\n - Expand the **Destination Configuration** section.  \n    - Select the **Destination** you just created. \n - Click **Save & Close**. \n6. Allow the configuration some time to activate."
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "InfobloxCloudDataConnectorAma",
    "title": "[Recommended] Infoblox Cloud Data Connector via AMA",
    "publisher": "Infoblox",
    "descriptionMarkdown": "The Infoblox Cloud Data Connector allows you to easily connect your Infoblox data with Microsoft Sentinel. By connecting your logs to Microsoft Sentinel, you can take advantage of search & correlation, alerting, and threat intelligence enrichment for each log.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CommonSecurityLog",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Infoblox'\n |where DeviceProduct =~ 'Data Connector'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Infoblox'\n |where DeviceProduct =~ 'Data Connector'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'Infoblox'\n |where DeviceProduct =~ 'Data Connector'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "sampleQueries": [
      {
        "description": "Return all Block DNS Query/Response logs",
        "query": "CommonSecurityLog\n| where DeviceEventClassID has_cs \"RPZ\""
      },
      {
        "description": "Return all DNS Query/Response logs",
        "query": "CommonSecurityLog\n| where DeviceEventClassID has_cs \"DNS\""
      },
      {
        "description": "Return all DHCP Query/Response logs",
        "query": "CommonSecurityLog\n| where DeviceEventClassID has_cs \"DHCP\""
      },
      {
        "description": "Return all Service Logs Query/Response logs",
        "query": "CommonSecurityLog\n| where DeviceEventClassID has_cs \"Service\""
      },
      {
        "description": "Return all Audit Query/Response logs",
        "query": "CommonSecurityLog\n| where DeviceEventClassID has_cs \"Audit\""
      },
      {
        "description": "Return all Category Filters security events logs",
        "query": "CommonSecurityLog\n| where DeviceEventClassID has_cs \"RPZ\"\n | where AdditionalExtensions has_cs \"InfobloxRPZ=CAT_\""
      },
      {
        "description": "Return all Application Filters security events logs",
        "query": "CommonSecurityLog\n| where DeviceEventClassID has_cs \"RPZ\"\n | where AdditionalExtensions has_cs \"InfobloxRPZ=APP_\""
      },
      {
        "description": "Return Top 10 TD Domains Hit Count",
        "query": "CommonSecurityLog\n| where DeviceEventClassID has_cs \"RPZ\" \n| summarize count() by DestinationDnsDomain \n| top 10 by count_ desc"
      },
      {
        "description": "Return Top 10 TD Source IPs Hit Count",
        "query": "CommonSecurityLog\n| where DeviceEventClassID has_cs \"RPZ\" \n| summarize count() by SourceIP \n| top 10 by count_ desc"
      },
      {
        "description": "Return Recently Created DHCP Leases",
        "query": "CommonSecurityLog\n| where DeviceEventClassID == \"DHCP-LEASE-CREATE\""
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "description": ">**IMPORTANT:** This Microsoft Sentinel data connector assumes an Infoblox Data Connector host has already been created and configured in the Infoblox Cloud Services Portal (CSP). As the [**Infoblox Data Connector**](https://docs.infoblox.com/display/BloxOneThreatDefense/Deploying+the+Data+Connector+Solution) is a feature of Threat Defense, access to an appropriate Threat Defense subscription is required. See this [**quick-start guide**](https://www.infoblox.com/wp-content/uploads/infoblox-deployment-guide-data-connector.pdf) for more information and licensing requirements.",
        "instructions": []
      },
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Configure Infoblox to send Syslog data to the Infoblox Cloud Data Connector to forward to the Syslog agent",
        "description": "Follow the steps below to configure the Infoblox CDC to send  data to Microsoft Sentinel via the Linux Syslog agent.\n1. Navigate to **Manage > Data Connector**.\n2. Click the **Destination Configuration** tab at the top.\n3. Click **Create > Syslog**. \n - **Name**: Give the new Destination a meaningful **name**, such as **Microsoft-Sentinel-Destination**.\n - **Description**: Optionally give it a meaningful **description**.\n - **State**: Set the state to **Enabled**.\n - **Format**: Set the format to **CEF**.\n - **FQDN/IP**: Enter the IP address of the Linux device on which the Linux agent is installed.\n - **Port**: Leave the port number at **514**.\n - **Protocol**: Select desired protocol and CA certificate if applicable.\n - Click **Save & Close**.\n4. Click the **Traffic Flow Configuration** tab at the top.\n5. Click **Create**.\n - **Name**: Give the new Traffic Flow a meaningful **name**, such as **Microsoft-Sentinel-Flow**.\n - **Description**: Optionally give it a meaningful **description**. \n - **State**: Set the state to **Enabled**. \n - Expand the **Service Instance** section. \n    - **Service Instance**: Select your desired Service Instance for which the Data Connector service is enabled. \n - Expand the **Source Configuration** section.  \n    - **Source**: Select **BloxOne Cloud Source**. \n    - Select all desired **log types** you wish to collect. Currently supported log types are:\n      - Threat Defense Query/Response Log\n      - Threat Defense Threat Feeds Hits Log\n      - DDI Query/Response Log\n      - DDI DHCP Lease Log\n - Expand the **Destination Configuration** section.  \n    - Select the **Destination** you just created. \n - Click **Save & Close**. \n6. Allow the configuration some time to activate."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "InfobloxDataConnector",
    "title": "Infoblox Data Connector via REST API",
    "publisher": "Infoblox",
    "descriptionMarkdown": "The Infoblox Data Connector allows you to easily connect your Infoblox TIDE data and Dossier data with Microsoft Sentinel. By connecting your data to Microsoft Sentinel, you can take advantage of search & correlation, alerting, and threat intelligence enrichment for each log.",
    "graphQueries": [
      {
        "metricName": "Failed Indicator time range received",
        "legend": "Failed_Range_To_Ingest",
        "baseQuery": "Failed_Range_To_Ingest_CL"
      },
      {
        "metricName": "Failed Indicators Range data received",
        "legend": "Infoblox_Failed_Indicators",
        "baseQuery": "Infoblox_Failed_Indicators_CL"
      },
      {
        "metricName": "Dossier whois source data received",
        "legend": "dossier_whois",
        "baseQuery": "dossier_whois_CL"
      },
      {
        "metricName": "Dossier whitelist source data received",
        "legend": "dossier_whitelist",
        "baseQuery": "dossier_whitelist_CL"
      },
      {
        "metricName": "Dossier tld risk source data received",
        "legend": "dossier_tld_risk",
        "baseQuery": "dossier_tld_risk_CL"
      },
      {
        "metricName": "Dossier threat actor source data received",
        "legend": "dossier_threat_actor",
        "baseQuery": "dossier_threat_actor_CL"
      },
      {
        "metricName": "Dossier rpz feeds records source data received",
        "legend": "dossier_rpz_feeds_records",
        "baseQuery": "dossier_rpz_feeds_records_CL"
      },
      {
        "metricName": "Dossier rpz feeds source data received",
        "legend": "dossier_rpz_feeds",
        "baseQuery": "dossier_rpz_feeds_CL"
      },
      {
        "metricName": "Dossier nameserver matches source data received",
        "legend": "dossier_nameserver_matches",
        "baseQuery": "dossier_nameserver_matches_CL"
      },
      {
        "metricName": "Dossier nameserver source data received",
        "legend": "dossier_nameserver",
        "baseQuery": "dossier_nameserver_CL"
      },
      {
        "metricName": "Dossier malware analysis v3 source data received",
        "legend": "dossier_malware_analysis_v3",
        "baseQuery": "dossier_malware_analysis_v3_CL"
      },
      {
        "metricName": "Dossier inforank source data received",
        "legend": "dossier_inforank",
        "baseQuery": "dossier_inforank_CL"
      },
      {
        "metricName": "Dossier infoblox web cat source data received",
        "legend": "dossier_infoblox_web_cat",
        "baseQuery": "dossier_infoblox_web_cat_CL"
      },
      {
        "metricName": "Dossier geo source data received",
        "legend": "dossier_geo",
        "baseQuery": "dossier_geo_CL"
      },
      {
        "metricName": "Dossier dns source data received",
        "legend": "dossier_dns",
        "baseQuery": "dossier_dns_CL"
      },
      {
        "metricName": "Dossier atp threat source data received",
        "legend": "dossier_atp_threat",
        "baseQuery": "dossier_atp_threat_CL"
      },
      {
        "metricName": "Dossier atp source data received",
        "legend": "dossier_atp",
        "baseQuery": "dossier_atp_CL"
      },
      {
        "metricName": "Dossier ptr source data received",
        "legend": "dossier_ptr",
        "baseQuery": "dossier_ptr_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Failed Indicator time range received",
        "query": "Failed_Range_To_Ingest_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Failed Indicators Range Data",
        "query": "Infoblox_Failed_Indicators_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Dossier whois data source",
        "query": "dossier_whois_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Dossier whitelist data source",
        "query": "dossier_whitelist_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Dossier tld risk data source",
        "query": "dossier_tld_risk_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Dossier threat actor data source",
        "query": "dossier_threat_actor_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Dossier rpz feeds records data source",
        "query": "dossier_rpz_feeds_records_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Dossier rpz feeds data source",
        "query": "dossier_rpz_feeds_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Dossier nameserver matches data source",
        "query": "dossier_nameserver_matches_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Dossier nameserver data source",
        "query": "dossier_nameserver_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Dossier malware analysis v3 data source",
        "query": "dossier_malware_analysis_v3_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Dossier inforank data source",
        "query": "dossier_inforank_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Dossier infoblox web cat data source",
        "query": "dossier_infoblox_web_cat_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Dossier geo data source",
        "query": "dossier_geo_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Dossier dns data source",
        "query": "dossier_dns_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Dossier atp threat data source",
        "query": "dossier_atp_threat_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Dossier atp data source",
        "query": "dossier_atp_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Dossier ptr data source",
        "query": "dossier_ptr_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Failed_Range_To_Ingest_CL",
        "lastDataReceivedQuery": "Failed_Range_To_Ingest_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      },
      {
        "name": "Infoblox_Failed_Indicators_CL",
        "lastDataReceivedQuery": "Infoblox_Failed_Indicators_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      },
      {
        "name": "dossier_whois_CL",
        "lastDataReceivedQuery": "dossier_whois_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      },
      {
        "name": "dossier_whitelist_CL",
        "lastDataReceivedQuery": "dossier_whitelist_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      },
      {
        "name": "dossier_tld_risk_CL",
        "lastDataReceivedQuery": "dossier_tld_risk_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      },
      {
        "name": "dossier_threat_actor_CL",
        "lastDataReceivedQuery": "dossier_threat_actor_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      },
      {
        "name": "dossier_rpz_feeds_records_CL",
        "lastDataReceivedQuery": "dossier_rpz_feeds_records_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      },
      {
        "name": "dossier_rpz_feeds_CL",
        "lastDataReceivedQuery": "dossier_rpz_feeds_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      },
      {
        "name": "dossier_nameserver_matches_CL",
        "lastDataReceivedQuery": "dossier_nameserver_matches_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      },
      {
        "name": "dossier_nameserver_CL",
        "lastDataReceivedQuery": "dossier_nameserver_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      },
      {
        "name": "dossier_malware_analysis_v3_CL",
        "lastDataReceivedQuery": "dossier_malware_analysis_v3_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      },
      {
        "name": "dossier_inforank_CL",
        "lastDataReceivedQuery": "dossier_inforank_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      },
      {
        "name": "dossier_infoblox_web_cat_CL",
        "lastDataReceivedQuery": "dossier_infoblox_web_cat_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      },
      {
        "name": "dossier_geo_CL",
        "lastDataReceivedQuery": "dossier_geo_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      },
      {
        "name": "dossier_dns_CL",
        "lastDataReceivedQuery": "dossier_dns_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      },
      {
        "name": "dossier_atp_threat_CL",
        "lastDataReceivedQuery": "dossier_atp_threat_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      },
      {
        "name": "dossier_atp_CL",
        "lastDataReceivedQuery": "dossier_atp_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      },
      {
        "name": "dossier_ptr_CL",
        "lastDataReceivedQuery": "dossier_ptr_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Failed_Range_To_Ingest_CL\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(3d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Infoblox_Failed_Indicators_CL\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(3d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "dossier_whois_CL\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(3d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "dossier_whitelist_CL\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(3d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "dossier_tld_risk_CL\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(3d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "dossier_threat_actor_CL\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(3d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "dossier_rpz_feeds_records_CL\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(3d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "dossier_rpz_feeds_CL\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(3d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "dossier_nameserver_matches_CL\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(3d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "dossier_nameserver_CL\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(3d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "dossier_malware_analysis_v3_CL\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(3d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "dossier_inforank_CL\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(3d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "dossier_infoblox_web_cat_CL\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(3d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "dossier_geo_CL\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(3d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "dossier_dns_CL\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(3d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "dossier_atp_threat_CL\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(3d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "dossier_atp_CL\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(3d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "dossier_ptr_CL\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(3d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Azure Subscription",
          "description": "Azure Subscription with owner role is required to register an application in Microsoft Entra ID and assign role of contributor to app in resource group."
        },
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "**Infoblox API Key** is required.  See the documentation to learn more about API on the [Rest API reference](https://csp.infoblox.com/apidoc?url=https://csp.infoblox.com/apidoc/docs/Infrastructure#/Services/ServicesRead)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Infoblox API to create Threat Indicators for TIDE and pull Dossier data into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1 - App Registration steps for the Application in Microsoft Entra ID**\n\n This integration requires an App registration in the Azure portal. Follow the steps in this section to create a new application in Microsoft Entra ID:\n 1. Sign in to the [Azure portal](https://portal.azure.com/).\n 2. Search for and select **Microsoft Entra ID**.\n 3. Under **Manage**, select **App registrations > New registration**.\n 4. Enter a display **Name** for your application.\n 5. Select **Register** to complete the initial app registration.\n 6. When registration finishes, the Azure portal displays the app registration's Overview pane. You see the **Application (client) ID** and **Tenant ID**. The client ID and Tenant ID is required as configuration parameters for the execution of the TriggersSync playbook. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app)"
      },
      {
        "title": "",
        "description": "**STEP 2 - Add a client secret for application in Microsoft Entra ID**\n\n Sometimes called an application password, a client secret is a string value required for the execution of TriggersSync playbook. Follow the steps in this section to create a new Client Secret:\n 1. In the Azure portal, in **App registrations**, select your application.\n 2. Select **Certificates & secrets > Client secrets > New client secret**.\n 3. Add a description for your client secret.\n 4. Select an expiration for the secret or specify a custom lifetime. Limit is 24 months.\n 5. Select **Add**. \n 6. *Record the secret's value for use in your client application code. This secret value is never displayed again after you leave this page.* The secret value is required as configuration parameter for the execution of TriggersSync playbook. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret)"
      },
      {
        "title": "",
        "description": "**STEP 3 - Assign role of Contributor to application in Microsoft Entra ID**\n\n Follow the steps in this section to assign the role:\n 1. In the Azure portal, Go to **Resource Group** and select your resource group.\n 2. Go to **Access control (IAM)** from left panel.\n 3. Click on **Add**, and then select **Add role assignment**.\n 4. Select **Contributor** as role and click on next.\n 5. In **Assign access to**, select `User, group, or service principal`.\n 6. Click on **add members** and type **your app name** that you have created and select it.\n 7. Now click on **Review + assign** and then again click on **Review + assign**. \n\n> **Reference link:** [https://learn.microsoft.com/azure/role-based-access-control/role-assignments-portal](https://learn.microsoft.com/azure/role-based-access-control/role-assignments-portal)"
      },
      {
        "title": "",
        "description": "**STEP 4 - Steps to generate the Infoblox API Credentials**\n\n Follow these instructions to generate Infoblox API Key.\n In the [Infoblox Cloud Services Portal](https://csp.infoblox.com/atlas/app/welcome), generate an API Key and copy it somewhere safe to use in the next step. You can find instructions on how to create API keys [**here**](https://docs.infoblox.com/space/BloxOneThreatDefense/230394187/How+Do+I+Create+an+API+Key%3F)."
      },
      {
        "title": "",
        "description": "**STEP 5 - Steps to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Infoblox data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following) readily available.., as well as the Infoblox API Authorization Credentials",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the Infoblox Data connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-infoblox-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the below information : \n\t\tAzure Tenant Id \n\t\tAzure Client Id \n\t\tAzure Client Secret \n\t\tInfoblox API Token \n\t\tInfoblox Base URL \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tLog Level (Default: INFO) \n\t\tConfidence \n\t\tThreat Level \n\t\tApp Insights Workspace Resource ID \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      }
    ]
  },
  {
    "id": "InfobloxNIOS",
    "title": "[Deprecated] Infoblox NIOS",
    "publisher": "Infoblox",
    "descriptionMarkdown": "The [Infoblox Network Identity Operating System (NIOS)](https://www.infoblox.com/glossary/network-identity-operating-system-nios/) connector allows you to easily connect your Infoblox NIOS logs with Microsoft Sentinel, to view dashboards, create custom alerts, and improve investigation. This gives you more insight into your organization's network and improves your security operation capabilities.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "InfobloxNIOS",
        "baseQuery": "Infoblox"
      }
    ],
    "sampleQueries": [
      {
        "description": "Total Count by DHCP Request Message Types",
        "query": "union isfuzzy=true \n Infoblox_dhcpdiscover,Infoblox_dhcprequest,Infoblox_dhcpinform \n| summarize count() by Log_Type"
      },
      {
        "description": "Top 5 Source IP address",
        "query": "Infoblox_dnsclient \n | summarize count() by SrcIpAddr \n | top 10 by count_ desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog (InfobloxNIOS)",
        "lastDataReceivedQuery": "Infoblox \n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Infoblox \n | where TimeGenerated > ago(3d)\n |take 1 \n | project IsConnected = true"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "write permission is required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "Infoblox NIOS",
          "description": "must be configured to export logs via Syslog"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias Infoblox and load the function code or click [here](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Infoblox%20NIOS/Parser/Infoblox.yaml), on the second line of the query, enter any unique identifiers for the logstream. The function usually takes 10-15 minutes to activate after solution installation/update.",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux",
        "description": "Typically, you should install the agent on a different computer from the one on which the logs are generated.\n\n>  Syslog logs are collected only from **Linux** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Configure the facilities you want to collect and their severities.\n 1. Under workspace advanced settings **Configuration**, select **Data** and then **Syslog**.\n 2. Select **Apply below configuration to my machines** and select the facilities and severities.\n 3.  Click **Save**.",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenSyslogSettings"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "3. Configure and connect the Infoblox NIOS",
        "description": "[Follow these instructions](https://www.infoblox.com/wp-content/uploads/infoblox-deployment-guide-slog-and-snmp-configuration-for-nios.pdf) to enable syslog forwarding of Infoblox NIOS Logs. Use the IP address or hostname for the Linux device with the Linux agent installed as the Destination IP address."
      },
      {
        "title": "4. Configure the Sentinel parser",
        "description": "Update the watchlist 'Sources_by_Source' with the hostname(s) of your Infoblox device(s). Set SourceType to 'InfobloxNIOS' and Source to the value of 'Computer' seen in the logs seen in Syslog table."
      }
    ]
  },
  {
    "id": "InfobloxSOCInsightsDataConnector_AMA",
    "title": "[Recommended] Infoblox SOC Insight Data Connector via AMA",
    "publisher": "Infoblox",
    "descriptionMarkdown": "The Infoblox SOC Insight Data Connector allows you to easily connect your Infoblox BloxOne SOC Insight data with Microsoft Sentinel. By connecting your logs to Microsoft Sentinel, you can take advantage of search & correlation, alerting, and threat intelligence enrichment for each log. \n\nThis data connector ingests Infoblox SOC Insight CDC logs into your Log Analytics Workspace using the new Azure Monitor Agent. Learn more about ingesting using the new Azure Monitor Agent [here](https://learn.microsoft.com/azure/sentinel/connect-cef-ama). **Microsoft recommends using this Data Connector.**",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected called [**InfobloxCDC_SOCInsights**](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Infoblox%20SOC%20Insights/Parsers/InfobloxCDC_SOCInsights.yaml) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "InfobloxCDC_SOCInsights",
        "baseQuery": "CommonSecurityLog\n| where DeviceVendor =~ \"Infoblox\" and DeviceProduct =~ \"Data Connector\" and DeviceEventClassID =~ \"BloxOne-InsightsNotification-Log\"\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "Return all logs involving DNS Tunneling",
        "query": "InfobloxCDC_SOCInsights\n| where ThreatType == \"DNS Tunneling\""
      },
      {
        "description": "Return all logs involving a configuration issue",
        "query": "InfobloxCDC_SOCInsights\n| where ThreatClass == \"TI-CONFIGURATIONISSUE\""
      },
      {
        "description": "Return all high threat level logs",
        "query": "InfobloxCDC_SOCInsights\n| where ThreatLevel == \"High\""
      },
      {
        "description": "Return raised status logs",
        "query": "InfobloxCDC_SOCInsights\n| where Status == \"RAISED\""
      },
      {
        "description": "Return logs involving a high amount of unblocked DNS hits",
        "query": "InfobloxCDC_SOCInsights\n| where NotBlockedCount >= 100"
      },
      {
        "description": "Return each Insight by ThreatFamily",
        "query": "InfobloxCDC_SOCInsights\n| summarize dcount(InfobloxInsightID) by ThreatFamily"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (InfobloxCDC_SOCInsights)",
        "lastDataReceivedQuery": "CommonSecurityLog\n| where DeviceVendor =~ \"Infoblox\" and DeviceProduct =~ \"Data Connector\" and DeviceEventClassID =~ \"BloxOne-InsightsNotification-Log\"\n |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n| where DeviceVendor =~ \"Infoblox\" and DeviceProduct =~ \"Data Connector\" and DeviceEventClassID =~ \"BloxOne-InsightsNotification-Log\"\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed. [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Workspace Keys",
        "description": "In order to use the playbooks as part of this solution, find your **Workspace ID** and **Workspace Primary Key** below for your convenience.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Workspace Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Parsers",
        "description": ">This data connector depends on a parser based on a Kusto Function to work as expected called [**InfobloxCDC_SOCInsights**](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Infoblox%20SOC%20Insights/Parsers/InfobloxCDC_SOCInsights.yaml) which is deployed with the Microsoft Sentinel Solution."
      },
      {
        "title": "SOC Insights",
        "description": ">This data connector assumes you have access to Infoblox BloxOne Threat Defense SOC Insights. You can find more information about SOC Insights [**here**](https://docs.infoblox.com/space/BloxOneThreatDefense/501514252/SOC+Insights)."
      },
      {
        "title": "Infoblox Cloud Data Connector",
        "description": ">This data connector assumes an Infoblox Data Connector host has already been created and configured in the Infoblox Cloud Services Portal (CSP). As the [**Infoblox Data Connector**](https://docs.infoblox.com/display/BloxOneThreatDefense/Deploying+the+Data+Connector+Solution) is a feature of BloxOne Threat Defense, access to an appropriate BloxOne Threat Defense subscription is required. See this [**quick-start guide**](https://www.infoblox.com/wp-content/uploads/infoblox-deployment-guide-data-connector.pdf) for more information and licensing requirements.",
        "instructions": [
          {
            "parameters": {
              "title": "Follow the steps below to configure this data connector",
              "instructionSteps": [
                {
                  "title": "A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note: CEF logs are collected only from Linux Agents_\n\n1. Navigate to your **Microsoft Sentinel workspace > Data connectors** blade.\n\n2. Search for the **Common Event Format (CEF) via AMA** data connector and open it.\n\n3. Ensure there is no existing DCR configured to collect required facility of logs as it may cause log duplication. Create a new **DCR (Data Collection Rule)**.\n\n\t_Note: It is recommended to install the AMA agent v1.27 at minimum. [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplication._\n\n4. Run the command provided in the **Common Event Format (CEF) via AMA** data connector page to configure the CEF collector on the machine."
                },
                {
                  "title": "B. Within the Infoblox Cloud Services Portal, configure Infoblox BloxOne to send CEF Syslog data to the Infoblox Cloud Data Connector to forward to the Syslog agent",
                  "description": "Follow the steps below to configure the Infoblox CDC to send BloxOne data to Microsoft Sentinel via the Linux Syslog agent.\n1. Navigate to **Manage > Data Connector**.\n2. Click the **Destination Configuration** tab at the top.\n3. Click **Create > Syslog**. \n - **Name**: Give the new Destination a meaningful **name**, such as **Microsoft-Sentinel-Destination**.\n - **Description**: Optionally give it a meaningful **description**.\n - **State**: Set the state to **Enabled**.\n - **Format**: Set the format to **CEF**.\n - **FQDN/IP**: Enter the IP address of the Linux device on which the Linux agent is installed.\n - **Port**: Leave the port number at **514**.\n - **Protocol**: Select desired protocol and CA certificate if applicable.\n - Click **Save & Close**.\n4. Click the **Traffic Flow Configuration** tab at the top.\n5. Click **Create**.\n - **Name**: Give the new Traffic Flow a meaningful **name**, such as **Microsoft-Sentinel-Flow**.\n - **Description**: Optionally give it a meaningful **description**. \n - **State**: Set the state to **Enabled**. \n - Expand the **Service Instance** section. \n    - **Service Instance**: Select your desired Service Instance for which the Data Connector service is enabled. \n - Expand the **Source Configuration** section.  \n    - **Source**: Select **BloxOne Cloud Source**. \n    - Select the **Internal Notifications** Log Type.\n - Expand the **Destination Configuration** section.  \n    - Select the **Destination** you just created. \n - Click **Save & Close**. \n6. Allow the configuration some time to activate."
                },
                {
                  "title": "C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "InfobloxSOCInsightsDataConnector_AMA",
    "title": "[Deprecated] Infoblox SOC Insight Data Connector via AMA",
    "publisher": "Infoblox",
    "descriptionMarkdown": "The Infoblox SOC Insight Data Connector allows you to easily connect your Infoblox BloxOne SOC Insight data with Microsoft Sentinel. By connecting your logs to Microsoft Sentinel, you can take advantage of search & correlation, alerting, and threat intelligence enrichment for each log. \n\nThis data connector ingests Infoblox SOC Insight CDC logs into your Log Analytics Workspace using the new Azure Monitor Agent. Learn more about ingesting using the new Azure Monitor Agent [here](https://learn.microsoft.com/azure/sentinel/connect-cef-ama). **Microsoft recommends using this Data Connector.**",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected called [**InfobloxCDC_SOCInsights**](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Infoblox%20SOC%20Insights/Parsers/InfobloxCDC_SOCInsights.yaml) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "InfobloxCDC_SOCInsights",
        "baseQuery": "CommonSecurityLog\n| where DeviceVendor =~ \"Infoblox\" and DeviceProduct =~ \"Data Connector\" and DeviceEventClassID =~ \"BloxOne-InsightsNotification-Log\"\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "Return all logs involving DNS Tunneling",
        "query": "InfobloxCDC_SOCInsights\n| where ThreatType == \"DNS Tunneling\""
      },
      {
        "description": "Return all logs involving a configuration issue",
        "query": "InfobloxCDC_SOCInsights\n| where ThreatClass == \"TI-CONFIGURATIONISSUE\""
      },
      {
        "description": "Return all high threat level logs",
        "query": "InfobloxCDC_SOCInsights\n| where ThreatLevel == \"High\""
      },
      {
        "description": "Return raised status logs",
        "query": "InfobloxCDC_SOCInsights\n| where Status == \"RAISED\""
      },
      {
        "description": "Return logs involving a high amount of unblocked DNS hits",
        "query": "InfobloxCDC_SOCInsights\n| where NotBlockedCount >= 100"
      },
      {
        "description": "Return each Insight by ThreatFamily",
        "query": "InfobloxCDC_SOCInsights\n| summarize dcount(InfobloxInsightID) by ThreatFamily"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (InfobloxCDC_SOCInsights)",
        "lastDataReceivedQuery": "CommonSecurityLog\n| where DeviceVendor =~ \"Infoblox\" and DeviceProduct =~ \"Data Connector\" and DeviceEventClassID =~ \"BloxOne-InsightsNotification-Log\"\n |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n| where DeviceVendor =~ \"Infoblox\" and DeviceProduct =~ \"Data Connector\" and DeviceEventClassID =~ \"BloxOne-InsightsNotification-Log\"\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed. [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Workspace Keys",
        "description": "In order to use the playbooks as part of this solution, find your **Workspace ID** and **Workspace Primary Key** below for your convenience.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Workspace Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Parsers",
        "description": ">This data connector depends on a parser based on a Kusto Function to work as expected called [**InfobloxCDC_SOCInsights**](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Infoblox%20SOC%20Insights/Parsers/InfobloxCDC_SOCInsights.yaml) which is deployed with the Microsoft Sentinel Solution."
      },
      {
        "title": "SOC Insights",
        "description": ">This data connector assumes you have access to Infoblox BloxOne Threat Defense SOC Insights. You can find more information about SOC Insights [**here**](https://docs.infoblox.com/space/BloxOneThreatDefense/501514252/SOC+Insights)."
      },
      {
        "title": "Infoblox Cloud Data Connector",
        "description": ">This data connector assumes an Infoblox Data Connector host has already been created and configured in the Infoblox Cloud Services Portal (CSP). As the [**Infoblox Data Connector**](https://docs.infoblox.com/display/BloxOneThreatDefense/Deploying+the+Data+Connector+Solution) is a feature of BloxOne Threat Defense, access to an appropriate BloxOne Threat Defense subscription is required. See this [**quick-start guide**](https://www.infoblox.com/wp-content/uploads/infoblox-deployment-guide-data-connector.pdf) for more information and licensing requirements.",
        "instructions": [
          {
            "parameters": {
              "title": "Follow the steps below to configure this data connector",
              "instructionSteps": [
                {
                  "title": "A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note: CEF logs are collected only from Linux Agents_\n\n1. Navigate to your **Microsoft Sentinel workspace > Data connectors** blade.\n\n2. Search for the **Common Event Format (CEF) via AMA** data connector and open it.\n\n3. Ensure there is no existing DCR configured to collect required facility of logs as it may cause log duplication. Create a new **DCR (Data Collection Rule)**.\n\n\t_Note: It is recommended to install the AMA agent v1.27 at minimum. [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplication._\n\n4. Run the command provided in the **Common Event Format (CEF) via AMA** data connector page to configure the CEF collector on the machine."
                },
                {
                  "title": "B. Within the Infoblox Cloud Services Portal, configure Infoblox BloxOne to send CEF Syslog data to the Infoblox Cloud Data Connector to forward to the Syslog agent",
                  "description": "Follow the steps below to configure the Infoblox CDC to send BloxOne data to Microsoft Sentinel via the Linux Syslog agent.\n1. Navigate to **Manage > Data Connector**.\n2. Click the **Destination Configuration** tab at the top.\n3. Click **Create > Syslog**. \n - **Name**: Give the new Destination a meaningful **name**, such as **Microsoft-Sentinel-Destination**.\n - **Description**: Optionally give it a meaningful **description**.\n - **State**: Set the state to **Enabled**.\n - **Format**: Set the format to **CEF**.\n - **FQDN/IP**: Enter the IP address of the Linux device on which the Linux agent is installed.\n - **Port**: Leave the port number at **514**.\n - **Protocol**: Select desired protocol and CA certificate if applicable.\n - Click **Save & Close**.\n4. Click the **Traffic Flow Configuration** tab at the top.\n5. Click **Create**.\n - **Name**: Give the new Traffic Flow a meaningful **name**, such as **Microsoft-Sentinel-Flow**.\n - **Description**: Optionally give it a meaningful **description**. \n - **State**: Set the state to **Enabled**. \n - Expand the **Service Instance** section. \n    - **Service Instance**: Select your desired Service Instance for which the Data Connector service is enabled. \n - Expand the **Source Configuration** section.  \n    - **Source**: Select **BloxOne Cloud Source**. \n    - Select the **Internal Notifications** Log Type.\n - Expand the **Destination Configuration** section.  \n    - Select the **Destination** you just created. \n - Click **Save & Close**. \n6. Allow the configuration some time to activate."
                },
                {
                  "title": "C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "InfobloxSOCInsightsDataConnector_API",
    "title": "Infoblox SOC Insight Data Connector via REST API",
    "publisher": "Infoblox",
    "descriptionMarkdown": "The Infoblox SOC Insight Data Connector allows you to easily connect your Infoblox BloxOne SOC Insight data with Microsoft Sentinel. By connecting your logs to Microsoft Sentinel, you can take advantage of search & correlation, alerting, and threat intelligence enrichment for each log.",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected called [**InfobloxInsight**](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Infoblox%20SOC%20Insights/Parsers/InfobloxInsight.yaml) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "InfobloxInsight",
        "baseQuery": "InfobloxInsight_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Return all logs involving DNS Tunneling",
        "query": "InfobloxInsight_CL\n| where threatType_s == \"DNS Tunneling\""
      },
      {
        "description": "Return all logs involving a configuration issue",
        "query": "InfobloxInsight_CL\n| where tClass_s == \"TI-CONFIGURATIONISSUE\""
      },
      {
        "description": "Return count of critical priority insights",
        "query": "InfobloxInsight_CL\n| where priorityText_s == \"CRITICAL\"\n | summarize dcount(insightId_g) by priorityText_s"
      },
      {
        "description": "Return each spreading insight by ThreatClass",
        "query": "InfobloxInsight_CL\n| where isnotempty(spreadingDate_t)\n | summarize dcount(insightId_g) by tClass_s"
      },
      {
        "description": "Return each Insight by ThreatFamily",
        "query": "InfobloxInsight_CL\n| | summarize dcount(insightId_g) by tFamily_s"
      }
    ],
    "dataTypes": [
      {
        "name": "InfobloxInsight_CL",
        "lastDataReceivedQuery": "InfobloxInsight_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "InfobloxInsight_CL\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(3d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Workspace Keys",
        "description": "In order to use the playbooks as part of this solution, find your **Workspace ID** and **Workspace Primary Key** below for your convenience.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Workspace Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Parsers",
        "description": ">This data connector depends on a parser based on a Kusto Function to work as expected called [**InfobloxInsight**](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Infoblox%20SOC%20Insights/Parsers/InfobloxInsight.yaml) which is deployed with the Microsoft Sentinel Solution."
      },
      {
        "title": "SOC Insights",
        "description": ">This data connector assumes you have access to Infoblox BloxOne Threat Defense SOC Insights. You can find more information about SOC Insights [**here**](https://docs.infoblox.com/space/BloxOneThreatDefense/501514252/SOC+Insights)."
      },
      {
        "title": "Follow the steps below to configure this data connector",
        "description": "",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "1.  Generate an Infoblox API Key and copy it somewhere safe",
                  "description": "In the [Infoblox Cloud Services Portal](https://csp.infoblox.com/atlas/app/welcome), generate an API Key and copy it somewhere safe to use in the next step. You can find instructions on how to create API keys [**here**](https://docs.infoblox.com/space/BloxOneThreatDefense/230394187/How+Do+I+Create+an+API+Key%3F)."
                },
                {
                  "title": "2.  Configure the Infoblox-SOC-Get-Open-Insights-API playbook",
                  "description": "Create and configure the **Infoblox-SOC-Get-Open-Insights-API** playbook which is deployed with this solution. Enter your Infoblox API key in the appropriate parameter when prompted."
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "InfobloxSOCInsightsDataConnector_API",
    "title": "Infoblox SOC Insight Data Connector via REST API",
    "publisher": "Infoblox",
    "descriptionMarkdown": "The Infoblox SOC Insight Data Connector allows you to easily connect your Infoblox BloxOne SOC Insight data with Microsoft Sentinel. By connecting your logs to Microsoft Sentinel, you can take advantage of search & correlation, alerting, and threat intelligence enrichment for each log.",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected called [**InfobloxInsight**](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Infoblox%20SOC%20Insights/Parsers/InfobloxInsight.yaml) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "InfobloxInsight",
        "baseQuery": "InfobloxInsight_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Return all logs involving DNS Tunneling",
        "query": "InfobloxInsight_CL\n| where threatType_s == \"DNS Tunneling\""
      },
      {
        "description": "Return all logs involving a configuration issue",
        "query": "InfobloxInsight_CL\n| where tClass_s == \"TI-CONFIGURATIONISSUE\""
      },
      {
        "description": "Return count of critical priority insights",
        "query": "InfobloxInsight_CL\n| where priorityText_s == \"CRITICAL\"\n | summarize dcount(insightId_g) by priorityText_s"
      },
      {
        "description": "Return each spreading insight by ThreatClass",
        "query": "InfobloxInsight_CL\n| where isnotempty(spreadingDate_t)\n | summarize dcount(insightId_g) by tClass_s"
      },
      {
        "description": "Return each Insight by ThreatFamily",
        "query": "InfobloxInsight_CL\n| | summarize dcount(insightId_g) by tFamily_s"
      }
    ],
    "dataTypes": [
      {
        "name": "InfobloxInsight_CL",
        "lastDataReceivedQuery": "InfobloxInsight_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "InfobloxInsight_CL\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(3d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Workspace Keys",
        "description": "In order to use the playbooks as part of this solution, find your **Workspace ID** and **Workspace Primary Key** below for your convenience.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Workspace Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Parsers",
        "description": ">This data connector depends on a parser based on a Kusto Function to work as expected called [**InfobloxInsight**](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Infoblox%20SOC%20Insights/Parsers/InfobloxInsight.yaml) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "SOC Insights",
        "description": ">This data connector assumes you have access to Infoblox BloxOne Threat Defense SOC Insights. You can find more information about SOC Insights [**here**](https://docs.infoblox.com/space/BloxOneThreatDefense/501514252/SOC+Insights).",
        "instructions": []
      },
      {
        "title": "Follow the steps below to configure this data connector",
        "description": "",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "1.  Generate an Infoblox API Key and copy it somewhere safe",
                  "description": "In the [Infoblox Cloud Services Portal](https://csp.infoblox.com/atlas/app/welcome), generate an API Key and copy it somewhere safe to use in the next step. You can find instructions on how to create API keys [**here**](https://docs.infoblox.com/space/BloxOneThreatDefense/230394187/How+Do+I+Create+an+API+Key%3F).",
                  "instructions": []
                },
                {
                  "title": "2.  Configure the Infoblox-SOC-Get-Open-Insights-API playbook",
                  "description": "Create and configure the **Infoblox-SOC-Get-Open-Insights-API** playbook which is deployed with this solution. Enter your Infoblox API key in the appropriate parameter when prompted.",
                  "instructions": []
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "InfobloxSOCInsightsDataConnector_Legacy",
    "title": "[Deprecated] Infoblox SOC Insight Data Connector via Legacy Agent",
    "publisher": "Infoblox",
    "descriptionMarkdown": "The Infoblox SOC Insight Data Connector allows you to easily connect your Infoblox BloxOne SOC Insight data with Microsoft Sentinel. By connecting your logs to Microsoft Sentinel, you can take advantage of search & correlation, alerting, and threat intelligence enrichment for each log. \n\nThis data connector ingests Infoblox SOC Insight CDC logs into your Log Analytics Workspace using the legacy Log Analytics agent.\n\n**Microsoft recommends installation of Infoblox SOC Insight Data Connector via AMA Connector.** The legacy connector uses the Log Analytics agent which is about to be deprecated by **Aug 31, 2024,** and should only be installed where AMA is not supported.\n\n Using MMA and AMA on the same machine can cause log duplication and extra ingestion cost. [More details](https://learn.microsoft.com/en-us/azure/sentinel/ama-migrate).",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected called [**InfobloxCDC_SOCInsights**](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Infoblox%20SOC%20Insights/Parsers/InfobloxCDC_SOCInsights.yaml) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "InfobloxCDC_SOCInsights",
        "baseQuery": "CommonSecurityLog\n| where DeviceVendor == \"Infoblox\" and DeviceProduct == \"Data Connector\" and DeviceEventClassID == \"BloxOne-InsightsNotification-Log\""
      }
    ],
    "sampleQueries": [
      {
        "description": "Return all logs involving DNS Tunneling",
        "query": "InfobloxCDC_SOCInsights\n| where ThreatType == \"DNS Tunneling\""
      },
      {
        "description": "Return all logs involving a configuration issue",
        "query": "InfobloxCDC_SOCInsights\n| where ThreatClass == \"TI-CONFIGURATIONISSUE\""
      },
      {
        "description": "Return all high threat level logs",
        "query": "InfobloxCDC_SOCInsights\n| where ThreatLevel == \"High\""
      },
      {
        "description": "Return raised status logs",
        "query": "InfobloxCDC_SOCInsights\n| where Status == \"RAISED\""
      },
      {
        "description": "Return logs involving a high amount of unblocked DNS hits",
        "query": "InfobloxCDC_SOCInsights\n| where NotBlockedCount >= 100"
      },
      {
        "description": "Return each Insight by ThreatFamily",
        "query": "InfobloxCDC_SOCInsights\n| summarize dcount(InfobloxInsightID) by ThreatFamily"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (InfobloxCDC_SOCInsights)",
        "lastDataReceivedQuery": "InfobloxCDC_SOCInsights\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "InfobloxCDC_SOCInsights\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(3d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Workspace Keys",
        "description": "In order to use the playbooks as part of this solution, find your **Workspace ID** and **Workspace Primary Key** below for your convenience.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Workspace Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Parsers",
        "description": ">This data connector depends on a parser based on a Kusto Function to work as expected called [**InfobloxCDC_SOCInsights**](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Infoblox%20SOC%20Insights/Parsers/InfobloxCDC_SOCInsights.yaml) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "SOC Insights",
        "description": ">This data connector assumes you have access to Infoblox BloxOne Threat Defense SOC Insights. You can find more information about SOC Insights [**here**](https://docs.infoblox.com/space/BloxOneThreatDefense/501514252/SOC+Insights). ",
        "instructions": []
      },
      {
        "title": "Infoblox Cloud Data Connector",
        "description": ">This data connector assumes an Infoblox Data Connector host has already been created and configured in the Infoblox Cloud Services Portal (CSP). As the [**Infoblox Data Connector**](https://docs.infoblox.com/display/BloxOneThreatDefense/Deploying+the+Data+Connector+Solution) is a feature of BloxOne Threat Defense, access to an appropriate BloxOne Threat Defense subscription is required. See this [**quick-start guide**](https://www.infoblox.com/wp-content/uploads/infoblox-deployment-guide-data-connector.pdf) for more information and licensing requirements.",
        "instructions": []
      },
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Within the Infoblox Cloud Services Portal, configure Infoblox BloxOne to send CEF Syslog data to the Infoblox Cloud Data Connector to forward to the Syslog agent",
        "description": "Follow the steps below to configure the Infoblox CDC to send BloxOne data to Microsoft Sentinel via the Linux Syslog agent.\n1. Navigate to **Manage > Data Connector**.\n2. Click the **Destination Configuration** tab at the top.\n3. Click **Create > Syslog**. \n - **Name**: Give the new Destination a meaningful **name**, such as **Microsoft-Sentinel-Destination**.\n - **Description**: Optionally give it a meaningful **description**.\n - **State**: Set the state to **Enabled**.\n - **Format**: Set the format to **CEF**.\n - **FQDN/IP**: Enter the IP address of the Linux device on which the Linux agent is installed.\n - **Port**: Leave the port number at **514**.\n - **Protocol**: Select desired protocol and CA certificate if applicable.\n - Click **Save & Close**.\n4. Click the **Traffic Flow Configuration** tab at the top.\n5. Click **Create**.\n - **Name**: Give the new Traffic Flow a meaningful **name**, such as **Microsoft-Sentinel-Flow**.\n - **Description**: Optionally give it a meaningful **description**. \n - **State**: Set the state to **Enabled**. \n - Expand the **Service Instance** section. \n    - **Service Instance**: Select your desired Service Instance for which the Data Connector service is enabled. \n - Expand the **Source Configuration** section.  \n    - **Source**: Select **BloxOne Cloud Source**. \n    - Select the **Internal Notifications** Log Type.\n - Expand the **Destination Configuration** section.  \n    - Select the **Destination** you just created. \n - Click **Save & Close**. \n6. Allow the configuration some time to activate."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "InfobloxSOCInsightsDataConnector_Legacy",
    "title": "[Deprecated] Infoblox SOC Insight Data Connector via Legacy Agent",
    "publisher": "Infoblox",
    "descriptionMarkdown": "The Infoblox SOC Insight Data Connector allows you to easily connect your Infoblox BloxOne SOC Insight data with Microsoft Sentinel. By connecting your logs to Microsoft Sentinel, you can take advantage of search & correlation, alerting, and threat intelligence enrichment for each log. \n\nThis data connector ingests Infoblox SOC Insight CDC logs into your Log Analytics Workspace using the legacy Log Analytics agent.\n\n**Microsoft recommends installation of Infoblox SOC Insight Data Connector via AMA Connector.** The legacy connector uses the Log Analytics agent which is about to be deprecated by **Aug 31, 2024,** and should only be installed where AMA is not supported.\n\n Using MMA and AMA on the same machine can cause log duplication and extra ingestion cost. [More details](https://learn.microsoft.com/en-us/azure/sentinel/ama-migrate).",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected called [**InfobloxCDC_SOCInsights**](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Infoblox%20SOC%20Insights/Parsers/InfobloxCDC_SOCInsights.yaml) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "InfobloxCDC_SOCInsights",
        "baseQuery": "CommonSecurityLog\n| where DeviceVendor == \"Infoblox\" and DeviceProduct == \"Data Connector\" and DeviceEventClassID == \"BloxOne-InsightsNotification-Log\""
      }
    ],
    "sampleQueries": [
      {
        "description": "Return all logs involving DNS Tunneling",
        "query": "InfobloxCDC_SOCInsights\n| where ThreatType == \"DNS Tunneling\""
      },
      {
        "description": "Return all logs involving a configuration issue",
        "query": "InfobloxCDC_SOCInsights\n| where ThreatClass == \"TI-CONFIGURATIONISSUE\""
      },
      {
        "description": "Return all high threat level logs",
        "query": "InfobloxCDC_SOCInsights\n| where ThreatLevel == \"High\""
      },
      {
        "description": "Return raised status logs",
        "query": "InfobloxCDC_SOCInsights\n| where Status == \"RAISED\""
      },
      {
        "description": "Return logs involving a high amount of unblocked DNS hits",
        "query": "InfobloxCDC_SOCInsights\n| where NotBlockedCount >= 100"
      },
      {
        "description": "Return each Insight by ThreatFamily",
        "query": "InfobloxCDC_SOCInsights\n| summarize dcount(InfobloxInsightID) by ThreatFamily"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (InfobloxCDC_SOCInsights)",
        "lastDataReceivedQuery": "InfobloxCDC_SOCInsights\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "InfobloxCDC_SOCInsights\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(3d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Workspace Keys",
        "description": "In order to use the playbooks as part of this solution, find your **Workspace ID** and **Workspace Primary Key** below for your convenience.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Workspace Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Parsers",
        "description": ">This data connector depends on a parser based on a Kusto Function to work as expected called [**InfobloxCDC_SOCInsights**](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Infoblox%20SOC%20Insights/Parsers/InfobloxCDC_SOCInsights.yaml) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "SOC Insights",
        "description": ">This data connector assumes you have access to Infoblox BloxOne Threat Defense SOC Insights. You can find more information about SOC Insights [**here**](https://docs.infoblox.com/space/BloxOneThreatDefense/501514252/SOC+Insights). ",
        "instructions": []
      },
      {
        "title": "Infoblox Cloud Data Connector",
        "description": ">This data connector assumes an Infoblox Data Connector host has already been created and configured in the Infoblox Cloud Services Portal (CSP). As the [**Infoblox Data Connector**](https://docs.infoblox.com/display/BloxOneThreatDefense/Deploying+the+Data+Connector+Solution) is a feature of BloxOne Threat Defense, access to an appropriate BloxOne Threat Defense subscription is required. See this [**quick-start guide**](https://www.infoblox.com/wp-content/uploads/infoblox-deployment-guide-data-connector.pdf) for more information and licensing requirements.",
        "instructions": []
      },
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Within the Infoblox Cloud Services Portal, configure Infoblox BloxOne to send CEF Syslog data to the Infoblox Cloud Data Connector to forward to the Syslog agent",
        "description": "Follow the steps below to configure the Infoblox CDC to send BloxOne data to Microsoft Sentinel via the Linux Syslog agent.\n1. Navigate to **Manage > Data Connector**.\n2. Click the **Destination Configuration** tab at the top.\n3. Click **Create > Syslog**. \n - **Name**: Give the new Destination a meaningful **name**, such as **Microsoft-Sentinel-Destination**.\n - **Description**: Optionally give it a meaningful **description**.\n - **State**: Set the state to **Enabled**.\n - **Format**: Set the format to **CEF**.\n - **FQDN/IP**: Enter the IP address of the Linux device on which the Linux agent is installed.\n - **Port**: Leave the port number at **514**.\n - **Protocol**: Select desired protocol and CA certificate if applicable.\n - Click **Save & Close**.\n4. Click the **Traffic Flow Configuration** tab at the top.\n5. Click **Create**.\n - **Name**: Give the new Traffic Flow a meaningful **name**, such as **Microsoft-Sentinel-Flow**.\n - **Description**: Optionally give it a meaningful **description**. \n - **State**: Set the state to **Enabled**. \n - Expand the **Service Instance** section. \n    - **Service Instance**: Select your desired Service Instance for which the Data Connector service is enabled. \n - Expand the **Source Configuration** section.  \n    - **Source**: Select **BloxOne Cloud Source**. \n    - Select the **Internal Notifications** Log Type.\n - Expand the **Destination Configuration** section.  \n    - Select the **Destination** you just created. \n - Click **Save & Close**. \n6. Allow the configuration some time to activate."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "InfoSecDataConnector",
    "title": "InfoSecGlobal Data Connector",
    "publisher": "InfoSecGlobal",
    "descriptionMarkdown": "Use this data connector to integrate with InfoSec Crypto Analytics and get data sent directly to Microsoft Sentinel.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "InfoSecAnalytics_CL",
        "baseQuery": "InfoSecAnalytics_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "List all artifacts",
        "query": "InfoSecAnalytics_CL"
      }
    ],
    "dataTypes": [
      {
        "name": "InfoSecAnalytics_CL",
        "lastDataReceivedQuery": "InfoSecAnalytics_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "InfoSecAnalytics_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "InfoSecGlobal Crypto Analytics Data Connector",
        "description": "1. Data is sent to Microsoft Sentinel through Logstash\n 2. Required Logstash configuration is included with Crypto Analytics installation\n 3. Documentation provided with the Crypto Analytics installation explains how to enable sending data to Microsoft Sentinel\n",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ],
    "metadata": {
      "id": "38ead227-273e-33e3-43ad-8f3e230df413",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "InfoSecGlobalSolution"
      },
      "author": {
        "name": "InfoSecGlobal"
      },
      "support": {
        "tier": "developer",
        "name": "InfoSecGlobal"
      }
    }
  },
  {
    "id": "InsightVMCloudAPI",
    "title": "Rapid7 Insight Platform Vulnerability Management Reports",
    "publisher": "Rapid7",
    "descriptionMarkdown": "The [Rapid7 Insight VM](https://www.rapid7.com/products/insightvm/) Report data connector provides the capability to ingest Scan reports and vulnerability data into Microsoft Sentinel through the REST API from the  Rapid7 Insight platform (Managed in the cloud). Refer to [API documentation](https://docs.rapid7.com/insight/api-overview/) for more information. The connector provides ability to get events which helps to examine potential security risks, analyze your team's use of collaboration, diagnose configuration problems and more.",
    "additionalRequirementBanner": "This data connector depends on a parsers based on a Kusto Function to work as expected [**InsightVMAssets**](https://aka.ms/sentinel-InsightVMAssets-parser) and [**InsightVMVulnerabilities**](https://aka.ms/sentinel-InsightVMVulnerabilities-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "NexposeInsightVMCloud_assets_CL",
        "baseQuery": "NexposeInsightVMCloud_assets_CL"
      },
      {
        "metricName": "Total data received",
        "legend": "NexposeInsightVMCloud_vulnerabilities_CL",
        "baseQuery": "NexposeInsightVMCloud_vulnerabilities_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Insight VM Report Events - Assets information",
        "query": "NexposeInsightVMCloud_assets_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Insight VM Report Events - Vulnerabilities information",
        "query": "NexposeInsightVMCloud_vulnerabilities_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "NexposeInsightVMCloud_assets_CL",
        "lastDataReceivedQuery": "NexposeInsightVMCloud_assets_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "NexposeInsightVMCloud_vulnerabilities_CL",
        "lastDataReceivedQuery": "NexposeInsightVMCloud_vulnerabilities_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "NexposeInsightVMCloud_assets_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "NexposeInsightVMCloud_vulnerabilities_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials",
          "description": "**InsightVMAPIKey** is required for REST API. [See the documentation to learn more about API](https://docs.rapid7.com/insight/api-overview/). Check all [requirements and follow  the instructions](https://docs.rapid7.com/insight/managing-platform-api-keys/) for obtaining credentials"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Insight VM API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "description": ">**NOTE:** This data connector depends on a parsers based on a Kusto Function to work as expected [**InsightVMAssets**](https://aka.ms/sentinel-InsightVMAssets-parser) and [**InsightVMVulnerabilities**](https://aka.ms/sentinel-InsightVMVulnerabilities-parser) which is deployed with the Microsoft Sentinel Solution."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the Insight VM Cloud**\n\n [Follow the instructions](https://docs.rapid7.com/insight/managing-platform-api-keys/) to obtain the credentials. \n"
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Workspace data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following).",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Option 1 - Azure Resource Manager (ARM) Template",
                  "description": "Use this method for automated deployment of the Rapid7 Insight Vulnerability Management Report data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-InsightVMCloudAPI-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n> **NOTE:** Within the same resource group, you can't mix Windows and Linux apps in the same region. Select existing resource group without Windows apps in it or create new resource group.\n3. Enter the **InsightVMAPIKey**, choose **InsightVMCloudRegion** and deploy. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
                },
                {
                  "title": "Option 2 - Manual Deployment of Azure Functions",
                  "description": "Use the following step-by-step instructions to deploy the Rapid7 Insight Vulnerability Management Report data connector manually with Azure Functions (Deployment via Visual Studio Code).",
                  "instructions": [
                    {
                      "parameters": {
                        "instructionSteps": [
                          {
                            "title": "Step 1 - Deploy a Function App",
                            "description": "1. Download the [Azure Function App](https://github.com/averbn/azure_sentinel_data_connectors/raw/main/insight-vm-cloud-azure-sentinel-data-connector/InsightVMCloudAPISentinelConn.zip) file. Extract archive to your local development computer.\n2. Follow the [function app manual deployment instructions](https://github.com/Azure/Azure-Sentinel/blob/master/DataConnectors/AzureFunctionsManualDeployment.md#function-app-manual-deployment-instructions) to deploy the Azure Functions app using VSCode.\n3. After successful deployment of the function app, follow next steps for configuring it."
                          },
                          {
                            "title": "Step 2 - Configure the Function App",
                            "description": "1. Go to Azure Portal for the Function App configuration.\n2. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive):  \n\t\tInsightVMAPIKey\n\t\tInsightVMCloudRegion\n\t\tWorkspaceID\n\t\tWorkspaceKey\n\t\tlogAnalyticsUri (optional)\n> - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n3. Once all application settings have been entered, click **Save**."
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "IPinfoAbuseDataConnector",
    "title": "IPinfo Abuse Data Connector",
    "publisher": "IPinfo",
    "descriptionMarkdown": "This IPinfo data connector installs an Azure Function app to download standard_abuse datasets and insert it into custom log table in Microsoft Sentinel",
    "graphQueries": [
      {
        "metricName": "Abuse Data",
        "legend": "Ipinfo_Abuse_CL",
        "baseQuery": "Ipinfo_Abuse_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Ipinfo_Abuse_CL",
        "query": "Ipinfo_Abuse_CL"
      }
    ],
    "dataTypes": [
      {
        "name": "Ipinfo_Abuse_CL",
        "lastDataReceivedQuery": "Ipinfo_Abuse_CL | summarize Time = max(TimeGenerated)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Ipinfo_Abuse_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "IPinfo API Token",
          "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Retrieve API Token",
        "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
      },
      {
        "title": "2. In your Azure AD tenant, create an Azure Active Directory (AAD) application",
        "description": "In your Azure AD tenant, create an Azure Active Directory (AAD) application and acquire Tenant ID, Client ID, and Client Secret: Use this Link."
      },
      {
        "title": "3. Assign the AAD application the Microsoft Sentinel Contributor Role.",
        "description": "Assign the AAD application you just created to the Contributor(Privileged administrator roles) and Monitoring Metrics Publisher(Job function roles) in the same Resource Group you use for Log Analytic Workspace on which Microsoft Sentinel is added: Use this Link."
      },
      {
        "title": "4. Get Workspace Resource ID",
        "description": "Use the Log Analytic Workspace -> Properties blade having the 'Resource ID' property value. This is a fully qualified resourceId which is in the format '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}'"
      },
      {
        "title": "5. Deploy the Azure Function",
        "description": "Use this for automated deployment of the IPinfo data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-IPinfo-Abuse-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **RESOURCE_ID**, **IPINFO_TOKEN**, **TENANT_ID**, **CLIENT_ID**, **CLIENT_SECRET**."
      },
      {
        "title": "Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the IPinfo data connector manually with Azure Functions (Deployment via Visual Studio Code).",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Step 1 - Deploy a Function App",
                  "description": "1. Download the Azure Function App file. Extract the archive to your local development computer [Azure Function App](https://aka.ms/sentinel-Ipinfo-Abuse-functionapp). \n2. Create Function App using Hosting Functions Premium or App service plan using advanced option using VSCode. \n3. Follow the function app manual deployment instructions to deploy the Azure Functions app using VSCode. \n4. After successful deployment of the function app, follow the next steps for configuring it."
                },
                {
                  "title": "Step 2 - Configure the Function App",
                  "description": "1. Go to Azure Portal for the Function App configuration.\n2. In the Function App, select the Function App Name and select **Settings** -> **Configuration** or **Environment variables**. \n3. In the **Application settings** tab, select **+ New application setting**.\n4. Add each of the following application settings individually, with their respective string values (case-sensitive):\n\t\tRESOURCE_ID\n\t\tIPINFO_TOKEN\n\t\tTENANT_ID\n\t\tCLIENT_ID\n\t\tCLIENT_SECRET\n\t\tRETENTION_IN_DAYS\n\t\tTOTAL_RETENTION_IN_DAYS\n\t\tSCHEDULE\n\t\tLOCATION \n5. Once all application settings have been entered, click **Save**."
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "IPinfoASNDataConnector",
    "title": "IPinfo ASN Data Connector",
    "publisher": "IPinfo",
    "descriptionMarkdown": "This IPinfo data connector installs an Azure Function app to download standard_ASN datasets and insert it into custom log table in Microsoft Sentinel",
    "graphQueries": [
      {
        "metricName": "ASN Data",
        "legend": "Ipinfo_ASN_CL",
        "baseQuery": "Ipinfo_ASN_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Ipinfo_ASN_CL",
        "query": "Ipinfo_ASN_CL"
      }
    ],
    "dataTypes": [
      {
        "name": "Ipinfo_ASN_CL",
        "lastDataReceivedQuery": "Ipinfo_ASN_CL | summarize Time = max(TimeGenerated)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Ipinfo_ASN_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "IPinfo API Token",
          "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Retrieve API Token",
        "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
      },
      {
        "title": "2. In your Azure AD tenant, create an Azure Active Directory (AAD) application",
        "description": "In your Azure AD tenant, create an Azure Active Directory (AAD) application and acquire Tenant ID, Client ID, and Client Secret: Use this Link."
      },
      {
        "title": "3. Assign the AAD application the Microsoft Sentinel Contributor Role.",
        "description": "Assign the AAD application you just created to the Contributor(Privileged administrator roles) and Monitoring Metrics Publisher(Job function roles) in the same Resource Group you use for Log Analytic Workspace on which Microsoft Sentinel is added: Use this Link."
      },
      {
        "title": "4. Get Workspace Resource ID",
        "description": "Use the Log Analytic Workspace -> Properties blade having the 'Resource ID' property value. This is a fully qualified resourceId which is in the format '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}'"
      },
      {
        "title": "5. Deploy the Azure Function",
        "description": "Use this for automated deployment of the IPinfo data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-IPinfo-ASN-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **RESOURCE_ID**, **IPINFO_TOKEN**, **TENANT_ID**, **CLIENT_ID**, **CLIENT_SECRET**."
      },
      {
        "title": "Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the IPinfo data connector manually with Azure Functions (Deployment via Visual Studio Code).",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Step 1 - Deploy a Function App",
                  "description": "1. Download the Azure Function App file. Extract the archive to your local development computer [Azure Function App](https://aka.ms/sentinel-Ipinfo-ASN-functionapp). \n2. Create Function App using Hosting Functions Premium or App service plan using advanced option using VSCode. \n3. Follow the function app manual deployment instructions to deploy the Azure Functions app using VSCode. \n4. After successful deployment of the function app, follow the next steps for configuring it."
                },
                {
                  "title": "Step 2 - Configure the Function App",
                  "description": "1. Go to Azure Portal for the Function App configuration.\n2. In the Function App, select the Function App Name and select **Settings** -> **Configuration** or **Environment variables**. \n3. In the **Application settings** tab, select **+ New application setting**.\n4. Add each of the following application settings individually, with their respective string values (case-sensitive):\n\t\tRESOURCE_ID\n\t\tIPINFO_TOKEN\n\t\tTENANT_ID\n\t\tCLIENT_ID\n\t\tCLIENT_SECRET\n\t\tRETENTION_IN_DAYS\n\t\tTOTAL_RETENTION_IN_DAYS\n\t\tSCHEDULE\n\t\tLOCATION \n5. Once all application settings have been entered, click **Save**."
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "IPinfoCarrierDataConnector",
    "title": "IPinfo Carrier Data Connector",
    "publisher": "IPinfo",
    "descriptionMarkdown": "This IPinfo data connector installs an Azure Function app to download standard_carrier datasets and insert it into custom log table in Microsoft Sentinel",
    "graphQueries": [
      {
        "metricName": "Carrier Data",
        "legend": "Ipinfo_Carrier_CL",
        "baseQuery": "Ipinfo_Carrier_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Ipinfo_Carrier_CL",
        "query": "Ipinfo_Carrier_CL"
      }
    ],
    "dataTypes": [
      {
        "name": "Ipinfo_Carrier_CL",
        "lastDataReceivedQuery": "Ipinfo_Carrier_CL | summarize Time = max(TimeGenerated)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Ipinfo_Carrier_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "IPinfo API Token",
          "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Retrieve API Token",
        "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
      },
      {
        "title": "2. In your Azure AD tenant, create an Azure Active Directory (AAD) application",
        "description": "In your Azure AD tenant, create an Azure Active Directory (AAD) application and acquire Tenant ID, Client ID, and Client Secret: Use this Link."
      },
      {
        "title": "3. Assign the AAD application the Microsoft Sentinel Contributor Role.",
        "description": "Assign the AAD application you just created to the Contributor(Privileged administrator roles) and Monitoring Metrics Publisher(Job function roles) in the same Resource Group you use for Log Analytic Workspace on which Microsoft Sentinel is added: Use this Link."
      },
      {
        "title": "4. Get Workspace Resource ID",
        "description": "Use the Log Analytic Workspace -> Properties blade having the 'Resource ID' property value. This is a fully qualified resourceId which is in the format '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}'"
      },
      {
        "title": "5. Deploy the Azure Function",
        "description": "Use this for automated deployment of the IPinfo data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-IPinfo-Carrier-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **RESOURCE_ID**, **IPINFO_TOKEN**, **TENANT_ID**, **CLIENT_ID**, **CLIENT_SECRET**."
      },
      {
        "title": "Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the IPinfo data connector manually with Azure Functions (Deployment via Visual Studio Code).",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Step 1 - Deploy a Function App",
                  "description": "1. Download the Azure Function App file. Extract the archive to your local development computer [Azure Function App](https://aka.ms/sentinel-Ipinfo-Carrier-functionapp). \n2. Create Function App using Hosting Functions Premium or App service plan using advanced option using VSCode. \n3. Follow the function app manual deployment instructions to deploy the Azure Functions app using VSCode. \n4. After successful deployment of the function app, follow the next steps for configuring it."
                },
                {
                  "title": "Step 2 - Configure the Function App",
                  "description": "1. Go to Azure Portal for the Function App configuration.\n2. In the Function App, select the Function App Name and select **Settings** -> **Configuration** or **Environment variables**. \n3. In the **Application settings** tab, select **+ New application setting**.\n4. Add each of the following application settings individually, with their respective string values (case-sensitive):\n\t\tRESOURCE_ID\n\t\tIPINFO_TOKEN\n\t\tTENANT_ID\n\t\tCLIENT_ID\n\t\tCLIENT_SECRET\n\t\tRETENTION_IN_DAYS\n\t\tTOTAL_RETENTION_IN_DAYS\n\t\tSCHEDULE\n\t\tLOCATION \n5. Once all application settings have been entered, click **Save**."
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "IPinfoCompanyDataConnector",
    "title": "IPinfo Company Data Connector",
    "publisher": "IPinfo",
    "descriptionMarkdown": "This IPinfo data connector installs an Azure Function app to download standard_company datasets and insert it into custom log table in Microsoft Sentinel",
    "graphQueries": [
      {
        "metricName": "Company Data",
        "legend": "Ipinfo_Company_CL",
        "baseQuery": "Ipinfo_Company_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Ipinfo_Company_CL",
        "query": "Ipinfo_Company_CL"
      }
    ],
    "dataTypes": [
      {
        "name": "Ipinfo_Company_CL",
        "lastDataReceivedQuery": "Ipinfo_Company_CL | summarize Time = max(TimeGenerated)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Ipinfo_Company_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "IPinfo API Token",
          "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Retrieve API Token",
        "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
      },
      {
        "title": "2. In your Azure AD tenant, create an Azure Active Directory (AAD) application",
        "description": "In your Azure AD tenant, create an Azure Active Directory (AAD) application and acquire Tenant ID, Client ID, and Client Secret: Use this Link."
      },
      {
        "title": "3. Assign the AAD application the Microsoft Sentinel Contributor Role.",
        "description": "Assign the AAD application you just created to the Contributor(Privileged administrator roles) and Monitoring Metrics Publisher(Job function roles) in the same Resource Group you use for Log Analytic Workspace on which Microsoft Sentinel is added: Use this Link."
      },
      {
        "title": "4. Get Workspace Resource ID",
        "description": "Use the Log Analytic Workspace -> Properties blade having the 'Resource ID' property value. This is a fully qualified resourceId which is in the format '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}'"
      },
      {
        "title": "5. Deploy the Azure Function",
        "description": "Use this for automated deployment of the IPinfo data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-IPinfo-Company-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **RESOURCE_ID**, **IPINFO_TOKEN**, **TENANT_ID**, **CLIENT_ID**, **CLIENT_SECRET**."
      },
      {
        "title": "Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the IPinfo data connector manually with Azure Functions (Deployment via Visual Studio Code).",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Step 1 - Deploy a Function App",
                  "description": "1. Download the Azure Function App file. Extract the archive to your local development computer [Azure Function App](https://aka.ms/sentinel-Ipinfo-Company-functionapp). \n2. Create Function App using Hosting Functions Premium or App service plan using advanced option using VSCode. \n3. Follow the function app manual deployment instructions to deploy the Azure Functions app using VSCode. \n4. After successful deployment of the function app, follow the next steps for configuring it."
                },
                {
                  "title": "Step 2 - Configure the Function App",
                  "description": "1. Go to Azure Portal for the Function App configuration.\n2. In the Function App, select the Function App Name and select **Settings** -> **Configuration** or **Environment variables**. \n3. In the **Application settings** tab, select **+ New application setting**.\n4. Add each of the following application settings individually, with their respective string values (case-sensitive):\n\t\tRESOURCE_ID\n\t\tIPINFO_TOKEN\n\t\tTENANT_ID\n\t\tCLIENT_ID\n\t\tCLIENT_SECRET\n\t\tRETENTION_IN_DAYS\n\t\tTOTAL_RETENTION_IN_DAYS\n\t\tSCHEDULE\n\t\tLOCATION \n5. Once all application settings have been entered, click **Save**."
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "IPinfoCountryDataConnector",
    "title": "IPinfo Country ASN Data Connector",
    "publisher": "IPinfo",
    "descriptionMarkdown": "This IPinfo data connector installs an Azure Function app to download country_asn datasets and insert it into custom log table in Microsoft Sentinel",
    "graphQueries": [
      {
        "metricName": "Country Data",
        "legend": "Ipinfo_Country_CL",
        "baseQuery": "Ipinfo_Country_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Ipinfo_Country_CL",
        "query": "Ipinfo_Country_CL"
      }
    ],
    "dataTypes": [
      {
        "name": "Ipinfo_Country_CL",
        "lastDataReceivedQuery": "Ipinfo_Country_CL | summarize Time = max(TimeGenerated)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Ipinfo_Country_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "IPinfo API Token",
          "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Retrieve API Token",
        "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
      },
      {
        "title": "2. In your Azure AD tenant, create an Azure Active Directory (AAD) application",
        "description": "In your Azure AD tenant, create an Azure Active Directory (AAD) application and acquire Tenant ID, Client ID, and Client Secret: Use this Link."
      },
      {
        "title": "3. Assign the AAD application the Microsoft Sentinel Contributor Role.",
        "description": "Assign the AAD application you just created to the Contributor(Privileged administrator roles) and Monitoring Metrics Publisher(Job function roles) in the same Resource Group you use for Log Analytic Workspace on which Microsoft Sentinel is added: Use this Link."
      },
      {
        "title": "4. Get Workspace Resource ID",
        "description": "Use the Log Analytic Workspace -> Properties blade having the 'Resource ID' property value. This is a fully qualified resourceId which is in the format '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}'"
      },
      {
        "title": "5. Deploy the Azure Function",
        "description": "Use this for automated deployment of the IPinfo data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-IPinfo-Country-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **RESOURCE_ID**, **IPINFO_TOKEN**, **TENANT_ID**, **CLIENT_ID**, **CLIENT_SECRET**."
      },
      {
        "title": "Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the IPinfo data connector manually with Azure Functions (Deployment via Visual Studio Code).",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Step 1 - Deploy a Function App",
                  "description": "1. Download the Azure Function App file. Extract the archive to your local development computer [Azure Function App](https://aka.ms/sentinel-Ipinfo-Country-functionapp). \n2. Create Function App using Hosting Functions Premium or App service plan using advanced option using VSCode. \n3. Follow the function app manual deployment instructions to deploy the Azure Functions app using VSCode. \n4. After successful deployment of the function app, follow the next steps for configuring it."
                },
                {
                  "title": "Step 2 - Configure the Function App",
                  "description": "1. Go to Azure Portal for the Function App configuration.\n2. In the Function App, select the Function App Name and select **Settings** -> **Configuration** or **Environment variables**. \n3. In the **Application settings** tab, select **+ New application setting**.\n4. Add each of the following application settings individually, with their respective string values (case-sensitive):\n\t\tRESOURCE_ID\n\t\tIPINFO_TOKEN\n\t\tTENANT_ID\n\t\tCLIENT_ID\n\t\tCLIENT_SECRET\n\t\tRETENTION_IN_DAYS\n\t\tTOTAL_RETENTION_IN_DAYS\n\t\tSCHEDULE\n\t\tLOCATION \n5. Once all application settings have been entered, click **Save**."
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "IPinfoDomainDataConnector",
    "title": "IPinfo Domain Data Connector",
    "publisher": "IPinfo",
    "descriptionMarkdown": "This IPinfo data connector installs an Azure Function app to download standard_domain datasets and insert it into custom log table in Microsoft Sentinel",
    "graphQueries": [
      {
        "metricName": "Domain Data",
        "legend": "Ipinfo_Domain_CL",
        "baseQuery": "Ipinfo_Domain_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Ipinfo_Domain_CL",
        "query": "Ipinfo_Domain_CL"
      }
    ],
    "dataTypes": [
      {
        "name": "Ipinfo_Domain_CL",
        "lastDataReceivedQuery": "Ipinfo_Domain_CL | summarize Time = max(TimeGenerated)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Ipinfo_Domain_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "IPinfo API Token",
          "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Retrieve API Token",
        "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
      },
      {
        "title": "2. In your Azure AD tenant, create an Azure Active Directory (AAD) application",
        "description": "In your Azure AD tenant, create an Azure Active Directory (AAD) application and acquire Tenant ID, Client ID, and Client Secret: Use this Link."
      },
      {
        "title": "3. Assign the AAD application the Microsoft Sentinel Contributor Role.",
        "description": "Assign the AAD application you just created to the Contributor(Privileged administrator roles) and Monitoring Metrics Publisher(Job function roles) in the same Resource Group you use for Log Analytic Workspace on which Microsoft Sentinel is added: Use this Link."
      },
      {
        "title": "4. Get Workspace Resource ID",
        "description": "Use the Log Analytic Workspace -> Properties blade having the 'Resource ID' property value. This is a fully qualified resourceId which is in the format '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}'"
      },
      {
        "title": "5. Deploy the Azure Function",
        "description": "Use this for automated deployment of the IPinfo data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-IPinfo-Domain-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **RESOURCE_ID**, **IPINFO_TOKEN**, **TENANT_ID**, **CLIENT_ID**, **CLIENT_SECRET**."
      },
      {
        "title": "Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the IPinfo data connector manually with Azure Functions (Deployment via Visual Studio Code).",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Step 1 - Deploy a Function App",
                  "description": "1. Download the Azure Function App file. Extract the archive to your local development computer [Azure Function App](https://aka.ms/sentinel-Ipinfo-Domain-functionapp). \n2. Create Function App using Hosting Functions Premium or App service plan using advanced option using VSCode. \n3. Follow the function app manual deployment instructions to deploy the Azure Functions app using VSCode. \n4. After successful deployment of the function app, follow the next steps for configuring it."
                },
                {
                  "title": "Step 2 - Configure the Function App",
                  "description": "1. Go to Azure Portal for the Function App configuration.\n2. In the Function App, select the Function App Name and select **Settings** -> **Configuration** or **Environment variables**. \n3. In the **Application settings** tab, select **+ New application setting**.\n4. Add each of the following application settings individually, with their respective string values (case-sensitive):\n\t\tRESOURCE_ID\n\t\tIPINFO_TOKEN\n\t\tTENANT_ID\n\t\tCLIENT_ID\n\t\tCLIENT_SECRET\n\t\tRETENTION_IN_DAYS\n\t\tTOTAL_RETENTION_IN_DAYS\n\t\tSCHEDULE\n\t\tLOCATION \n5. Once all application settings have been entered, click **Save**."
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "IPinfoIplocationDataConnector",
    "title": "IPinfo Iplocation Data Connector",
    "publisher": "IPinfo",
    "descriptionMarkdown": "This IPinfo data connector installs an Azure Function app to download standard_location datasets and insert it into custom log table in Microsoft Sentinel",
    "graphQueries": [
      {
        "metricName": "Location Data",
        "legend": "Ipinfo_Location_CL",
        "baseQuery": "Ipinfo_Location_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Ipinfo_Location_CL",
        "query": "Ipinfo_Location_CL"
      }
    ],
    "dataTypes": [
      {
        "name": "Ipinfo_Location_CL",
        "lastDataReceivedQuery": "Ipinfo_Location_CL | summarize Time = max(TimeGenerated)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Ipinfo_Location_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "IPinfo API Token",
          "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Retrieve API Token",
        "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
      },
      {
        "title": "2. In your Azure AD tenant, create an Azure Active Directory (AAD) application",
        "description": "In your Azure AD tenant, create an Azure Active Directory (AAD) application and acquire Tenant ID, Client ID, and Client Secret: Use this Link."
      },
      {
        "title": "3. Assign the AAD application the Microsoft Sentinel Contributor Role.",
        "description": "Assign the AAD application you just created to the Contributor(Privileged administrator roles) and Monitoring Metrics Publisher(Job function roles) in the same Resource Group you use for Log Analytic Workspace on which Microsoft Sentinel is added: Use this Link."
      },
      {
        "title": "4. Get Workspace Resource ID",
        "description": "Use the Log Analytic Workspace -> Properties blade having the 'Resource ID' property value. This is a fully qualified resourceId which is in the format '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}'"
      },
      {
        "title": "5. Deploy the Azure Function",
        "description": "Use this for automated deployment of the IPinfo data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-IPinfo-Iplocation-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **RESOURCE_ID**, **IPINFO_TOKEN**, **TENANT_ID**, **CLIENT_ID**, **CLIENT_SECRET**."
      },
      {
        "title": "Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the IPinfo data connector manually with Azure Functions (Deployment via Visual Studio Code).",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Step 1 - Deploy a Function App",
                  "description": "1. Download the Azure Function App file. Extract the archive to your local development computer [Azure Function App](https://aka.ms/sentinel-Ipinfo-Iplocation-functionapp). \n2. Create Function App using Hosting Functions Premium or App service plan using advanced option using VSCode. \n3. Follow the function app manual deployment instructions to deploy the Azure Functions app using VSCode. \n4. After successful deployment of the function app, follow the next steps for configuring it."
                },
                {
                  "title": "Step 2 - Configure the Function App",
                  "description": "1. Go to Azure Portal for the Function App configuration.\n2. In the Function App, select the Function App Name and select **Settings** -> **Configuration** or **Environment variables**. \n3. In the **Application settings** tab, select **+ New application setting**.\n4. Add each of the following application settings individually, with their respective string values (case-sensitive):\n\t\tRESOURCE_ID\n\t\tIPINFO_TOKEN\n\t\tTENANT_ID\n\t\tCLIENT_ID\n\t\tCLIENT_SECRET\n\t\tRETENTION_IN_DAYS\n\t\tTOTAL_RETENTION_IN_DAYS\n\t\tSCHEDULE\n\t\tLOCATION \n5. Once all application settings have been entered, click **Save**."
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "IPinfoIplocationExtendedDataConnector",
    "title": "IPinfo Iplocation Extended Data Connector",
    "publisher": "IPinfo",
    "descriptionMarkdown": "This IPinfo data connector installs an Azure Function app to download standard_location_extended datasets and insert it into custom log table in Microsoft Sentinel",
    "graphQueries": [
      {
        "metricName": "Location Extended Data",
        "legend": "Ipinfo_Location_extended_CL",
        "baseQuery": "Ipinfo_Location_extended_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Ipinfo_Location_extended_CL",
        "query": "Ipinfo_Location_extended_CL"
      }
    ],
    "dataTypes": [
      {
        "name": "Ipinfo_Location_extended_CL",
        "lastDataReceivedQuery": "Ipinfo_Location_extended_CL | summarize Time = max(TimeGenerated)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Ipinfo_Location_extended_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "IPinfo API Token",
          "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Retrieve API Token",
        "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
      },
      {
        "title": "2. In your Azure AD tenant, create an Azure Active Directory (AAD) application",
        "description": "In your Azure AD tenant, create an Azure Active Directory (AAD) application and acquire Tenant ID, Client ID, and Client Secret: Use this Link."
      },
      {
        "title": "3. Assign the AAD application the Microsoft Sentinel Contributor Role.",
        "description": "Assign the AAD application you just created to the Contributor(Privileged administrator roles) and Monitoring Metrics Publisher(Job function roles) in the same Resource Group you use for Log Analytic Workspace on which Microsoft Sentinel is added: Use this Link."
      },
      {
        "title": "4. Get Workspace Resource ID",
        "description": "Use the Log Analytic Workspace -> Properties blade having the 'Resource ID' property value. This is a fully qualified resourceId which is in the format '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}'"
      },
      {
        "title": "5. Deploy the Azure Function",
        "description": "Use this for automated deployment of the IPinfo data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-IPinfo-Iplocation-Extended-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **RESOURCE_ID**, **IPINFO_TOKEN**, **TENANT_ID**, **CLIENT_ID**, **CLIENT_SECRET**."
      },
      {
        "title": "Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the IPinfo data connector manually with Azure Functions (Deployment via Visual Studio Code).",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Step 1 - Deploy a Function App",
                  "description": "1. Download the Azure Function App file. Extract the archive to your local development computer [Azure Function App](https://aka.ms/sentinel-Ipinfo-Iplocation-Extended-functionapp). \n2. Create Function App using Hosting Functions Premium or App service plan using advanced option using VSCode. \n3. Follow the function app manual deployment instructions to deploy the Azure Functions app using VSCode. \n4. After successful deployment of the function app, follow the next steps for configuring it."
                },
                {
                  "title": "Step 2 - Configure the Function App",
                  "description": "1. Go to Azure Portal for the Function App configuration.\n2. In the Function App, select the Function App Name and select **Settings** -> **Configuration** or **Environment variables**. \n3. In the **Application settings** tab, select **+ New application setting**.\n4. Add each of the following application settings individually, with their respective string values (case-sensitive):\n\t\tRESOURCE_ID\n\t\tIPINFO_TOKEN\n\t\tTENANT_ID\n\t\tCLIENT_ID\n\t\tCLIENT_SECRET\n\t\tRETENTION_IN_DAYS\n\t\tTOTAL_RETENTION_IN_DAYS\n\t\tSCHEDULE\n\t\tLOCATION \n5. Once all application settings have been entered, click **Save**."
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "IPinfoPrivacyDataConnector",
    "title": "IPinfo Privacy Data Connector",
    "publisher": "IPinfo",
    "descriptionMarkdown": "This IPinfo data connector installs an Azure Function app to download standard_privacy datasets and insert it into custom log table in Microsoft Sentinel",
    "graphQueries": [
      {
        "metricName": "Privacy Data",
        "legend": "Ipinfo_Privacy_CL",
        "baseQuery": "Ipinfo_Privacy_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Ipinfo_Privacy_CL",
        "query": "Ipinfo_Privacy_CL"
      }
    ],
    "dataTypes": [
      {
        "name": "Ipinfo_Privacy_CL",
        "lastDataReceivedQuery": "Ipinfo_Privacy_CL | summarize Time = max(TimeGenerated)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Ipinfo_Privacy_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "IPinfo API Token",
          "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Retrieve API Token",
        "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
      },
      {
        "title": "2. In your Azure AD tenant, create an Azure Active Directory (AAD) application",
        "description": "In your Azure AD tenant, create an Azure Active Directory (AAD) application and acquire Tenant ID, Client ID, and Client Secret: Use this Link."
      },
      {
        "title": "3. Assign the AAD application the Microsoft Sentinel Contributor Role.",
        "description": "Assign the AAD application you just created to the Contributor(Privileged administrator roles) and Monitoring Metrics Publisher(Job function roles) in the same Resource Group you use for Log Analytic Workspace on which Microsoft Sentinel is added: Use this Link."
      },
      {
        "title": "4. Get Workspace Resource ID",
        "description": "Use the Log Analytic Workspace -> Properties blade having the 'Resource ID' property value. This is a fully qualified resourceId which is in the format '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}'"
      },
      {
        "title": "5. Deploy the Azure Function",
        "description": "Use this for automated deployment of the IPinfo data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-IPinfo-Privacy-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **RESOURCE_ID**, **IPINFO_TOKEN**, **TENANT_ID**, **CLIENT_ID**, **CLIENT_SECRET**."
      },
      {
        "title": "Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the IPinfo data connector manually with Azure Functions (Deployment via Visual Studio Code).",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Step 1 - Deploy a Function App",
                  "description": "1. Download the Azure Function App file. Extract the archive to your local development computer [Azure Function App](https://aka.ms/sentinel-Ipinfo-Privacy-functionapp). \n2. Create Function App using Hosting Functions Premium or App service plan using advanced option using VSCode. \n3. Follow the function app manual deployment instructions to deploy the Azure Functions app using VSCode. \n4. After successful deployment of the function app, follow the next steps for configuring it."
                },
                {
                  "title": "Step 2 - Configure the Function App",
                  "description": "1. Go to Azure Portal for the Function App configuration.\n2. In the Function App, select the Function App Name and select **Settings** -> **Configuration** or **Environment variables**. \n3. In the **Application settings** tab, select **+ New application setting**.\n4. Add each of the following application settings individually, with their respective string values (case-sensitive):\n\t\tRESOURCE_ID\n\t\tIPINFO_TOKEN\n\t\tTENANT_ID\n\t\tCLIENT_ID\n\t\tCLIENT_SECRET\n\t\tRETENTION_IN_DAYS\n\t\tTOTAL_RETENTION_IN_DAYS\n\t\tSCHEDULE\n\t\tLOCATION \n5. Once all application settings have been entered, click **Save**."
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "IPinfoPrivacyExtendedDataConnector",
    "title": "IPinfo Privacy Extended Data Connector",
    "publisher": "IPinfo",
    "descriptionMarkdown": "This IPinfo data connector installs an Azure Function app to download standard_privacy datasets and insert it into custom log table in Microsoft Sentinel",
    "graphQueries": [
      {
        "metricName": "Privacy Extended Data",
        "legend": "Ipinfo_Privacy_extended_CL",
        "baseQuery": "Ipinfo_Privacy_extended_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Ipinfo_Privacy_extended_CL",
        "query": "Ipinfo_Privacy_extended_CL"
      }
    ],
    "dataTypes": [
      {
        "name": "Ipinfo_Privacy_extended_CL",
        "lastDataReceivedQuery": "Ipinfo_Privacy_extended_CL | summarize Time = max(TimeGenerated)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Ipinfo_Privacy_extended_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "IPinfo API Token",
          "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Retrieve API Token",
        "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
      },
      {
        "title": "2. In your Azure AD tenant, create an Azure Active Directory (AAD) application",
        "description": "In your Azure AD tenant, create an Azure Active Directory (AAD) application and acquire Tenant ID, Client ID, and Client Secret: Use this Link."
      },
      {
        "title": "3. Assign the AAD application the Microsoft Sentinel Contributor Role.",
        "description": "Assign the AAD application you just created to the Contributor(Privileged administrator roles) and Monitoring Metrics Publisher(Job function roles) in the same Resource Group you use for Log Analytic Workspace on which Microsoft Sentinel is added: Use this Link."
      },
      {
        "title": "4. Get Workspace Resource ID",
        "description": "Use the Log Analytic Workspace -> Properties blade having the 'Resource ID' property value. This is a fully qualified resourceId which is in the format '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}'"
      },
      {
        "title": "5. Deploy the Azure Function",
        "description": "Use this for automated deployment of the IPinfo data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-IPinfo-Privacy-Extended-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **RESOURCE_ID**, **IPINFO_TOKEN**, **TENANT_ID**, **CLIENT_ID**, **CLIENT_SECRET**."
      },
      {
        "title": "Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the IPinfo data connector manually with Azure Functions (Deployment via Visual Studio Code).",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Step 1 - Deploy a Function App",
                  "description": "1. Download the Azure Function App file. Extract the archive to your local development computer [Azure Function App](https://aka.ms/sentinel-Ipinfo-Privacy-Extended-functionapp). \n2. Create Function App using Hosting Functions Premium or App service plan using advanced option using VSCode. \n3. Follow the function app manual deployment instructions to deploy the Azure Functions app using VSCode. \n4. After successful deployment of the function app, follow the next steps for configuring it."
                },
                {
                  "title": "Step 2 - Configure the Function App",
                  "description": "1. Go to Azure Portal for the Function App configuration.\n2. In the Function App, select the Function App Name and select **Settings** -> **Configuration** or **Environment variables**. \n3. In the **Application settings** tab, select **+ New application setting**.\n4. Add each of the following application settings individually, with their respective string values (case-sensitive):\n\t\tRESOURCE_ID\n\t\tIPINFO_TOKEN\n\t\tTENANT_ID\n\t\tCLIENT_ID\n\t\tCLIENT_SECRET\n\t\tRETENTION_IN_DAYS\n\t\tTOTAL_RETENTION_IN_DAYS\n\t\tSCHEDULE\n\t\tLOCATION \n5. Once all application settings have been entered, click **Save**."
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "IPinfoRIRWHOISDataConnector",
    "title": "IPinfo RIRWHOIS Data Connector",
    "publisher": "IPinfo",
    "descriptionMarkdown": "This IPinfo data connector installs an Azure Function app to download RIRWHOIS datasets and insert it into custom log table in Microsoft Sentinel",
    "graphQueries": [
      {
        "metricName": "RIRWHOIS Data",
        "legend": "Ipinfo_RIRWHOIS_CL",
        "baseQuery": "Ipinfo_RIRWHOIS_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Ipinfo_RIRWHOIS_CL",
        "query": "Ipinfo_RIRWHOIS_CL"
      }
    ],
    "dataTypes": [
      {
        "name": "Ipinfo_RIRWHOIS_CL",
        "lastDataReceivedQuery": "Ipinfo_RIRWHOIS_CL | summarize Time = max(TimeGenerated)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Ipinfo_RIRWHOIS_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "IPinfo API Token",
          "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Retrieve API Token",
        "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
      },
      {
        "title": "2. In your Azure AD tenant, create an Azure Active Directory (AAD) application",
        "description": "In your Azure AD tenant, create an Azure Active Directory (AAD) application and acquire Tenant ID, Client ID, and Client Secret: Use this Link."
      },
      {
        "title": "3. Assign the AAD application the Microsoft Sentinel Contributor Role.",
        "description": "Assign the AAD application you just created to the Contributor(Privileged administrator roles) and Monitoring Metrics Publisher(Job function roles) in the same Resource Group you use for Log Analytic Workspace on which Microsoft Sentinel is added: Use this Link."
      },
      {
        "title": "4. Get Workspace Resource ID",
        "description": "Use the Log Analytic Workspace -> Properties blade having the 'Resource ID' property value. This is a fully qualified resourceId which is in the format '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}'"
      },
      {
        "title": "5. Deploy the Azure Function",
        "description": "Use this for automated deployment of the IPinfo data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-IPinfo-RIRWHOIS-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **RESOURCE_ID**, **IPINFO_TOKEN**, **TENANT_ID**, **CLIENT_ID**, **CLIENT_SECRET**."
      },
      {
        "title": "Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the IPinfo data connector manually with Azure Functions (Deployment via Visual Studio Code).",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Step 1 - Deploy a Function App",
                  "description": "1. Download the Azure Function App file. Extract the archive to your local development computer [Azure Function App](https://aka.ms/sentinel-Ipinfo-RIRWHOIS-functionapp). \n2. Create Function App using Hosting Functions Premium or App service plan using advanced option using VSCode. \n3. Follow the function app manual deployment instructions to deploy the Azure Functions app using VSCode. \n4. After successful deployment of the function app, follow the next steps for configuring it."
                },
                {
                  "title": "Step 2 - Configure the Function App",
                  "description": "1. Go to Azure Portal for the Function App configuration.\n2. In the Function App, select the Function App Name and select **Settings** -> **Configuration** or **Environment variables**. \n3. In the **Application settings** tab, select **+ New application setting**.\n4. Add each of the following application settings individually, with their respective string values (case-sensitive):\n\t\tRESOURCE_ID\n\t\tIPINFO_TOKEN\n\t\tTENANT_ID\n\t\tCLIENT_ID\n\t\tCLIENT_SECRET\n\t\tRETENTION_IN_DAYS\n\t\tTOTAL_RETENTION_IN_DAYS\n\t\tSCHEDULE\n\t\tLOCATION \n5. Once all application settings have been entered, click **Save**."
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "IPinfoRWHOISDataConnector",
    "title": "IPinfo RWHOIS Data Connector",
    "publisher": "IPinfo",
    "descriptionMarkdown": "This IPinfo data connector installs an Azure Function app to download RWHOIS datasets and insert it into custom log table in Microsoft Sentinel",
    "graphQueries": [
      {
        "metricName": "RWHOIS Data",
        "legend": "Ipinfo_RWHOIS_CL",
        "baseQuery": "Ipinfo_RWHOIS_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Ipinfo_RWHOIS_CL",
        "query": "Ipinfo_RWHOIS_CL"
      }
    ],
    "dataTypes": [
      {
        "name": "Ipinfo_RWHOIS_CL",
        "lastDataReceivedQuery": "Ipinfo_RWHOIS_CL | summarize Time = max(TimeGenerated)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Ipinfo_RWHOIS_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "IPinfo API Token",
          "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Retrieve API Token",
        "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
      },
      {
        "title": "2. In your Azure AD tenant, create an Azure Active Directory (AAD) application",
        "description": "In your Azure AD tenant, create an Azure Active Directory (AAD) application and acquire Tenant ID, Client ID, and Client Secret: Use this Link."
      },
      {
        "title": "3. Assign the AAD application the Microsoft Sentinel Contributor Role.",
        "description": "Assign the AAD application you just created to the Contributor(Privileged administrator roles) and Monitoring Metrics Publisher(Job function roles) in the same Resource Group you use for Log Analytic Workspace on which Microsoft Sentinel is added: Use this Link."
      },
      {
        "title": "4. Get Workspace Resource ID",
        "description": "Use the Log Analytic Workspace -> Properties blade having the 'Resource ID' property value. This is a fully qualified resourceId which is in the format '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}'"
      },
      {
        "title": "5. Deploy the Azure Function",
        "description": "Use this for automated deployment of the IPinfo data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-IPinfo-RWHOIS-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **RESOURCE_ID**, **IPINFO_TOKEN**, **TENANT_ID**, **CLIENT_ID**, **CLIENT_SECRET**."
      },
      {
        "title": "Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the IPinfo data connector manually with Azure Functions (Deployment via Visual Studio Code).",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Step 1 - Deploy a Function App",
                  "description": "1. Download the Azure Function App file. Extract the archive to your local development computer [Azure Function App](https://aka.ms/sentinel-Ipinfo-RWHOIS-functionapp). \n2. Create Function App using Hosting Functions Premium or App service plan using advanced option using VSCode. \n3. Follow the function app manual deployment instructions to deploy the Azure Functions app using VSCode. \n4. After successful deployment of the function app, follow the next steps for configuring it."
                },
                {
                  "title": "Step 2 - Configure the Function App",
                  "description": "1. Go to Azure Portal for the Function App configuration.\n2. In the Function App, select the Function App Name and select **Settings** -> **Configuration** or **Environment variables**. \n3. In the **Application settings** tab, select **+ New application setting**.\n4. Add each of the following application settings individually, with their respective string values (case-sensitive):\n\t\tRESOURCE_ID\n\t\tIPINFO_TOKEN\n\t\tTENANT_ID\n\t\tCLIENT_ID\n\t\tCLIENT_SECRET\n\t\tRETENTION_IN_DAYS\n\t\tTOTAL_RETENTION_IN_DAYS\n\t\tSCHEDULE\n\t\tLOCATION \n5. Once all application settings have been entered, click **Save**."
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "IPinfoWHOISASNDataConnector",
    "title": "IPinfo WHOIS ASN Data Connector",
    "publisher": "IPinfo",
    "descriptionMarkdown": "This IPinfo data connector installs an Azure Function app to download WHOIS_ASN datasets and insert it into custom log table in Microsoft Sentinel",
    "graphQueries": [
      {
        "metricName": "WHOIS_ASN Data",
        "legend": "Ipinfo_WHOIS_ASN_CL",
        "baseQuery": "Ipinfo_WHOIS_ASN_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Ipinfo_WHOIS_ASN_CL",
        "query": "Ipinfo_WHOIS_ASN_CL"
      }
    ],
    "dataTypes": [
      {
        "name": "Ipinfo_WHOIS_ASN_CL",
        "lastDataReceivedQuery": "Ipinfo_WHOIS_ASN_CL | summarize Time = max(TimeGenerated)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Ipinfo_WHOIS_ASN_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "IPinfo API Token",
          "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Retrieve API Token",
        "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
      },
      {
        "title": "2. In your Azure AD tenant, create an Azure Active Directory (AAD) application",
        "description": "In your Azure AD tenant, create an Azure Active Directory (AAD) application and acquire Tenant ID, Client ID, and Client Secret: Use this Link."
      },
      {
        "title": "3. Assign the AAD application the Microsoft Sentinel Contributor Role.",
        "description": "Assign the AAD application you just created to the Contributor(Privileged administrator roles) and Monitoring Metrics Publisher(Job function roles) in the same Resource Group you use for Log Analytic Workspace on which Microsoft Sentinel is added: Use this Link."
      },
      {
        "title": "4. Get Workspace Resource ID",
        "description": "Use the Log Analytic Workspace -> Properties blade having the 'Resource ID' property value. This is a fully qualified resourceId which is in the format '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}'"
      },
      {
        "title": "5. Deploy the Azure Function",
        "description": "Use this for automated deployment of the IPinfo data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-IPinfo-WHOIS-ASN-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **RESOURCE_ID**, **IPINFO_TOKEN**, **TENANT_ID**, **CLIENT_ID**, **CLIENT_SECRET**."
      },
      {
        "title": "Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the IPinfo data connector manually with Azure Functions (Deployment via Visual Studio Code).",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Step 1 - Deploy a Function App",
                  "description": "1. Download the Azure Function App file. Extract the archive to your local development computer [Azure Function App](https://aka.ms/sentinel-Ipinfo-WHOIS-ASN-functionapp). \n2. Create Function App using Hosting Functions Premium or App service plan using advanced option using VSCode. \n3. Follow the function app manual deployment instructions to deploy the Azure Functions app using VSCode. \n4. After successful deployment of the function app, follow the next steps for configuring it."
                },
                {
                  "title": "Step 2 - Configure the Function App",
                  "description": "1. Go to Azure Portal for the Function App configuration.\n2. In the Function App, select the Function App Name and select **Settings** -> **Configuration** or **Environment variables**. \n3. In the **Application settings** tab, select **+ New application setting**.\n4. Add each of the following application settings individually, with their respective string values (case-sensitive):\n\t\tRESOURCE_ID\n\t\tIPINFO_TOKEN\n\t\tTENANT_ID\n\t\tCLIENT_ID\n\t\tCLIENT_SECRET\n\t\tRETENTION_IN_DAYS\n\t\tTOTAL_RETENTION_IN_DAYS\n\t\tSCHEDULE\n\t\tLOCATION \n5. Once all application settings have been entered, click **Save**."
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "IPinfoWHOISMNTDataConnector",
    "title": "IPinfo WHOIS MNT Data Connector",
    "publisher": "IPinfo",
    "descriptionMarkdown": "This IPinfo data connector installs an Azure Function app to download WHOIS_MNT datasets and insert it into custom log table in Microsoft Sentinel",
    "graphQueries": [
      {
        "metricName": "WHOIS_MNT Data",
        "legend": "Ipinfo_WHOIS_MNT_CL",
        "baseQuery": "Ipinfo_WHOIS_MNT_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Ipinfo_WHOIS_MNT_CL",
        "query": "Ipinfo_WHOIS_MNT_CL"
      }
    ],
    "dataTypes": [
      {
        "name": "Ipinfo_WHOIS_MNT_CL",
        "lastDataReceivedQuery": "Ipinfo_WHOIS_MNT_CL | summarize Time = max(TimeGenerated)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Ipinfo_WHOIS_MNT_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "IPinfo API Token",
          "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Retrieve API Token",
        "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
      },
      {
        "title": "2. In your Azure AD tenant, create an Azure Active Directory (AAD) application",
        "description": "In your Azure AD tenant, create an Azure Active Directory (AAD) application and acquire Tenant ID, Client ID, and Client Secret: Use this Link."
      },
      {
        "title": "3. Assign the AAD application the Microsoft Sentinel Contributor Role.",
        "description": "Assign the AAD application you just created to the Contributor(Privileged administrator roles) and Monitoring Metrics Publisher(Job function roles) in the same Resource Group you use for Log Analytic Workspace on which Microsoft Sentinel is added: Use this Link."
      },
      {
        "title": "4. Get Workspace Resource ID",
        "description": "Use the Log Analytic Workspace -> Properties blade having the 'Resource ID' property value. This is a fully qualified resourceId which is in the format '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}'"
      },
      {
        "title": "5. Deploy the Azure Function",
        "description": "Use this for automated deployment of the IPinfo data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-IPinfo-WHOIS-MNT-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **RESOURCE_ID**, **IPINFO_TOKEN**, **TENANT_ID**, **CLIENT_ID**, **CLIENT_SECRET**."
      },
      {
        "title": "Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the IPinfo data connector manually with Azure Functions (Deployment via Visual Studio Code).",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Step 1 - Deploy a Function App",
                  "description": "1. Download the Azure Function App file. Extract the archive to your local development computer [Azure Function App](https://aka.ms/sentinel-Ipinfo-WHOIS-MNT-functionapp). \n2. Create Function App using Hosting Functions Premium or App service plan using advanced option using VSCode. \n3. Follow the function app manual deployment instructions to deploy the Azure Functions app using VSCode. \n4. After successful deployment of the function app, follow the next steps for configuring it."
                },
                {
                  "title": "Step 2 - Configure the Function App",
                  "description": "1. Go to Azure Portal for the Function App configuration.\n2. In the Function App, select the Function App Name and select **Settings** -> **Configuration** or **Environment variables**. \n3. In the **Application settings** tab, select **+ New application setting**.\n4. Add each of the following application settings individually, with their respective string values (case-sensitive):\n\t\tRESOURCE_ID\n\t\tIPINFO_TOKEN\n\t\tTENANT_ID\n\t\tCLIENT_ID\n\t\tCLIENT_SECRET\n\t\tRETENTION_IN_DAYS\n\t\tTOTAL_RETENTION_IN_DAYS\n\t\tSCHEDULE\n\t\tLOCATION \n5. Once all application settings have been entered, click **Save**."
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "IPinfoWHOISNETDataConnector",
    "title": "IPinfo WHOIS NET Data Connector",
    "publisher": "IPinfo",
    "descriptionMarkdown": "This IPinfo data connector installs an Azure Function app to download WHOIS_NET datasets and insert it into custom log table in Microsoft Sentinel",
    "graphQueries": [
      {
        "metricName": "WHOIS_NET Data",
        "legend": "Ipinfo_WHOIS_NET_CL",
        "baseQuery": "Ipinfo_WHOIS_NET_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Ipinfo_WHOIS_NET_CL",
        "query": "Ipinfo_WHOIS_NET_CL"
      }
    ],
    "dataTypes": [
      {
        "name": "Ipinfo_WHOIS_NET_CL",
        "lastDataReceivedQuery": "Ipinfo_WHOIS_NET_CL | summarize Time = max(TimeGenerated)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Ipinfo_WHOIS_NET_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "IPinfo API Token",
          "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Retrieve API Token",
        "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
      },
      {
        "title": "2. In your Azure AD tenant, create an Azure Active Directory (AAD) application",
        "description": "In your Azure AD tenant, create an Azure Active Directory (AAD) application and acquire Tenant ID, Client ID, and Client Secret: Use this Link."
      },
      {
        "title": "3. Assign the AAD application the Microsoft Sentinel Contributor Role.",
        "description": "Assign the AAD application you just created to the Contributor(Privileged administrator roles) and Monitoring Metrics Publisher(Job function roles) in the same Resource Group you use for Log Analytic Workspace on which Microsoft Sentinel is added: Use this Link."
      },
      {
        "title": "4. Get Workspace Resource ID",
        "description": "Use the Log Analytic Workspace -> Properties blade having the 'Resource ID' property value. This is a fully qualified resourceId which is in the format '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}'"
      },
      {
        "title": "5. Deploy the Azure Function",
        "description": "Use this for automated deployment of the IPinfo data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-IPinfo-WHOIS-NET-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **RESOURCE_ID**, **IPINFO_TOKEN**, **TENANT_ID**, **CLIENT_ID**, **CLIENT_SECRET**."
      },
      {
        "title": "Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the IPinfo data connector manually with Azure Functions (Deployment via Visual Studio Code).",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Step 1 - Deploy a Function App",
                  "description": "1. Download the Azure Function App file. Extract the archive to your local development computer [Azure Function App](https://aka.ms/sentinel-Ipinfo-WHOIS-NET-functionapp). \n2. Create Function App using Hosting Functions Premium or App service plan using advanced option using VSCode. \n3. Follow the function app manual deployment instructions to deploy the Azure Functions app using VSCode. \n4. After successful deployment of the function app, follow the next steps for configuring it."
                },
                {
                  "title": "Step 2 - Configure the Function App",
                  "description": "1. Go to Azure Portal for the Function App configuration.\n2. In the Function App, select the Function App Name and select **Settings** -> **Configuration** or **Environment variables**. \n3. In the **Application settings** tab, select **+ New application setting**.\n4. Add each of the following application settings individually, with their respective string values (case-sensitive):\n\t\tRESOURCE_ID\n\t\tIPINFO_TOKEN\n\t\tTENANT_ID\n\t\tCLIENT_ID\n\t\tCLIENT_SECRET\n\t\tRETENTION_IN_DAYS\n\t\tTOTAL_RETENTION_IN_DAYS\n\t\tSCHEDULE\n\t\tLOCATION \n5. Once all application settings have been entered, click **Save**."
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "IPinfoWHOISORGDataConnector",
    "title": "IPinfo WHOIS ORG Data Connector",
    "publisher": "IPinfo",
    "descriptionMarkdown": "This IPinfo data connector installs an Azure Function app to download WHOIS_ORG datasets and insert it into custom log table in Microsoft Sentinel",
    "graphQueries": [
      {
        "metricName": "WHOIS_ORG Data",
        "legend": "Ipinfo_WHOIS_ORG_CL",
        "baseQuery": "Ipinfo_WHOIS_ORG_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Ipinfo_WHOIS_ORG_CL",
        "query": "Ipinfo_WHOIS_ORG_CL"
      }
    ],
    "dataTypes": [
      {
        "name": "Ipinfo_WHOIS_ORG_CL",
        "lastDataReceivedQuery": "Ipinfo_WHOIS_ORG_CL | summarize Time = max(TimeGenerated)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Ipinfo_WHOIS_ORG_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "IPinfo API Token",
          "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Retrieve API Token",
        "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
      },
      {
        "title": "2. In your Azure AD tenant, create an Azure Active Directory (AAD) application",
        "description": "In your Azure AD tenant, create an Azure Active Directory (AAD) application and acquire Tenant ID, Client ID, and Client Secret: Use this Link."
      },
      {
        "title": "3. Assign the AAD application the Microsoft Sentinel Contributor Role.",
        "description": "Assign the AAD application you just created to the Contributor(Privileged administrator roles) and Monitoring Metrics Publisher(Job function roles) in the same Resource Group you use for Log Analytic Workspace on which Microsoft Sentinel is added: Use this Link."
      },
      {
        "title": "4. Get Workspace Resource ID",
        "description": "Use the Log Analytic Workspace -> Properties blade having the 'Resource ID' property value. This is a fully qualified resourceId which is in the format '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}'"
      },
      {
        "title": "5. Deploy the Azure Function",
        "description": "Use this for automated deployment of the IPinfo data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-IPinfo-WHOIS-ORG-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **RESOURCE_ID**, **IPINFO_TOKEN**, **TENANT_ID**, **CLIENT_ID**, **CLIENT_SECRET**."
      },
      {
        "title": "Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the IPinfo data connector manually with Azure Functions (Deployment via Visual Studio Code).",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Step 1 - Deploy a Function App",
                  "description": "1. Download the Azure Function App file. Extract the archive to your local development computer [Azure Function App](https://aka.ms/sentinel-Ipinfo-WHOIS-ORG-functionapp). \n2. Create Function App using Hosting Functions Premium or App service plan using advanced option using VSCode. \n3. Follow the function app manual deployment instructions to deploy the Azure Functions app using VSCode. \n4. After successful deployment of the function app, follow the next steps for configuring it."
                },
                {
                  "title": "Step 2 - Configure the Function App",
                  "description": "1. Go to Azure Portal for the Function App configuration.\n2. In the Function App, select the Function App Name and select **Settings** -> **Configuration** or **Environment variables**. \n3. In the **Application settings** tab, select **+ New application setting**.\n4. Add each of the following application settings individually, with their respective string values (case-sensitive):\n\t\tRESOURCE_ID\n\t\tIPINFO_TOKEN\n\t\tTENANT_ID\n\t\tCLIENT_ID\n\t\tCLIENT_SECRET\n\t\tRETENTION_IN_DAYS\n\t\tTOTAL_RETENTION_IN_DAYS\n\t\tSCHEDULE\n\t\tLOCATION \n5. Once all application settings have been entered, click **Save**."
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "IPinfoWHOISPOCDataConnector",
    "title": "IPinfo WHOIS POC Data Connector",
    "publisher": "IPinfo",
    "descriptionMarkdown": "This IPinfo data connector installs an Azure Function app to download WHOIS_POC datasets and insert it into custom log table in Microsoft Sentinel",
    "graphQueries": [
      {
        "metricName": "WHOIS_POC Data",
        "legend": "Ipinfo_WHOIS_POC_CL",
        "baseQuery": "Ipinfo_WHOIS_POC_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Ipinfo_WHOIS_POC_CL",
        "query": "Ipinfo_WHOIS_POC_CL"
      }
    ],
    "dataTypes": [
      {
        "name": "Ipinfo_WHOIS_POC_CL",
        "lastDataReceivedQuery": "Ipinfo_WHOIS_POC_CL | summarize Time = max(TimeGenerated)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Ipinfo_WHOIS_POC_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "IPinfo API Token",
          "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Retrieve API Token",
        "description": "Retrieve your IPinfo API Token [here](https://ipinfo.io/)."
      },
      {
        "title": "2. In your Azure AD tenant, create an Azure Active Directory (AAD) application",
        "description": "In your Azure AD tenant, create an Azure Active Directory (AAD) application and acquire Tenant ID, Client ID, and Client Secret: Use this Link."
      },
      {
        "title": "3. Assign the AAD application the Microsoft Sentinel Contributor Role.",
        "description": "Assign the AAD application you just created to the Contributor(Privileged administrator roles) and Monitoring Metrics Publisher(Job function roles) in the same Resource Group you use for Log Analytic Workspace on which Microsoft Sentinel is added: Use this Link."
      },
      {
        "title": "4. Get Workspace Resource ID",
        "description": "Use the Log Analytic Workspace -> Properties blade having the 'Resource ID' property value. This is a fully qualified resourceId which is in the format '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}'"
      },
      {
        "title": "5. Deploy the Azure Function",
        "description": "Use this for automated deployment of the IPinfo data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-IPinfo-WHOIS-POC-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **RESOURCE_ID**, **IPINFO_TOKEN**, **TENANT_ID**, **CLIENT_ID**, **CLIENT_SECRET**."
      },
      {
        "title": "Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the IPinfo data connector manually with Azure Functions (Deployment via Visual Studio Code).",
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Step 1 - Deploy a Function App",
                  "description": "1. Download the Azure Function App file. Extract the archive to your local development computer [Azure Function App](https://aka.ms/sentinel-Ipinfo-WHOIS-POC-functionapp). \n2. Create Function App using Hosting Functions Premium or App service plan using advanced option using VSCode. \n3. Follow the function app manual deployment instructions to deploy the Azure Functions app using VSCode. \n4. After successful deployment of the function app, follow the next steps for configuring it."
                },
                {
                  "title": "Step 2 - Configure the Function App",
                  "description": "1. Go to Azure Portal for the Function App configuration.\n2. In the Function App, select the Function App Name and select **Settings** -> **Configuration** or **Environment variables**. \n3. In the **Application settings** tab, select **+ New application setting**.\n4. Add each of the following application settings individually, with their respective string values (case-sensitive):\n\t\tRESOURCE_ID\n\t\tIPINFO_TOKEN\n\t\tTENANT_ID\n\t\tCLIENT_ID\n\t\tCLIENT_SECRET\n\t\tRETENTION_IN_DAYS\n\t\tTOTAL_RETENTION_IN_DAYS\n\t\tSCHEDULE\n\t\tLOCATION \n5. Once all application settings have been entered, click **Save**."
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "ISCBind",
    "title": "[Deprecated] ISC Bind",
    "publisher": "ISC",
    "descriptionMarkdown": "The [ISC Bind](https://www.isc.org/bind/) connector allows you to easily connect your ISC Bind logs with Microsoft Sentinel. This gives you more insight into your organization's network traffic data, DNS query data, traffic statistics and improves your security operation capabilities.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ISCBind",
        "baseQuery": "ISCBind"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Domains Queried",
        "query": "ISCBind \n| where EventSubType == \"request\" \n| summarize count() by DnsQuery \n| top 10 by count_"
      },
      {
        "description": "Top 10 clients by Source IP Address",
        "query": "ISCBind \n| where EventSubType == \"request\" \n| summarize count() by SrcIpAddr \n| top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog (ISCBind)",
        "lastDataReceivedQuery": "ISCBind \n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ISCBind \n      | where TimeGenerated > ago(3d)\n       |take 1\n       | project IsConnected = true"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "write permission is required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "ISC Bind",
          "description": "must be configured to export logs via Syslog"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias ISCBind and load the function code or click [here](https://aka.ms/sentinel-iscbind-parser).The function usually takes 10-15 minutes to activate after solution installation/update.",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux",
        "description": "Typically, you should install the agent on a different computer from the one on which the logs are generated.\n\n>  Syslog logs are collected only from **Linux** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Configure the facilities you want to collect and their severities.\n 1. Under workspace advanced settings **Configuration**, select **Data** and then **Syslog**.\n 2. Select **Apply below configuration to my machines** and select the facilities and severities.\n 3.  Click **Save**.",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenSyslogSettings"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "3. Configure and connect the ISC Bind",
        "description": "1. Follow these instructions to configure the ISC Bind to forward syslog: \n - [DNS Logs](https://kb.isc.org/docs/aa-01526) \n2. Configure Syslog to send the Syslog traffic to Agent. Use the IP address or hostname for the Linux device with the Linux agent installed as the Destination IP address."
      }
    ],
    "metadata": {
      "id": "c6571a09-375c-4482-9cf9-15bb7935f201",
      "version": "1.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "ISCBind"
      },
      "author": {
        "name": "Microsoft"
      },
      "support": {
        "tier": "microsoft",
        "name": "Microsoft",
        "email": "support@microsoft.com"
      }
    }
  },
  {
    "id": "IvantiUEM",
    "title": "[Deprecated] Ivanti Unified Endpoint Management",
    "publisher": "Ivanti",
    "descriptionMarkdown": "The [Ivanti Unified Endpoint Management](https://www.ivanti.com/products/unified-endpoint-manager) data connector provides the capability to ingest [Ivanti UEM Alerts](https://help.ivanti.com/ld/help/en_US/LDMS/11.0/Windows/alert-c-monitoring-overview.htm) into Microsoft Sentinel.",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected [**IvantiUEMEvent**](https://aka.ms/sentinel-ivantiuem-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "IvantiUEM",
        "baseQuery": "IvantiUEMEvent"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Sources",
        "query": "IvantiUEMEvent\n | summarize count() by tostring(SrcHostname)\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog (IvantiUEMEvent)",
        "lastDataReceivedQuery": "IvantiUEMEvent\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "IvantiUEMEvent\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**IvantiUEMEvent**](https://aka.ms/sentinel-ivantiuem-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "",
        "description": ">**NOTE:** This data connector has been developed using Ivanti Unified Endpoint Management Release 2021.1 Version 11.0.3.374",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux or Windows",
        "description": "Install the agent on the Server where the Ivanti Unified Endpoint Management Alerts are forwarded.\n\n> Logs from Ivanti Unified Endpoint Management Server deployed on Linux or Windows servers are collected by **Linux** or **Windows** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Linux agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Windows agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Windows Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Windows Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure Ivanti Unified Endpoint Management alert forwarding.",
        "description": "[Follow the instructions](https://help.ivanti.com/ld/help/en_US/LDMS/11.0/Windows/alert-t-define-action.htm) to set up Alert Actions to send logs to syslog server."
      }
    ]
  },
  {
    "id": "JamfProtectPush",
    "title": "Jamf Protect Push Connector",
    "publisher": "Jamf",
    "descriptionMarkdown": "The [Jamf Protect](https://www.jamf.com/products/jamf-protect/) connector provides the capability to read raw event data from Jamf Protect in Microsoft Sentinel.",
    "graphQueries": [
      {
        "metricName": "Telemetry",
        "legend": "jamfprotecttelemetryv2_CL",
        "baseQuery": "jamfprotecttelemetryv2_CL"
      },
      {
        "metricName": "Unified Logs",
        "legend": "jamfprotectunifiedlogs_CL",
        "baseQuery": "jamfprotectunifiedlogs_CL"
      },
      {
        "metricName": "Alerts",
        "legend": "jamfprotectalerts_CL",
        "baseQuery": "jamfprotectalerts_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Jamf Protect - All Alerts",
        "query": "jamfprotectalerts_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Jamf Protect - All Telemetry events",
        "query": "jamfprotecttelemetryv2_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "jamfprotecttelemetryv2_CL",
        "lastDataReceivedQuery": "jamfprotecttelemetryv2_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "jamfprotectunifiedlogs_CL",
        "lastDataReceivedQuery": "jamfprotectunifiedlogs_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "jamfprotectalerts_CL",
        "lastDataReceivedQuery": "jamfprotectalerts_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1
    },
    "metadata": null
  },
  {
    "id": "JBossEAP",
    "title": "[Deprecated] JBoss Enterprise Application Platform",
    "publisher": "Red Hat",
    "descriptionMarkdown": "The JBoss Enterprise Application Platform data connector provides the capability to ingest [JBoss](https://www.redhat.com/en/technologies/jboss-middleware/application-platform) events into Microsoft Sentinel. Refer to [Red Hat documentation](https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.0/html/configuration_guide/logging_with_jboss_eap) for more information.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "JBossLogs_CL",
        "baseQuery": "JBossEvent"
      }
    ],
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected [**JBossEvent**](https://aka.ms/sentinel-jbosseap-parser) which is deployed with the Microsoft Sentinel Solution.",
    "sampleQueries": [
      {
        "description": "Top 10 Processes",
        "query": "JBossEvent\n            | summarize count() by ActingProcessName \n            | top 10 by count_"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "JBossEvent\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "JBossLogs_CL",
        "lastDataReceivedQuery": "JBossEvent\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 2,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**JBossEvent**](https://aka.ms/sentinel-jbosseap-parser) which is deployed with the Microsoft Sentinel Solution."
      },
      {
        "title": "",
        "description": ">**NOTE:** This data connector has been developed using JBoss Enterprise Application Platform 7.4.0.",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux or Windows",
        "description": "Install the agent on the JBoss server where the logs are generated.\n\n>  Logs from JBoss Server deployed on Linux or Windows servers are collected by **Linux** or **Windows** agents.\n    ",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Linux agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Windows agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Windows Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Windows Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Configure the custom log directory to be collected",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenCustomLogsSettings"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "description": "1. Select the link above to open your workspace advanced settings \n2. Click **+Add custom**\n3. Click **Browse** to upload a sample of a JBoss log file (e.g. server.log). Then, click **Next >**\n4. Select **Timestamp** as the record delimiter and select Timestamp format **YYYY-MM-DD HH:MM:SS** from the dropdown list then click **Next >**\n5. Select **Windows** or **Linux** and enter the path to JBoss logs based on your configuration. Example:\n - **Linux** Directory:\n\n>Standalone server: EAP_HOME/standalone/log/server.log\n\n>Managed domain: EAP_HOME/domain/servers/SERVER_NAME/log/server.log\n\n6. After entering the path, click the '+' symbol to apply, then click **Next >** \n7. Add **JBossLogs** as the custom log Name and click **Done**"
      },
      {
        "title": "3. Check logs in Microsoft Sentinel",
        "description": "Open Log Analytics to check if the logs are received using the JBossLogs_CL Custom log table.\n\n>**NOTE:** It may take up to 30 minutes before new logs will appear in JBossLogs_CL table.",
        "instructions": []
      }
    ]
  },
  {
    "id": "JiraAuditAPI",
    "title": "Atlassian Jira Audit",
    "publisher": "Atlassian",
    "descriptionMarkdown": "The [Atlassian Jira](https://www.atlassian.com/software/jira) Audit data connector provides the capability to ingest [Jira Audit Records](https://support.atlassian.com/jira-cloud-administration/docs/audit-activities-in-jira-applications/) events into Microsoft Sentinel through the REST API. Refer to [API documentation](https://developer.atlassian.com/cloud/jira/platform/rest/v3/api-group-audit-records/) for more information. The connector provides ability to get events which helps to examine potential security risks, analyze your team's use of collaboration, diagnose configuration problems and more.",
    "additionalRequirementBanner": "These queries and workbooks are dependent on a parser based on Kusto to work as expected. Follow the steps to use this Kusto functions alias **JiraAudit** in queries and workbooks [Follow steps to get this Kusto functions>](https://aka.ms/sentinel-jiraauditapi-parser).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Jira_Audit_CL",
        "baseQuery": "Jira_Audit_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Jira Audit Events - All Activities",
        "query": "JiraAudit\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Jira_Audit_CL",
        "lastDataReceivedQuery": "Jira_Audit_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Jira_Audit_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "**JiraAccessToken**, **JiraUsername** is required for REST API. [See the documentation to learn more about API](https://developer.atlassian.com/cloud/jira/platform/rest/v3/api-group-audit-records/). Check all [requirements and follow  the instructions](https://developer.atlassian.com/cloud/jira/platform/rest/v3/intro/#authentication) for obtaining credentials."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Jira REST API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected. [Follow these steps](https://aka.ms/sentinel-jiraauditapi-parser) to create the Kusto functions alias, **JiraAudit**"
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the Jira API**\n\n [Follow the instructions](https://developer.atlassian.com/cloud/jira/platform/rest/v3/intro/#authentication) to obtain the credentials. \n"
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Workspace data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following).",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the Jira Audit data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentineljiraauditazuredeploy) [![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://aka.ms/sentineljiraauditazuredeploy-gov)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n> **NOTE:** Within the same resource group, you can't mix Windows and Linux apps in the same region. Select existing resource group without Windows apps in it or create new resource group.\n3. Enter the **JiraAccessToken**, **JiraUsername**, **JiraHomeSiteName** (short site name part, as example HOMESITENAME from https://community.atlassian.com) and deploy. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the Jira Audit data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-jiraauditapi-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. JiraAuditXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.11.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select ** New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tJiraUsername\n\t\tJiraAccessToken\n\t\tJiraHomeSiteName\n\t\tWorkspaceID\n\t\tWorkspaceKey\n\t\tlogAnalyticsUri (optional)\n> - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n3. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "JiraAuditCCPDefinition",
    "title": "Atlassian Jira Audit (using REST API)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The [Atlassian Jira](https://www.atlassian.com/software/jira) Audit data connector provides the capability to ingest [Jira Audit Records](https://support.atlassian.com/jira-cloud-administration/docs/audit-activities-in-jira-applications/) events into Microsoft Sentinel through the REST API. Refer to [API documentation](https://developer.atlassian.com/cloud/jira/platform/rest/v3/api-group-audit-records/) for more information. The connector provides ability to get events which helps to examine potential security risks, analyze your team's use of collaboration, diagnose configuration problems and more.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Jira Audit Events",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Atlassian Jira audit logs",
        "query": "{{graphQueriesTableName}}\n| sort by TimeGenerated desc"
      },
      {
        "description": "Total Events",
        "query": "{{graphQueriesTableName}}\n | summarize count() by OriginalEventUid"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}|summarize Time = max  (TimeGenerated)\n|where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": null,
    "metadata": null
  },
  {
    "id": "JuniperIDP",
    "title": "[Deprecated] Juniper IDP",
    "publisher": "Juniper",
    "descriptionMarkdown": "The [Juniper](https://www.juniper.net/) IDP data connector provides the capability to ingest [Juniper IDP](https://www.juniper.net/documentation/us/en/software/junos/idp-policy/topics/topic-map/security-idp-overview.html) events into Microsoft Sentinel.",
    "additionalRequirementBanner": "This data connector depends on a parser based on Kusto Function to work as expected [**JuniperIDP**](https://aka.ms/sentinel-JuniperIDP-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "JuniperIDP_CL",
        "baseQuery": "JuniperIDP"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Clients (Source IP)",
        "query": "JuniperIDP\n | summarize count() by SrcIpAddr\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "JuniperIDP_CL",
        "lastDataReceivedQuery": "JuniperIDP\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "JuniperIDP\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on Kusto Function to work as expected [**JuniperIDP**](https://aka.ms/sentinel-JuniperIDP-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "",
        "description": ">**NOTE:**  IDP OS 5.1 and above is supported by this data connector.",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux or Windows",
        "description": "Install the agent on the Server.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Linux agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Windows agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Windows Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Windows Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Follow the configuration steps below to get Juniper IDP logs into Microsoft Sentinel. This configuration enriches events generated by Juniper IDP module to provide visibility on log source information for Juniper IDP logs. Refer to the [Azure Monitor Documentation](https://docs.microsoft.com/azure/azure-monitor/agents/data-sources-json) for more details on these steps.\n1. Download config file [juniper_idp.conf](https://aka.ms/sentinel-JuniperIDP-conf).\n2. Login to the server where you have installed Azure Log Analytics agent.\n3. Copy juniper_idp.conf to the /etc/opt/microsoft/omsagent/**workspace_id**/conf/omsagent.d/ folder.\n4. Edit juniper_idp.conf as follows:\n\n\t i. change the listen port for receiving logs based on your configuration (line 3)\n\n\t ii. replace **workspace_id** with real value of your Workspace ID (lines 58,59,60,63)\n5. Save changes and restart the Azure Log Analytics agent for Linux service with the following command:\n\t\tsudo /opt/microsoft/omsagent/bin/service_control restart\n6. To configure a remote syslog destination, please reference the [SRX Getting Started - Configure System Logging](https://kb.juniper.net/InfoCenter/index?page=content&id=kb16502).",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ]
  },
  {
    "id": "JuniperSRX",
    "title": "[Deprecated] Juniper SRX",
    "publisher": "Juniper",
    "descriptionMarkdown": "The [Juniper SRX](https://www.juniper.net/us/en/products-services/security/srx-series/) connector allows you to easily connect your Juniper SRX logs with Microsoft Sentinel. This gives you more insight into your organization's network and improves your security operation capabilities.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "JuniperSRX",
        "baseQuery": "JuniperSRX"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Users with Failed Passwords",
        "query": "JuniperSRX \n| where EventType == \"sshd\" \n| where EventName == \"Failed password\" \n| summarize count() by UserName \n| top 10 by count_"
      },
      {
        "description": "Top 10 IDS Detections by Source IP Address",
        "query": "JuniperSRX \n| where EventType == \"RT_IDS\" \n| summarize count() by SrcIpAddr \n| top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog (JuniperSRX)",
        "lastDataReceivedQuery": "JuniperSRX \n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "JuniperSRX \n      | where TimeGenerated > ago(3d)\n       |take 1\n       | project IsConnected = true"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "write permission is required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "Juniper SRX",
          "description": "must be configured to export logs via Syslog"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias JuniperSRX and load the function code or click [here](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Juniper%20SRX/Parsers/JuniperSRX.txt), on the second line of the query, enter the hostname(s) of your JuniperSRX device(s) and any other unique identifiers for the logstream. The function usually takes 10-15 minutes to activate after solution installation/update.",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux",
        "description": "Typically, you should install the agent on a different computer from the one on which the logs are generated.\n\n>  Syslog logs are collected only from **Linux** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Configure the facilities you want to collect and their severities.\n 1. Under workspace advanced settings **Configuration**, select **Data** and then **Syslog**.\n 2. Select **Apply below configuration to my machines** and select the facilities and severities.\n 3.  Click **Save**.",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenSyslogSettings"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "3. Configure and connect the Juniper SRX",
        "description": "1. Follow these instructions to configure the Juniper SRX to forward syslog: \n - [Traffic Logs (Security Policy Logs)](https://kb.juniper.net/InfoCenter/index?page=content&id=KB16509&actp=METADATA) \n - [System Logs](https://kb.juniper.net/InfoCenter/index?page=content&id=kb16502)\n2. Use the IP address or hostname for the Linux device with the Linux agent installed as the Destination IP address."
      }
    ]
  },
  {
    "id": "KeeperSecurityPush2",
    "title": "Keeper Security Push Connector",
    "publisher": "Keeper Security",
    "descriptionMarkdown": "The [Keeper Security](https://keepersecurity.com) connector provides the capability to read raw event data from Keeper Security in Microsoft Sentinel.",
    "graphQueries": [
      {
        "metricName": "Events Logs",
        "legend": "KeeperSecurityEventNewLogs_CL",
        "baseQuery": "KeeperSecurityEventNewLogs_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Keeper Security - All Events Logs",
        "query": "KeeperSecurityEventNewLogs_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "KeeperSecurityEventNewLogs_CL",
        "lastDataReceivedQuery": "KeeperSecurityEventNewLogs_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1
    },
    "metadata": null
  },
  {
    "id": "LookoutAPI",
    "title": "[DEPRECATED] Lookout",
    "publisher": "Lookout",
    "descriptionMarkdown": "The [Lookout](https://lookout.com) data connector provides the capability to ingest [Lookout](https://enterprise.support.lookout.com/hc/en-us/articles/115002741773-Mobile-Risk-API-Guide#commoneventfields) events into Microsoft Sentinel through the Mobile Risk API. Refer to [API documentation](https://enterprise.support.lookout.com/hc/en-us/articles/115002741773-Mobile-Risk-API-Guide) for more information. The [Lookout](https://lookout.com) data connector provides ability to get events which helps to examine potential security risks and more.\n\n<p><span style='color:red; font-weight:bold;'>NOTE</span>: This data connector has been deprecated, consider moving to the CCF data connector available in the solution which replaces ingestion via the <a href='https://learn.microsoft.com/en-us/azure/azure-monitor/logs/custom-logs-migrate' style='color:#1890F1;'>deprecated HTTP Data Collector API</a>.</p>",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected [**LookoutEvents**](https://aka.ms/sentinel-lookoutapi-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Lookout_CL",
        "baseQuery": "Lookout_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Lookout Events - All Activities.",
        "query": "Lookout_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Lookout_CL",
        "lastDataReceivedQuery": "Lookout_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Lookout_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Mobile Risk API Credentials/permissions",
          "description": "**EnterpriseName** & **ApiKey** are required for Mobile Risk API. [See the documentation to learn more about API](https://enterprise.support.lookout.com/hc/en-us/articles/115002741773-Mobile-Risk-API-Guide). Check all [requirements and follow  the instructions](https://enterprise.support.lookout.com/hc/en-us/articles/115002741773-Mobile-Risk-API-Guide#authenticatingwiththemobileriskapi) for obtaining credentials."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This [Lookout](https://lookout.com) data connector uses Azure Functions to connect to the Mobile Risk API to pull its events into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**LookoutEvents**](https://aka.ms/sentinel-lookoutapi-parser) which is deployed with the Microsoft Sentinel Solution."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the Mobile Risk API**\n\n [Follow the instructions](https://enterprise.support.lookout.com/hc/en-us/articles/115002741773-Mobile-Risk-API-Guide#authenticatingwiththemobileriskapi) to obtain the credentials. \n"
      },
      {
        "title": "",
        "description": "**STEP 2 - Follow below mentioned instructions to deploy the [Lookout](https://lookout.com) data connector and the associated Azure Function**\n\n>**IMPORTANT:** Before starting the deployment of the [Lookout](https://lookout.com) data connector, make sure to have the Workspace ID and Workspace Key ready (can be copied from the following).",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Workspace Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Azure Resource Manager (ARM) Template",
        "description": "Follow below steps for automated deployment of the [Lookout](https://lookout.com) data connector using an ARM Template.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-lookoutapi-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Region**. \n> **NOTE:** Within the same resource group, you can't mix Windows and Linux apps in the same region. Select existing resource group without Windows apps in it or create new resource group.\n3. Enter the **Function Name**, **Workspace ID**,**Workspace Key**,**Enterprise Name** & **Api Key** and deploy. \n4. Click **Create** to deploy."
      }
    ]
  },
  {
    "id": "LookoutCloudSecurityDataConnector",
    "title": "Lookout Cloud Security for Microsoft Sentinel",
    "publisher": "Lookout",
    "descriptionMarkdown": "This connector uses a Agari REST API connection to push data into Microsoft Sentinel Log Analytics.",
    "graphQueries": [
      {
        "metricName": "Lookout Cloud Security logs",
        "legend": "LookoutCloudSecurity_CL",
        "baseQuery": "LookoutCloudSecurity_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Lookout Cloud Security logs",
        "query": "LookoutCloudSecurity_CL\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "LookoutCloudSecurity_CL",
        "lastDataReceivedQuery": "LookoutCloudSecurity_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "LookoutCloudSecurity_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Agari REST API to pull logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**Step-by-Step Instructions**\n\n As a prerequisite to this integration, first, you need to configure an API client on Lookout's Management Console.  From the Management Console, you can add one or more clients and configure the appropriate permissions and actions for each. \n\n 1. Name - The name given to this client. \n\n 2. Client ID - the unique ID that was provided for this client. \n\n 3. Permissions - The permissions enabled for this client. The permissions you check are those that the client will be allowed to access. The listed options are Activity, Violation, Anomaly, Insights, and Profile \n\n 4. Service URL - The URL used to access this client.It must start with https:// \n\n 5. Authorized IPs - The valid IP address or addresses that apply to this client. \n\n 6. Actions - The actions you can take for this client. Click the icon for the action you want to perform. Editing client information, displaying the client secret, or deleting the client. \n\n **To add a new API client:** \n\n    1. Go to Administration > Enterprise Integration > API Clients and click New. \n\n     2. Enter a Name (required) and a Description (optional). \n\n     3. Enter the Client ID that was provided to you. \n\n     4. Select one or more Permissions from the dropdown list. \n\n     5. Enter one or more Authorized IP addresses for this client. Separate each address with a comma.\n\n     6. Click Save. \n\n When prompted, copy the string for the client's secret. You will need this information (along with the client ID) to authenticate to the API gateway. "
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following), as well as Azure Blob Storage connection string and container name, readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-LookoutCS-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Lookout Client ID**, **Lookout Client Secret**, **Lookout Base url**, **Microsoft Sentinel Workspace Id**, **Microsoft Sentinel Shared Key**\n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**.\n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/create-first-function-vs-code-python) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-Lookout-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions.\n\n\te. **Select a runtime:** Choose Python 3.11.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tLookoutClientId\n\t\tLookoutApiSecret\n\t\tBaseurl\n\t\tWorkspaceID\n\t\tPrimaryKey\n\t\tlogAnalyticsUri (Optional)\n - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://WORKSPACE_ID.ods.opinsights.azure.us`. \n4. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "LookoutStreaming_Definition",
    "title": "Lookout Mobile Threat Detection Connector (via Codeless Connector Framework) (Preview)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The [Lookout Mobile Threat Detection](https://lookout.com) data connector provides the capability to ingest events related to mobile security risks into Microsoft Sentinel through the Mobile Risk API. Refer to [API documentation](https://enterprise.support.lookout.com/hc/en-us/articles/115002741773-Mobile-Risk-API-Guide) for more information. This connector helps you examine potential security risks detected in mobile devices.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "Events",
        "baseQuery": "LookoutMtdV2_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Lookout Mobile Threat Detection Events - All Activities.",
        "query": "LookoutMtdV2_CL\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "LookoutMtdV2_CL",
        "lastDataReceivedQuery": "LookoutMtdV2_CL\n | summarize Time = max(TimeGenerated)"
      }
    ],
    "connectivityCriterias": null,
    "availability": null,
    "metadata": null
  },
  {
    "id": "LumenThreatFeedConnector",
    "title": "Lumen Defender Threat Feed Data Connector",
    "publisher": "Lumen Technologies, Inc.",
    "descriptionMarkdown": "The [Lumen Defender Threat Feed](https://bll-analytics.mss.lumen.com/analytics) connector provides the capability to ingest STIX-formatted threat intelligence indicators from Lumen's Black Lotus Labs research team into Microsoft Sentinel. The connector automatically downloads and uploads daily threat intelligence indicators including IPv4 addresses and domains to the ThreatIntelIndicators table via the STIX Objects Upload API.",
    "additionalRequirementBanner": "This connector requires API access to Lumen Defender Threat Feed API service, Microsoft Sentinel STIX Objects API permissions, and proper configuration of Azure AD authentication components.",
    "graphQueries": [
      {
        "metricName": "Total Threat Intelligence Indicators",
        "legend": "ThreatIntelIndicators",
        "baseQuery": "ThreatIntelIndicators | where SourceSystem == 'Lumen'"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Lumen Threat Intelligence Indicators",
        "query": "ThreatIntelIndicators | where SourceSystem == 'Lumen' | sort by TimeGenerated desc"
      },
      {
        "description": "High Confidence Indicators",
        "query": "ThreatIntelIndicators | where SourceSystem == 'Lumen' and Confidence >= 80 | sort by TimeGenerated desc"
      },
      {
        "description": "Malicious IP Indicators",
        "query": "ThreatIntelIndicators | where SourceSystem == 'Lumen' and ObservableValue != '' and ObservableKey == 'ipv4-addr:value' | sort by TimeGenerated desc"
      },
      {
        "description": "Malicious Domain Indicators",
        "query": "ThreatIntelIndicators | where SourceSystem == 'Lumen' and ObservableValue != '' and ObservableKey == 'domain-name:value' | sort by TimeGenerated desc"
      },
      {
        "description": "Recent Indicators (Last 7 Days)",
        "query": "ThreatIntelIndicators | where SourceSystem == 'Lumen' and TimeGenerated > ago(7d) | summarize count() by bin(TimeGenerated, 1d)"
      }
    ],
    "dataTypes": [
      {
        "name": "ThreatIntelIndicators(Lumen)",
        "lastDataReceivedQuery": "ThreatIntelIndicators | where SourceSystem == 'Lumen' | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ThreatIntelIndicators | where SourceSystem == 'Lumen' | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "Read and write permissions on the Log Analytics workspace are required.",
          "providerDisplayName": "Log Analytics Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": false
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Azure Entra App Registration",
          "description": "An Azure Entra application registration with the Microsoft Sentinel Contributor role assigned is required for STIX Objects API access. [See the documentation to learn more about Azure Entra applications](https://docs.microsoft.com/azure/active-directory/develop/quickstart-register-app)."
        },
        {
          "name": "Microsoft Sentinel Contributor Role",
          "description": "Microsoft Sentinel Contributor role is required for the Azure Entra application to upload threat intelligence indicators."
        },
        {
          "name": "Lumen Defender Threat Feed API Key",
          "description": "A Lumen Defender Threat Feed API Key is required for accessing threat intelligence data. [Contact Lumen for API access](mailto:DefenderThreatFeedSales@Lumen.com?subject=API%20Access%20Request)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions with Durable Functions to connect to the Lumen Defender Threat Feed API and upload threat intelligence indicators to Microsoft Sentinel via the STIX Objects API. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "Configuration",
        "description": "**STEP 1 - Obtain Lumen Defender Threat Feed API Key**\n\n1. [Contact Lumen](mailto:DefenderThreatFeedSales@Lumen.com?subject=API%20Access%20Request) to obtain API access to our Threat Feed API service\n2. Obtain your API key for authentication."
      },
      {
        "title": "",
        "description": "**STEP 2 - Configure Azure Entra ID Application and gather information**\n\n1. Create an Entra application. [See the documentation for a guide to registering an application in Microsoft Entra ID.](https://learn.microsoft.com/en-us/entra/identity-platform/quickstart-register-app)\n2. Create a client secret and note the Application ID, Tenant ID, and Client Secret\n4. Assign the **Microsoft Sentinel Contributor** role to the application on your Microsoft Sentinel Log Analytics Workspace\n5. Make note of your Workspace ID, as well as the App Insights Workspace Resource ID, which can be obtained from the overview page of the Log Analytics Workspace for your Microsoft Sentinel instance. Click on the JSON View link in the top right and the Resource ID will be displayed at the top with a copy button.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "TenantId"
              ],
              "label": "Tenant ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "",
        "description": "**STEP 3 - Enable the Threat Intelligence Upload Indicators API (Preview) data connector in Microsoft Sentinel**\n\n1. Deploy the **Threat Intelligence (New) Solution**, which includes the **Threat Intelligence Upload Indicators API (Preview)**\n2. Browse to the Content Hub, find and select the **Threat Intelligence (NEW)** solution.\n3. Select the **Install/Update** button."
      },
      {
        "title": "",
        "description": "**STEP 4 - Deploy the Azure Function**\n\n**IMPORTANT:** Before deploying the Lumen Defender Threat Feed connector, have the Tenant ID, Workspace ID, App Insights Workspace Resource ID, Azure Entra application details (Client ID, Client Secret), and Lumen API key readily available.\n\n1. Click the Deploy to Azure button.\n\n[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2FAzure-Sentinel%2Fmaster%2FSolutions%2FLumen%20Defender%20Threat%20Feed%2FData%2520Connectors%2FLumenThreatFeed%2Fazuredeploy_Connector_LumenThreatFeed_AzureFunction.json)\n\n2. Fill in the appropriate values for each parameter:\n\n- Subscription: Confirm the correct subscription is selected or use the dropdown to change your selection\n- Resource Group: Select the resource group to be used by the Function App and related resources\n- Function Name: Enter a globally unique name with an 11-character limit. Adhere to your organizations naming convention and ensure the name is globally unique since it is used (along with the uniqueString() function) to identify the ARM template being deployed.\n- Workspace ID: Found in the \"Overview\" tab for the Log Analytics Workspace of the Microsoft Sentinel instance and provided for convenience on the connector information page.\n- Lumen API Key: Obtain an API key through Lumen support\n- Lumen Base URL: Filled in automatically and should generally not be changed. This URL contains API endpoints used by the connector\n- Tenant ID: Obtained from the Entra App Registration overview page for the registered application (listed as Directory ID) and can also be obtained from the Tenant Information page in Azure\n- Client ID: Obtained from the Entra App Registration overview page for the registered application (listed as Application ID)\n- Client Secret: Obtained when the secret is created during the app registration process. It can only be viewed when first created and is hidden permanently afterwards. Rerun the app registration process to obtain a new Client Secret if necessary.\n- App Insights Workspace Resource ID: Obtained from the overview page of the Log Analytics Workspace for your Microsoft Sentinel instance. Click on the \"JSON View\" link in the top right and the Resource ID will be displayed at the top with a copy button.\n- Blob Container Name: Use the default name unless otherwise required. Azure Blob Storage is used for temporary storage and processing of threat indicators."
      },
      {
        "title": "",
        "description": "**STEP 5 - Verify Deployment**\n\n1. The connector polls for indicator updates every 15 minutes.\n2. Monitor the Function App logs in the Azure Portal to verify successful execution\n3. After the app performs its first run, review the indicators ingested by either viewing the Lumen Defender Threat Feed Overview workbook or viewing the Threat Intelligence section in Microsoft Sentinel. In Microsoft Sentinel Threat Intelligence, filter for source Lumen to display only Lumen generated indicators."
      }
    ],
    "metadata": {
      "id": "8d7d3b0e-4f6a-4f2a-bc2d-6d9f5a3c7e21",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "Lumen Defender Threat Feed for Microsoft Sentinel"
      },
      "author": {
        "name": "Lumen Technologies, Inc."
      },
      "support": {
        "tier": "developer",
        "name": "Lumen Technologies, Inc."
      }
    }
  },
  {
    "id": "M365Assets",
    "title": "Microsoft 365 Assets (formerly, Office 365)",
    "publisher": "Microsoft",
    "logo": "office365_logo.svg",
    "descriptionMarkdown": "The Microsoft 365 (formerly, Office 365) asset connector gives richer insights into ongoing user activities in Microsoft Sentinel by supplementing activity logs with details such as owners, permissions, retention policies and sensitivity labels.\n\nData from this connector is used to build data risk graphs in Purview. If you've enabled those graphs, deactivating this connector will prevent the graphs from being built. [Learn about the data risk graph](https://go.microsoft.com/fwlink/?linkid=2320023).\n\nThis connector is in limited private preview.",
    "graphQueries": [],
    "sampleQueries": [],
    "dataTypes": [],
    "connectivityCriterias": [
      {
        "type": "M365Assets"
      }
    ],
    "permissions": {
      "tenant": [
        "GlobalAdmin",
        "SecurityAdmin"
      ],
      "customs": [
        {
          "name": "OfficeActivity table availability",
          "description": "Enable the OfficeActivity table in Log Analytics."
        }
      ]
    },
    "availability": {
      "status": 2
    },
    "instructionSteps": [
      {
        "instructions": [
          {
            "parameters": {
              "type": "M365Assets",
              "description": "1.Connect Microsoft 365 assets (formerly, Office 365) to Microsoft Sentinel.",
              "items": [
                {
                  "label": "SharePoint and OneDrive"
                }
              ]
            },
            "type": "MSG"
          }
        ]
      }
    ]
  },
  {
    "id": "MailGuard365",
    "title": "MailGuard 365",
    "publisher": "MailGuard365",
    "descriptionMarkdown": "MailGuard 365 Enhanced Email Security for Microsoft 365. Exclusive to the Microsoft marketplace, MailGuard 365 is integrated with Microsoft 365 security (incl. Defender) for enhanced protection against advanced email threats like phishing, ransomware and sophisticated BEC attacks.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "MailGuard365_Threats_CL",
        "baseQuery": "MailGuard365_Threats_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All phishing threats stopped by MailGuard 365",
        "query": "MailGuard365_Threats_CL \n | where Category == \"Phishing\""
      },
      {
        "description": "All threats summarized by sender email address",
        "query": "MailGuard365_Threats_CL \n | summarize count() by Sender_Email_s"
      },
      {
        "description": "All threats summarized by category",
        "query": "MailGuard365_Threats_CL \n | summarize count() by Category"
      }
    ],
    "dataTypes": [
      {
        "name": "MailGuard365_Threats_CL",
        "lastDataReceivedQuery": "MailGuard365_Threats_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "MailGuard365_Threats_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Configure and connect MailGuard 365",
        "description": "1. In the MailGuard 365 Console, click **Settings** on the navigation bar.\n2. Click the **Integrations** tab.\n3. Click the **Enable Microsoft Sentinel**.\n4. Enter your workspace id and primary key from the fields below, click **Finish**.\n5. For additional instructions, please contact MailGuard 365 support.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ],
    "metadata": {
      "id": "310bcb08-38be-4257-b4d5-035e1ae3f256",
      "version": "1.0.0",
      "kind": "dataConnector",
      "author": {
        "name": "MailGuard 365"
      },
      "support": {
        "name": "MailGuard 365",
        "link": "https://www.mailguard365.com/support",
        "tier": "developer"
      }
    }
  },
  {
    "id": "McAfeeePO",
    "title": "[Deprecated] McAfee ePolicy Orchestrator (ePO)",
    "publisher": "McAfee",
    "descriptionMarkdown": "The McAfee ePolicy Orchestrator data connector provides the capability to ingest [McAfee ePO](https://www.mcafee.com/enterprise/en-us/products/epolicy-orchestrator.html) events into Microsoft Sentinel through the syslog. Refer to [documentation](https://docs.mcafee.com/bundle/epolicy-orchestrator-landing/page/GUID-0C40020F-5B7F-4549-B9CC-0E017BC8797F.html) for more information.",
    "additionalRequirementBanner": "This data connector depends on a parser based on Kusto Function to work as expected. Follow the steps to use this Kusto Function alias **McAfeeEPOEvent** in queries and workbooks. [Follow steps to get this Kusto Function>](https://aka.ms/sentinel-McAfeeePO-parser)\nNote: This data connector has been developed using McAfee ePolicy Orchestrator 5.10.x (Syslog)",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "McAfeeePO",
        "baseQuery": "McAfeeEPOEvent"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Sources",
        "query": "McAfeeEPOEvent\n | summarize count() by DvcHostname\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog(McAfeeePO)",
        "lastDataReceivedQuery": "McAfeeEPOEvent\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "McAfeeEPOEvent \n      | where TimeGenerated > ago(3d)\n            | take 1\n            | project IsConnected = true"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "write permission is required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">This data connector depends on a parser based on a Kusto Function to work as expected [**McAfeeEPOEvent**](https://aka.ms/sentinel-McAfeeePO-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux",
        "description": "Typically, you should install the agent on a different computer from the one on which the logs are generated.\n\n>  Syslog logs are collected only from **Linux** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Configure the facilities you want to collect and their severities.\n\n1.  Under workspace advanced settings **Configuration**, select **Data** and then **Syslog**.\n2.  Select **Apply below configuration to my machines** and select the facilities and severities.\n3.  Click **Save**.",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenSyslogSettings"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "3. Configure McAfee ePolicy Orchestrator event forwarding to Syslog server",
        "description": "[Follow these instructions](https://kcm.trellix.com/corporate/index?page=content&id=KB87927) to add register syslog server."
      }
    ]
  },
  {
    "id": "McAfeeNSP",
    "title": "[Deprecated] McAfee Network Security Platform",
    "publisher": "McAfee",
    "descriptionMarkdown": "The [McAfee Network Security Platform](https://www.mcafee.com/enterprise/en-us/products/network-security-platform.html) data connector provides the capability to ingest [McAfee Network Security Platform events](https://docs.mcafee.com/bundle/network-security-platform-10.1.x-integration-guide-unmanaged/page/GUID-8C706BE9-6AC9-4641-8A53-8910B51207D8.html) into Microsoft Sentinel. Refer to [McAfee Network Security Platform](https://docs.mcafee.com/bundle/network-security-platform-10.1.x-integration-guide-unmanaged/page/GUID-F7D281EC-1CC9-4962-A7A3-5A9D9584670E.html) for more information.",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected [**McAfeeNSPEvent**](https://aka.ms/sentinel-mcafeensp-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "McAfeeNSP",
        "baseQuery": "McAfeeNSPEvent"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Sources",
        "query": "McAfeeNSPEvent\n | summarize count() by tostring(DvcHostname)\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog (McAfeeNSPEvent)",
        "lastDataReceivedQuery": "McAfeeNSPEvent\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "McAfeeNSPEvent\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**McAfeeNSPEvent**](https://aka.ms/sentinel-mcafeensp-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "",
        "description": ">**NOTE:** This data connector has been developed using McAfee Network Security Platform version: 10.1.x",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux or Windows",
        "description": "Install the agent on the Server where the McAfee Network Security Platform logs are forwarded.\n\n> Logs from McAfee Network Security Platform Server deployed on Linux or Windows servers are collected by **Linux** or **Windows** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Linux agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Windows agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Windows Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Windows Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure McAfee Network Security Platform event forwarding",
        "description": "Follow the configuration steps below to get McAfee Network Security Platform logs into Microsoft Sentinel.\n1. [Follow these instructions](https://docs.mcafee.com/bundle/network-security-platform-10.1.x-product-guide/page/GUID-E4A687B0-FAFB-4170-AC94-1D968A10380F.html) to forward alerts from the Manager to a syslog server.\n2. Add a syslog notification profile, [more details here](https://docs.mcafee.com/bundle/network-security-platform-10.1.x-product-guide/page/GUID-5BADD5D7-21AE-4E3B-AEE2-A079F3FD6A38.html). This is mandatory. While creating profile, to make sure that events are formatted correctly, enter the following text in the Message text box:\n\t\t<SyslogAlertForwarderNSP>:|SENSOR_ALERT_UUID|ALERT_TYPE|ATTACK_TIME|ATTACK_NAME|ATTACK_ID\n\t\t|ATTACK_SEVERITY|ATTACK_SIGNATURE|ATTACK_CONFIDENCE|ADMIN_DOMAIN|SENSOR_NAME|INTERFACE\n\t\t|SOURCE_IP|SOURCE_PORT|DESTINATION_IP|DESTINATION_PORT|CATEGORY|SUB_CATEGORY\n\t\t|DIRECTION|RESULT_STATUS|DETECTION_MECHANISM|APPLICATION_PROTOCOL|NETWORK_PROTOCOL|"
      }
    ]
  },
  {
    "id": "MicrosoftAzurePurview",
    "title": "Microsoft Purview",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Connect to Microsoft Purview to enable data sensitivity enrichment of Microsoft Sentinel. Data classification and sensitivity label logs from Microsoft Purview scans can be ingested and visualized through workbooks, analytical rules, and more. For more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2224125&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "PurviewDataSensitivityLogs",
        "baseQuery": "PurviewDataSensitivityLogs"
      }
    ],
    "sampleQueries": [
      {
        "description": "View files that contain a specific classification (example shows Social Security Number)",
        "query": "PurviewDataSensitivityLogs\n | where Classification has \"Social Security Number\""
      }
    ],
    "dataTypes": [
      {
        "name": "AzureDiagnostics (PurviewDataSensitivityLogs)",
        "lastDataReceivedQuery": "PurviewDataSensitivityLogs\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "PurviewDataSensitivityLogs\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "Microsoft Purview account Owner or Contributor role to set up Diagnostic Settings. Microsoft Contributor role with write permissions to enable data connector, view workbook, and create analytic rules.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Connect Microsoft Purview to Microsoft Sentinel",
        "description": "Within the Azure Portal, navigate to your Purview resource:\n 1. In the search bar, search for **Purview accounts.**\n 2. Select the specific account that you would like to be set up with Sentinel.\n\nInside your Microsoft Purview resource:\n 3. Select **Diagnostic Settings.**\n 4. Select **+ Add diagnostic setting.**\n 5. In the **Diagnostic setting** blade:\n   - Select the Log Category as **DataSensitivityLogEvent**.\n   - Select **Send to Log Analytics**.\n   - Chose the log destination workspace. This should be the same workspace that is used by **Microsoft Sentinel.**\n  - Click **Save**.",
        "instructions": []
      }
    ]
  },
  {
    "id": "MicrosoftCloudAppSecurity",
    "title": "Microsoft Defender for Cloud Apps",
    "publisher": "Microsoft",
    "logo": {
      "type": 258,
      "options": null
    },
    "descriptionMarkdown": "By connecting with [Microsoft Defender for Cloud Apps](https://aka.ms/asi-mcas-connector-description) you will gain visibility into your cloud apps, get sophisticated analytics to identify and combat cyberthreats, and control how your data travels.\n\n-   Identify shadow IT cloud apps on your network.\n-   Control and limit access based on conditions and session context.\n-   Use built-in or custom policies for data sharing and data loss prevention.\n-   Identify high-risk use and get alerts for unusual user activities with Microsoft behavioral analytics and anomaly detection capabilities, including ransomware activity, impossible travel, suspicious email forwarding rules, and mass download of files.\n-   Mass download of files\n\n[Deploy now >](https://aka.ms/asi-mcas-connector-deploynow)",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Security Alerts",
        "baseQuery": "SecurityAlert | where ProductName == \"Microsoft Cloud App Security\""
      },
      {
        "metricName": "Total data received",
        "legend": "Discovery Logs",
        "baseQuery": "McasShadowItReporting"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "SecurityAlert | where ProductName == \"Microsoft Cloud App Security\" | summarize arg_max(TimeGenerated, *) by SystemAlertId\n            | sort by TimeGenerated"
      },
      {
        "description": "Summarize by severity",
        "query": "SecurityAlert | where ProductName == \"Microsoft Cloud App Security\" | summarize arg_max(TimeGenerated, *) by SystemAlertId\n            | summarize count() by AlertSeverity"
      },
      {
        "description": "All logs",
        "query": "McasShadowItReporting\n            | sort by TimeGenerated"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "MtpAlerts",
        "value": [
          "MicrosoftCloudAppSecurity"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "SecurityAlert (MCAS)",
        "lastDataReceivedQuery": "SecurityAlert | where ProductName == \"Microsoft Cloud App Security\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "McasShadowItReporting",
        "lastDataReceivedQuery": "McasShadowItReporting\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 2,
      "isPreview": false,
      "featureFlag": {
        "feature": "MCASConnector",
        "featureStates": {
          "1": 2,
          "2": 2,
          "3": 2,
          "4": 2,
          "5": 2,
          "6": 1,
          "7": 1
        }
      }
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        }
      ],
      "tenant": [
        "GlobalAdmin",
        "SecurityAdmin"
      ],
      "licenses": [
        "Mcas"
      ]
    },
    "instructionSteps": [
      {
        "title": "Connect Microsoft Defender for Cloud Apps to Microsoft Sentinel",
        "description": "In the Microsoft Defender for Cloud Apps portal, under Settings, select Security extensions and then SIEM and set Microsoft Sentinel as your SIEM agent. For more information, see  [Microsoft Defender for Cloud Apps](https://aka.ms/azuresentinelmcas) .\n\nAfter you connect Microsoft Defender for Cloud Apps, the alerts and discovery logs are sent to this Microsoft Sentinel workspace.",
        "instructions": [
          {
            "parameters": {
              "connectorKind": "MicrosoftCloudAppSecurity",
              "dataTypes": [
                {
                  "title": "Alerts",
                  "name": "alerts"
                },
                {
                  "title": "Cloud Discovery Logs (Preview)",
                  "name": "discoveryLogs"
                }
              ]
            },
            "type": "MCasDataTypes"
          }
        ]
      }
    ],
    "caseGenerationSteps": [
      {
        "instructions": [
          {
            "parameters": {
              "filterProduct": "Microsoft Cloud App Security"
            },
            "type": "FilterAlert"
          }
        ]
      }
    ]
  },
  {
    "id": "MicrosoftCopilot",
    "title": "Microsoft Copilot",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The Microsoft Copilot logs connector in Microsoft Sentinel enables the seamless ingestion of Copilot-generated activity logs into Microsoft Sentinel for advanced threat detection, investigation, and response. It collects telemetry from Microsoft Copilot services - such as usage data, prompts and system responses - and ingests into Microsoft Sentinel, allowing security teams to monitor for misuse, detect anomalies, and maintain compliance with organizational policies.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Microsoft Copilot",
        "baseQuery": "LLMActivity"
      }
    ],
    "sampleQueries": [
      {
        "description": "Microsoft Copilot Logs",
        "query": "LLMActivity\n            | sort by TimeGenerated"
      }
    ],
    "dataTypes": [
      {
        "name": "LLMActivity",
        "lastDataReceivedQuery": "LLMActivity\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "metadata": null
  },
  {
    "id": "MicrosoftDefenderAdvancedThreatProtection",
    "title": "Microsoft Defender for Endpoint",
    "publisher": "Microsoft",
    "logo": "MdatpLogo.svg",
    "descriptionMarkdown": "Microsoft Defender for Endpoint is a security platform designed to prevent, detect, investigate, and respond to advanced threats. The platform creates alerts when suspicious security events are seen in an organization. Fetch alerts generated in Microsoft Defender for Endpoint to Microsoft Sentinel so that you can effectively analyze security events. You can create rules, build dashboards and author playbooks for immediate response. For more information, see the [Microsoft Sentinel documentation >](https://go.microsoft.com/fwlink/p/?linkid=2220128&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "SecurityAlert (MDATP)",
        "baseQuery": "SecurityAlert | where ProviderName == \"MDATP\""
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "SecurityAlert | where ProviderName == \"MDATP\"\n            | sort by TimeGenerated"
      }
    ],
    "isConnectivityCriteriasMatchSome": true,
    "connectivityCriterias": [
      {
        "type": "MtpAlerts",
        "value": [
          "MicrosoftDefenderAdvancedThreatProtection"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "SecurityAlert (MDATP)",
        "lastDataReceivedQuery": "SecurityAlert | where ProviderName == \"MDATP\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 2,
      "isPreview": false
    },
    "permissions": {
      "tenant": [
        "GlobalAdmin",
        "SecurityAdmin"
      ],
      "licenses": [
        "Mdatp"
      ],
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Connect Microsoft Defender for Endpoint alerts to Microsoft Sentinel",
        "description": "> Connecting Microsoft Defender for Endpoint will cause your data that is collected by Microsoft Defender for Endpoint service to be stored and processed in the location that you have configured your Microsoft Sentinel workspace.",
        "instructions": [
          {
            "parameters": {},
            "type": "MicrosoftDefenderATP"
          },
          {
            "parameters": {
              "text": "Microsoft Defender for Endpoint Advanced Hunting raw logs are available as part of the Microsoft 365 Defender (Preview) connector",
              "visible": true,
              "inline": true
            },
            "type": "InfoMessage"
          }
        ]
      }
    ],
    "caseGenerationSteps": [
      {
        "instructions": [
          {
            "parameters": {
              "filterProduct": "Microsoft Defender Advanced Threat Protection"
            },
            "type": "FilterAlert"
          }
        ],
        "featureFlag": {
          "feature": "MDATPProductFilter",
          "featureStates": {
            "1": 2,
            "2": 2,
            "3": 2,
            "4": 2,
            "5": 2
          }
        }
      }
    ]
  },
  {
    "id": "MicrosoftDefenderForCloudTenantBased",
    "title": "Tenant-based Microsoft Defender for Cloud",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Microsoft Defender for Cloud is a security management tool that allows you to detect and quickly respond to threats across Azure, hybrid, and multi-cloud workloads. This connector allows you to stream your MDC security alerts from Microsoft 365 Defender into Microsoft Sentinel, so you can can leverage the advantages of XDR correlations connecting the dots across your cloud resources, devices and identities and view the data in workbooks, queries and investigate and respond to incidents. For more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2269832&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "logo": "Microsoft.svg",
    "graphQueriesTableName": "SecurityAlerts",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "SecurityAlerts",
        "baseQuery": "SecurityAlert | where ProductName == \"Azure Security Center\""
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "SecurityAlert | where ProductName == \"Azure Security Center\"\n            | sort by TimeGenerated"
      },
      {
        "description": "Summarize by severity",
        "query": "SecurityAlert\n| where ProductName == \"Azure Security Center\"\n| summarize count() by AlertSeverity"
      }
    ],
    "dataTypes": [
      {
        "name": "SecurityAlert(ASC)",
        "lastDataReceivedQuery": "SecurityAlert | where ProductName == \"Azure Security Center\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "MtpAlerts",
        "value": [
          "MicrosoftDefenderForCloudTenantBased"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "tenant": [
        "SecurityAdmin",
        "GlobalAdmin"
      ],
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        }
      ],
      "tenantMember": true
    },
    "instructionSteps": [
      {
        "title": "Connect Tenant-based Microsoft Defender for Cloud to Microsoft Sentinel",
        "description": "After connecting this connector, **all** your Microsoft Defender for Cloud subscriptions' alerts will be sent to this Microsoft Sentinel workspace.\n\n> Your Microsoft Defender for Cloud alerts are connected to stream through the Microsoft 365 Defender. To benefit from automated grouping of the alerts into incidents, connect the Microsoft 365 Defender incidents connector. Incidents can be viewed in the incidents queue.",
        "instructions": [
          {
            "parameters": {
              "title": "Tenant-based Microsoft Defender for Cloud",
              "connectorKind": "MicrosoftDefenderForCloudTenantBased",
              "enable": true,
              "newPipelineEnabledFeatureFlagConfig": {
                "feature": "MdcAlertsByMtp",
                "featureStates": {
                  "1": 2,
                  "2": 2,
                  "3": 2,
                  "4": 2,
                  "5": 2
                }
              },
              "infoBoxMessage": "Your Microsoft Defender for Cloud alerts are connected to stream through the Microsoft 365 Defender. To benefit from automated grouping of the alerts into incidents, connect the Microsoft 365 Defender incidents connector. Incidents can be viewed in the incidents queue",
              "shouldAlwaysDisplayInfoMessage": true
            },
            "type": "MicrosoftDefenderForCloudTenantBased"
          }
        ]
      }
    ]
  },
  {
    "id": "MicrosoftDefenderThreatIntelligence",
    "title": "Microsoft Defender Threat Intelligence",
    "publisher": "Microsoft",
    "logo": {
      "type": 258,
      "options": null
    },
    "descriptionMarkdown": "Microsoft Sentinel provides you the capability to import threat intelligence generated by Microsoft to enable monitoring, alerting and hunting. Use this data connector to import Indicators of Compromise (IOCs) from Microsoft Defender Threat Intelligence (MDTI) into Microsoft Sentinel. Threat indicators can include IP addresses, domains, URLs, and file hashes, etc.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ThreatIntelligenceIndicator",
        "baseQuery": "ThreatIntelligenceIndicator\n                      | where SourceSystem in (\"Microsoft Defender Threat Intelligence\", \"Microsoft Emerging Threat Feed\")"
      }
    ],
    "sampleQueries": [
      {
        "description": "Summarize by threat type",
        "query": "ThreatIntelligenceIndicator\n| where ExpirationDateTime > now()\n| where SourceSystem in (\"Microsoft Defender Threat Intelligence\", \"Microsoft Emerging Threat Feed\")\n| where ExpirationDateTime > now()\n| join ( SigninLogs ) on $left.NetworkIP == $right.IPAddress | summarize count() by ThreatType"
      },
      {
        "description": "Summarize by 1 hour bins",
        "query": "ThreatIntelligenceIndicator\n| where SourceSystem in (\"Microsoft Defender Threat Intelligence\", \"Microsoft Emerging Threat Feed\")\n| where TimeGenerated >= ago(1d) | summarize count()"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "SentinelKinds",
        "value": [
          "MicrosoftThreatIntelligence"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "ThreatIntelligenceIndicator",
        "lastDataReceivedQuery": "ThreatIntelligenceIndicator \n                | where SourceSystem in (\"Microsoft Defender Threat Intelligence\", \"Microsoft Emerging Threat Feed\")\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 2,
      "isPreview": false,
      "featureFlag": {
        "feature": "msticonnector",
        "featureStates": {
          "1": 3,
          "2": 3,
          "3": 3,
          "4": 3,
          "5": 3,
          "6": 0,
          "7": 2,
          "8": 2
        }
      }
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Use this data connector to import Indicators of Compromise (IOCs) from Microsoft Defender Threat Intelligence (MDTI) into Microsoft Sentinel."
      },
      {
        "instructions": [
          {
            "type": "MicrosoftThreatIntelligence",
            "parameters": {
              "connectorKind": "MicrosoftThreatIntelligence"
            }
          }
        ]
      }
    ]
  },
  {
    "id": "MicrosoftDefenderThreatIntelligence",
    "title": "Microsoft Defender Threat Intelligence",
    "publisher": "Microsoft",
    "logo": {
      "type": 258,
      "options": null
    },
    "descriptionMarkdown": "Microsoft Sentinel provides you the capability to import threat intelligence generated by Microsoft to enable monitoring, alerting and hunting. Use this data connector to import Indicators of Compromise (IOCs) from Microsoft Defender Threat Intelligence (MDTI) into Microsoft Sentinel. Threat indicators can include IP addresses, domains, URLs, and file hashes, etc.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ThreatIntelIndicators",
        "baseQuery": "ThreatIntelIndicators\n                      | where SourceSystem in (\"Microsoft Defender Threat Intelligence\", \"Microsoft Emerging Threat Feed\")"
      },
      {
        "metricName": "Total data received",
        "legend": "ThreatIntelObjects",
        "baseQuery": "ThreatIntelObjects\n                      | where SourceSystem in (\"Microsoft Defender Threat Intelligence\", \"Microsoft Emerging Threat Feed\")"
      }
    ],
    "sampleQueries": [
      {
        "description": "Summarize by threat type",
        "query": "ThreatIntelIndicators\n| where ExpirationDateTime > now()\n| where SourceSystem in (\"Microsoft Defender Threat Intelligence\", \"Microsoft Emerging Threat Feed\")\n| where ExpirationDateTime > now()\n| join ( SigninLogs ) on $left.NetworkIP == $right.IPAddress | summarize count() by ThreatType"
      },
      {
        "description": "Summarize by 1 hour bins",
        "query": "ThreatIntelIndicators\n| where SourceSystem in (\"Microsoft Defender Threat Intelligence\", \"Microsoft Emerging Threat Feed\")\n| where TimeGenerated >= ago(1d) | summarize count()"
      },
      {
        "description": "Summarize by threat type",
        "query": "ThreatIntelObjects\n| where ExpirationDateTime > now()\n| where SourceSystem in (\"Microsoft Defender Threat Intelligence\", \"Microsoft Emerging Threat Feed\")\n| where ExpirationDateTime > now()\n| join ( SigninLogs ) on $left.NetworkIP == $right.IPAddress | summarize count() by ThreatType"
      },
      {
        "description": "Summarize by 1 hour bins",
        "query": "ThreatIntelObjects\n| where SourceSystem in (\"Microsoft Defender Threat Intelligence\", \"Microsoft Emerging Threat Feed\")\n| where TimeGenerated >= ago(1d) | summarize count()"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "SentinelKinds",
        "value": [
          "MicrosoftThreatIntelligence"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "ThreatIntelIndicators",
        "lastDataReceivedQuery": "ThreatIntelIndicators \n                | where SourceSystem in (\"Microsoft Defender Threat Intelligence\", \"Microsoft Emerging Threat Feed\")\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ThreatIntelObjects",
        "lastDataReceivedQuery": "ThreatIntelObjects \n                | where SourceSystem in (\"Microsoft Defender Threat Intelligence\", \"Microsoft Emerging Threat Feed\")\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 2,
      "isPreview": false,
      "featureFlag": {
        "feature": "msticonnector",
        "featureStates": {
          "1": 3,
          "2": 3,
          "3": 3,
          "4": 3,
          "5": 3,
          "6": 0,
          "7": 2,
          "8": 2
        }
      }
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Use this data connector to import Indicators of Compromise (IOCs) from Microsoft Defender Threat Intelligence (MDTI) into Microsoft Sentinel."
      },
      {
        "instructions": [
          {
            "type": "MicrosoftThreatIntelligence",
            "parameters": {
              "connectorKind": "MicrosoftThreatIntelligence"
            }
          }
        ]
      }
    ]
  },
  {
    "id": "MicrosoftPurviewInformationProtection",
    "title": "Microsoft Purview Information Protection",
    "publisher": "Microsoft",
    "logo": {
      "type": 258,
      "options": null
    },
    "descriptionMarkdown": "Microsoft Purview Information Protection helps you discover, classify, protect, and govern sensitive information wherever it lives or travels. Using these capabilities enable you to know your data, identify items that are sensitive and gain visibility into how they are being used to better protect your data. Sensitivity labels are the foundational capability that provide protection actions, applying encryption, access restrictions and visual markings.\n    Integrate Microsoft Purview Information Protection logs with Microsoft Sentinel to view dashboards, create custom alerts and improve investigation. For more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2223811&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Microsoft Purview Information Protection",
        "baseQuery": "MicrosoftPurviewInformationProtection"
      }
    ],
    "sampleQueries": [
      {
        "description": "Microsoft Purview Information Protection",
        "query": "MicrosoftPurviewInformationProtection\n            | sort by TimeGenerated"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "SentinelKinds",
        "value": [
          "MicrosoftPurviewInformationProtection"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "MicrosoftPurviewInformationProtection",
        "lastDataReceivedQuery": "MicrosoftPurviewInformationProtection\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 2,
      "featureFlag": {
        "feature": "MicrosoftPurviewInformationProtectionConnector",
        "featureStates": {
          "1": 1,
          "2": 1,
          "3": 1,
          "4": 1
        }
      },
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        }
      ],
      "tenant": [
        "GlobalAdmin",
        "SecurityAdmin"
      ],
      "customs": [
        {
          "name": "License",
          "description": "Enterprise Mobility + Security E5/A5 or Microsoft 365 E5/A5 or P2"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Connect Microsoft Purview Information Protection audit logs to Microsoft Sentinel",
        "instructions": [
          {
            "parameters": {
              "connectorKind": "MicrosoftPurviewInformationProtection",
              "title": "",
              "enable": true
            },
            "type": "SentinelResourceProvider"
          }
        ]
      }
    ]
  },
  {
    "id": "MicrosoftSysmonForLinux",
    "title": "[Deprecated] Microsoft Sysmon For Linux",
    "publisher": "Microsoft",
    "descriptionMarkdown": "[Sysmon for Linux](https://github.com/Sysinternals/SysmonForLinux) provides detailed information about process creations, network connections and other system events.\n[Sysmon for linux link:]. The Sysmon for Linux connector uses [Syslog](https://aka.ms/sysLogInfo) as its data ingestion method. This solution depends on ASIM to work as expected. [Deploy ASIM](https://aka.ms/DeployASIM) to get the full value from the solution.",
    "additionalRequirementBanner": "This data connector depends on ASIM to work as expected. [Deploy ASIM](https://aka.ms/DeployASIM) to get the full value from the connector.",
    "graphQueries": [
      {
        "metricName": "Sysmon",
        "legend": "Syslog",
        "baseQuery": "Syslog | where ProcessName == 'sysmon'"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Events by ActingProcessName",
        "query": "vimProcessCreateLinuxSysmon\n            | summarize count() by ActingProcessName\n             | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog (Sysmon)",
        "lastDataReceivedQuery": "Syslog | where ProcessName == 'sysmon'\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Syslog | where ProcessName == 'sysmon'\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "write permission is required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">This data connector depends on ASIM parsers based on a Kusto Functions to work as expected. [Deploy the parsers](https://aka.ms/ASimSysmonForLinuxARM) \n\n The following functions will be deployed:\n\n - vimFileEventLinuxSysmonFileCreated, vimFileEventLinuxSysmonFileDeleted\n\n - vimProcessCreateLinuxSysmon, vimProcessTerminateLinuxSysmon\n\n - vimNetworkSessionLinuxSysmon \n\n[Read more](https://aka.ms/AboutASIM)",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux",
        "description": "Typically, you should install the agent on a different computer from the one on which the logs are generated.\n\n>  Syslog logs are collected only from **Linux** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Configure the facilities you want to collect and their severities.\n\n1.  Under workspace advanced settings **Configuration**, select **Data** and then **Syslog**.\n2.  Select **Apply below configuration to my machines** and select the facilities and severities.\n3.  Click **Save**.",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenSyslogSettings"
            },
            "type": "InstallAgent"
          }
        ]
      }
    ]
  },
  {
    "id": "MicrosoftThreatProtection",
    "title": "Microsoft Defender XDR",
    "publisher": "Microsoft",
    "logo": {
      "type": 258,
      "options": null
    },
    "descriptionMarkdown": "Microsoft Defender XDR is a unified, natively integrated, pre- and post-breach enterprise defense suite that protects endpoint, identity, email, and applications and helps you detect, prevent, investigate, and automatically respond to sophisticated threats.\n\nMicrosoft Defender XDR suite includes: \n- Microsoft Defender for Endpoint\n- Microsoft Defender for Identity\n- Microsoft Defender for Office 365\n- Threat & Vulnerability Management\n- Microsoft Defender for Cloud Apps\n\nFor more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2220004&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Incidents",
        "baseQuery": "SecurityIncident \n| where ProviderName == \"Microsoft 365 Defender\""
      },
      {
        "metricName": "Total data received",
        "legend": "Alerts",
        "baseQuery": "SecurityAlert \n| where ProductName in(\"Microsoft Defender Advanced Threat Protection\",\"Office 365 Advanced Threat Protection\",\"Azure Advanced Threat Protection\",\"Microsoft Cloud App Security\",\"Microsoft 365 Defender\")"
      },
      {
        "metricName": "Total data received",
        "legend": "Endpoint Events",
        "baseQuery": "DeviceEvents| union isfuzzy=true DeviceFileEvents| union isfuzzy=true DeviceImageLoadEvents| union isfuzzy=true DeviceInfo| union isfuzzy=true DeviceLogonEvents| union isfuzzy=true DeviceNetworkEvents| union isfuzzy=true DeviceNetworkInfo| union isfuzzy=true DeviceProcessEvents| union isfuzzy=true DeviceRegistryEvents| union isfuzzy=true DeviceFileCertificateInfo"
      },
      {
        "metricName": "Total data received",
        "legend": "Office Events",
        "baseQuery": "EmailEvents| union isfuzzy=true EmailUrlInfo| union isfuzzy=true EmailAttachmentInfo| union isfuzzy=true EmailPostDeliveryEvents"
      },
      {
        "metricName": "Total data received",
        "legend": "Identity Events",
        "baseQuery": "IdentityLogonEvents| union isfuzzy=true IdentityQueryEvents| union isfuzzy=true IdentityDirectoryEvents"
      },
      {
        "metricName": "Total data received",
        "legend": "Cloud app Events",
        "baseQuery": "CloudAppEvents"
      },
      {
        "metricName": "Total data received",
        "legend": "Defender Alert Evidence",
        "baseQuery": "AlertEvidence"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Microsoft Defender XDR alerts",
        "query": "SecurityAlert \n| where ProductName in(\"Microsoft Defender Advanced Threat Protection\",\"Office 365 Advanced Threat Protection\",\"Azure Advanced Threat Protection\",\"Microsoft Cloud App Security\",\"Microsoft 365 Defender\")\n            | sort by TimeGenerated"
      },
      {
        "description": "Find possible clear text passwords in Windows registry.",
        "query": "DeviceRegistryEvents\n| where ActionType == \"RegistryValueSet\"\n| where RegistryValueName == \"DefaultPassword\"\n| where RegistryKey has @\"SOFTWAREMicrosoftWindows NTCurrentVersionWinlogon\"\n| project Timestamp, DeviceName, RegistryKey\n| top 100 by Timestamp"
      },
      {
        "description": "Finds PowerShell execution events that could involve a download.",
        "query": "union DeviceProcessEvents, DeviceNetworkEvents\n| where Timestamp > ago(7d)\n| where FileName in~ (\"powershell.exe\", \"powershell_ise.exe\")\n| where ProcessCommandLine has_any(\"WebClient\",\n\"DownloadFile\",\n\"DownloadData\",\n\"DownloadString\",\n\"WebRequest\",\n\"Shellcode\",\n\"http\",\n\"https\")\n| project Timestamp, DeviceName, InitiatingProcessFileName,\nInitiatingProcessCommandLine,\nFileName, ProcessCommandLine, RemoteIP, RemoteUrl, RemotePort, RemoteIPType\n"
      },
      {
        "description": "Lookup process executed from binary hidden in Base64 encoded file.",
        "query": "DeviceProcessEvents\n| where Timestamp > ago(14d)\n| where ProcessCommandLine contains \".decode('base64')\"\nor ProcessCommandLine contains \"base64 --decode\"\nor ProcessCommandLine contains \".decode64(\"\n| project Timestamp , DeviceName , FileName , FolderPath , ProcessCommandLine ,\nInitiatingProcessCommandLine\n| top 100 by Timestamp"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "SentinelKinds",
        "value": [
          "MicrosoftThreatProtection"
        ]
      },
      {
        "type": "MtpAlerts",
        "value": [
          "AzureAdvancedThreatProtection",
          "MicrosoftCloudAppSecurity",
          "MicrosoftThreatProtection",
          "OfficeATP",
          "MicrosoftDefenderAdvancedThreatProtection",
          "AzureActiveDirectory",
          "OfficeIRM"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "DeviceEvents\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "DeviceFileEvents\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "DeviceImageLoadEvents\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "DeviceInfo\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "DeviceLogonEvents\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "DeviceNetworkEvents\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "DeviceNetworkInfo\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "DeviceProcessEvents\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "DeviceRegistryEvents\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "DeviceFileCertificateInfo\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "EmailEvents\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "EmailUrlInfo\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "EmailAttachmentInfo\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "EmailPostDeliveryEvents\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "UrlClickEvents\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "IdentityLogonEvents\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "IdentityQueryEvents\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "IdentityDirectoryEvents\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "CloudAppEvents\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "AlertEvidence\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "isConnectivityCriteriasMatchSome": true,
    "dataTypes": [
      {
        "name": "SecurityIncident",
        "lastDataReceivedQuery": "SecurityIncident \n| where ProviderName == \"Microsoft 365 Defender\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "SecurityAlert",
        "lastDataReceivedQuery": "SecurityAlert \n| where ProductName in(\"Microsoft Defender Advanced Threat Protection\",\"Office 365 Advanced Threat Protection\",\"Azure Advanced Threat Protection\",\"Microsoft Cloud App Security\",\"Microsoft 365 Defender\")\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "DeviceEvents",
        "lastDataReceivedQuery": "DeviceEvents\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "DeviceFileEvents",
        "lastDataReceivedQuery": "DeviceFileEvents\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "DeviceImageLoadEvents",
        "lastDataReceivedQuery": "DeviceImageLoadEvents\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "DeviceInfo",
        "lastDataReceivedQuery": "DeviceInfo\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "DeviceLogonEvents",
        "lastDataReceivedQuery": "DeviceLogonEvents\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "DeviceNetworkEvents",
        "lastDataReceivedQuery": "DeviceNetworkEvents\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "DeviceNetworkInfo",
        "lastDataReceivedQuery": "DeviceNetworkInfo\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "DeviceProcessEvents",
        "lastDataReceivedQuery": "DeviceProcessEvents\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "DeviceRegistryEvents",
        "lastDataReceivedQuery": "DeviceRegistryEvents\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "DeviceFileCertificateInfo",
        "lastDataReceivedQuery": "DeviceFileCertificateInfo\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "EmailEvents",
        "lastDataReceivedQuery": "EmailEvents\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "EmailUrlInfo",
        "lastDataReceivedQuery": "EmailUrlInfo\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "EmailAttachmentInfo",
        "lastDataReceivedQuery": "EmailAttachmentInfo\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "EmailPostDeliveryEvents",
        "lastDataReceivedQuery": "EmailPostDeliveryEvents\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "UrlClickEvents",
        "lastDataReceivedQuery": "UrlClickEvents\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "IdentityLogonEvents",
        "lastDataReceivedQuery": "IdentityLogonEvents\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "IdentityQueryEvents",
        "lastDataReceivedQuery": "IdentityQueryEvents\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "IdentityDirectoryEvents",
        "lastDataReceivedQuery": "IdentityDirectoryEvents\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CloudAppEvents",
        "lastDataReceivedQuery": "CloudAppEvents\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "AlertEvidence",
        "lastDataReceivedQuery": "AlertEvidence\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 2,
      "isPreview": false,
      "featureFlag": {
        "feature": "MdatpRawData",
        "featureStates": {
          "1": 2,
          "2": 2,
          "3": 2,
          "4": 2,
          "5": 2
        }
      }
    },
    "permissions": {
      "tenant": [
        "GlobalAdmin",
        "SecurityAdmin"
      ],
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "License",
          "description": "M365 E5, M365 A5 or any other Microsoft Defender XDR eligible license."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Connect incidents & alerts",
        "description": "Connect Microsoft Defender XDR incidents to your Microsoft Sentinel. Incidents will appear in the incidents queue.",
        "isComingSoon": false,
        "bottomBorder": true,
        "instructions": [
          {
            "parameters": {},
            "type": "MicrosoftThreatProtection"
          }
        ]
      },
      {
        "title": "Connect events",
        "instructions": [
          {
            "parameters": {},
            "type": "MicrosoftDefenderATPEvents"
          }
        ]
      }
    ]
  },
  {
    "id": "MimecastATAPI",
    "title": "Mimecast Awareness Training",
    "publisher": "Mimecast",
    "descriptionMarkdown": "The data connector for [Mimecast Awareness Training](https://integrations.mimecast.com/tech-partners/microsoft-sentinel/) provides customers with the visibility into security events related to the Targeted Threat Protection inspection technologies within Microsoft Sentinel. The data connector provides pre-created dashboards to allow analysts to view insight into email based threats, aid in incident correlation and reduce investigation response times coupled with custom alert capabilities.  \nThe Mimecast products included within the connector are: \n- Performance Details \n- Safe Score Details \n- User Data\n- Watchlist Details\n",
    "graphQueries": [
      {
        "metricName": "Total Performance Details data received",
        "legend": "Awareness_Performance_Details_CL",
        "baseQuery": "Awareness_Performance_Details_CL"
      },
      {
        "metricName": "Total Safe Score Details data received",
        "legend": "Awareness_SafeScore_Details_CL",
        "baseQuery": "Awareness_SafeScore_Details_CL"
      },
      {
        "metricName": "Total User Data received",
        "legend": "Awareness_User_Data_CL",
        "baseQuery": "Awareness_User_Data_CL"
      },
      {
        "metricName": "Total Watchlist Details data received",
        "legend": "Awareness_Watchlist_Details_CL",
        "baseQuery": "Awareness_Watchlist_Details_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Awareness_Performance_Details_CL",
        "query": "Awareness_Performance_Details_CL\n| sort by TimeGenerated desc"
      },
      {
        "description": "Awareness_SafeScore_Details_CL",
        "query": "Awareness_SafeScore_Details_CL\n| sort by TimeGenerated desc"
      },
      {
        "description": "Awareness_User_Data_CL",
        "query": "Awareness_User_Data_CL\n| sort by TimeGenerated desc"
      },
      {
        "description": "Awareness_Watchlist_Details_CL",
        "query": "Awareness_User_Data_CL\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Awareness_Performance_Details_CL",
        "lastDataReceivedQuery": "Awareness_Performance_Details_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Awareness_SafeScore_Details_CL",
        "lastDataReceivedQuery": "Awareness_SafeScore_Details_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Awareness_User_Data_CL",
        "lastDataReceivedQuery": "Awareness_User_Data_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Awareness_Watchlist_Details_CL",
        "lastDataReceivedQuery": "Awareness_Watchlist_Details_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Awareness_Performance_Details_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "Awareness_SafeScore_Details_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "Awareness_User_Data_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "Awareness_Watchlist_Details_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Azure Subscription",
          "description": "Azure Subscription with owner role is required to register an application in Microsoft Entra ID and assign role of contributor to app in resource group."
        },
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "See the documentation to learn more about API on the [Rest API reference](https://integrations.mimecast.com/documentation/)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Resource group",
        "description": "You need to have a resource group created with a subscription you are going to use."
      },
      {
        "title": "Functions app",
        "description": "You need to have an Azure App registered for this connector to use\n1. Application Id\n2. Tenant Id\n3. Client Id\n4. Client Secret\n5. Entra Object ID"
      },
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to a Mimecast API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1 - App Registration steps for the Application in Microsoft Entra ID**\n\n This integration requires an App registration in the Azure portal. Follow the steps in this section to create a new application in Microsoft Entra ID:\n 1. Sign in to the [Azure portal](https://portal.azure.com/).\n 2. Search for and select **Microsoft Entra ID**.\n 3. Under **Manage**, select **App registrations > New registration**.\n 4. Enter a display **Name** for your application.\n 5. Select **Register** to complete the initial app registration.\n 6. When registration finishes, the Azure portal displays the app registration's Overview pane. You see the **Application (client) ID** and **Tenant ID**. The client ID and Tenant ID is required as configuration parameters for the execution of Mimecast Data Connector. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app)"
      },
      {
        "title": "",
        "description": "**STEP 2 - Add a client secret for application in Microsoft Entra ID**\n\n Sometimes called an application password, a client secret is a string value required for the execution of Mimecast Data Connector. Follow the steps in this section to create a new Client Secret:\n 1. In the Azure portal, in **App registrations**, select your application.\n 2. Select **Certificates & secrets > Client secrets > New client secret**.\n 3. Add a description for your client secret.\n 4. Select an expiration for the secret or specify a custom lifetime. Limit is 24 months.\n 5. Select **Add**. \n 6. *Record the secret's value for use in your client application code. This secret value is never displayed again after you leave this page.* The secret value is required as configuration parameter for the execution of Mimecast Data Connector. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret)"
      },
      {
        "title": "",
        "description": "**STEP 3 - Get Object ID of your application in Microsoft Entra ID**\n\n After creating your app registration, follow the steps in this section to get Object ID:\n 1. Go to **Microsoft Entra ID**.\n 2. Select **Enterprise applications** from the left menu.\n 3. Find your newly created application in the list (you can search by the name you provided).\n 4. Click on the application.\n 5. On the overview page, copy the **Object ID**. This is the **AzureEntraObjectId** needed for your ARM template role assignment.\n"
      },
      {
        "title": "",
        "description": "**STEP 4 - Deploy Mimecast API Connector**\n\n>**IMPORTANT:** Before deploying the Mimecast API connector, have the Mimecast API authorization key(s) or Token, readily available."
      },
      {
        "title": "Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the Mimecast Awareness Training Data connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-MimecastAT-azuredeploy) [![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://aka.ms/sentinel-MimecastAT-azuredeploy-gov)\n2. Select the preferred **Subscription**, **Resource Group** and **Region**. \n3. Enter the below information : \n\n\t a. Location - The location in which the data collection rules and data collection endpoints should be deployed\n\n\t b. WorkspaceName - Enter Microsoft Sentinel Workspace Name of Log Analytics workspace\n\n\t c. AzureClientID - Enter Azure Client ID that you have created during app registration\n\n\t d. AzureClientSecret - Enter Azure Client Secret that you have created during creating the client secret\n\n\t e. AzureTenantID - Enter Azure Tenant ID of your Azure Active Directory\n\n\t f. AzureEntraObjectID - Enter Object id of your Microsoft Entra App\n\n\t g. MimecastBaseURL - Enter Base URL of Mimecast API 2.0 (e.g. https://api.services.mimecast.com)\n\n\t h. MimecastClientID - Enter Mimecast Client ID for authentication\n\n\t i. MimecastClientSecret - Enter Mimecast Client Secret for authentication\n\n\t j. MimecastAwarenessPerformanceDetailsTableName - Enter name of the table used to store Awareness Performance Details data. Default is 'Awareness_Performance_Details'\n\n\t k. MimecastAwarenessUserDataTableName - Enter name of the table used to store Awareness User Data data. Default is 'Awareness_User_Data'\n\n\t l. MimecastAwarenessWatchlistDetailsTableName - Enter name of the table used to store Awareness Watchlist Details data. Default is 'Awareness_Watchlist_Details'\n\n\t m. MimecastAwarenessSafeScoreDetailsTableName - Enter name of the table used to store Awareness SafeScore Details data. Default is 'Awareness_SafeScore_Details'\n\n\t n. StartDate - Enter the start date in the 'yyyy-mm-dd' format. If you do not provide a date, data from the last 60 days will be fetched automatically. Ensure that the date is in the past and properly formatted\n\n\t o. Schedule - Please enter a valid Quartz cron-expression. (Example: 0 0 */1 * * *) Do not keep the value empty, minimum value is 10 minutes\n\n\t p. LogLevel - Please add log level or log severity value. By default it is set to INFO\n\n\t q. AppInsightsWorkspaceResourceId - Migrate Classic Application Insights to Log Analytic Workspace which is retiring by 29 Febraury 2024. Use 'Log Analytic Workspace-->Properties' blade having 'Resource ID' property value. This is a fully qualified resourceId which is in format '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}' \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      }
    ]
  },
  {
    "id": "MimecastAuditAPI",
    "title": "Mimecast Audit & Authentication",
    "publisher": "Mimecast",
    "descriptionMarkdown": "The data connector for [Mimecast Audit & Authentication](https://integrations.mimecast.com/tech-partners/microsoft-sentinel/) provides customers with the visibility into security events related to audit and authentication events within Microsoft Sentinel. The data connector provides pre-created dashboards to allow analysts to view insight into user activity, aid in incident correlation and reduce investigation response times coupled with custom alert capabilities.  \nThe Mimecast products included within the connector are: \nAudit & Authentication\n ",
    "graphQueries": [
      {
        "metricName": "Total Audit & Authentication data received",
        "legend": "MimecastAudit_CL",
        "baseQuery": "MimecastAudit_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "MimecastAudit_CL",
        "query": "MimecastAudit_CL\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "MimecastAudit_CL",
        "lastDataReceivedQuery": "MimecastAudit_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "MimecastAudit_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Mimecast API credentials",
          "description": "You need to have the following pieces of information to configure the integration:\n- mimecastEmail: Email address of a dedicated Mimecast admin user\n- mimecastPassword: Password for the dedicated Mimecast admin user\n- mimecastAppId: API Application Id of the Mimecast Microsoft Sentinel app registered with Mimecast\n- mimecastAppKey: API Application Key of the Mimecast Microsoft Sentinel app registered with Mimecast\n- mimecastAccessKey: Access Key for the dedicated Mimecast admin user\n- mimecastSecretKey: Secret Key for the dedicated Mimecast admin user\n- mimecastBaseURL: Mimecast Regional API Base URL\n\n> The Mimecast Application Id, Application Key, along with the Access Key and Secret keys for the dedicated Mimecast admin user are obtainable via the Mimecast Administration Console: Administration | Services | API and Platform Integrations.\n\n> The Mimecast API Base URL for each region is documented here: https://integrations.mimecast.com/documentation/api-overview/global-base-urls/"
        },
        {
          "name": "Resource group",
          "description": "You need to have a resource group created with a subscription you are going to use."
        },
        {
          "name": "Functions app",
          "description": "You need to have an Azure App registered for this connector to use\n1. Application Id\n2. Tenant Id\n3. Client Id\n4. Client Secret"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to a Mimecast API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "Configuration:",
        "description": "**STEP 1 - Configuration steps for the Mimecast API**\n\nGo to ***Azure portal ---> App registrations ---> [your_app] ---> Certificates & secrets ---> New client secret*** and create a new secret (save the Value somewhere safe right away because you will not be able to preview it later)"
      },
      {
        "title": "",
        "description": "**STEP 2 - Deploy Mimecast API Connector**\n\n>**IMPORTANT:** Before deploying the Mimecast API connector, have the Workspace ID  and Workspace Primary Key (can be copied from the following), as well as the Mimecast API authorization key(s) or Token, readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Deploy the Mimecast Audit & Authentication Data Connector:",
        "description": "\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-MimecastAudit-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the following fields:\n - appName: Unique string that will be used as id for the app in Azure platform\n - objectId: Azure portal ---> Azure Active Directory ---> more info ---> Profile -----> Object ID\n - appInsightsLocation(default): westeurope\n - mimecastEmail: Email address of dedicated user for this integraion\n - mimecastPassword: Password for dedicated user\n - mimecastAppId: Application Id from the Microsoft Sentinel app registered with Mimecast\n - mimecastAppKey: Application Key from the Microsoft Sentinel app registered with Mimecast\n - mimecastAccessKey: Access Key for the dedicated Mimecast user\n - mimecastSecretKey: Secret Key for dedicated Mimecast user\n - mimecastBaseURL: Regional Mimecast API Base URL\n - activeDirectoryAppId: Azure portal ---> App registrations ---> [your_app] ---> Application ID\n - activeDirectoryAppSecret: Azure portal ---> App registrations ---> [your_app] ---> Certificates & secrets ---> [your_app_secret]\n - workspaceId: Azure portal ---> Log Analytics Workspaces ---> [Your workspace] ---> Agents ---> Workspace ID (or you can copy workspaceId from above) \n - workspaceKey:  Azure portal ---> Log Analytics Workspaces ---> [Your workspace] ---> Agents ---> Primary Key (or you can copy workspaceKey from above) \n - AppInsightsWorkspaceResourceID : Azure portal ---> Log Analytics Workspaces ---> [Your workspace] ---> Properties ---> Resource ID \n\n >Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details.\n\n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy. \n\n6. Go to ***Azure portal ---> Resource groups ---> [your_resource_group] --->  [appName](type: Storage account) ---> Storage Explorer ---> BLOB CONTAINERS ---> Audit checkpoints ---> Upload*** and create empty file on your machine named checkpoint.txt and select it for upload (this is done so that date_range for SIEM logs is stored in consistent state)\n"
      }
    ],
    "metadata": {
      "id": "f33b70f0-8d05-4c80-a44b-3ad040516613",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "Mimecast"
      },
      "author": {
        "name": "Mimecast"
      },
      "support": {
        "tier": "Partner",
        "name": "Mimecast",
        "email": "support@mimecast.com",
        "link": "https://mimecastsupport.zendesk.com/"
      }
    }
  },
  {
    "id": "MimecastAuditAPI",
    "title": "Mimecast Audit",
    "publisher": "Mimecast",
    "descriptionMarkdown": "The data connector for [Mimecast Audit](https://integrations.mimecast.com/tech-partners/microsoft-sentinel/) provides customers with the visibility into security events related to audit and authentication events within Microsoft Sentinel. The data connector provides pre-created dashboards to allow analysts to view insight into user activity, aid in incident correlation and reduce investigation response times coupled with custom alert capabilities.  \nThe Mimecast products included within the connector are: \nAudit\n ",
    "graphQueries": [
      {
        "metricName": "Total Audit data received",
        "legend": "Audit_CL",
        "baseQuery": "Audit_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Audit_CL",
        "query": "Audit_CL\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Audit_CL",
        "lastDataReceivedQuery": "Audit_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Audit_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Azure Subscription",
          "description": "Azure Subscription with owner role is required to register an application in Microsoft Entra ID and assign role of contributor to app in resource group."
        },
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "See the documentation to learn more about API on the [Rest API reference](https://integrations.mimecast.com/documentation/)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to a Mimecast API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "Configuration:",
        "description": "**STEP 1 - Configuration steps for the Mimecast API**\n\nGo to ***Azure portal ---> App registrations ---> [your_app] ---> Certificates & secrets ---> New client secret*** and create a new secret (save the Value somewhere safe right away because you will not be able to preview it later)"
      },
      {
        "title": "",
        "description": "**STEP 2 - Deploy Mimecast API Connector**\n\n>**IMPORTANT:** Before deploying the Mimecast API connector, have the Mimecast API authorization key(s) or Token, readily available."
      },
      {
        "title": "",
        "description": "**STEP 3 - App Registration steps for the Application in Microsoft Entra ID**\n\n This integration requires an App registration in the Azure portal. Follow the steps in this section to create a new application in Microsoft Entra ID:\n 1. Sign in to the [Azure portal](https://portal.azure.com/).\n 2. Search for and select **Microsoft Entra ID**.\n 3. Under **Manage**, select **App registrations > New registration**.\n 4. Enter a display **Name** for your application.\n 5. Select **Register** to complete the initial app registration.\n 6. When registration finishes, the Azure portal displays the app registration's Overview pane. You see the **Application (client) ID** and **Tenant ID**. The client ID and Tenant ID is required as configuration parameters for the execution of TenableVM Data Connector. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app)"
      },
      {
        "title": "",
        "description": "**STEP 4 - Add a client secret for application in Microsoft Entra ID**\n\n Sometimes called an application password, a client secret is a string value required for the execution of TenableVM Data Connector. Follow the steps in this section to create a new Client Secret:\n 1. In the Azure portal, in **App registrations**, select your application.\n 2. Select **Certificates & secrets > Client secrets > New client secret**.\n 3. Add a description for your client secret.\n 4. Select an expiration for the secret or specify a custom lifetime. Limit is 24 months.\n 5. Select **Add**. \n 6. *Record the secret's value for use in your client application code. This secret value is never displayed again after you leave this page.* The secret value is required as configuration parameter for the execution of TenableVM Data Connector. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret)"
      },
      {
        "title": "",
        "description": "**STEP 5 - Get Object ID of your application in Microsoft Entra ID**\n\n After creating your app registration, follow the steps in this section to get Object ID:\n 1. Go to **Microsoft Entra ID**.\n 2. Select **Enterprise applications** from the left menu.\n 3. Find your newly created application in the list (you can search by the name you provided).\n 4. Click on the application.\n 5. On the overview page, copy the **Object ID**. This is the **AzureEntraObjectId** needed for your ARM template role assignment.\n"
      },
      {
        "title": "Deploy the Mimecast Audit Data Connector:",
        "description": "Use this method for automated deployment of the Mimecast Audit Data connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-MimecastAuditAzureDeploy-azuredeploy) [![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://aka.ms/sentinel-MimecastAuditAzureDeploy-azuredeploy-gov)\n2. Select the preferred **Subscription**, **Resource Group** and **Region**. \n3. Enter the below information : \n\n\t a. Location - The location in which the data collection rules and data collection endpoints should be deployed\n\n\t b. WorkspaceName - Enter Microsoft Sentinel Workspace Name of Log Analytics workspace\n\n\t c. AzureClientID - Enter Azure Client ID that you have created during app registration\n\n\t d. AzureClientSecret - Enter Azure Client Secret that you have created during creating the client secret\n\n\t e. AzureTenantID - Enter Azure Tenant ID of your Azure Active Directory\n\n\t f. AzureEntraObjectID - Enter Object id of your Microsoft Entra App\n\n\t g. MimecastBaseURL - Enter Base URL of Mimecast API 2.0 (e.g. https://api.services.mimecast.com)\n\n\t h. MimecastClientID - Enter Mimecast Client ID for authentication\n\n\t i. MimecastClientSecret - Enter Mimecast Client Secret for authentication\n\n\t j. MimecastAuditTableName - Enter name of the table used to store Audit data. Default is 'Audit'\n\n\t k. StartDate - Enter the start date in the 'yyyy-mm-dd' format. If you do not provide a date, data from the last 60 days will be fetched automatically. Ensure that the date is in the past and properly formatted\n\n\t l. Schedule - Please enter a valid Quartz cron-expression. (Example: 0 0 */1 * * *) Do not keep the value empty, minimum value is 10 minutes\n\n\t m. LogLevel - Please add log level or log severity value. By default it is set to INFO\n\n\t n. AppInsightsWorkspaceResourceId - Migrate Classic Application Insights to Log Analytic Workspace which is retiring by 29 Febraury 2024. Use 'Log Analytic Workspace-->Properties' blade having 'Resource ID' property value. This is a fully qualified resourceId which is in format '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}' \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      }
    ]
  },
  {
    "id": "MimecastCIAPI",
    "title": "Mimecast Cloud Integrated",
    "publisher": "Mimecast",
    "descriptionMarkdown": "The data connector for [Mimecast Cloud Integrated](https://integrations.mimecast.com/tech-partners/microsoft-sentinel/) provides customers with the visibility into security events related to the Cloud Integrated inspection technologies within Microsoft Sentinel. The data connector provides pre-created dashboards to allow analysts to view insight into email based threats, aid in incident correlation and reduce investigation response times coupled with custom alert capabilities.",
    "graphQueries": [
      {
        "metricName": "Total Cloud Integrated data received",
        "legend": "Cloud_Integrated_CL",
        "baseQuery": "Cloud_Integrated_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Cloud_Integrated_CL",
        "query": "Cloud_Integrated_CL\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Cloud_Integrated_CL",
        "lastDataReceivedQuery": "Cloud_Integrated_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Cloud_Integrated_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Azure Subscription",
          "description": "Azure Subscription with owner role is required to register an application in Microsoft Entra ID and assign role of contributor to app in resource group."
        },
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "See the documentation to learn more about API on the [Rest API reference](https://integrations.mimecast.com/documentation/)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Resource group",
        "description": "You need to have a resource group created with a subscription you are going to use."
      },
      {
        "title": "Functions app",
        "description": "You need to have an Azure App registered for this connector to use\n1. Application Id\n2. Tenant Id\n3. Client Id\n4. Client Secret"
      },
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to a Mimecast API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "Configuration:",
        "description": "**STEP 1 - Configuration steps for the Mimecast API**\n\nGo to ***Azure portal ---> App registrations ---> [your_app] ---> Certificates & secrets ---> New client secret*** and create a new secret (save the Value somewhere safe right away because you will not be able to preview it later)"
      },
      {
        "title": "",
        "description": "**STEP 2 - Deploy Mimecast API Connector**\n\n>**IMPORTANT:** Before deploying the Mimecast API connector, have the Mimecast API authorization key(s) or Token, readily available."
      },
      {
        "title": "",
        "description": "**STEP 3 - App Registration steps for the Application in Microsoft Entra ID**\n\n This integration requires an App registration in the Azure portal. Follow the steps in this section to create a new application in Microsoft Entra ID:\n 1. Sign in to the [Azure portal](https://portal.azure.com/).\n 2. Search for and select **Microsoft Entra ID**.\n 3. Under **Manage**, select **App registrations > New registration**.\n 4. Enter a display **Name** for your application.\n 5. Select **Register** to complete the initial app registration.\n 6. When registration finishes, the Azure portal displays the app registration's Overview pane. You see the **Application (client) ID** and **Tenant ID**. The client ID and Tenant ID is required as configuration parameters for the execution of TenableVM Data Connector. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app)"
      },
      {
        "title": "",
        "description": "**STEP 4 - Add a client secret for application in Microsoft Entra ID**\n\n Sometimes called an application password, a client secret is a string value required for the execution of TenableVM Data Connector. Follow the steps in this section to create a new Client Secret:\n 1. In the Azure portal, in **App registrations**, select your application.\n 2. Select **Certificates & secrets > Client secrets > New client secret**.\n 3. Add a description for your client secret.\n 4. Select an expiration for the secret or specify a custom lifetime. Limit is 24 months.\n 5. Select **Add**. \n 6. *Record the secret's value for use in your client application code. This secret value is never displayed again after you leave this page.* The secret value is required as configuration parameter for the execution of TenableVM Data Connector. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret)"
      },
      {
        "title": "",
        "description": "**STEP 5 - Get Object ID of your application in Microsoft Entra ID**\n\n After creating your app registration, follow the steps in this section to get Object ID:\n 1. Go to **Microsoft Entra ID**.\n 2. Select **Enterprise applications** from the left menu.\n 3. Find your newly created application in the list (you can search by the name you provided).\n 4. Click on the application.\n 5. On the overview page, copy the **Object ID**. This is the **AzureEntraObjectId** needed for your ARM template role assignment.\n"
      },
      {
        "title": "Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the Mimecast Cloud Integrated Data connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-MimecastCI-azuredeploy) [![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://aka.ms/sentinel-MimecastCI-azuredeploy-gov)\n2. Select the preferred **Subscription**, **Resource Group** and **Region**. \n3. Enter the below information : \n\n\t a. Location - The location in which the data collection rules and data collection endpoints should be deployed\n\n\t b. WorkspaceName - Enter Microsoft Sentinel Workspace Name of Log Analytics workspace\n\n\t c. AzureClientID - Enter Azure Client ID that you have created during app registration\n\n\t d. AzureClientSecret - Enter Azure Client Secret that you have created during creating the client secret\n\n\t e. AzureTenantID - Enter Azure Tenant ID of your Azure Active Directory\n\n\t f. AzureEntraObjectID - Enter Object id of your Microsoft Entra App\n\n\t g. MimecastBaseURL - Enter Base URL of Mimecast API 2.0 (e.g. https://api.services.mimecast.com)\n\n\t h. MimecastClientID - Enter Mimecast Client ID for authentication\n\n\t i. MimecastClientSecret - Enter Mimecast Client Secret for authentication\n\n\t j. MimecastCITableName - Enter name of the table used to store Cloud Integrated data. Default is 'Cloud_Integrated'\n\n\t k. StartDate - Enter the start date in the 'yyyy-mm-dd' format. If you do not provide a date, data from the last 60 days will be fetched automatically. Ensure that the date is in the past and properly formatted\n\n\t l. Schedule - Please enter a valid Quartz cron-expression. (Example: 0 0 */1 * * *) Do not keep the value empty, minimum value is 10 minutes\n\n\t m. LogLevel - Please add log level or log severity value. By default it is set to INFO\n\n\t n. AppInsightsWorkspaceResourceId - Migrate Classic Application Insights to Log Analytic Workspace which is retiring by 29 Febraury 2024. Use 'Log Analytic Workspace-->Properties' blade having 'Resource ID' property value. This is a fully qualified resourceId which is in format '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}' \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      }
    ]
  },
  {
    "id": "MimecastSEGAPI",
    "title": "Mimecast Secure Email Gateway",
    "publisher": "Mimecast",
    "descriptionMarkdown": "The data connector for [Mimecast Secure Email Gateway](https://integrations.mimecast.com/tech-partners/microsoft-sentinel/) allows easy log collection from the Secure Email Gateway to surface email insight and user activity within Microsoft Sentinel. The data connector provides pre-created dashboards to allow analysts to view insight into email based threats, aid in incident correlation and reduce investigation response times coupled with custom alert capabilities. Mimecast products and features required: \n- Mimecast Cloud Gateway \n- Mimecast Data Leak Prevention\n ",
    "graphQueries": [
      {
        "metricName": "Total Cloud Gateway data received",
        "legend": "Seg_Cg_CL",
        "baseQuery": "Seg_Cg_CL"
      },
      {
        "metricName": "Total Data Leak Prevention data received",
        "legend": "Seg_Dlp_CL",
        "baseQuery": "Seg_Dlp_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Seg_Cg_CL",
        "query": "Seg_Cg_CL\n| sort by TimeGenerated desc"
      },
      {
        "description": "Seg_Dlp_CL",
        "query": "Seg_Dlp_CL\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Seg_Cg_CL",
        "lastDataReceivedQuery": "Seg_Cg_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Seg_Dlp_CL",
        "lastDataReceivedQuery": "Seg_Dlp_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Seg_Cg_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "Seg_Dlp_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Azure Subscription",
          "description": "Azure Subscription with owner role is required to register an application in Microsoft Entra ID and assign role of contributor to app in resource group."
        },
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "See the documentation to learn more about API on the [Rest API reference](https://integrations.mimecast.com/documentation/)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to a Mimecast API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "Configuration:",
        "description": "**STEP 1 - Configuration steps for the Mimecast API**\n\nGo to ***Azure portal ---> App registrations ---> [your_app] ---> Certificates & secrets ---> New client secret*** and create a new secret (save the Value somewhere safe right away because you will not be able to preview it later)"
      },
      {
        "title": "",
        "description": "****STEP 2 - Deploy Mimecast API Connector**\n\n>**IMPORTANT:** Before deploying the Mimecast API connector, have the Mimecast API authorization key(s) or Token, readily available."
      },
      {
        "title": "",
        "description": "**STEP 3 - App Registration steps for the Application in Microsoft Entra ID**\n\n This integration requires an App registration in the Azure portal. Follow the steps in this section to create a new application in Microsoft Entra ID:\n 1. Sign in to the [Azure portal](https://portal.azure.com/).\n 2. Search for and select **Microsoft Entra ID**.\n 3. Under **Manage**, select **App registrations > New registration**.\n 4. Enter a display **Name** for your application.\n 5. Select **Register** to complete the initial app registration.\n 6. When registration finishes, the Azure portal displays the app registration's Overview pane. You see the **Application (client) ID** and **Tenant ID**. The client ID and Tenant ID is required as configuration parameters for the execution of TenableVM Data Connector. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app)"
      },
      {
        "title": "",
        "description": "**STEP 4 - Add a client secret for application in Microsoft Entra ID**\n\n Sometimes called an application password, a client secret is a string value required for the execution of TenableVM Data Connector. Follow the steps in this section to create a new Client Secret:\n 1. In the Azure portal, in **App registrations**, select your application.\n 2. Select **Certificates & secrets > Client secrets > New client secret**.\n 3. Add a description for your client secret.\n 4. Select an expiration for the secret or specify a custom lifetime. Limit is 24 months.\n 5. Select **Add**. \n 6. *Record the secret's value for use in your client application code. This secret value is never displayed again after you leave this page.* The secret value is required as configuration parameter for the execution of TenableVM Data Connector. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret)"
      },
      {
        "title": "",
        "description": "**STEP 5 - Get Object ID of your application in Microsoft Entra ID**\n\n After creating your app registration, follow the steps in this section to get Object ID:\n 1. Go to **Microsoft Entra ID**.\n 2. Select **Enterprise applications** from the left menu.\n 3. Find your newly created application in the list (you can search by the name you provided).\n 4. Click on the application.\n 5. On the overview page, copy the **Object ID**. This is the **AzureEntraObjectId** needed for your ARM template role assignment.\n"
      },
      {
        "title": "Deploy the Mimecast Secure Email Gateway Data Connector:",
        "description": "Use this method for automated deployment of the Mimecast Secure Email Gateway Data connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-MimecastSEGAzureDeploy-azuredeploy) [![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://aka.ms/sentinel-MimecastSEGAzureDeploy-azuredeploy-gov)\n2. SSelect the preferred **Subscription**, **Resource Group** and **Region**. \n3. Enter the below information : \n\n\t a. Location - The location in which the data collection rules and data collection endpoints should be deployed\n\n\t b. WorkspaceName - Enter Microsoft Sentinel Workspace Name of Log Analytics workspace\n\n\t c. AzureClientID - Enter Azure Client ID that you have created during app registration\n\n\t d. AzureClientSecret - Enter Azure Client Secret that you have created during creating the client secret\n\n\t e. AzureTenantID - Enter Azure Tenant ID of your Azure Active Directory\n\n\t f. AzureEntraObjectID - Enter Object id of your Microsoft Entra App\n\n\t g. MimecastBaseURL - Enter Base URL of Mimecast API 2.0 (e.g. https://api.services.mimecast.com)\n\n\t h. MimecastClientID - Enter Mimecast Client ID for authentication\n\n\t i. MimecastClientSecret - Enter Mimecast Client Secret for authentication\n\n\t j. MimecastCGTableName - Enter name of the table used to store CG data. Default is 'Seg_Cg'\n\n\t k. MimecastDLPTableName - Enter name of the table used to store DLP data. Default is 'Seg_Dlp'\n\n\t l. StartDate - Enter the start date in the 'yyyy-mm-dd' format. If you do not provide a date, data from the last 60 days will be fetched automatically. Ensure that the date is in the past and properly formatted\n\n\t m. Schedule - Please enter a valid Quartz cron-expression. (Example: 0 0 */1 * * *) Do not keep the value empty, minimum value is 10 minutes\n\n\t n. LogLevel - Please add log level or log severity value. By default it is set to INFO\n\n\t o. AppInsightsWorkspaceResourceId - Migrate Classic Application Insights to Log Analytic Workspace which is retiring by 29 Febraury 2024. Use 'Log Analytic Workspace-->Properties' blade having 'Resource ID' property value. This is a fully qualified resourceId which is in format '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}' \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      }
    ]
  },
  {
    "id": "MimecastSIEMAPI",
    "title": "Mimecast Secure Email Gateway",
    "publisher": "Mimecast",
    "descriptionMarkdown": "The data connector for [Mimecast Secure Email Gateway](https://integrations.mimecast.com/tech-partners/microsoft-sentinel/) allows easy log collection from the Secure Email Gateway to surface email insight and user activity within Microsoft Sentinel. The data connector provides pre-created dashboards to allow analysts to view insight into email based threats, aid in incident correlation and reduce investigation response times coupled with custom alert capabilities. Mimecast products and features required: \n- Mimecast Secure Email Gateway \n- Mimecast Data Leak Prevention\n ",
    "graphQueries": [
      {
        "metricName": "Total Secure Email Gateway data received",
        "legend": "MimecastSIEM_CL",
        "baseQuery": "MimecastSIEM_CL"
      },
      {
        "metricName": "Total Data Leak Prevention data received",
        "legend": "MimecastDLP_CL",
        "baseQuery": "MimecastDLP_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "MimecastSIEM_CL",
        "query": "MimecastSIEM_CL\n| sort by TimeGenerated desc"
      },
      {
        "description": "MimecastDLP_CL",
        "query": "MimecastDLP_CL\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "MimecastSIEM_CL",
        "lastDataReceivedQuery": "MimecastSIEM_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "MimecastDLP_CL",
        "lastDataReceivedQuery": "MimecastDLP_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "MimecastSIEM_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "MimecastDLP_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Mimecast API credentials",
          "description": "You need to have the following pieces of information to configure the integration:\n- mimecastEmail: Email address of a dedicated Mimecast admin user\n- mimecastPassword: Password for the dedicated Mimecast admin user\n- mimecastAppId: API Application Id of the Mimecast Microsoft Sentinel app registered with Mimecast\n- mimecastAppKey: API Application Key of the Mimecast Microsoft Sentinel app registered with Mimecast\n- mimecastAccessKey: Access Key for the dedicated Mimecast admin user\n- mimecastSecretKey: Secret Key for the dedicated Mimecast admin user\n- mimecastBaseURL: Mimecast Regional API Base URL\n\n> The Mimecast Application Id, Application Key, along with the Access Key and Secret keys for the dedicated Mimecast admin user are obtainable via the Mimecast Administration Console: Administration | Services | API and Platform Integrations.\n\n> The Mimecast API Base URL for each region is documented here: https://integrations.mimecast.com/documentation/api-overview/global-base-urls/"
        },
        {
          "name": "Resource group",
          "description": "You need to have a resource group created with a subscription you are going to use."
        },
        {
          "name": "Functions app",
          "description": "You need to have an Azure App registered for this connector to use\n1. Application Id\n2. Tenant Id\n3. Client Id\n4. Client Secret"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to a Mimecast API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "Configuration:",
        "description": "**STEP 1 - Configuration steps for the Mimecast API**\n\nGo to ***Azure portal ---> App registrations ---> [your_app] ---> Certificates & secrets ---> New client secret*** and create a new secret (save the Value somewhere safe right away because you will not be able to preview it later)"
      },
      {
        "title": "",
        "description": "**STEP 2 - Deploy Mimecast API Connector**\n\n>**IMPORTANT:** Before deploying the Mimecast API connector, have the Workspace ID  and Workspace Primary Key (can be copied from the following), as well as the Mimecast API authorization key(s) or Token, readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Deploy the Mimecast Secure Email Gateway Data Connector:",
        "description": "\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-MimecastSEG-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the following fields:\n - appName: Unique string that will be used as id for the app in Azure platform\n - objectId: Azure portal ---> Azure Active Directory ---> more info ---> Profile -----> Object ID\n - appInsightsLocation(default): westeurope\n - mimecastEmail: Email address of dedicated user for this integraion\n - mimecastPassword: Password for dedicated user\n - mimecastAppId: Application Id from the Microsoft Sentinel app registered with Mimecast\n - mimecastAppKey: Application Key from the Microsoft Sentinel app registered with Mimecast\n - mimecastAccessKey: Access Key for the dedicated Mimecast user\n - mimecastSecretKey: Secret Key for dedicated Mimecast user\n - mimecastBaseURL: Regional Mimecast API Base URL\n - activeDirectoryAppId: Azure portal ---> App registrations ---> [your_app] ---> Application ID\n - activeDirectoryAppSecret: Azure portal ---> App registrations ---> [your_app] ---> Certificates & secrets ---> [your_app_secret]\n - workspaceId: Azure portal ---> Log Analytics Workspaces ---> [Your workspace] ---> Agents ---> Workspace ID (or you can copy workspaceId from above) \n - workspaceKey:  Azure portal ---> Log Analytics Workspaces ---> [Your workspace] ---> Agents ---> Primary Key (or you can copy workspaceKey from above) \n - AppInsightsWorkspaceResourceID : Azure portal ---> Log Analytics Workspaces ---> [Your workspace] ---> Properties ---> Resource ID \n\n >Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details.\n\n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy.\n\n6. Go to ***Azure portal ---> Resource groups ---> [your_resource_group] --->  [appName](type: Storage account) ---> Storage Explorer ---> BLOB CONTAINERS ---> SIEM checkpoints ---> Upload*** and create empty file on your machine named checkpoint.txt, dlp-checkpoint.txt and select it for upload (this is done so that date_range for SIEM logs is stored in consistent state)\n"
      }
    ],
    "metadata": {
      "id": "d394478b-62f5-49c9-9ce7-96ed999cc727",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "Mimecast"
      },
      "author": {
        "name": "Mimecast"
      },
      "support": {
        "tier": "Partner",
        "name": "Mimecast",
        "email": "support@mimecast.com",
        "link": "https://mimecastsupport.zendesk.com/"
      }
    }
  },
  {
    "id": "MimecastTIRegionalConnectorAzureFunctions",
    "title": "Mimecast Intelligence for Microsoft - Microsoft Sentinel",
    "publisher": "Mimecast",
    "descriptionMarkdown": "The data connector for Mimecast Intelligence for Microsoft provides regional threat intelligence curated from Mimecasts email inspection technologies with pre-created dashboards to allow analysts to view insight into email based threats, aid in incident correlation and reduce investigation response times.  \nMimecast products and features required: \n- Mimecast Secure Email Gateway \n- Mimecast Threat Intelligence\n",
    "graphQueries": [
      {
        "metricName": "Total Threat Intelligence (Regional) data received",
        "legend": "ThreatIntelligenceIndicator",
        "baseQuery": "ThreatIntelligenceIndicator"
      }
    ],
    "sampleQueries": [
      {
        "description": "ThreatIntelligenceIndicator",
        "query": "ThreatIntelligenceIndicator\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Event(ThreatIntelligenceIndicator)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ThreatIntelligenceIndicator\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 0,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Mimecast API credentials",
          "description": "You need to have the following pieces of information to configure the integration:\n- mimecastEmail: Email address of a dedicated Mimecast admin user\n- mimecastPassword: Password for the dedicated Mimecast admin user\n- mimecastAppId: API Application Id of the Mimecast Microsoft Sentinel app registered with Mimecast\n- mimecastAppKey: API Application Key of the Mimecast Microsoft Sentinel app registered with Mimecast\n- mimecastAccessKey: Access Key for the dedicated Mimecast admin user\n- mimecastSecretKey: Secret Key for the dedicated Mimecast admin user\n- mimecastBaseURL: Mimecast Regional API Base URL\n\n> The Mimecast Application Id, Application Key, along with the Access Key and Secret keys for the dedicated Mimecast admin user are obtainable via the Mimecast Administration Console: Administration | Services | API and Platform Integrations.\n\n> The Mimecast API Base URL for each region is documented here: https://integrations.mimecast.com/documentation/api-overview/global-base-urls/"
        },
        {
          "name": "Resource group",
          "description": "You need to have a resource group created with a subscription you are going to use."
        },
        {
          "name": "Functions app",
          "description": "You need to have an Azure App registered for this connector to use\n1. Application Id\n2. Tenant Id\n3. Client Id\n4. Client Secret"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to a Mimecast API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "Configuration:",
        "description": "**STEP 1 - Configuration steps for the Mimecast API**\n\nGo to ***Azure portal ---> App registrations ---> [your_app] ---> Certificates & secrets ---> New client secret*** and create a new secret (save the Value somewhere safe right away because you will not be able to preview it later)"
      },
      {
        "title": "",
        "description": "**STEP 2 - Deploy Mimecast API Connector**\n\n>**IMPORTANT:** Before deploying the Mimecast API connector, have the Workspace ID  and Workspace Primary Key (can be copied from the following), as well as the Mimecast API authorization key(s) or Token, readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Enable Mimecast Intelligence for Microsoft - Microsoft Sentinel Connector:",
        "description": "\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-MimecastTIRegional-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the following fields:\n - appName: Unique string that will be used as id for the app in Azure platform\n - objectId: Azure portal ---> Azure Active Directory ---> more info ---> Profile -----> Object ID\n - appInsightsLocation(default): westeurope\n - mimecastEmail: Email address of dedicated user for this integraion\n - mimecastPassword: Password for dedicated user\n - mimecastAppId: Application Id from the Microsoft Sentinel app registered with Mimecast\n - mimecastAppKey: Application Key from the Microsoft Sentinel app registered with Mimecast\n - mimecastAccessKey: Access Key for the dedicated Mimecast user\n - mimecastSecretKey: Secret Key for dedicated Mimecast user\n - mimecastBaseURL: Regional Mimecast API Base URL\n - activeDirectoryAppId: Azure portal ---> App registrations ---> [your_app] ---> Application ID\n - activeDirectoryAppSecret: Azure portal ---> App registrations ---> [your_app] ---> Certificates & secrets ---> [your_app_secret]\n - workspaceId: Azure portal ---> Log Analytics Workspaces ---> [Your workspace] ---> Agents ---> Workspace ID (or you can copy workspaceId from above) \n - workspaceKey:  Azure portal ---> Log Analytics Workspaces ---> [Your workspace] ---> Agents ---> Primary Key (or you can copy workspaceKey from above) \n - AppInsightsWorkspaceResourceID : Azure portal ---> Log Analytics Workspaces ---> [Your workspace] ---> Properties ---> Resource ID \n\n >Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details.\n\n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy.\n\n6. Go to ***Azure portal ---> Resource groups ---> [your_resource_group] --->  [appName](type: Storage account) ---> Storage Explorer ---> BLOB CONTAINERS ---> TIR checkpoints ---> Upload*** and create empty file on your machine named checkpoint.txt and select it for upload (this is done so that date_range for TIR logs is stored in consistent state)\n"
      },
      {
        "title": "Additional configuration:",
        "description": ">Connect to a **Threat Intelligence Platforms** Data Connector. Follow instructions on the connector page and then click connect button."
      }
    ],
    "metadata": {
      "id": "b9c65326-f65b-4f55-8671-fbedae05adf9",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "Mimecast"
      },
      "author": {
        "name": "Mimecast"
      },
      "support": {
        "tier": "Partner",
        "name": "Mimecast",
        "email": "support@mimecast.com",
        "link": "https://mimecastsupport.zendesk.com/"
      }
    }
  },
  {
    "id": "MimecastTTPAPI",
    "title": "Mimecast Targeted Threat Protection",
    "publisher": "Mimecast",
    "descriptionMarkdown": "The data connector for [Mimecast Targeted Threat Protection](https://integrations.mimecast.com/tech-partners/microsoft-sentinel/) provides customers with the visibility into security events related to the Targeted Threat Protection inspection technologies within Microsoft Sentinel. The data connector provides pre-created dashboards to allow analysts to view insight into email based threats, aid in incident correlation and reduce investigation response times coupled with custom alert capabilities.  \nThe Mimecast products included within the connector are: \n- URL Protect \n- Impersonation Protect \n- Attachment Protect\n",
    "graphQueries": [
      {
        "metricName": "Total URL Protect data received",
        "legend": "Ttp_Url_CL",
        "baseQuery": "Ttp_Url_CL"
      },
      {
        "metricName": "Total Attachment Protect data received",
        "legend": "Ttp_Attachment_CL",
        "baseQuery": "Ttp_Attachment_CL"
      },
      {
        "metricName": "Total Impersonation Protect data received",
        "legend": "Ttp_Impersonation_CL",
        "baseQuery": "Ttp_Impersonation_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Ttp_Url_CL",
        "query": "Ttp_Url_CL\n| sort by TimeGenerated desc"
      },
      {
        "description": "Ttp_Attachment_CL",
        "query": "Ttp_Attachment_CL\n| sort by TimeGenerated desc"
      },
      {
        "description": "Ttp_Impersonation_CL",
        "query": "Ttp_Impersonation_CL\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Ttp_Url_CL",
        "lastDataReceivedQuery": "Ttp_Url_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Ttp_Attachment_CL",
        "lastDataReceivedQuery": "Ttp_Attachment_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Ttp_Impersonation_CL",
        "lastDataReceivedQuery": "Ttp_Impersonation_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Ttp_Url_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "Ttp_Attachment_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "Ttp_Impersonation_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Azure Subscription",
          "description": "Azure Subscription with owner role is required to register an application in Microsoft Entra ID and assign role of contributor to app in resource group."
        },
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "See the documentation to learn more about API on the [Rest API reference](https://integrations.mimecast.com/documentation/)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Resource group",
        "description": "You need to have a resource group created with a subscription you are going to use."
      },
      {
        "title": "Functions app",
        "description": "You need to have an Azure App registered for this connector to use\n1. Application Id\n2. Tenant Id\n3. Client Id\n4. Client Secret"
      },
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to a Mimecast API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1 - App Registration steps for the Application in Microsoft Entra ID**\n\n This integration requires an App registration in the Azure portal. Follow the steps in this section to create a new application in Microsoft Entra ID:\n 1. Sign in to the [Azure portal](https://portal.azure.com/).\n 2. Search for and select **Microsoft Entra ID**.\n 3. Under **Manage**, select **App registrations > New registration**.\n 4. Enter a display **Name** for your application.\n 5. Select **Register** to complete the initial app registration.\n 6. When registration finishes, the Azure portal displays the app registration's Overview pane. You see the **Application (client) ID** and **Tenant ID**. The client ID and Tenant ID is required as configuration parameters for the execution of Mimecast Data Connector. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app)"
      },
      {
        "title": "",
        "description": "**STEP 2 - Add a client secret for application in Microsoft Entra ID**\n\n Sometimes called an application password, a client secret is a string value required for the execution of Mimecast Data Connector. Follow the steps in this section to create a new Client Secret:\n 1. In the Azure portal, in **App registrations**, select your application.\n 2. Select **Certificates & secrets > Client secrets > New client secret**.\n 3. Add a description for your client secret.\n 4. Select an expiration for the secret or specify a custom lifetime. Limit is 24 months.\n 5. Select **Add**. \n 6. *Record the secret's value for use in your client application code. This secret value is never displayed again after you leave this page.* The secret value is required as configuration parameter for the execution of Mimecast Data Connector. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret)"
      },
      {
        "title": "",
        "description": "**STEP 3 - Get Object ID of your application in Microsoft Entra ID**\n\n After creating your app registration, follow the steps in this section to get Object ID:\n 1. Go to **Microsoft Entra ID**.\n 2. Select **Enterprise applications** from the left menu.\n 3. Find your newly created application in the list (you can search by the name you provided).\n 4. Click on the application.\n 5. On the overview page, copy the **Object ID**. This is the **AzureEntraObjectId** needed for your ARM template role assignment.\n"
      },
      {
        "title": "",
        "description": "**STEP 4 - Deploy Mimecast API Connector**\n\n>**IMPORTANT:** Before deploying the Mimecast API connector, have the Mimecast API authorization key(s) or Token, readily available."
      },
      {
        "title": "Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the Mimecast Targeted Threat Protection Data connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-MimecastTTPAzureDeploy-azuredeploy) [![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://aka.ms/sentinel-MimecastTTPAzureDeploy-azuredeploy-gov)\n2. Select the preferred **Subscription**, **Resource Group** and **Region**. \n3. Enter the below information : \n\n\t a. Location - The location in which the data collection rules and data collection endpoints should be deployed\n\n\t b. WorkspaceName - Enter Microsoft Sentinel Workspace Name of Log Analytics workspace\n\n\t c. AzureClientID - Enter Azure Client ID that you have created during app registration\n\n\t d. AzureClientSecret - Enter Azure Client Secret that you have created during creating the client secret\n\n\t e. AzureTenantID - Enter Azure Tenant ID of your Azure Active Directory\n\n\t f. AzureEntraObjectID - Enter Object id of your Microsoft Entra App\n\n\t g. MimecastBaseURL - Enter Base URL of Mimecast API 2.0 (e.g. https://api.services.mimecast.com)\n\n\t h. MimecastClientID - Enter Mimecast Client ID for authentication\n\n\t i. MimecastClientSecret - Enter Mimecast Client Secret for authentication\n\n\t j. StartDate - Enter the start date in the 'yyyy-mm-dd' format. If you do not provide a date, data from the last 60 days will be fetched automatically. Ensure that the date is in the past and properly formatted\n\n\t k. MimecastTTPAttachmentTableName - Enter name of the table used to store TTP Attachment data. Default is 'Ttp_Attachment'\n\n\t l. MimecastTTPImpersonationTableName - Enter name of the table used to store TTP Impersonation data. Default is 'Ttp_Impersonation'\n\n\t m. MimecastTTPUrlTableName - Enter name of the table used to store TTP Attachment data. Default is 'Ttp_Url'\n\n\t n. Schedule - Please enter a valid Quartz cron-expression. (Example: 0 0 */1 * * *) Do not keep the value empty, minimum value is 10 minutes\n\n\t l. LogLevel - Please add log level or log severity value. By default it is set to INFO\n\n\t o. AppInsightsWorkspaceResourceId - Migrate Classic Application Insights to Log Analytic Workspace which is retiring by 29 Febraury 2024. Use 'Log Analytic Workspace-->Properties' blade having 'Resource ID' property value. This is a fully qualified resourceId which is in format '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}' \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      }
    ]
  },
  {
    "id": "MimecastTTPAPI",
    "title": "Mimecast Targeted Threat Protection",
    "publisher": "Mimecast",
    "descriptionMarkdown": "The data connector for [Mimecast Targeted Threat Protection](https://integrations.mimecast.com/tech-partners/microsoft-sentinel/) provides customers with the visibility into security events related to the Targeted Threat Protection inspection technologies within Microsoft Sentinel. The data connector provides pre-created dashboards to allow analysts to view insight into email based threats, aid in incident correlation and reduce investigation response times coupled with custom alert capabilities.  \nThe Mimecast products included within the connector are: \n- URL Protect \n- Impersonation Protect \n- Attachment Protect\n",
    "graphQueries": [
      {
        "metricName": "Total URL Protect data received",
        "legend": "MimecastTTPUrl_CL",
        "baseQuery": "MimecastTTPUrl_CL"
      },
      {
        "metricName": "Total Attachment Protect data received",
        "legend": "MimecastTTPAttachment_CL",
        "baseQuery": "MimecastTTPAttachment_CL"
      },
      {
        "metricName": "Total Impersonation Protect data received",
        "legend": "MimecastTTPImpersonation_CL",
        "baseQuery": "MimecastTTPImpersonation_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "MimecastTTPUrl_CL",
        "query": "MimecastTTPUrl_CL\n| sort by TimeGenerated desc"
      },
      {
        "description": "MimecastTTPAttachment_CL",
        "query": "MimecastTTPAttachment_CL\n| sort by TimeGenerated desc"
      },
      {
        "description": "MimecastTTPImpersonation_CL",
        "query": "MimecastTTPImpersonation_CL\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "MimecastTTPUrl_CL",
        "lastDataReceivedQuery": "MimecastTTPUrl_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "MimecastTTPAttachment_CL",
        "lastDataReceivedQuery": "MimecastTTPAttachment_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "MimecastTTPImpersonation_CL",
        "lastDataReceivedQuery": "MimecastTTPImpersonation_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "MimecastTTPUrl_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "MimecastTTPAttachment_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "MimecastTTPImpersonation_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "You need to have the following pieces of information to configure the integration:\n- mimecastEmail: Email address of a dedicated Mimecast admin user\n- mimecastPassword: Password for the dedicated Mimecast admin user\n- mimecastAppId: API Application Id of the Mimecast Microsoft Sentinel app registered with Mimecast\n- mimecastAppKey: API Application Key of the Mimecast Microsoft Sentinel app registered with Mimecast\n- mimecastAccessKey: Access Key for the dedicated Mimecast admin user\n- mimecastSecretKey: Secret Key for the dedicated Mimecast admin user\n- mimecastBaseURL: Mimecast Regional API Base URL\n\n> The Mimecast Application Id, Application Key, along with the Access Key and Secret keys for the dedicated Mimecast admin user are obtainable via the Mimecast Administration Console: Administration | Services | API and Platform Integrations.\n\n> The Mimecast API Base URL for each region is documented here: https://integrations.mimecast.com/documentation/api-overview/global-base-urls/"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Resource group",
        "description": "You need to have a resource group created with a subscription you are going to use."
      },
      {
        "title": "Functions app",
        "description": "You need to have an Azure App registered for this connector to use\n1. Application Id\n2. Tenant Id\n3. Client Id\n4. Client Secret"
      },
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to a Mimecast API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "Configuration:",
        "description": "**STEP 1 - Configuration steps for the Mimecast API**\n\nGo to ***Azure portal ---> App registrations ---> [your_app] ---> Certificates & secrets ---> New client secret*** and create a new secret (save the Value somewhere safe right away because you will not be able to preview it later)"
      },
      {
        "title": "",
        "description": "**STEP 2 - Deploy Mimecast API Connector**\n\n>**IMPORTANT:** Before deploying the Mimecast API connector, have the Workspace ID  and Workspace Primary Key (can be copied from the following), as well as the Mimecast API authorization key(s) or Token, readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Deploy the Mimecast Targeted Threat Protection Data Connector:",
        "description": "\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-MimecastTTP-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the following fields:\n - appName: Unique string that will be used as id for the app in Azure platform\n - objectId: Azure portal ---> Azure Active Directory ---> more info ---> Profile -----> Object ID\n - appInsightsLocation(default): westeurope\n - mimecastEmail: Email address of dedicated user for this integraion\n - mimecastPassword: Password for dedicated user\n - mimecastAppId: Application Id from the Microsoft Sentinel app registered with Mimecast\n - mimecastAppKey: Application Key from the Microsoft Sentinel app registered with Mimecast\n - mimecastAccessKey: Access Key for the dedicated Mimecast user\n - mimecastSecretKey: Secret Key for dedicated Mimecast user\n - mimecastBaseURL: Regional Mimecast API Base URL\n - activeDirectoryAppId: Azure portal ---> App registrations ---> [your_app] ---> Application ID\n - activeDirectoryAppSecret: Azure portal ---> App registrations ---> [your_app] ---> Certificates & secrets ---> [your_app_secret]\n - workspaceId: Azure portal ---> Log Analytics Workspaces ---> [Your workspace] ---> Agents ---> Workspace ID (or you can copy workspaceId from above) \n - workspaceKey:  Azure portal ---> Log Analytics Workspaces ---> [Your workspace] ---> Agents ---> Primary Key (or you can copy workspaceKey from above) \n - AppInsightsWorkspaceResourceID : Azure portal ---> Log Analytics Workspaces ---> [Your workspace] ---> Properties ---> Resource ID \n\n >Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details.\n\n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy.\n\n6. Go to ***Azure portal ---> Resource groups ---> [your_resource_group] --->  [appName](type: Storage account) ---> Storage Explorer ---> BLOB CONTAINERS ---> TTP checkpoints ---> Upload*** and create empty files on your machine named attachment-checkpoint.txt, impersonation-checkpoint.txt, url-checkpoint.txt and select them for upload (this is done so that date_range for TTP logs are stored in consistent state)\n"
      }
    ],
    "metadata": {
      "id": "4588c4ec-1e98-4ddc-841f-35c015f12654",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "Mimecast"
      },
      "author": {
        "name": "Mimecast"
      },
      "support": {
        "tier": "Partner",
        "name": "Mimecast",
        "email": "support@mimecast.com",
        "link": "https://mimecastsupport.zendesk.com/"
      }
    }
  },
  {
    "id": "MISP2SentinelConnector",
    "title": "MISP2Sentinel",
    "publisher": "MISP project & cudeso.be",
    "descriptionMarkdown": "This solution installs the MISP2Sentinel connector that allows you to automatically push threat indicators from MISP to Microsoft Sentinel via the Upload Indicators REST API. After installing the solution, configure and enable this data connector by following guidance in Manage solution view.",
    "graphQueries": [
      {
        "metricName": "Total indicators received",
        "legend": "Connection Events",
        "baseQuery": "ThreatIntelligenceIndicator | where SourceSystem == 'MISP'"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Threat Intelligence APIs Indicators",
        "query": "ThreatIntelligenceIndicator | where SourceSystem == 'MISP'| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "ThreatIntelligenceIndicator",
        "lastDataReceivedQuery": "ThreatIntelligenceIndicator| where isnotempty(TimeGenerated) and SourceSystem == 'MISP' | summarize Time = max(TimeGenerated)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ThreatIntelligenceIndicator| where SourceSystem == 'MISP' | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.SecurityInsights/threatintelligence/write",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Installation and setup instructions",
        "description": "Use the documentation from this GitHub repository to install and configure the MISP to Microsoft Sentinel connector: \n\nhttps://github.com/cudeso/misp2sentinel"
      }
    ]
  },
  {
    "id": "MongoDB",
    "title": "[Deprecated] MongoDB Audit",
    "publisher": "MongoDB",
    "descriptionMarkdown": "MongoDB data connector provides the capability to ingest [MongoDBAudit](https://www.mongodb.com/) into Microsoft Sentinel. Refer to [MongoDB documentation](https://www.mongodb.com/docs/manual/tutorial/getting-started/) for more information.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "MongoDBAudit_CL",
        "baseQuery": "MongoDBAudit_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "MongoDBAudit - All Activities.",
        "query": "MongoDBAudit_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "MongoDBAudit_CL",
        "lastDataReceivedQuery": "MongoDBAudit_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "MongoDBAudit_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias MongoDBAudit and load the function code or click [here](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/MongoDBAudit/Parsers/MongoDBAudit.txt) on the second line of the query, enter the hostname(s) of your MongoDBAudit device(s) and any other unique identifiers for the logstream. The function usually takes 10-15 minutes to activate after solution installation/update.",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux or Windows",
        "description": "Install the agent on the Tomcat Server where the logs are generated.\n\n> Logs from MongoDB Enterprise Server deployed on Linux or Windows servers are collected by **Linux** or **Windows** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Linux agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Windows agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Windows Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Windows Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure MongoDBAudit to write logs to files",
        "description": "Edit mongod.conf file (for Linux) or mongod.cfg (for Windows) to write logs to files:\n\n>**dbPath**: data/db\n\n>**path**: data/db/auditLog.json\n\nSet the following parameters: **dbPath** and **path**. Refer to the [MongoDB documentation for more details](https://www.mongodb.com/docs/manual/tutorial/configure-auditing/)"
      },
      {
        "title": "3. Configure the logs to be collected",
        "description": "Configure the custom log directory to be collected",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenCustomLogsSettings"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "",
        "description": "1. Select the link above to open your workspace advanced settings \n2. From the left pane, select **Settings**, select **Custom Logs** and click **+Add custom log**\n3. Click **Browse** to upload a sample of a MongoDBAudit log file. Then, click **Next >**\n4. Select **Timestamp** as the record delimiter and click **Next >**\n5. Select **Windows** or **Linux** and enter the path to MongoDBAudit logs based on your configuration \n6. After entering the path, click the '+' symbol to apply, then click **Next >** \n7. Add **MongoDBAudit** as the custom log Name (the '_CL' suffix will be added automatically) and click **Done**."
      },
      {
        "title": "Validate connectivity",
        "description": "It may take upwards of 20 minutes until your logs start to appear in Microsoft Sentinel."
      }
    ],
    "metadata": {
      "id": "Unique Identifier (GUID) used to identify dependencies and content from solutions or community.",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Microsoft"
      },
      "support": {
        "tier": "community",
        "name": "Microsoft",
        "link": "https://github.com/Azure/Azure-Sentinel/issues"
      }
    }
  },
  {
    "id": "MongoDBAtlasLogsAzureFunctions",
    "title": "MongoDB Atlas Logs",
    "publisher": "MongoDB",
    "descriptionMarkdown": "The [MongoDBAtlas](https://www.mongodb.com/products/platform/atlas-database) Logs connector gives the capability to upload MongoDB Atlas database logs into Microsoft Sentinel through the MongoDB Atlas Administration API. Refer to the [API documentation](https://www.mongodb.com/docs/api/doc/atlas-admin-api-v2/) for more information. The connector provides the ability to get a range of database log messages for the specified hosts and specified project.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "MDBALogTable_CL",
        "baseQuery": "MDBALogTable_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "MongoDB Atlas logs",
        "query": "MDBALogTable_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "MDBALogTable_CL",
        "lastDataReceivedQuery": "MDBALogTable_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "MDBALogTable_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "MongoDB Atlas service account **Client ID** and **Client Secret** are required.  [See the documentation to learn more about creating a service account](https://www.mongodb.com/docs/atlas/configure-api-access/#grant-programmatic-access-to-an-organization)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to 'MongoDB Atlas' to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": ">Ensure the workspace is added to Microsoft Sentinel before deploying the connector."
      },
      {
        "title": "STEP 1 - Configuration steps for the 'MongoDB Atlas Administration API'",
        "description": "1. [Follow these instructions](https://www.mongodb.com/docs/atlas/configure-api-access/#grant-programmatic-access-to-an-organization) to create a MongoDB Atlas service account.\n2. Copy the **Client ID** and **Client Secret** you created, also the **Group ID** (Project) and each **Cluster ID** (Hostname) required for later steps.\n3. Refer [MongoDB Atlas API documentation](https://www.mongodb.com/docs/api/doc/atlas-admin-api-v2/operation/operation-downloadgroupclusterlog) for more details.\n4. The client secret can be passed into the connector via an Azure key vault or directly into the connector.\n5. If you want to use the key vault option create a key vault, using a Vault Access Policy, with a secret named **mongodb-client-secret** and your client secret saved as the secret value."
      },
      {
        "title": "STEP 2 - Deploy the 'MongoDB Atlas Logs' connector and the associated Azure Function",
        "description": "\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#view/Microsoft_Azure_CreateUIDef/CustomDeploymentBlade/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2FAzure-Sentinel%2Fmaster%2FSolutions%2FMongoDBAtlas%2FData%20Connectors%2FMongoDBAtlasLogs%2Fazuredeploy_Connector_MongoDBAtlasLogs_AzureFunction.json/uiFormDefinitionUri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2FAzure-Sentinel%2Fmaster%2FSolutions%2FMongoDBAtlas%2FData%20Connectors%2FMongoDBAtlasLogs%2FcreateUiDef.json)"
      },
      {
        "title": "STEP 3 - Set the connector parameters",
        "description": "1. Select the preferred **Subscription** and an existing **Resource Group**.\n2. Enter an existing **Log Analytics Workspace Resource ID** belonging to the resource group.\n3. Click **Next**\n4. Enter the **MongoDB Group ID**, a list of up to 10 **MongoDB Cluster IDs**, each on a separate line, and **MongoDB Client ID**.\n5. Choose for **Authentication Method** either **Client Secret** and copy in your client secret value or **Key Vault** and copy in the name of your key vault. \nClick **Next** \n6. Review the MongoDB filters. Select logs from at least one category. Click **Next** \n7. Review the schedule. Click **Next** \n8. Review the settings then click **Create**."
      }
    ]
  },
  {
    "id": "MorphisecCCF",
    "title": "Morphisec API Data Connector (via Codeless Connector Framework)",
    "publisher": "Morphisec",
    "descriptionMarkdown": "The [Morphisec](https://www.morphisec.com/) solution for Microsoft Sentinel enables you to seamlessly ingest security alerts directly from the Morphisec API. By leveraging Morphisec's proactive breach prevention and moving target defense capabilities, this integration enriches your security operations with high-fidelity, low-noise alerts on evasive threats.\nThis solution provides more than just data ingestion; it equips your security team with a full suite of ready-to-use content, including: Data Connector, ASIM Parser, Analytic Rule Templates and Workbook.\nWith this solution, you can empower your SOC to leverage Morphisec's powerful threat prevention within a unified investigation and response workflow in Microsoft Sentinel.",
    "graphQueries": [
      {
        "metricName": "Total Vulnerability logs received",
        "legend": "Morphisec Vulnerability Logs",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get all Morphisec alerts",
        "query": "{{graphQueriesTableName}} | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}} | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "MuleSoft",
    "title": "MuleSoft Cloudhub",
    "publisher": "MuleSoft",
    "descriptionMarkdown": "The [MuleSoft Cloudhub](https://www.mulesoft.com/platform/saas/cloudhub-ipaas-cloud-based-integration) data connector provides the capability to retrieve logs from Cloudhub applications using the Cloudhub API and more events into Microsoft Sentinel through the REST API. The connector provides ability to get events which helps to examine potential security risks, analyze your team's use of collaboration, diagnose configuration problems and more.",
    "additionalRequirementBanner": ">This data connector depends on a parser based on a Kusto Function to work as expected [**MuleSoftCloudhub**](https://aka.ms/sentinel-MuleSoftCloudhub-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "MuleSoft_Cloudhub_CL",
        "baseQuery": "MuleSoft_Cloudhub_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "MuleSoft Cloudhub Events - All Activities.",
        "query": "MuleSoft_Cloudhub_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "MuleSoft_Cloudhub_CL",
        "lastDataReceivedQuery": "MuleSoft_Cloudhub_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "MuleSoft_Cloudhub_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "**MuleSoftEnvId**, **MuleSoftAppName**, **MuleSoftUsername** and **MuleSoftPassword** are required for making API calls."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Azure Blob Storage API to pull logs into Microsoft Sentinel. This might result in additional costs for data ingestion and for storing data in Azure Blob Storage costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) and [Azure Blob Storage pricing page](https://azure.microsoft.com/pricing/details/storage/blobs/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**MuleSoftCloudhub**](https://aka.ms/sentinel-MuleSoftCloudhub-parser) which is deployed with the Microsoft Sentinel Solution."
      },
      {
        "title": "",
        "description": "**Note: This data connector fetch only the logs of the CloudHub application using Platform API and not of CloudHub 2.0 application**"
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the MuleSoft Cloudhub API**\n\n Follow the instructions to obtain the credentials.\n\n1. Obtain the  **MuleSoftEnvId**, **MuleSoftAppName**, **MuleSoftUsername** and **MuleSoftPassword** using the [documentation](https://help.mulesoft.com/s/article/How-to-get-Cloudhub-application-information-using-Anypoint-Platform-API).\n2. Save credentials for using in the data connector."
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the MuleSoft Cloudhub data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following).",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "",
        "description": "**Option 1 - Azure Resource Manager (ARM) Template**\n\nUse this method for automated deployment of the MuleSoft Cloudhub data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-MuleSoftCloudhubAPI-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n> **NOTE:** Within the same resource group, you can't mix Windows and Linux apps in the same region. Select existing resource group without Windows apps in it or create new resource group.\n3. Enter the **MuleSoftEnvId**, **MuleSoftAppName**, **MuleSoftUsername** and **MuleSoftPassword**  and deploy. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "",
        "description": "**Option 2 - Manual Deployment of Azure Functions**\n\n Use the following step-by-step instructions to deploy the MuleSoft Cloudhub data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-MuleSoftCloudhubAPI-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. MuleSoftXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.11.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select ** New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tMuleSoftEnvId\n\t\tMuleSoftAppName\n\t\tMuleSoftUsername\n\t\tMuleSoftPassword\n\t\tWorkspaceID\n\t\tWorkspaceKey\n\t\tlogAnalyticsUri (optional)\n> - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n4. Once all application settings have been entered, click **Save**."
      }
    ],
    "metadata": {
      "id": "aae8a8dc-38e4-4109-8f10-97d04587b7d9",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution"
      },
      "author": {
        "name": "Microsoft"
      },
      "support": {
        "name": "Microsoft",
        "tier": "microsoft"
      }
    }
  },
  {
    "id": "NasuniEdgeAppliance",
    "title": "[Deprecated] Nasuni Edge Appliance",
    "publisher": "Nasuni",
    "descriptionMarkdown": "The [Nasuni](https://www.nasuni.com/) connector allows you to easily connect your Nasuni Edge Appliance Notifications and file system audit logs with Microsoft Sentinel. This gives you more insight into activity within your Nasuni infrastructure and improves your security operation capabilities.",
    "additionalRequirementBanner": "None",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "Nasuni",
        "baseQuery": "Nasuni"
      }
    ],
    "sampleQueries": [
      {
        "description": "Last 1000 generated events",
        "query": "Syslog\n            | top 1000 by TimeGenerated"
      },
      {
        "description": "All events by facility except for cron",
        "query": "Syslog\n            | summarize count() by Facility | where Facility != \"cron\""
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Syslog\n   | where TimeGenerated > ago(3d)\n       |take 1\n       | project IsConnected = true"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog",
        "lastDataReceivedQuery": "Syslog\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "write permission is required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ]
    },
    "customers": [
      {
        "name": "Nasuni Edge Appliances",
        "description": "must be configured to export events via Syslog"
      }
    ],
    "instructionSteps": [
      {
        "title": "1. Install and onboard the agent for Linux",
        "description": "Typically, you should install the agent on a different computer from the one on which the logs are generated.\n\n>  Syslog logs are collected only from **Linux** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Follow the configuration steps below to configure your Linux machine to send Nasuni event information to Microsoft Sentinel. Refer to the [Azure Monitor Agent documenation](https://learn.microsoft.com/en-us/azure/azure-monitor/agents/agents-overview) for additional details on these steps.\nConfigure the facilities you want to collect and their severities.\n1. Select the link below to open your workspace agents configuration, and select the Syslog tab.\n2. Select Add facility and choose from the drop-down list of facilities. Repeat for all the facilities you want to add.\n3. Mark the check boxes for the desired severities for each facility.\n4. Click Apply.\n",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenSyslogSettings"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "3. Configure Nasuni Edge Appliance settings",
        "description": "Follow the instructions in the [Nasuni Management Console Guide](https://view.highspot.com/viewer/629a633ae5b4caaf17018daa?iid=5e6fbfcbc7143309f69fcfcf) to configure Nasuni Edge Appliances to forward syslog events. Use the IP address or hostname of the Linux device running the Azure Monitor Agent in the Servers configuration field for the syslog settings."
      }
    ]
  },
  {
    "id": "Netclean_ProActive_Incidents",
    "title": "Netclean ProActive Incidents",
    "publisher": "NetClean Technologies",
    "descriptionMarkdown": "This connector uses the Netclean Webhook (required) and Logic Apps to push data into Microsoft Sentinel Log Analytics",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Netclean_Incidents_CL",
        "baseQuery": "Netclean_Incidents_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Netclean - All Activities.",
        "query": "Netclean_Incidents_CL | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Netclean_Incidents_CL",
        "lastDataReceivedQuery": "Netclean_Incidents_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Netclean_Incidents_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** NetClean ProActive uses a Webhook to expose incident data, Azure Logic Apps is used to receive and push data to Log Analytics This might result in additional data ingestion costs.\n It's possible to test this without Logic Apps or NetClean Proactive see option 2",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "description": "1. Create a new logic app\n Use When a HTTP request is recived as the Trigger and save it. It will now have generated a URL that can be used in the ProActive webconsole configuration.\n Add an action:\n Select the Azure Log Analytics Data Collector and choose Send Data\n Enter Connection Name, Workspace ID and Workspace Key, you will find the information needed in your Log Analytics workspace under Settings-->Agents-->Log Analytics agent instructions.\n In JSON Request body add @triggerBody(). in Custom Log Name add Netclean_Incidents.",
        "title": " Option 1: Logic app"
      },
      {
        "description": "Ingest data using a api function. please use the script found on\n https://learn.microsoft.com/en-us/azure/azure-monitor/logs/data-collector-api?tabs=powershell \nReplace the CustomerId and SharedKey values with your values\nReplace the content in $json variable to the sample data found here: https://github.com/Azure/Azure-Sentinel/blob/master/Sample%20Data/Custom/Netclean_Incidents_CL.json .\nSet the LogType varible to **Netclean_Incidents_CL**\nRun the script",
        "title": " Option 2 (Testing only)"
      }
    ],
    "metadata": {
      "id": "d6a16a5e-19c0-4599-bbbc-04d6c38b00d4",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "Netclean ProActive Incidents"
      },
      "author": {
        "name": "NetClean"
      },
      "support": {
        "tier": "developer",
        "name": "NetClean support",
        "email": "Support@netclean.com",
        "link": "www.netclean.com"
      }
    }
  },
  {
    "id": "Netskope",
    "title": "Netskope",
    "publisher": "Netskope",
    "descriptionMarkdown": "The [Netskope Cloud Security Platform](https://www.netskope.com/platform) connector provides the capability to ingest Netskope logs and events into Microsoft Sentinel. The connector provides visibility into Netskope Platform Events and Alerts in Microsoft Sentinel to improve monitoring and investigation capabilities.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Netskope",
        "baseQuery": "Netskope_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Users",
        "query": "Netskope_CL\n | summarize count() by SrcUserName \n | top 10 by count_"
      },
      {
        "description": "Top 10 Alerts",
        "query": "Netskope_CL\n | where isnotempty(AlertName) \n | summarize count() by AlertName \n| top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "Netskope_CL",
        "lastDataReceivedQuery": "Netskope_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Netskope_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Netskope API Token",
          "description": "A Netskope API Token is required. [See the documentation to learn more about Netskope API](https://innovatechcloud.goskope.com/docs/Netskope_Help/en/rest-api-v1-overview.html). **Note:** A Netskope account is required"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to Netskope to pull logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias Netskope and load the function code or click [here](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Netskope/Parsers/Netskope.txt), on the second line of the query, enter the hostname(s) of your Netskope device(s) and any other unique identifiers for the logstream. The function usually takes 10-15 minutes to activate after solution installation/update."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the Netskope API**\n\n [Follow these instructions](https://docs.netskope.com/en/rest-api-v1-overview.html) provided by Netskope to obtain an API Token. **Note:** A Netskope account is required"
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Netskope connector, have the Workspace ID and Workspace Primary Key (can be copied from the following), as well as the Netskope API Authorization Token, readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "This method provides an automated deployment of the Netskope connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-netskope-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace ID**, **Workspace Key**, **API Key**, and **URI**.\n - Use the following schema for the `uri` value: `https://<Tenant Name>.goskope.com` Replace `<Tenant Name>` with your domain.\n - The default **Time Interval** is set to pull the last five (5) minutes of data. If the time interval needs to be modified, it is recommended to change the Function App Timer Trigger accordingly (in the function.json file, post deployment) to prevent overlapping data ingestion.\n - The default **Log Types** is set to pull all 6 available log types (`alert, page, application, audit, infrastructure, network`), remove any are not required. \n - Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy.\n6. After successfully deploying the connector, download the Kusto Function to normalize the data fields. [Follow the steps](https://aka.ms/sentinelgithubparsersnetskope) to use the Kusto function alias, **Netskope**."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "This method provides the step-by-step instructions to deploy the Netskope connector manually with Azure Function."
      },
      {
        "title": "",
        "description": "**1. Create a Function App**\n\n1.  From the Azure Portal, navigate to [Function App](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Web%2Fsites/kind/functionapp), and select **+ Add**.\n2. In the **Basics** tab, ensure Runtime stack is set to **Powershell Core**. \n3. In the **Hosting** tab, ensure the **Consumption (Serverless)** plan type is selected.\n4. Make other preferrable configuration changes, if needed, then click **Create**."
      },
      {
        "title": "",
        "description": "**2. Import Function App Code**\n\n1. In the newly created Function App, select **Functions** on the left pane and click **+ Add**.\n2. Select **Timer Trigger**.\n3. Enter a unique Function **Name** and modify the cron schedule, if needed. The default value is set to run the Function App every 5 minutes. (Note: the Timer trigger should match the `timeInterval` value below to prevent overlapping data), click **Create**.\n4. Click on **Code + Test** on the left pane. \n5. Copy the [Function App Code](https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Netskope/Data%20Connectors/Netskope/AzureFunctionNetskope/run.ps1) and paste into the Function App `run.ps1` editor.\n5. Click **Save**."
      },
      {
        "title": "",
        "description": "**3. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following seven (7) application settings individually, with their respective string values (case-sensitive): \n\t\tapikey\n\t\tworkspaceID\n\t\tworkspaceKey\n\t\turi\n\t\ttimeInterval\n\t\tlogTypes\n\t\tlogAnalyticsUri (optional)\n> - Enter the URI that corresponds to your region. The `uri` value must follow the following schema: `https://<Tenant Name>.goskope.com` - There is no need to add subsquent parameters to the Uri, the Function App will dynamically append the parameteres in the proper format.\n> - Set the `timeInterval` (in minutes) to the default value of `5` to correspond to the default Timer Trigger of every `5` minutes. If the time interval needs to be modified, it is recommended to change the Function App Timer Trigger accordingly to prevent overlapping data ingestion. \n> - Set the `logTypes` to `alert, page, application, audit, infrastructure, network` - This list represents all the avaliable log types. Select the log types based on logging requirements, seperating each by a single comma.\n> - Note: If using Azure Key Vault, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details. \n> - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n4. Once all application settings have been entered, click **Save**.\n5. After successfully deploying the connector, download the Kusto Function to normalize the data fields. [Follow the steps](https://aka.ms/sentinelgithubparsersnetskope) to use the Kusto function alias, **Netskope**."
      }
    ]
  },
  {
    "id": "NetskopeAlertsEvents",
    "title": "Netskope Alerts and Events",
    "publisher": "Netskope",
    "descriptionMarkdown": "Netskope Security Alerts and Events",
    "graphQueries": [
      {
        "metricName": "Total Netskope Alerts received",
        "legend": "Netskope Alerts",
        "baseQuery": "NetskopeAlerts_CL"
      },
      {
        "metricName": "Total Netskope Application Events",
        "legend": "Netskope Application Events",
        "baseQuery": "NetskopeEventsApplication_CL"
      },
      {
        "metricName": "Total Netskope Audit Events",
        "legend": "Netskope Audit Events",
        "baseQuery": "NetskopeEventsAudit_CL"
      },
      {
        "metricName": "Total Netskope Connection Events",
        "legend": "Netskope Connection Events",
        "baseQuery": "NetskopeEventsConnection_CL"
      },
      {
        "metricName": "Total Netskope DLP Events",
        "legend": "Netskope DLP Events",
        "baseQuery": "NetskopeEventsDLP_CL"
      },
      {
        "metricName": "Total Netskope Endpoint Events",
        "legend": "Netskope Endpoint Events",
        "baseQuery": "NetskopeEventsEndpoint_CL"
      },
      {
        "metricName": "Total Netskope Infrastructure Events",
        "legend": "Netskope Infrastructure Events",
        "baseQuery": "NetskopeEventsInfrastructure_CL"
      },
      {
        "metricName": "Total Netskope Network Events",
        "legend": "Netskope Network Events",
        "baseQuery": "NetskopeEventsNetwork_CL"
      },
      {
        "metricName": "Total Netskope Page Events",
        "legend": "Netskope Page Events",
        "baseQuery": "NetskopeEventsPage_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of Netskope events",
        "query": "NetskopeAlerts_CL\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "NetskopeAlerts_CL",
        "lastDataReceivedQuery": "NetskopeAlerts_CL \n | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "NetskopeEventsApplication_CL",
        "lastDataReceivedQuery": "NetskopeEventsApplication_CL \n | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "NetskopeEventsAudit_CL",
        "lastDataReceivedQuery": "NetskopeEventsAudit_CL \n | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "NetskopeEventsConnection_CL",
        "lastDataReceivedQuery": "NetskopeEventsConnection_CL \n | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "NetskopeEventsDLP_CL",
        "lastDataReceivedQuery": "NetskopeEventsDLP_CL \n | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "NetskopeEventsEndpoint_CL",
        "lastDataReceivedQuery": "NetskopeEventsEndpoint_CL \n | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "NetskopeEventsInfrastructure_CL",
        "lastDataReceivedQuery": "NetskopeEventsInfrastructure_CL \n | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "NetskopeEventsNetwork_CL",
        "lastDataReceivedQuery": "NetskopeEventsNetwork_CL \n | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "NetskopeEventsPage_CL",
        "lastDataReceivedQuery": "NetskopeEventsPage_CL \n | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "NetskopeDataConnector",
    "title": "Netskope Data Connector",
    "publisher": "Netskope",
    "descriptionMarkdown": "The [Netskope](https://docs.netskope.com/en/netskope-help/admin-console/rest-api/rest-api-v2-overview-312207/) data connector provides the following capabilities: \n 1. NetskopeToAzureStorage : \n >* Get the Netskope Alerts and Events data from Netskope and ingest to Azure storage. \n 2. StorageToSentinel : \n >* Get the Netskope Alerts and Events data from Azure storage and ingest to custom log table in log analytics workspace. \n 3. WebTxMetrics : \n >* Get the WebTxMetrics data from Netskope and ingest to custom log table in log analytics workspace.\n\n\n For more details of REST APIs refer to the below documentations: \n 1. Netskope API documentation: \n> https://docs.netskope.com/en/netskope-help/admin-console/rest-api/rest-api-v2-overview-312207/ \n 2. Azure storage documentation: \n> https://learn.microsoft.com/azure/storage/common/storage-introduction \n 3. Microsoft log analytic documentation: \n> https://learn.microsoft.com/azure/azure-monitor/logs/log-analytics-overview",
    "graphQueries": [
      {
        "metricName": "Compromised Credential data received",
        "legend": "alertscompromisedcredentialdata_CL",
        "baseQuery": "alertscompromisedcredentialdata_CL"
      },
      {
        "metricName": "CTEP data received",
        "legend": "alertsctepdata_CL",
        "baseQuery": "alertsctepdata_CL"
      },
      {
        "metricName": "DLP data received",
        "legend": "alertsdlpdata_CL",
        "baseQuery": "alertsdlpdata_CL"
      },
      {
        "metricName": "Malsite data received",
        "legend": "alertsmalsitedata_CL",
        "baseQuery": "alertsmalsitedata_CL"
      },
      {
        "metricName": "Malware data received",
        "legend": "alertsmalwaredata_CL",
        "baseQuery": "alertsmalwaredata_CL"
      },
      {
        "metricName": "Policy data received",
        "legend": "alertspolicydata_CL",
        "baseQuery": "alertspolicydata_CL"
      },
      {
        "metricName": "Quarantine data received",
        "legend": "alertsquarantinedata_CL",
        "baseQuery": "alertsquarantinedata_CL"
      },
      {
        "metricName": "Remediation data received",
        "legend": "alertsremediationdata_CL",
        "baseQuery": "alertsremediationdata_CL"
      },
      {
        "metricName": "SecurityAssessment data received",
        "legend": "alertssecurityassessmentdata_CL",
        "baseQuery": "alertssecurityassessmentdata_CL"
      },
      {
        "metricName": "UBA data received",
        "legend": "alertsubadata_CL",
        "baseQuery": "alertsubadata_CL"
      },
      {
        "metricName": "Application data received",
        "legend": "eventsapplicationdata_CL",
        "baseQuery": "eventsapplicationdata_CL"
      },
      {
        "metricName": "Audit data received",
        "legend": "eventsauditdata_CL",
        "baseQuery": "eventsauditdata_CL"
      },
      {
        "metricName": "Connection data received",
        "legend": "eventsconnectiondata_CL",
        "baseQuery": "eventsconnectiondata_CL"
      },
      {
        "metricName": "Incident data received",
        "legend": "eventsincidentdata_CL",
        "baseQuery": "eventsincidentdata_CL"
      },
      {
        "metricName": "Network data received",
        "legend": "eventsnetworkdata_CL",
        "baseQuery": "eventsnetworkdata_CL"
      },
      {
        "metricName": "Page data received",
        "legend": "eventspagedata_CL",
        "baseQuery": "eventspagedata_CL"
      },
      {
        "metricName": "WebTxMetrics data received",
        "legend": "Netskope_WebTx_metrics_CL",
        "baseQuery": "Netskope_WebTx_metrics_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Netskope CompromisedCredential Alerts Data",
        "query": "alertscompromisedcredentialdata_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Netskope CTEP Alerts Data",
        "query": "alertsctepdata_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Netskope DLP Alerts Data",
        "query": "alertsdlpdata_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Netskope Malsite Alerts Data",
        "query": "alertsmalsitedata_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Netskope Malware Alerts Data",
        "query": "alertsmalwaredata_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Netskope Policy Alerts Data",
        "query": "alertspolicydata_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Netskope Quarantine Alerts Data",
        "query": "alertsquarantinedata_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Netskope Remediation Alerts Data",
        "query": "alertsremediationdata_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Netskope SecurityAssessment Alerts Data",
        "query": "alertssecurityassessmentdata_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Netskope Uba Alerts Data",
        "query": "alertsubadata_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Netskope Application Events Data.",
        "query": "eventsapplicationdata_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Netskope Audit Events Data",
        "query": "eventsauditdata_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Netskope Connection Events Data",
        "query": "eventsconnectiondata_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Netskope Incident Events Data",
        "query": "eventsincidentdata_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Netskope Network Events Data",
        "query": "eventsnetworkdata_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Netskope Page Events Data",
        "query": "eventspagedata_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Netskope WebTransactions Metrics Data",
        "query": "Netskope_WebTx_metrics_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "alertscompromisedcredentialdata_CL",
        "lastDataReceivedQuery": "alertscompromisedcredentialdata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "alertsctepdata_CL",
        "lastDataReceivedQuery": "alertsctepdata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "alertsdlpdata_CL",
        "lastDataReceivedQuery": "alertsdlpdata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "alertsmalsitedata_CL",
        "lastDataReceivedQuery": "alertsmalsitedata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "alertsmalwaredata_CL",
        "lastDataReceivedQuery": "alertsmalwaredata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "alertspolicydata_CL",
        "lastDataReceivedQuery": "alertspolicydata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "alertsquarantinedata_CL",
        "lastDataReceivedQuery": "alertsquarantinedata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "alertsremediationdata_CL",
        "lastDataReceivedQuery": "alertsremediationdata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "alertssecurityassessmentdata_CL",
        "lastDataReceivedQuery": "alertssecurityassessmentdata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "alertsubadata_CL",
        "lastDataReceivedQuery": "alertsubadata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "eventsapplicationdata_CL",
        "lastDataReceivedQuery": "eventsapplicationdata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "eventsauditdata_CL",
        "lastDataReceivedQuery": "eventsauditdata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "eventsconnectiondata_CL",
        "lastDataReceivedQuery": "eventsconnectiondata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "eventsincidentdata_CL",
        "lastDataReceivedQuery": "eventsincidentdata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "eventsnetworkdata_CL",
        "lastDataReceivedQuery": "eventsnetworkdata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "eventspagedata_CL",
        "lastDataReceivedQuery": "eventspagedata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Netskope_WebTx_metrics_CL",
        "lastDataReceivedQuery": "Netskope_WebTx_metrics_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "alertscompromisedcredentialdata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "alertsctepdata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "alertsdlpdata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "alertsmalsitedata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "alertsmalwaredata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "alertspolicydata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "alertsquarantinedata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "alertsremediationdata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "alertssecurityassessmentdata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "alertsubadata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "eventsapplicationdata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "eventsauditdata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "eventsconnectiondata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "eventsincidentdata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "eventsnetworkdata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "eventspagedata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Netskope_WebTx_metrics_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Azure Subscription",
          "description": "Azure Subscription with owner role is required to register an application in azure active directory() and assign role of contributor to app in resource group."
        },
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "**Netskope Tenant** and **Netskope API Token** is required.  See the documentation to learn more about API on the [Rest API reference](https://docs.netskope.com/en/netskope-help/admin-console/rest-api/rest-api-v2-overview-312207/)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Netskope APIs to pull its Alerts and Events data into custom log table. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1 - App Registration steps for the Application in Microsoft Entra ID**\n\n This integration requires an App registration in the Azure portal. Follow the steps in this section to create a new application in Microsoft Entra ID:\n 1. Sign in to the [Azure portal](https://portal.azure.com/).\n 2. Search for and select **Microsoft Entra ID**.\n 3. Under **Manage**, select **App registrations > New registration**.\n 4. Enter a display **Name** for your application.\n 5. Select **Register** to complete the initial app registration.\n 6. When registration finishes, the Azure portal displays the app registration's Overview pane. You see the **Application (client) ID** and **Tenant ID**. The client ID and Tenant ID is required as configuration parameters for the execution of the TriggersSync playbook. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app)"
      },
      {
        "title": "",
        "description": "**STEP 2 - Add a client secret for application in Microsoft Entra ID**\n\n Sometimes called an application password, a client secret is a string value required for the execution of TriggersSync playbook. Follow the steps in this section to create a new Client Secret:\n 1. In the Azure portal, in **App registrations**, select your application.\n 2. Select **Certificates & secrets > Client secrets > New client secret**.\n 3. Add a description for your client secret.\n 4. Select an expiration for the secret or specify a custom lifetime. Limit is 24 months.\n 5. Select **Add**. \n 6. *Record the secret's value for use in your client application code. This secret value is never displayed again after you leave this page.* The secret value is required as configuration parameter for the execution of TriggersSync playbook. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret)"
      },
      {
        "title": "",
        "description": "**STEP 3 - Assign role of Contributor to application in Microsoft Entra ID**\n\n Follow the steps in this section to assign the role:\n 1. In the Azure portal, Go to **Resource Group** and select your resource group.\n 2. Go to **Access control (IAM)** from left panel.\n 3. Click on **Add**, and then select **Add role assignment**.\n 4. Select **Contributor** as role and click on next.\n 5. In **Assign access to**, select `User, group, or service principal`.\n 6. Click on **add members** and type **your app name** that you have created and select it.\n 7. Now click on **Review + assign** and then again click on **Review + assign**. \n\n> **Reference link:** [https://learn.microsoft.com/azure/role-based-access-control/role-assignments-portal](https://learn.microsoft.com/azure/role-based-access-control/role-assignments-portal)"
      },
      {
        "title": "",
        "description": "**STEP 4 - Steps to create/get Credentials for the Netskope account** \n\n Follow the steps in this section to create/get **Netskope Hostname** and **Netskope API Token**:\n 1. Login to your **Netskope Tenant** and go to the **Settings menu** on the left navigation bar.\n 2. Click on Tools and then **REST API v2**\n 3. Now, click on the new token button. Then it will ask for token name, expiration duration and the endpoints that you want to fetch data from.\n 5. Once that is done click the save button, the token will be generated. Copy the token and save at a secure place for further usage."
      },
      {
        "title": "",
        "description": "**STEP 5 - Steps to create the azure functions for Netskope Alerts and Events Data Collection**\n\n>**IMPORTANT:** Before deploying Netskope data connector, have the  Workspace ID and Workspace Primary Key (can be copied from the following) readily available.., as well as the Netskope API Authorization Key(s).",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "description": "Using the ARM template deploy the function apps for ingestion of Netskope events and alerts data to Sentinel.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-NetskopeV2-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the below information : \n\t\tNetskope HostName \n\t\tNetskope API Token \n\t\tSelect Yes in Alerts and Events types dropdown for that endpoint you want to fetch Alerts and Events \n\t\tLog Level \n\t\tWorkspace ID \n\t\tWorkspace Key \n4. Click on **Review+Create**. \n5. Then after validation click on **Create** to deploy."
      }
    ]
  },
  {
    "id": "NetskopeWebTransactionsDataConnector",
    "title": "Netskope Web Transactions Data Connector",
    "publisher": "Netskope",
    "descriptionMarkdown": "The [Netskope Web Transactions](https://docs.netskope.com/en/netskope-help/data-security/transaction-events/netskope-transaction-events/) data connector provides the functionality of a docker image to pull the Netskope Web Transactions data from google pubsublite, process the data and ingest the processed data to Log Analytics. As part of this data connector two tables will be formed in Log Analytics, one for Web Transactions data and other for errors encountered during execution.\n\n\n For more details related to Web Transactions refer to the below documentation: \n 1. Netskope Web Transactions documentation: \n> https://docs.netskope.com/en/netskope-help/data-security/transaction-events/netskope-transaction-events/ \n",
    "graphQueries": [
      {
        "metricName": "Web Transactions data received",
        "legend": "NetskopeWebtxData_CL",
        "baseQuery": "NetskopeWebtxData_CL"
      },
      {
        "metricName": "Web Transactions Data Connector Errors",
        "legend": "NetskopeWebtxErrors_CL",
        "baseQuery": "NetskopeWebtxErrors_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Netskope Web Transactions Data",
        "query": "NetskopeWebtxData_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Netskope Web Transactions Data Connector Errors",
        "query": "NetskopeWebtxErrors_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "NetskopeWebtxData_CL",
        "lastDataReceivedQuery": "NetskopeWebtxData_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "NetskopeWebtxErrors_CL",
        "lastDataReceivedQuery": "NetskopeWebtxErrors_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "NetskopeWebtxData_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "NetskopeWebtxErrors_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Azure Subscription",
          "description": "Azure Subscription with owner role is required to register an application in Microsoft Entra ID and assign role of contributor to app in resource group."
        },
        {
          "name": "Microsoft.Compute permissions",
          "description": "Read and write permissions to Azure VMs is required. [See the documentation to learn more about Azure VMs](https://learn.microsoft.com/azure/virtual-machines/overview)."
        },
        {
          "name": "TransactionEvents Credentials and Permissions",
          "description": "**Netskope Tenant** and **Netskope API Token** is required. [See the documentation to learn more about Transaction Events.](https://docs.netskope.com/en/netskope-help/data-security/transaction-events/netskope-transaction-events/)"
        },
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector provides the functionality of ingesting Netskope Web Transactions data using a docker image to be deployed on a virtual machine (Either Azure VM/On Premise VM). Check the [Azure VM pricing page](https://azure.microsoft.com/pricing/details/virtual-machines/linux) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1 - Steps to create/get Credentials for the Netskope account** \n\n Follow the steps in this section to create/get **Netskope Hostname** and **Netskope API Token**:\n 1. Login to your **Netskope Tenant** and go to the **Settings menu** on the left navigation bar.\n 2. Click on Tools and then **REST API v2**\n 3. Now, click on the new token button. Then it will ask for token name, expiration duration and the endpoints that you want to fetch data from.\n 5. Once that is done click the save button, the token will be generated. Copy the token and save at a secure place for further usage."
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose one from the following two deployment options to deploy the docker based data connector to ingest Netskope Web Transactions data **\n\n>**IMPORTANT:** Before deploying Netskope data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following) readily available, as well as the Netskope API Authorization Key(s) [Make sure the token has permissions for transaction events].",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Using Azure Resource Manager (ARM) Template to deploy VM [Recommended]",
        "description": "Using the ARM template deploy an Azure VM, install the prerequisites and start execution.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-NetskopeV2WebTransactions-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the below information : \n\t\tDocker Image Name (mgulledge/netskope-microsoft-sentinel-plugin:netskopewebtransactions)\n\t\tNetskope HostName \n\t\tNetskope API Token \n\t\tSeek Timestamp (The epoch timestamp that you want to seek the pubsublite pointer, can be left empty) \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tBackoff Retry Count (The retry count for token related errors before restarting the execution.)  \n\t\tBackoff Sleep Time (Number of seconds to sleep before retrying) \n\t\tIdle Timeout (Number of seconds to wait for Web Transactions Data before restarting execution) \n\t\tVM Name \n\t\tAuthentication Type \n\t\tAdmin Password or Key \n\t\tDNS Label Prefix \n\t\tUbuntu OS Version \n\t\tLocation \n\t\tVM Size \n\t\tSubnet Name \n\t\tNetwork Security Group Name \n\t\tSecurity Type \n4. Click on **Review+Create**. \n5. Then after validation click on **Create** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment on previously created virtual machine",
        "description": "Use the following step-by-step instructions to deploy the docker based data connector manually on a previously created virtual machine."
      },
      {
        "title": "",
        "description": "**1. Install docker and pull docker Image**\n\n>**NOTE:** Make sure that the VM is linux based (preferably Ubuntu).\n\n1. Firstly you will need to [SSH into the virtual machine](https://learn.microsoft.com/azure/virtual-machines/linux-vm-connect?tabs=Linux).\n2. Now install [docker engine](https://docs.docker.com/engine/install/).\n3. Now pull the docker image from docker hub using the command: 'sudo docker pull mgulledge/netskope-microsoft-sentinel-plugin:netskopewebtransactions'.\n4. Now to run the docker image use the command: 'sudo docker run -it -v $(pwd)/docker_persistent_volume:/app mgulledge/netskope-microsoft-sentinel-plugin:netskopewebtransactions'. You can replace mgulledge/netskope-microsoft-sentinel-plugin:netskopewebtransactions with the image id. Here docker_persistent_volume is the name of the folder that would be created on the vm in which the files will get stored."
      },
      {
        "title": "",
        "description": "**2. Configure the Parameters**\n\n1. Once the docker image is running it will ask for the required parameters.\n2. Add each of the following application settings individually, with their respective values (case-sensitive): \n\t\tNetskope HostName \n\t\tNetskope API Token \n\t\tSeek Timestamp (The epoch timestamp that you want to seek the pubsublite pointer, can be left empty) \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tBackoff Retry Count (The retry count for token related errors before restarting the execution.)  \n\t\tBackoff Sleep Time (Number of seconds to sleep before retrying) \n\t\tIdle Timeout (Number of seconds to wait for Web Transactions Data before restarting execution)\n3. Now the execution has started but is in interactive mode, so that shell cannot be stopped. To run it as a background process, stop the current execution by pressing Ctrl+C and then use the command: 'sudo docker run -d -v $(pwd)/docker_persistent_volume:/app mgulledge/netskope-microsoft-sentinel-plugin:netskopewebtransactions'."
      },
      {
        "title": "",
        "description": "**3. Stop the docker container**\n\n1. Use the command 'sudo docker container ps' to list the running docker containers. Note down your container id.\n2. Now stop the container using the command: 'sudo docker stop *<*container-id*>*'."
      }
    ]
  },
  {
    "id": "Netwrix",
    "title": "[Deprecated] Netwrix Auditor via Legacy Agent",
    "publisher": "Netwrix",
    "descriptionMarkdown": "Netwrix Auditor data connector provides the capability to ingest [Netwrix Auditor (formerly Stealthbits Privileged Activity Manager)](https://www.netwrix.com/auditor.html) events into Microsoft Sentinel. Refer to [Netwrix documentation](https://helpcenter.netwrix.com/) for more information.",
    "additionalRequirementBanner": "This data connector depends on a parser based on Kusto Function to work as expected. Follow the steps to use this Kusto Function alias **NetwrixAuditor** in queries and workbooks. [Follow steps to get this Kusto Function>](https://aka.ms/sentinel-netwrixauditor-parser)",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "NetwrixAuditor",
        "baseQuery": "NetwrixAuditor"
      }
    ],
    "sampleQueries": [
      {
        "description": "Netwrix Auditor Events - All Activities.",
        "query": "NetwrixAuditor\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog",
        "lastDataReceivedQuery": "NetwrixAuditor\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "NetwrixAuditor\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on NetwrixAuditor parser based on a Kusto Function to work as expected. This parser is installed along with solution installation.",
        "instructions": []
      },
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2.  Configure Netwrix Auditor to send logs using CEF",
        "description": "[Follow the instructions](https://www.netwrix.com/download/QuickStart/Netwrix_Auditor_Add-on_for_HPE_ArcSight_Quick_Start_Guide.pdf) to configure event export from Netwrix Auditor."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "Unique Identifier (GUID) used to identify dependencies and content from solutions or community.",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Microsoft"
      },
      "support": {
        "tier": "community",
        "name": "Microsoft",
        "link": "https://github.com/Azure/Azure-Sentinel/issues"
      }
    }
  },
  {
    "id": "NetwrixAma",
    "title": "[Deprecated] Netwrix Auditor via AMA",
    "publisher": "Netwrix",
    "descriptionMarkdown": "Netwrix Auditor data connector provides the capability to ingest [Netwrix Auditor (formerly Stealthbits Privileged Activity Manager)](https://www.netwrix.com/auditor.html) events into Microsoft Sentinel. Refer to [Netwrix documentation](https://helpcenter.netwrix.com/) for more information.",
    "additionalRequirementBanner": "This data connector depends on a parser based on Kusto Function to work as expected. Follow the steps to use this Kusto Function alias **NetwrixAuditor** in queries and workbooks. [Follow steps to get this Kusto Function>](https://aka.ms/sentinel-netwrixauditor-parser)",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "NetwrixAuditor",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Netwrix'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "Netwrix Auditor Events - All Activities.",
        "query": "NetwrixAuditor\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Netwrix'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'Netwrix'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on NetwrixAuditor parser based on a Kusto Function to work as expected. This parser is installed along with solution installation.",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine",
                  "instructions": []
                },
                {
                  "title": "Step B. Configure Netwrix Auditor to send logs using CEF",
                  "description": "[Follow the instructions](https://www.netwrix.com/download/QuickStart/Netwrix_Auditor_Add-on_for_HPE_ArcSight_Quick_Start_Guide.pdf) to configure event export from Netwrix Auditor.",
                  "instructions": []
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "Unique Identifier (GUID) used to identify dependencies and content from solutions or community.",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Microsoft"
      },
      "support": {
        "tier": "community",
        "name": "Microsoft",
        "link": "https://github.com/Azure/Azure-Sentinel/issues"
      }
    }
  },
  {
    "id": "NGINXHTTPServer",
    "title": "[Deprecated] NGINX HTTP Server",
    "publisher": "Nginx",
    "descriptionMarkdown": "The NGINX HTTP Server data connector provides the capability to ingest [NGINX](https://nginx.org/en/) HTTP Server events into Microsoft Sentinel. Refer to [NGINX Logs documentation](https://nginx.org/en/docs/http/ngx_http_log_module.html) for more information.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "NGINX_CL",
        "baseQuery": "NGINXHTTPServer"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Clients (Source IP)",
        "query": "NGINXHTTPServer\n | summarize count() by SrcIpAddr\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "NGINX_CL",
        "lastDataReceivedQuery": "NGINXHTTPServer\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "NGINXHTTPServer\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias NGINXHTTPServer and load the function code or click [here](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/NGINX%20HTTP%20Server/Parsers/NGINXHTTPServer.txt).The function usually takes 10-15 minutes to activate after solution installation/update.",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux or Windows",
        "description": "Install the agent on the NGINX HTTP Server where the logs are generated.\n\n> Logs from NGINX HTTP Server deployed on Linux or Windows servers are collected by **Linux** or **Windows** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Linux agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Windows agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Windows Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Windows Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Configure the custom log directory to be collected",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenCustomLogsSettings"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "",
        "description": "1. Select the link above to open your workspace advanced settings \n2. From the left pane, select **Data**, select **Custom Logs** and click **Add+**\n3. Click **Browse** to upload a sample of a NGINX HTTP Server log file (e.g. access.log or error.log). Then, click **Next >**\n4. Select **New line** as the record delimiter and click **Next >**\n5. Select **Windows** or **Linux** and enter the path to NGINX HTTP logs based on your configuration. Example: \n - **Linux** Directory:  '/var/log/nginx/*.log' \n6. After entering the path, click the '+' symbol to apply, then click **Next >** \n7. Add **NGINX_CL** as the custom log Name and click **Done**"
      }
    ]
  },
  {
    "id": "NonameSecurityMicrosoftSentinel",
    "title": "Noname Security for Microsoft Sentinel",
    "publisher": "Noname Security",
    "descriptionMarkdown": "Noname Security solution to POST data into a Microsoft Sentinel SIEM workspace via the Azure Monitor REST API",
    "graphQueries": [
      {
        "metricName": "Noname API Security Alert",
        "legend": "NonameAPISecurityAlert_CL",
        "baseQuery": "NonameAPISecurityAlert_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Noname API Security Alerts",
        "query": "NonameAPISecurityAlert_CL\n| where TimeGenerated >= ago(1d)\n"
      }
    ],
    "dataTypes": [
      {
        "name": "NonameAPISecurityAlert_CL",
        "lastDataReceivedQuery": "NonameAPISecurityAlert_CL\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "NonameAPISecurityAlert_CL\n| summarize LastAlertReceived = max(TimeGenerated)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Configure the Noname Sentinel integration.",
        "description": "Configure the Sentinel workflow in the Noname integrations settings.  Find documentation at https://docs.nonamesecurity.com",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ],
    "metadata": {
      "id": "f66a9bee-323d-4280-8c3b-e95bc66db83a",
      "version": "2.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution"
      },
      "author": {
        "name": "Noname Security"
      },
      "support": {
        "tier": "community",
        "name": "Noname Security",
        "email": "support@nonamesecurity.com",
        "link": "https://nonamesecurity.com/"
      }
    }
  },
  {
    "id": "NordPass",
    "title": "NordPass",
    "publisher": "NordPass",
    "descriptionMarkdown": "Integrating NordPass with Microsoft Sentinel SIEM via the API will allow you to automatically transfer Activity Log data from NordPass to Microsoft Sentinel and get real-time insights, such as item activity, all login attempts, and security notifications.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "NordPass",
        "baseQuery": "NordPassEventLogs_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Users",
        "query": "NordPassEventLogs_CL\n | summarize count() by user_email \n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "NordPassEventLogs_CL",
        "lastDataReceivedQuery": "NordPassEventLogs_CL\n | summarize Time = max(TimeGenerated)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "NordPassEventLogs_CL\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "description": "Ensure that the [resource group](https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/manage-resource-groups-portal#create-resource-groups) and the [Log Analytics workspace](https://learn.microsoft.com/en-us/azure/azure-monitor/logs/quick-create-workspace?tabs=azure-portal) are created and located in the same region so you can deploy the Azure Functions."
        },
        {
          "description": "[Add Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/quickstart-onboard#enable-microsoft-sentinel-) to the created Log Analytics workspace."
        },
        {
          "description": "Generate a [Microsoft Sentinel API URL and token](https://www.google.com/url?q=https://support.nordpass.com/hc/en-us/articles/31972037289873&sa=D&source=docs&ust=1743770997230005&usg=AOvVaw16p0hstJ6OeBBoFdBKZRfr) in the NordPass Admin Panel to finish the Azure Functions integration. Please note that youll need the NordPass Enterprise account for that."
        },
        {
          "description": "**Important:** This connector uses Azure Functions to retrieve Activity Logs from NordPass into Microsoft Sentinel. This may result in additional data ingestion costs. For more information, refer to the Azure Functions pricing page."
        }
      ]
    },
    "instructionSteps": [
      {
        "description": "To proceed with the Microsoft Sentinel setup\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-Nordpass-azuredeploy)\n2. **Please note that after the successful deployment, the system pulls Activity Log data every 1 minute by default.**"
      }
    ]
  },
  {
    "id": "NozomiNetworksN2OS",
    "title": "[Deprecated] Nozomi Networks N2OS via Legacy Agent",
    "publisher": "Nozomi Networks",
    "descriptionMarkdown": "The [Nozomi Networks](https://www.nozominetworks.com/) data connector provides the capability to ingest Nozomi Networks Events into Microsoft Sentinel. Refer to the Nozomi Networks [PDF documentation](https://www.nozominetworks.com/resources/data-sheets-brochures-learning-guides/) for more information.",
    "additionalRequirementBanner": "This data connector depends on a parser based on Kusto Function to work as expected [**NozomiNetworksEvents**](https://aka.ms/sentinel-NozomiNetworks-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Nozomi Networks",
        "baseQuery": "NozomiNetworksEvents"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Devices",
        "query": "NozomiNetworksEvents\n | summarize count() by DvcHostname\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (NozomiNetworks)",
        "lastDataReceivedQuery": "NozomiNetworksEvents\n | summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "NozomiNetworksEvents\n | summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**NozomiNetworksEvents**](https://aka.ms/sentinel-NozomiNetworks-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Common Event Format (CEF) logs to Syslog agent",
        "description": "Follow these steps to configure Nozomi Networks device for sending Alerts, Audit Logs, Health Logs log via syslog in CEF format:\n\n> 1. Log in to the Guardian console.\n\n> 2. Navigate to Administration->Data Integration, press +Add and select the Common Event Format (CEF) from the drop down\n\n> 3. Create New Endpoint using the appropriate host information and enable Alerts, Audit Logs, Health Logs for sending."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "9e55a64f-7db4-406a-9fdd-dc27b03e0231",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "NozomiNetworks"
      },
      "author": {
        "name": "Microsoft"
      },
      "support": {
        "name": "Microsoft",
        "tier": "microsoft"
      }
    }
  },
  {
    "id": "NozomiNetworksN2OSAma",
    "title": "[Deprecated] Nozomi Networks N2OS via AMA",
    "publisher": "Nozomi Networks",
    "descriptionMarkdown": "The [Nozomi Networks](https://www.nozominetworks.com/) data connector provides the capability to ingest Nozomi Networks Events into Microsoft Sentinel. Refer to the Nozomi Networks [PDF documentation](https://www.nozominetworks.com/resources/data-sheets-brochures-learning-guides/) for more information.",
    "additionalRequirementBanner": "This data connector depends on a parser based on Kusto Function to work as expected [**NozomiNetworksEvents**](https://aka.ms/sentinel-NozomiNetworks-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Nozomi Networks",
        "baseQuery": "CommonSecurityLog\n |where  DeviceVendor has 'Nozomi'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Devices",
        "query": "NozomiNetworksEvents\n | summarize count() by DvcHostname\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (NozomiNetworks)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor has 'Nozomi'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor has 'Nozomi'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**NozomiNetworksEvents**](https://aka.ms/sentinel-NozomiNetworks-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine",
                  "instructions": []
                },
                {
                  "title": "Step B. Forward Common Event Format (CEF) logs to Syslog agent",
                  "description": "Follow these steps to configure Nozomi Networks device for sending Alerts, Audit Logs, Health Logs log via syslog in CEF format:\n\n> 1. Log in to the Guardian console.\n\n> 2. Navigate to Administration->Data Integration, press +Add and select the Common Event Format (CEF) from the drop down\n\n> 3. Create New Endpoint using the appropriate host information and enable Alerts, Audit Logs, Health Logs for sending.",
                  "instructions": []
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "9e55a64f-7db4-406a-9fdd-dc27b03e0231",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "NozomiNetworks"
      },
      "author": {
        "name": "Microsoft"
      },
      "support": {
        "name": "Microsoft",
        "tier": "microsoft"
      }
    }
  },
  {
    "id": "NucleusCyberNCProtect",
    "title": "NC Protect",
    "publisher": "archTIS",
    "descriptionMarkdown": "[NC Protect Data Connector (archtis.com)](https://info.archtis.com/get-started-with-nc-protect-sentinel-data-connector) provides the capability to ingest user activity logs and events into Microsoft Sentinel. The connector provides visibility into NC Protect user activity logs and events in Microsoft Sentinel to improve monitoring and investigation capabilities",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "NCProtectUAL_CL",
        "baseQuery": "NCProtectUAL_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get last 7 days records",
        "query": "\nNCProtectUAL_CL\n | where TimeGenerated > ago(7d)\n | order by TimeGenerated desc"
      },
      {
        "description": "Login failed consecutively for more than 3 times in an hour by user",
        "query": "\nNCProtectUAL_CL\n | where TimeGenerated > ago(1h) and Type_s == 'LoginFailure'\n | summarize FailedRequestCount = count() by bin(TimeGenerated, 1h), UserDisplayName_s, UserEmail_s, UserLoginName_s, Type_s, JSONExtra_s\n | where  FailedRequestCount > 3"
      },
      {
        "description": "Download failed consecutively for more than 3 times in an hour by user",
        "query": "\nNCProtectUAL_CL\n | where TimeGenerated > ago(1h) and Type_s == 'Open' and Status_s == 'Fail'\n | summarize FailedRequestCount = count() by bin(TimeGenerated, 1h), UserDisplayName_s, UserEmail_s, UserLoginName_s, Type_s, JSONExtra_s, DocumentUrl_s\n | where  FailedRequestCount > 3"
      },
      {
        "description": "Get logs for rule created or modified or deleted records in last 7 days",
        "query": "\nNCProtectUAL_CL\n | where TimeGenerated > ago(7d) and (Type_s == 'Create' or Type_s == 'Modify' or Type_s == 'Delete') and isnotempty(RuleName_s)\n | order by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "NCProtectUAL_CL",
        "lastDataReceivedQuery": "\nNCProtectUAL_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "\nNCProtectUAL_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "NC Protect",
          "description": "You must have a running instance of NC Protect for O365. Please [contact us](https://www.archtis.com/data-discovery-classification-protection-software-secure-collaboration/)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "1. Install NC Protect into your Azure Tenancy\n2. Log into the NC Protect Administration site\n3. From the left hand navigation menu, select General -> User Activity Monitoring\n4. Tick the checkbox to Enable SIEM and click the Configure button\n5. Select Microsoft Sentinel as the Application and complete the configuration using the information below\n6. Click Save to activate the connection\n",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ],
    "metadata": {
      "id": "3161ee3b-2ddd-4902-aeff-5e297b98bc00",
      "version": "8.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "archTIS"
      },
      "support": {
        "name": "archTIS",
        "link": "https://www.archtis.com/nc-protect-support/",
        "tier": "developer"
      }
    }
  },
  {
    "id": "NXLogAixAudit",
    "title": "NXLog AIX Audit",
    "publisher": "NXLog",
    "descriptionMarkdown": "The [NXLog AIX Audit](https://docs.nxlog.co/refman/current/im/aixaudit.html) data connector uses the AIX Audit subsystem to read events directly from the kernel for capturing audit events on the AIX platform. This REST API connector can efficiently export AIX Audit events to Microsoft Sentinel in real time.",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected [**NXLog_parsed_AIX_Audit_view**](https://aka.ms/sentinel-nxlogaixaudit-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "NXLog_parsed_AIX_Audit_view",
        "baseQuery": "NXLog_parsed_AIX_Audit_view"
      }
    ],
    "sampleQueries": [
      {
        "description": "AIX Audit event type distribution",
        "query": "NXLog_parsed_AIX_Audit_view\n| summarize count() by EventType\n| render piechart title=\"AIX Audit event type distributon\""
      },
      {
        "description": "Highest event per second (EPS) AIX Audit event types",
        "query": "NXLog_parsed_AIX_Audit_view\n| where EventEndTime >  todatetime('2021-09-09')\n| summarize EPS=count() by bin(EventEndTime, 1s), EventType\n| sort by EPS, EventType, EventEndTime\n| take 5\n| render columnchart title=\"Highest event per second (EPS) event types\""
      },
      {
        "description": "Time chart of AIX Audit events per day",
        "query": "NXLog_parsed_AIX_Audit_view\n| where EventEndTime >= todatetime('2021-09-06')\n| where EventEndTime <  todatetime('2021-09-10')\n| summarize Count=count() by bin(EventEndTime, 1d)\n| render timechart title=\"AIX Audit events per day\""
      },
      {
        "description": "Time chart of AIX Audit events per hour",
        "query": "NXLog_parsed_AIX_Audit_view\n| where EventEndTime >= todatetime('2021-09-07')\n| where EventEndTime <  todatetime('2021-09-08')\n| summarize Count=count() by bin(EventEndTime, 1h)\n| render timechart title=\"AIX Audit events per hour\""
      },
      {
        "description": "AIX Audit events per second (EPS) time chart",
        "query": "NXLog_parsed_AIX_Audit_view\n| where EventEndTime >= todatetime('2021-09-07 18:29')\n| where EventEndTime <  todatetime('2021-09-07 23:55')\n| summarize EPS=count() by bin(EventEndTime, 1s)\n| render timechart title=\"AIX Audit events per second (EPS)\""
      }
    ],
    "dataTypes": [
      {
        "name": "AIX_Audit_CL",
        "lastDataReceivedQuery": "NXLog_parsed_AIX_Audit_view            | summarize Time = max(TimeGenerated)            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "NXLog_parsed_AIX_Audit_view | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**NXLog_parsed_AIX_Audit_view**](https://aka.ms/sentinel-nxlogaixaudit-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "",
        "description": "Follow the step-by-step instructions in the *NXLog User Guide* Integration Guide [Microsoft Sentinel](https://docs.nxlog.co/userguide/integrate/microsoft-azure-sentinel.html) to configure this connector.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ]
  },
  {
    "id": "NXLogBSMmacOS",
    "title": "NXLog BSM macOS",
    "publisher": "NXLog",
    "descriptionMarkdown": "The [NXLog BSM](https://docs.nxlog.co/refman/current/im/bsm.html) macOS data connector uses Sun's Basic Security Module (BSM) Auditing API to read events directly from the kernel for capturing audit events on the macOS platform. This REST API connector can efficiently export macOS audit events to Microsoft Sentinel in real-time.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "BSMmacOS_CL",
        "baseQuery": "BSMmacOS_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Most frequent event types",
        "query": "BSMmacOS_CL\n| summarize EventCount = count() by EventType_s\n| where strlen(EventType_s) > 1\n| project Eventype = EventType_s, EventCount\n| order by EventCount desc\n| render barchart"
      },
      {
        "description": "Most frequent event names",
        "query": "BSMmacOS_CL\n| summarize EventCount = count() by EventName_s\n| project EventCount, EventName = EventName_s\n| where strlen(EventName) > 1\n| order by EventCount desc\n| render barchart"
      },
      {
        "description": "Distribution of (notification) texts",
        "query": "BSMmacOS_CL\n| summarize EventCount = count() by Text_s\n| where strlen(Text_s) > 1\n| order by EventCount\n| render piechart"
      }
    ],
    "dataTypes": [
      {
        "name": "BSMmacOS_CL",
        "lastDataReceivedQuery": "BSMmacOS_CL            | summarize Time = max(TimeGenerated)            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "BSMmacOS_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "Follow the step-by-step instructions in the *NXLog User Guide* Integration Topic [Microsoft Sentinel](https://docs.nxlog.co/userguide/integrate/microsoft-azure-sentinel.html) to configure this connector.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ]
  },
  {
    "id": "NXLogDNSLogs",
    "title": "NXLog DNS Logs",
    "publisher": "NXLog",
    "descriptionMarkdown": "The NXLog DNS Logs data connector uses Event Tracing for Windows ([ETW](https://docs.microsoft.com/windows/apps/trace-processing/overview)) for collecting both Audit and Analytical DNS Server events. The [NXLog *im_etw* module](https://docs.nxlog.co/refman/current/im/etw.html) reads event tracing data directly for maximum efficiency, without the need to capture the event trace into an .etl file. This REST API connector can forward DNS Server events to Microsoft Sentinel in real time.",
    "additionalRequirementBanner": "This data connector depends on parsers based on Kusto functions deployed with the Microsoft Sentinel Solution to work as expected. The [**ASimDnsMicrosoftNXLog **](https://aka.ms/sentinel-nxlogdnslogs-parser) is designed to leverage Microsoft Sentinel's built-in DNS-related analytics capabilities.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ASimDnsMicrosoftNXLog ",
        "baseQuery": "ASimDnsMicrosoftNXLog "
      }
    ],
    "sampleQueries": [
      {
        "description": "DNS Server top 5 hostlookups",
        "query": "ASimDnsMicrosoftNXLog \n| summarize count() by Domain\n| take 5\n| render piechart title='Top 5 host lookups'"
      },
      {
        "description": "DNS Server Top 5 EventOriginalTypes (Event IDs)",
        "query": "ASimDnsMicrosoftNXLog \n| extend EventID=strcat('Event ID ',trim_end('.0',tostring(EventOriginalType)))\n| summarize CountByEventID=count() by EventID\n| sort by CountByEventID\n| take 5\n| render piechart title='Top 5 EventOriginalTypes (Event IDs)'"
      },
      {
        "description": "DNS Server analytical events per second (EPS)",
        "query": "ASimDnsMicrosoftNXLog \n| where EventEndTime >= todatetime('2021-09-17 03:07')\n| where EventEndTime <  todatetime('2021-09-18 03:14')\n| summarize EPS=count() by bin(EventEndTime, 1s)\n| render timechart title='DNS analytical events per second (EPS) - All event types'"
      }
    ],
    "dataTypes": [
      {
        "name": "NXLog_DNS_Server_CL",
        "lastDataReceivedQuery": "ASimDnsMicrosoftNXLog             | summarize Time = max(TimeGenerated)            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "NXLog_DNS_Server_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on parsers based on Kusto functions deployed with the Microsoft Sentinel Solution to work as expected. The [**ASimDnsMicrosoftNXLog **](https://aka.ms/sentinel-nxlogdnslogs-parser) is designed to leverage Microsoft Sentinel's built-in DNS-related analytics capabilities.",
        "instructions": []
      },
      {
        "title": "",
        "description": "Follow the step-by-step instructions in the *NXLog User Guide* Integration Topic [Microsoft Sentinel](https://docs.nxlog.co/userguide/integrate/microsoft-azure-sentinel.html) to configure this connector.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ]
  },
  {
    "id": "NXLogFIM",
    "title": "NXLog FIM",
    "publisher": "NXLog",
    "descriptionMarkdown": "The [NXLog FIM](https://docs.nxlog.co/refman/current/im/fim.html) module allows for the scanning of files and directories, reporting detected additions, changes, renames and deletions on the designated paths through calculated checksums during successive scans. This REST API connector can efficiently export the configured FIM events to Microsoft Sentinel in real time.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "NXLogFIM_CL",
        "baseQuery": "NXLogFIM_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Find all DELETE events",
        "query": "NXLogFIM_CL\n| where EventType_s == 'DELETE'\n| project-away\n   Type\n| sort by EventTime_t"
      },
      {
        "description": "Bar Chart for Events per type, per host",
        "query": "NXLogFIM_CL\n| summarize EventCount = count() by Hostname_s, EventType_s\n| where strlen(EventType_s) > 1\n| project Eventype = Hostname_s, EventType_s, EventCount\n| order by EventCount desc\n| render barchart"
      },
      {
        "description": "Pie Chart for visualization of events per host",
        "query": "NXLogFIM_CL\n| summarize EventCount = count() by Hostname_s, EventType_s\n| sort by EventCount\n| render piechart"
      },
      {
        "description": "General Summary of Events per Host",
        "query": "NXLogFIM_CL\n| summarize count() by Hostname_s, EventType_s"
      }
    ],
    "dataTypes": [
      {
        "name": "NXLogFIM_CL",
        "lastDataReceivedQuery": "NXLogFIM_CL | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "NXLogFIM_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "Follow the step-by-step instructions in the [Microsoft Sentinel](https://docs.nxlog.co/userguide/integrate/microsoft-azure-sentinel.html) integration chapter of the *NXLog User Guide* to configure this connector.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ]
  },
  {
    "id": "NXLogLinuxAudit",
    "title": "NXLog LinuxAudit",
    "publisher": "NXLog",
    "descriptionMarkdown": "The [NXLog LinuxAudit](https://docs.nxlog.co/refman/current/im/linuxaudit.html) data connector supports custom audit rules and collects logs without auditd or any other user-space software. IP addresses and group/user IDs are resolved to their respective names making [Linux audit](https://docs.nxlog.co/userguide/integrate/linux-audit.html) logs more intelligible to security analysts. This REST API connector can efficiently export Linux security events to Microsoft Sentinel in real-time.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "LinuxAudit_CL",
        "baseQuery": "LinuxAudit_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Most frequent type",
        "query": "LinuxAudit_CL\n| summarize EventCount = count() by type_s \n| where strlen(type_s) > 1 \n| render barchart"
      },
      {
        "description": "Most frequent comm",
        "query": "LinuxAudit_CL\n| summarize EventCount = count() by comm_s\n| where strlen(comm_s) > 1\n| render barchart"
      },
      {
        "description": "Most frequent name",
        "query": "LinuxAudit_CL\n| summarize EventCount = count() by name_s\n| where strlen(name_s) > 1\n| render barchart"
      }
    ],
    "dataTypes": [
      {
        "name": "LinuxAudit_CL",
        "lastDataReceivedQuery": "LinuxAudit_CL            | summarize Time = max(TimeGenerated)            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "LinuxAudit_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "Follow the step-by-step instructions in the *NXLog User Guide* Integration Topic [Microsoft Sentinel](https://docs.nxlog.co/userguide/integrate/microsoft-azure-sentinel.html) to configure this connector.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ],
    "metadata": {
      "id": "3969d734-ab64-44fe-ac9b-73d758e0e814",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "NXLog"
      },
      "support": {
        "name": "NXLog",
        "tier": "Partner",
        "link": "https://nxlog.co/support-tickets/add/support-ticket"
      }
    }
  },
  {
    "id": "ObsidianDatasharing",
    "title": "Obsidian Datasharing Connector",
    "publisher": "Obsidian Security",
    "descriptionMarkdown": "The Obsidian Datasharing connector provides the capability to read raw event data from Obsidian Datasharing in Microsoft Sentinel.",
    "graphQueries": [
      {
        "metricName": "Activity",
        "legend": "ObsidianActivity_CL",
        "baseQuery": "ObsidianActivity_CL"
      },
      {
        "metricName": "Threat",
        "legend": "ObsidianThreat_CL",
        "baseQuery": "ObsidianThreat_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Obsidian - All Threats",
        "query": "ObsidianThreat_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Obsidian - All Activity events",
        "query": "ObsidianActivity_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "ObsidianActivity_CL",
        "lastDataReceivedQuery": "ObsidianActivity_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ObsidianThreat_CL",
        "lastDataReceivedQuery": "ObsidianThreat_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1
    },
    "metadata": null
  },
  {
    "id": "OCI-Connector-CCP-Definition",
    "title": "Oracle Cloud Infrastructure (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The Oracle Cloud Infrastructure (OCI) data connector provides the capability to ingest OCI Logs from [OCI Stream](https://docs.oracle.com/iaas/Content/Streaming/Concepts/streamingoverview.htm) into Microsoft Sentinel using the [OCI Streaming REST API](https://docs.oracle.com/iaas/api/#/streaming/streaming/20180418).",
    "graphQueries": [
      {
        "metricName": "OCI Events",
        "legend": "OCI Data Connector Event Logs",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "All OCI Events",
        "query": "{{graphQueriesTableName}} \n| sort by TimeGenerated desc"
      },
      {
        "description": "Get Sample of OCI Events",
        "query": "{{graphQueriesTableName}} \n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}} \n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": null,
    "metadata": null
  },
  {
    "id": "Office365",
    "title": "Microsoft 365 (formerly, Office 365)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The Microsoft 365 (formerly, Office 365) activity log connector provides insight into ongoing user activities. You will get details of operations such as file downloads, access requests sent, changes to group events, set-mailbox and details of the user who performed the actions. By connecting Microsoft 365 logs into Microsoft Sentinel you can use this data to view dashboards, create custom alerts, and improve your investigation process. For more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2219943&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "logo": "Office365Logo.svg",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "SharePoint",
        "baseQuery": "OfficeActivity\n| where OfficeWorkload == \"SharePoint\" or OfficeWorkload == \"OneDrive\""
      },
      {
        "metricName": "Total data received",
        "legend": "Exchange",
        "baseQuery": "OfficeActivity\n| where OfficeWorkload == \"Exchange\""
      },
      {
        "metricName": "Total data received",
        "legend": "Teams",
        "baseQuery": "OfficeActivity\n| where OfficeWorkload == \"MicrosoftTeams\""
      }
    ],
    "sampleQueries": [
      {
        "description": "SharePoint and OneDrive logs",
        "query": "OfficeActivity\n| where OfficeWorkload == \"SharePoint\" or OfficeWorkload == \"OneDrive\"\n            | sort by TimeGenerated"
      },
      {
        "description": "Exchange logs",
        "query": "OfficeActivity\n| where OfficeWorkload == \"Exchange\"\n            | sort by TimeGenerated"
      },
      {
        "description": "Teams logs",
        "query": "OfficeActivity\n| where OfficeWorkload == \"MicrosoftTeams\"\n            | sort by TimeGenerated"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "SentinelKinds",
        "value": [
          "Office365"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "OfficeActivity (SharePoint)",
        "lastDataReceivedQuery": "OfficeActivity\n| where OfficeWorkload == \"SharePoint\" or OfficeWorkload == \"OneDrive\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "OfficeActivity (Exchange)",
        "lastDataReceivedQuery": "OfficeActivity\n| where OfficeWorkload == \"Exchange\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "OfficeActivity (Teams)",
        "lastDataReceivedQuery": "OfficeActivity\n| where OfficeWorkload == \"MicrosoftTeams\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 2,
      "isPreview": false,
      "featureFlag": {
        "feature": "Office365Connector",
        "featureStates": {
          "1": 3,
          "2": 3,
          "3": 3,
          "4": 3,
          "5": 2,
          "6": 2,
          "7": 2,
          "8": 2
        }
      }
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        }
      ],
      "tenant": [
        "GlobalAdmin",
        "SecurityAdmin"
      ]
    },
    "instructionSteps": [
      {
        "title": "Connect Office 365 activity logs to your Microsoft Sentinel.",
        "description": "Select the record types you want to collect from your tenant and click **Apply Changes**.",
        "instructions": [
          {
            "type": "OfficeDataTypes",
            "parameters": {
              "connectorKind": "Office365",
              "dataTypes": [
                {
                  "title": "Exchange",
                  "name": "exchange"
                },
                {
                  "title": "SharePoint",
                  "name": "sharePoint"
                },
                {
                  "title": "Teams",
                  "name": "teams"
                }
              ]
            }
          }
        ]
      },
      {
        "title": "2. Previously connected tenants",
        "description": "Microsoft Sentinel now enables Office 365 single-tenant connection. You can modify your previously connected tenants and click **Save**.",
        "instructions": [
          {
            "type": "Office365"
          }
        ]
      }
    ],
    "metadata": {
      "id": "b568ccbf-376d-411c-82ca-729d4b3f2973",
      "version": "2.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Microsoft"
      },
      "support": {
        "tier": "community",
        "name": "Microsoft",
        "link": "https://github.com/Azure/Azure-Sentinel/issues"
      }
    }
  },
  {
    "id": "Office365Project",
    "title": "Microsoft Project",
    "publisher": "Microsoft",
    "logo": "Project.svg",
    "descriptionMarkdown": "Microsoft Project (MSP) is a project management software solution. Depending on your plan, Microsoft Project lets you plan projects, assign tasks, manage resources, create reports and more. This connector allows you to stream your Azure Project audit logs into Microsoft Sentinel in order to track your project activities.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Microsoft Project",
        "baseQuery": "ProjectActivity"
      }
    ],
    "sampleQueries": [
      {
        "description": "Office Project Logs",
        "query": "ProjectActivity\n            | sort by TimeGenerated"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "SentinelKinds",
        "value": [
          "Office365Project"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "ProjectActivity",
        "lastDataReceivedQuery": "ProjectActivity\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        }
      ],
      "tenant": [
        "GlobalAdmin",
        "SecurityAdmin"
      ],
      "customs": [
        {
          "name": "License",
          "description": "\"Microsoft Project eligible license is required.\""
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Connect Microsoft Project audit logs to Microsoft Sentinel",
        "description": "This connector uses the Office Management API to get your Project audit logs. The logs will be stored and processed in your existing Microsoft Sentinel workspace. You can find the data in the **ProjectActivity** table.",
        "instructions": [
          {
            "parameters": {
              "connectorKind": "Office365Project",
              "title": "Microsoft Project",
              "enable": true
            },
            "type": "SentinelResourceProvider"
          }
        ]
      }
    ]
  },
  {
    "id": "OfficeATP",
    "title": "Microsoft Defender for Office 365 (Preview)",
    "publisher": "Microsoft",
    "logo": "Office365Logo.svg",
    "descriptionMarkdown": "Microsoft Defender for Office 365 safeguards your organization against malicious threats posed by email messages, links (URLs) and collaboration tools. By ingesting Microsoft Defender for Office 365 alerts into Microsoft Sentinel, you can incorporate information about email- and URL-based threats into your broader risk analysis and build response scenarios accordingly.\n \nThe following types of alerts will be imported:\n\n-   A potentially malicious URL click was detected \n-   Email messages containing malware removed after delivery\n-   Email messages containing phish URLs removed after delivery\n-   Email reported by user as malware or phish \n-   Suspicious email sending patterns detected \n-   User restricted from sending email \n\nThese alerts can be seen by Office customers in the ** Office Security and Compliance Center**.\n\nFor more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2219942&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "SecurityAlert (Office 365 Advanced Threat Protection)",
        "baseQuery": "SecurityAlert\n| where ProviderName == \"OATP\""
      }
    ],
    "sampleQueries": [
      {
        "description": "Security Alert Logs",
        "query": "SecurityAlert\n| where ProviderName == \"OATP\"\n            | sort by TimeGenerated"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "MtpAlerts",
        "value": [
          "OfficeATP"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "SecurityAlert(OATP)",
        "lastDataReceivedQuery": "SecurityAlert\n| where ProviderName == \"OATP\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 2,
      "featureFlag": {
        "feature": "OfficeATPConnector",
        "featureStates": {
          "1": 2,
          "2": 2,
          "3": 2,
          "4": 2,
          "5": 2
        }
      }
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        }
      ],
      "tenant": [
        "GlobalAdmin",
        "SecurityAdmin"
      ],
      "licenses": [
        "OfficeATP"
      ]
    },
    "instructionSteps": [
      {
        "title": "Connect Microsoft Defender for Office 365 alerts to Microsoft Sentinel",
        "description": "Connecting Microsoft Defender for Office 365 will cause your data that is collected by Microsoft Defender for Office 365 service to be stored and processed in the location that you have configured your Microsoft Sentinel workspace.",
        "instructions": [
          {
            "parameters": {
              "connectorKind": "OfficeATP",
              "title": "Microsoft Defender for Office 365",
              "enable": true
            },
            "type": "SentinelResourceProvider"
          }
        ]
      }
    ],
    "caseGenerationSteps": [
      {
        "instructions": [
          {
            "parameters": {
              "filterProduct": "Office 365 Advanced Threat Protection"
            },
            "type": "FilterAlert"
          }
        ]
      }
    ]
  },
  {
    "id": "OfficeIRM",
    "title": "Microsoft 365 Insider Risk Management",
    "publisher": "Microsoft",
    "logo": {
      "type": 258,
      "options": null
    },
    "descriptionMarkdown": "Microsoft 365 Insider Risk Management is a compliance solution in Microsoft 365 that helps minimize internal risks by enabling you to detect, investigate, and act on malicious and inadvertent activities in your organization. Risk analysts in your organization can quickly take appropriate actions to make sure users are compliant with your organization's compliance standards.\n\nInsider risk policies allow you to:\n\n-   define the types of risks you want to identify and detect in your organization.\n-   decide on what actions to take in response, including escalating cases to Microsoft Advanced eDiscovery if needed.\n\nThis solution produces alerts that can be seen by Office customers in the Insider Risk Management solution in Microsoft 365 Compliance Center.\n[Learn More](https://aka.ms/OfficeIRMConnector) about Insider Risk Management.\n\nThese alerts can be imported into Microsoft Sentinel with this connector, allowing you to see, investigate, and respond to them in a broader organizational threat context. For more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2223721&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "SecurityAlert (Microsoft 365 Insider Risk Management)",
        "baseQuery": "SecurityAlert\n    | where ProductName == \"Microsoft 365 Insider Risk Management\"\n        | extend alertWasCustomized = bag_has_key(todynamic(ExtendedProperties), \"OriginalProductName\")\n        | where alertWasCustomized == false"
      }
    ],
    "sampleQueries": [
      {
        "description": "Security Alert Logs",
        "query": "SecurityAlert\n    | where ProductName == \"Microsoft 365 Insider Risk Management\"\n        | extend alertWasCustomized = bag_has_key(todynamic(ExtendedProperties), \"OriginalProductName\")\n        | where alertWasCustomized == false\n        | extend alertWasCustomized = bag_has_key(todynamic(ExtendedProperties), \"OriginalProductName\")\n        | where alertWasCustomized == false\n            | sort by TimeGenerated"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "MtpAlerts",
        "value": [
          "OfficeIRM"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "SecurityAlert (OfficeIRM)",
        "lastDataReceivedQuery": "SecurityAlert\n    | where ProductName == \"Microsoft 365 Insider Risk Management\"\n        | extend alertWasCustomized = bag_has_key(todynamic(ExtendedProperties), \"OriginalProductName\")\n        | where alertWasCustomized == false\n        | extend alertWasCustomized = bag_has_key(todynamic(ExtendedProperties), \"OriginalProductName\")\n        | where alertWasCustomized == false\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 2,
      "featureFlag": {
        "feature": "OfficeIRMConnector",
        "featureStates": {
          "1": 2,
          "2": 2,
          "3": 2,
          "4": 2,
          "5": 2
        }
      },
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        }
      ],
      "tenant": [
        "GlobalAdmin",
        "SecurityAdmin"
      ],
      "licenses": [
        "OfficeIRM"
      ],
      "customs": [
        {
          "description": "Enable export of Insider Risk Management alerts to the Office 365 Management Activity API to receive alerts through the connector. [Learn More](https://aka.ms/OfficeIRMRequirement)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Connect Microsoft 365 Insider Risk Management alerts to Microsoft Sentinel",
        "description": "Connecting Microsoft 365 Insider Risk Management will cause your data that is collected by Microsoft 365 Insider Risk Management service to be stored and processed in the location that you have configured your Microsoft Sentinel workspace.",
        "instructions": [
          {
            "parameters": {
              "connectorKind": "OfficeIRM",
              "title": "Microsoft 365 Insider Risk Management",
              "enable": true
            },
            "type": "SentinelResourceProvider"
          }
        ]
      }
    ],
    "caseGenerationSteps": [
      {
        "instructions": [
          {
            "parameters": {
              "filterProduct": "Microsoft 365 Insider Risk Management"
            },
            "type": "FilterAlert"
          }
        ]
      }
    ]
  },
  {
    "id": "OfficePowerBI",
    "title": "Microsoft PowerBI",
    "publisher": "Microsoft",
    "logo": "PowerBILogo.svg",
    "descriptionMarkdown": "Microsoft PowerBI is a collection of software services, apps, and connectors that work together to turn your unrelated sources of data into coherent, visually immersive, and interactive insights. Your data may be an Excel spreadsheet, a collection of cloud-based and on-premises hybrid data warehouses, or a data store of some other type. This connector lets you stream PowerBI audit logs into Microsoft Sentinel, allowing you to track user activities in your PowerBI environment. You can filter the audit data by date range, user, dashboard, report, dataset, and activity type.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Microsoft PowerBI",
        "baseQuery": "PowerBIActivity"
      }
    ],
    "sampleQueries": [
      {
        "description": "Office PowerBI Logs",
        "query": "PowerBIActivity\n            | sort by TimeGenerated"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "SentinelKinds",
        "value": [
          "OfficePowerBI"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "PowerBIActivity",
        "lastDataReceivedQuery": "PowerBIActivity\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        }
      ],
      "tenant": [
        "GlobalAdmin",
        "SecurityAdmin"
      ],
      "customs": [
        {
          "name": "License",
          "description": "Microsoft Power BI eligible license is required."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Connect Microsoft PowerBI audit logs to Microsoft Sentinel",
        "description": "This connector uses the Office Management API to get your PowerBI audit logs. The logs will be stored and processed in your existing Microsoft Sentinel workspace. You can find the data in the **PowerBIActivity** table.",
        "instructions": [
          {
            "parameters": {
              "connectorKind": "OfficePowerBI",
              "title": "Microsoft PowerBI",
              "enable": true
            },
            "type": "SentinelResourceProvider"
          }
        ]
      }
    ]
  },
  {
    "id": "OktaSSO",
    "title": "Okta Single Sign-On",
    "publisher": "Okta",
    "descriptionMarkdown": "The [Okta Single Sign-On (SSO)](https://www.okta.com/products/single-sign-on/) connector provides the capability to ingest audit and event logs from the Okta API into Microsoft Sentinel. The connector provides visibility into these log types in Microsoft Sentinel to view dashboards, create custom alerts, and to improve monitoring and investigation capabilities.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Okta Logs",
        "baseQuery": "Okta_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Active Applications",
        "query": "Okta_CL \n| mv-expand todynamic(target_s)  \n| where target_s.type == \"AppInstance\"  \n| summarize count() by tostring(target_s.alternateId)  \n| top 10 by count_"
      },
      {
        "description": "Top 10 Client IP Addresses",
        "query": "Okta_CL \n| summarize count() by client_ipAddress_s \n| top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "Okta_CL",
        "lastDataReceivedQuery": "Okta_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Okta_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Okta API Token",
          "description": "An Okta API Token is required. See the documentation to learn more about the [Okta System Log API](https://developer.okta.com/docs/reference/api/system-log/)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to Okta SSO to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**NOTE:** This connector has been updated, if you have previously deployed an earlier version, and want to update, please delete the existing Okta Azure Function before redeploying this version."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the Okta SSO API**\n\n [Follow these instructions](https://developer.okta.com/docs/guides/create-an-api-token/create-the-token/) to create an API Token."
      },
      {
        "title": "",
        "description": "**Note** - For more information on the rate limit restrictions enforced by Okta, please refer to the **[documentation](https://developer.okta.com/docs/reference/rl-global-mgmt/)**."
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Okta SSO connector, have the Workspace ID and Workspace Primary Key (can be copied from the following), as well as the Okta SSO API Authorization Token, readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Option 1 - Azure Resource Manager (ARM) Template",
                  "description": "This method provides an automated deployment of the Okta SSO connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentineloktaazuredeployv2-solution)  [![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://aka.ms/sentineloktaazuredeployv2-solution-gov)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace ID**, **Workspace Key**, **API Token** and **URI**. \n - Use the following schema for the `uri` value: `https://<OktaDomain>/api/v1/logs?since=` Replace `<OktaDomain>` with your domain. [Click here](https://developer.okta.com/docs/reference/api-overview/#url-namespace) for further details on how to identify your Okta domain namespace. There is no need to add a time value to the URI, the Function App will dynamically append the inital start time of logs to UTC 0:00 for the current UTC date as time value to the URI in the proper format. \n - Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
                },
                {
                  "title": "Option 2 - Manual Deployment of Azure Functions",
                  "description": "Use the following step-by-step instructions to deploy the Okta SSO connector manually with Azure Functions (Deployment via Visual Studio Code).",
                  "instructions": [
                    {
                      "parameters": {
                        "instructionSteps": [
                          {
                            "title": "Step 1 - Deploy a Function App",
                            "description": "1. Download the [Azure Function App](https://aka.ms/sentineloktaazurefunctioncodev2) file. Extract archive to your local development computer.\n2. Follow the [function app manual deployment instructions](https://github.com/Azure/Azure-Sentinel/blob/master/DataConnectors/AzureFunctionsManualDeployment.md#function-app-manual-deployment-instructions) to deploy the Azure Functions app using VSCode.\n3. After successful deployment of the function app, follow next steps for configuring it."
                          },
                          {
                            "title": "Step 2 - Configure the Function App",
                            "description": "1. Go to Azure Portal for the Function App configuration.\n2. In the Function App, select the Function App Name and select **Configuration**.\n3. In the **Application settings** tab, select **+ New application setting**.\n4. Add each of the following five (5) application settings individually, with their respective string values (case-sensitive): \n\t\tapiToken\n\t\tworkspaceID\n\t\tworkspaceKey\n\t\turi\n\t\tlogAnalyticsUri (optional)\n - Use the following schema for the `uri` value: `https://<OktaDomain>/api/v1/logs?since=` Replace `<OktaDomain>` with your domain. [Click here](https://developer.okta.com/docs/reference/api-overview/#url-namespace) for further details on how to identify your Okta domain namespace. There is no need to add a time value to the URI, the Function App will dynamically append the inital start time of logs to UTC 0:00 for the current UTC date as time value to the URI in the proper format.\n - Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details.\n - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: https://<CustomerId>.ods.opinsights.azure.us. \n5. Once all application settings have been entered, click **Save**."
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "OktaSSOv2",
    "title": "Okta Single Sign-On",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The [Okta Single Sign-On (SSO)](https://www.okta.com/products/single-sign-on/) data connector provides the capability to ingest audit and event logs from the Okta Sysem Log API into Microsoft Sentinel. The data connector is built on Microsoft Sentinel Codeless Connector Platform and uses the Okta System Log API to fetch the events. The connector supports DCR-based [ingestion time transformations](https://docs.microsoft.com/azure/azure-monitor/logs/custom-logs-overview) that parses the received security event data into a custom columns so that queries don't need to parse it again, thus resulting in better performance.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Okta SSO Events",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of Okta SSO Events",
        "query": "{{graphQueriesTableName}}\n | take 10"
      },
      {
        "description": "Total Events by uuid",
        "query": "{{graphQueriesTableName}}\n | summarize count() by OriginalEventUid"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}|summarize Time = max  (TimeGenerated)\n|where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "Onapsis",
    "title": "Onapsis Defend Integration",
    "publisher": "Onapsis Platform",
    "logo": "Onapsis.svg",
    "descriptionMarkdown": "Onapsis Defend Integration is aimed at forwarding alerts and logs collected and detected by Onapsis Platform into Microsoft Sentinel SIEM",
    "graphQueriesTableName": "Onapsis_Defend_CL",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "Onapsis_SID",
        "baseQuery": "{{graphQueriesTableName}} | project TimeGenerated, Onapsis_SID= sid"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample Events",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | where TimeGenerated > ago(12h) | where name_s == \"no data test\" | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriteria": [
      {
        "type": "HasDataConnectors"
      }
    ],
    "availability": {
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "Read and Write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "Read permissions to shared keys for the workspace are required.",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft Entra",
          "description": "Permission to create an app registration in Microsoft Entra ID. Typically requires Entra ID Application Developer role or higher."
        },
        {
          "name": "Microsoft Azure",
          "description": "Permission to assign Monitoring Metrics Publisher role on data collection rules. Typically requires Azure RBAC Owner or User Access Administrator role."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Create ARM Resources and Provide the Required Permissions",
        "description": "We will create data collection rule (DCR) and data collection endpoint (DCE) resources. We will also create a Microsoft Entra app registration and assign the required permissions to it.",
        "instructions": [
          {
            "type": "Markdown",
            "parameters": {
              "content": "#### Automated deployment of Azure resources\nClicking on \"Deploy push connector resources\" will trigger the creation of DCR and DCE resources.\nIt will then create a Microsoft Entra app registration with client secret and grant permissions on the DCR. This setup enables data to be sent securely to the DCR using a OAuth v2 client credentials."
            }
          },
          {
            "parameters": {
              "label": "Deploy push connector resources",
              "applicationDisplayName": "Onapsis Defend Integration push to Microsoft Sentinel"
            },
            "type": "DeployPushConnectorButton_test"
          }
        ]
      },
      {
        "title": "2. Maintain the data collection endpoint details and authentication info in Onapsis Defend Integration",
        "description": "Share the data collection endpoint URL and authentication info with the Onapsis Defend Integration administrator to configure the Onapsis Defend Integration to send data to the data collection endpoint.",
        "instructions": [
          {
            "parameters": {
              "label": "Use this value to configure as Tenant ID in the LogIngestionAPI credential.",
              "fillWith": [
                "TenantId"
              ]
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "label": "Entra Application ID",
              "fillWith": [
                "ApplicationId"
              ],
              "placeholder": "Deploy push connector to get the Application ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "label": "Entra Application Secret",
              "fillWith": [
                "ApplicationSecret"
              ],
              "placeholder": "Deploy push connector to get the Application Secret"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "label": "Use this value to configure the LogsIngestionURL parameter when deploying the IFlow.",
              "fillWith": [
                "DataCollectionEndpoint"
              ],
              "placeholder": "Deploy push connector to get the DCE URI"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "label": "DCR Immutable ID",
              "fillWith": [
                "DataCollectionRuleId"
              ],
              "placeholder": "Deploy push connector to get the DCR ID"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ],
    "metadata": {
      "id": "Onapsis",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "Onapsis Defend Integration for Microsoft Sentinel"
      },
      "author": {
        "name": "Onapsis Platform",
        "email": "support@onapsis.com"
      },
      "support": {
        "tier": "Partner",
        "name": "Onapsis Platform",
        "email": "support@onapsis.com",
        "link": "https://onapsis.com/support/"
      }
    }
  },
  {
    "id": "Onapsis",
    "title": "Onapsis Defend: Integrate Unmatched SAP Threat Detection & Intel with Microsoft Sentinel",
    "publisher": "Onapsis SE",
    "descriptionMarkdown": "Empower security teams with deep visibility into unique exploit, zero-day, and threat actor activity; suspicious user or insider behavior; sensitive data downloads; security control violations; and more - all enriched by the SAP experts at Onapsis.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "Onapsis_SID",
        "baseQuery": "{{graphQueriesTableName}} | project TimeGenerated, Onapsis_SID= sid"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample Events",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | where TimeGenerated > ago(12h) | where name_s == \"no data test\" | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "isPreview": true
    },
    "metadata": null
  },
  {
    "id": "OnapsisPlatform",
    "title": "[Deprecated] Onapsis Platform",
    "publisher": "Onapsis",
    "descriptionMarkdown": "The Onapsis Connector allows you to export the alarms triggered in the Onapsis Platform into Microsoft Sentinel in real-time. This gives you the ability to monitor the activity on your SAP systems, identify incidents and respond to them quickly.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "OnapsisAlarms",
        "baseQuery": "CommonSecurityLog\n| where DeviceVendor == \"Onapsis\"\n| where DeviceProduct == \"OSP\""
      }
    ],
    "sampleQueries": [
      {
        "description": "Total Alarms by Asset",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"Onapsis\"\n| summarize count() by DeviceCustomString1 | take 10"
      },
      {
        "description": "List of Incidents occurring in SAP Systems",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"Onapsis\"\n| parse kind = regex AdditionalExtensions with \"sev=\" Criticality\n| summarize Count = count() by Message, Criticality | order by Criticality, Count\n| project Incident_Name=Message, Criticality, Count"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (OnapsisAlarms)",
        "lastDataReceivedQuery": "CommonSecurityLog\n| where DeviceVendor == \"Onapsis\"\n| where DeviceProduct == \"OSP\"\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n| where DeviceVendor == \"Onapsis\"\n| where DeviceProduct == \"OSP\"\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your Onapsis Console and Microsoft Sentinel. This machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Common Event Format (CEF) logs to Syslog agent",
        "description": "Refer to the Onapsis in-product help to set up log forwarding to the Syslog agent.\n\n> 1. Go to Setup > Third-party integrations > Defend Alarms and follow the instructions for Microsoft Sentinel.\n\n> 2. Make sure your Onapsis Console can reach the proxy machine where the agent is installed - logs should be sent to port 514 using TCP."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Create Onapsis lookup function for incident enrichment",
        "description": "[Follow these steps to get this Kusto function](https://aka.ms/sentinel-Onapsis-parser)"
      },
      {
        "title": "5. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "81ae314e-2c7c-40d0-87fe-812ffda0b60c",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Onapsis"
      },
      "support": {
        "name": "Onapsis",
        "link": "https://onapsis.force.com/s/login/",
        "tier": "developer"
      }
    }
  },
  {
    "id": "OneIdentity",
    "title": "One Identity Safeguard",
    "publisher": "One Identity LLC.",
    "logo": "OneIdentityCloud.svg",
    "descriptionMarkdown": "The One Identity Safeguard (CEF) Sentinel data connector enhances the standard Common Event Format (CEF) connector with Safeguard for Privileged Sessions-specific dashboards. Use this connector to easily start utilizing the events generated by your device for visualization, alerts, investigations and more.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "One Identity LLC.",
        "baseQuery": "\nCommonSecurityLog\n| whereDeviceVendor == \"OneIdentity\"andDeviceProduct == \"SPS\"\n"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs of the last 24 hours",
        "query": "\nCommonSecurityLog\n| whereDeviceVendor == \"OneIdentity\"andDeviceProduct == \"SPS\"\n\n            | whereTimeGenerated > ago(1d) \n                | sortbyTimeGenerated desc"
      },
      {
        "description": "Safeguard for Privileged Sessions session count of the last 24 hours",
        "query": "\nCommonSecurityLog\n| whereDeviceVendor == \"OneIdentity\"andDeviceProduct == \"SPS\"\n\n            | whereTimeGenerated > ago(1d) \n                | whereDeviceCustomString1Label == \"Session ID\"\n                | summarizeany(*) byDeviceCustomString1\n                | count"
      },
      {
        "description": "Safeguard for Privileged Sessions session count by verdict (ACCEPT/DENY/AUTH_FAIL)",
        "query": "\nCommonSecurityLog\n| whereDeviceVendor == \"OneIdentity\"andDeviceProduct == \"SPS\"\n\n            | whereTimeGenerated > ago(1d)\n            | whereActivity == \"SessionClosed\"\n            | summarizecount() byDeviceCustomString2"
      },
      {
        "description": "Safeguard for Privileged Sessions session count by severity (if analytics is enabled)",
        "query": "\nCommonSecurityLog\n| whereDeviceVendor == \"OneIdentity\"andDeviceProduct == \"SPS\"\n\n            | whereTimeGenerated > ago(1d)\n            | whereDeviceCustomString1Label == \"Session ID\"\n            | summarizemax(LogSeverity) byDeviceCustomString1\n            | summarizecount() bymax_LogSeverity"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "\nCommonSecurityLog\n| whereDeviceVendor == \"OneIdentity\"andDeviceProduct == \"SPS\"\n\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (OneIdentity)",
        "lastDataReceivedQuery": "\nCommonSecurityLog\n| whereDeviceVendor == \"OneIdentity\"andDeviceProduct == \"SPS\"\n\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python --version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward One Identity SafeGuard logs to Syslog agent",
        "description": "Follow the [instructions in the Safeguard for Privileged Sessions Administration Guide](https://aka.ms/sentinel-cef-oneidentity-forwarding) in section \"Universal SIEM Forwarder\". Make sure to select the format \"CEF\".\n\nNote that by default there is no TLS security set up in the syslog on the Linux machine."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python --version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "28fbac9c-1909-49bb-b5f3-c42250422414",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "One Identity"
      },
      "support": {
        "name": "One Identity",
        "link": "https://support.oneidentity.com/",
        "tier": "developer"
      }
    }
  },
  {
    "id": "OneLogin",
    "title": "[DEPRECATED] OneLogin IAM Platform",
    "publisher": "OneLogin",
    "descriptionMarkdown": "The [OneLogin](https://www.onelogin.com/) data connector provides the capability to ingest common OneLogin IAM Platform events into Microsoft Sentinel through Webhooks. The OneLogin Event Webhook API which is also known as the Event Broadcaster will send batches of events in near real-time to an endpoint that you specify. When a change occurs in the OneLogin, an HTTPS POST request with event information is sent to a callback data connector URL.  Refer to [Webhooks documentation](https://developers.onelogin.com/api-docs/1/events/webhooks) for more information. The connector provides ability to get events which helps to examine potential security risks, analyze your team's use of collaboration, diagnose configuration problems and more.\n\n<p><span style='color:red; font-weight:bold;'>NOTE</span>: This data connector has been deprecated, consider moving to the CCF data connector available in the solution which replaces ingestion via the <a href='https://learn.microsoft.com/en-us/azure/azure-monitor/logs/custom-logs-migrate' style='color:#1890F1;'>deprecated HTTP Data Collector API</a>.</p>",
    "additionalRequirementBanner": ">This data connector depends on a parser based on a Kusto Function to work as expected [**OneLogin**](https://aka.ms/sentinel-OneLogin-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "OneLogin_CL",
        "baseQuery": "OneLogin_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "OneLogin Events - All Activities.",
        "query": "OneLogin\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "OneLogin_CL",
        "lastDataReceivedQuery": "OneLogin_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "OneLogin_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Webhooks Credentials/permissions",
          "description": "**OneLoginBearerToken**, **Callback URL** are required for working Webhooks. See the documentation to learn more about [configuring Webhooks](https://onelogin.service-now.com/kb_view_customer.do?sysparm_article=KB0010469).You need to generate **OneLoginBearerToken** according to your security requirements and use it in **Custom Headers** section in format: Authorization: Bearer **OneLoginBearerToken**. Logs Format: JSON Array."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector uses Azure Functions based on HTTP Trigger for waiting POST requests with logs to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**OneLogin**](https://aka.ms/sentinel-OneLogin-parser) which is deployed with the Microsoft Sentinel Solution."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the OneLogin**\n\n Follow the [instructions](https://onelogin.service-now.com/kb_view_customer.do?sysparm_article=KB0010469) to configure Webhooks.\n\n1. Generate the **OneLoginBearerToken** according to your password policy.\n2. Set Custom Header in the format: Authorization: Bearer <OneLoginBearerToken>.\n3. Use JSON Array Logs Format."
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the OneLogin data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following).",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Option 1 - Azure Resource Manager (ARM) Template",
                  "description": "Use this method for automated deployment of the OneLogin data connector using an ARM Template.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-OneLogin-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n> **NOTE:** Within the same resource group, you can't mix Windows and Linux apps in the same region. Select existing resource group without Windows apps in it or create new resource group.\n3. Enter the **OneLoginBearerToken** and deploy. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy.\n6. After deploying open Function App page, select your app, go to the **Functions** and click **Get Function Url** copy it and follow p.7 from STEP 1."
                },
                {
                  "title": "Option 2 - Manual Deployment of Azure Functions",
                  "description": "Use the following step-by-step instructions to deploy the OneLogin data connector manually with Azure Functions (Deployment via Visual Studio Code).",
                  "instructions": [
                    {
                      "parameters": {
                        "instructionSteps": [
                          {
                            "title": "Step 1 - Deploy a Function App",
                            "description": "**NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-OneLogin-functionapp) file. Extract archive to your local development computer.\n2. Follow the [function app manual deployment instructions](https://github.com/Azure/Azure-Sentinel/blob/master/DataConnectors/AzureFunctionsManualDeployment.md#function-app-manual-deployment-instructions) to deploy the Azure Functions app using VSCode.\n3. After successful deployment of the function app, follow next steps for configuring it."
                          },
                          {
                            "title": "Step 2 - Configure the Function App",
                            "description": "1. Go to Azure Portal for the Function App configuration.\n2. In the Function App, select the Function App Name and select **Configuration**.\n3. In the **Application settings** tab, select ** New application setting**.\n4. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tOneLoginBearerToken\n\t\tWorkspaceID\n\t\tWorkspaceKey\n\t\tlogAnalyticsUri (optional)\n> - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n5. Once all application settings have been entered, click **Save**."
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ],
    "metadata": {
      "id": "28c8e10b-1e0a-4e44-89cb-2c746aa82bf2",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "OneLoginIAM"
      },
      "author": {
        "name": "Microsoft"
      },
      "support": {
        "name": "Microsoft",
        "tier": "Microsoft",
        "link": "https://support.microsoft.com/"
      }
    }
  },
  {
    "id": "OneLoginIAMLogsCCPDefinition",
    "title": "OneLogin IAM Platform (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The [OneLogin](https://www.onelogin.com/) data connector provides the capability to ingest common OneLogin IAM Platform events into Microsoft Sentinel through REST API by using OneLogin [Events API](https://developers.onelogin.com/api-docs/1/events/get-events) and OneLogin [Users API](https://developers.onelogin.com/api-docs/1/users/get-users). The connector provides ability to get events which helps to examine potential security risks, analyze your team's use of collaboration, diagnose configuration problems and more.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "OneLogin IAM Event Logs",
        "baseQuery": "OneLoginEventsV2_CL"
      },
      {
        "metricName": "Total users received",
        "legend": "OneLogin IAM User Logs",
        "baseQuery": "OneLoginUsersV2_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of OneLogin IAM Event Logs",
        "query": "OneLoginEventsV2_CL\n | take 10"
      },
      {
        "description": "Get a Sample of OneLogin IAM User Logs",
        "query": "OneLoginUsersV2_CL\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "OneLoginEventsV2_CL",
        "lastDataReceivedQuery": "OneLoginEventsV2_CL\n | summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      },
      {
        "name": "OneLoginUsersV2_CL",
        "lastDataReceivedQuery": "OneLoginUsersV2_CL\n | summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "OnetrustPush",
    "title": "OneTrust",
    "publisher": "OneTrust",
    "descriptionMarkdown": "The OneTrust connector for Microsoft Sentinel provides the capability to have near real time visibility into where sensitive data has been located or remediated across across Google Cloud and other OneTrust supported data sources.",
    "graphQueries": [
      {
        "metricName": "OneTrust Metadata Logs",
        "legend": "OneTrustMetadataV3_CL",
        "baseQuery": "OneTrustMetadataV3_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "OneTrust Logs - All Logs",
        "query": "OneTrustMetadataV3_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "OneTrustMetadataV3_CL",
        "lastDataReceivedQuery": "OneTrustMetadataV3_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1
    },
    "metadata": null
  },
  {
    "id": "OpenVPN",
    "title": "[Deprecated] OpenVPN Server",
    "publisher": "OpenVPN",
    "descriptionMarkdown": "The [OpenVPN](https://github.com/OpenVPN) data connector provides the capability to ingest OpenVPN Server logs into Microsoft Sentinel.",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected [**OpenVpnEvent**](https://aka.ms/sentinel-openvpn-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "OpenVPN",
        "baseQuery": "OpenVpnEvent"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Sources",
        "query": "OpenVpnEvent\n | summarize count() by tostring(SrcIpAddr)\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog(OpenVPN)",
        "lastDataReceivedQuery": "OpenVpnEvent\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "OpenVpnEvent\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "write permission is required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**OpenVpnEvent**](https://aka.ms/sentinel-openvpn-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux or Windows",
        "description": "Install the agent on the Server where the OpenVPN are forwarded.\n\n> Logs from OpenVPN Server deployed on Linux or Windows servers are collected by **Linux** or **Windows** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Linux agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Windows agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Windows Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Windows Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Configure the facilities you want to collect and their severities.\n\n1.  Under workspace advanced settings **Configuration**, select **Data** and then **Syslog**.\n2.  Select **Apply below configuration to my machines** and select the facilities and severities.\n3.  Click **Save**.",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenSyslogSettings"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "3. Check your OpenVPN logs.",
        "description": "OpenVPN server logs are written into common syslog file (depending on the Linux distribution used: e.g. /var/log/messages)"
      }
    ],
    "metadata": {
      "id": "67650481-6078-457a-9056-c5b7883fb9f9",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution"
      },
      "author": {
        "name": "Microsoft"
      },
      "support": {
        "name": "Microsoft",
        "link": "https://support.microsoft.com/",
        "tier": "Microsoft"
      }
    }
  },
  {
    "id": "OracleCloudInfrastructureLogsConnector",
    "title": "[DEPRECATED] Oracle Cloud Infrastructure",
    "publisher": "Oracle",
    "descriptionMarkdown": "The Oracle Cloud Infrastructure (OCI) data connector provides the capability to ingest OCI Logs from [OCI Stream](https://docs.oracle.com/iaas/Content/Streaming/Concepts/streamingoverview.htm) into Microsoft Sentinel using the [OCI Streaming REST API](https://docs.oracle.com/iaas/api/#/streaming/streaming/20180418).\n\n<p><span style='color:red; font-weight:bold;'>NOTE</span>: This data connector has been deprecated, consider moving to the CCF data connector available in the solution which replaces ingestion via the <a href='https://learn.microsoft.com/en-us/azure/azure-monitor/logs/custom-logs-migrate' style='color:#1890F1;'>deprecated HTTP Data Collector API</a>.</p>",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected [**OCILogs**](https://aka.ms/sentinel-OracleCloudInfrastructureLogsConnector-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "OCI Events",
        "legend": "OCI_Logs_CL",
        "baseQuery": "OCI_Logs_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All OCI Events",
        "query": "OCI_Logs_CL\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "OCI_Logs_CL",
        "lastDataReceivedQuery": "OCI_Logs_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "OCI_Logs_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "OCI API Credentials",
          "description": " **API Key Configuration File** and **Private Key** are required for OCI API connection. See the documentation to learn more about [creating keys for API access](https://docs.oracle.com/en-us/iaas/Content/API/Concepts/apisigningkey.htm)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector can go over the 500 column limit of log Analytics. When this happens some logs will be dropped. For this reason the connector can be unrealiable depending on the logs that are being generated and collected."
      },
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Azure Blob Storage API to pull logs into Microsoft Sentinel. This might result in additional costs for data ingestion and for storing data in Azure Blob Storage costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) and [Azure Blob Storage pricing page](https://azure.microsoft.com/pricing/details/storage/blobs/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**OCILogs**](https://aka.ms/sentinel-OracleCloudInfrastructureLogsConnector-parser) which is deployed with the Microsoft Sentinel Solution."
      },
      {
        "title": "",
        "description": "**STEP 1 - Creating Stream**\n\n1. Log in to OCI console and go to *navigation menu* -> *Analytics & AI* -> *Streaming*\n2. Click *Create Stream*\n3. Select Stream Pool or create a new one\n4. Provide the *Stream Name*, *Retention*, *Number of Partitions*, *Total Write Rate*, *Total Read Rate* based on your data amount.\n5. Go to *navigation menu* -> *Logging* -> *Service Connectors*\n6. Click *Create Service Connector*\n6. Provide *Connector Name*, *Description*, *Resource Compartment*\n7. Select Source: Logging\n8. Select Target: Streaming\n9. (Optional) Configure *Log Group*, *Filters* or use custom search query to stream only logs that you need.\n10. Configure Target - select the strem created before.\n11. Click *Create*\n\nCheck the documentation to get more information about [Streaming](https://docs.oracle.com/en-us/iaas/Content/Streaming/home.htm) and [Service Connectors](https://docs.oracle.com/en-us/iaas/Content/service-connector-hub/home.htm)."
      },
      {
        "title": "",
        "description": "**STEP 2 - Creating credentials for OCI REST API**\n\nFollow the documentation to [create Private Key and API Key Configuration File.](https://docs.oracle.com/en-us/iaas/Content/API/Concepts/apisigningkey.htm)\n\n>**IMPORTANT:** Save Private Key and API Key Configuration File created during this step as they will be used during deployment step."
      },
      {
        "title": "",
        "description": "**STEP 3 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the OCI data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following), as well as OCI API credentials, readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Option 1 - Azure Resource Manager (ARM) Template",
                  "description": "Use this method for automated deployment of the OCI data connector using an ARM Template.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-OracleCloudInfrastructureLogsConnector-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Microsoft Sentinel Workspace Id**, **Microsoft Sentinel Shared Key**, **User**, **Key_content**, **Pass_phrase**, **Fingerprint**, **Tenancy**, **Region**, **Message Endpoint**, **Stream Ocid**\n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**.\n5. Click **Purchase** to deploy."
                },
                {
                  "title": "Option 2 - Manual Deployment of Azure Functions",
                  "description": "Use the following step-by-step instructions to deploy the OCI data connector manually with Azure Functions (Deployment via Visual Studio Code).",
                  "instructions": [
                    {
                      "parameters": {
                        "instructionSteps": [
                          {
                            "title": "Step 1 - Deploy a Function App",
                            "description": "1.  Download the [Azure Function App](https://aka.ms/sentinel-OracleCloudInfrastructureLogsConnector-functionapp) file. Extract archive to your local development computer..\n2. Follow the [function app manual deployment instructions](https://github.com/Azure/Azure-Sentinel/blob/master/DataConnectors/AzureFunctionsManualDeployment.md#function-app-manual-deployment-instructions) to deploy the Azure Functions app using VSCode.\n3. After successful deployment of the function app, follow next steps for configuring it."
                          },
                          {
                            "title": "Step 2 - Configure the Function App",
                            "description": "1. Go to Azure Portal for the Function App configuration.\n2. In the Function App, select the Function App Name and select **Configuration**.\n3. In the **Application settings** tab, select **+ New application setting**.\n4. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tAzureSentinelWorkspaceId\n\t\tAzureSentinelSharedKey\n\t\tuser\n\t\tkey_content\n\t\tpass_phrase (Optional)\n\t\tfingerprint\n\t\ttenancy\n\t\tregion\n\t\tMessage Endpoint\n\t\tStreamOcid\n\t\tlogAnalyticsUri (Optional)\n - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://WORKSPACE_ID.ods.opinsights.azure.us`.\n5. Once all application settings have been entered, click **Save**."
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "OracleDatabaseAudit",
    "title": "[Deprecated] Oracle Database Audit",
    "publisher": "Oracle",
    "descriptionMarkdown": "The Oracle DB Audit data connector provides the capability to ingest [Oracle Database](https://www.oracle.com/database/technologies/) audit events into Microsoft Sentinel through the syslog. Refer to [documentation](https://docs.oracle.com/en/database/oracle/oracle-database/21/dbseg/introduction-to-auditing.html#GUID-94381464-53A3-421B-8F13-BD171C867405) for more information.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "OracleDatabaseAudit",
        "baseQuery": "OracleDatabaseAuditEvent"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Sources",
        "query": "OracleDatabaseAuditEvent\n | summarize count() by SrcDvcHostname\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog (OracleDatabaseAudit)",
        "lastDataReceivedQuery": "OracleDatabaseAuditEvent\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "OracleDatabaseAuditEvent\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "write permission is required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias Oracle Database Audit and load the function code or click [here](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/OracleDatabaseAudit/Parsers/OracleDatabaseAuditEvent.txt). The function usually takes 10-15 minutes to activate after solution installation/update.",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux",
        "description": "Typically, you should install the agent on a different computer from the one on which the logs are generated.\n\n>  Syslog logs are collected only from **Linux** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Configure the facilities you want to collect and their severities.\n\n1.  Under workspace advanced settings **Configuration**, select **Data** and then **Syslog**.\n2.  Select **Apply below configuration to my machines** and select the facilities and severities.\n3.  Click **Save**.",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenSyslogSettings"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "3. Configure Oracle Database Audit events to be sent to Syslog",
        "description": "Follow the below instructions \n\n 1. Create the Oracle database [Follow these steps.](https://learn.microsoft.com/en-us/azure/virtual-machines/workloads/oracle/oracle-database-quick-create) \n\n 2. Login to Oracle database created from the above step [Follow these steps.](https://docs.oracle.com/cd/F49540_01/DOC/server.815/a67772/create.htm) \n\n 3. Enable unified logging over syslog by **Alter the system to enable unified logging** [Following these steps.](https://docs.oracle.com/en/database/oracle/oracle-database/21/refrn/UNIFIED_AUDIT_COMMON_SYSTEMLOG.html#GUID-9F26BC8E-1397-4B0E-8A08-3B12E4F9ED3A) \n\n 4. Create and  **enable an Audit policy for unified auditing** [Follow these steps.](https://docs.oracle.com/en/database/oracle/oracle-database/19/sqlrf/CREATE-AUDIT-POLICY-Unified-Auditing.html#GUID-8D6961FB-2E50-46F5-81F7-9AEA314FC693) \n\n 5. **Enabling syslog and Event Viewer** Captures for the Unified Audit Trail [Follow these steps.](https://docs.oracle.com/en/database/oracle/oracle-database/18/dbseg/administering-the-audit-trail.html#GUID-3EFB75DB-AE1C-44E6-B46E-30E5702B0FC4)"
      }
    ]
  },
  {
    "id": "OracleWebLogicServer",
    "title": "[Deprecated] Oracle WebLogic Server",
    "publisher": "Oracle",
    "descriptionMarkdown": "OracleWebLogicServer data connector provides the capability to ingest [OracleWebLogicServer](https://docs.oracle.com/en/middleware/standalone/weblogic-server/index.html) events into Microsoft Sentinel. Refer to [OracleWebLogicServer documentation](https://docs.oracle.com/en/middleware/standalone/weblogic-server/14.1.1.0/index.html) for more information.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "OracleWebLogicServer_CL",
        "baseQuery": "OracleWebLogicServerEvent"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Devices",
        "query": "OracleWebLogicServerEvent\n | summarize count() by DvcHostname\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "OracleWebLogicServer_CL",
        "lastDataReceivedQuery": "OracleWebLogicServerEvent\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "OracleWebLogicServerEvent\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias OracleWebLogicServerEvent and load the function code or click [here](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/OracleWebLogicServer/Parsers/OracleWebLogicServerEvent.yaml). The function usually takes 10-15 minutes to activate after solution installation/update.",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux or Windows",
        "description": "Install the agent on the Oracle WebLogic Server where the logs are generated.\n\n> Logs from Oracle WebLogic Server deployed on Linux or Windows servers are collected by **Linux** or **Windows** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Linux agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Windows agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Windows Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Windows Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Configure the custom log directory to be collected",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenCustomLogsSettings"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "",
        "description": "1. Select the link above to open your workspace advanced settings \n2. From the left pane, select **Data**, select **Custom Logs** and click **Add+**\n3. Click **Browse** to upload a sample of a OracleWebLogicServer log file (e.g. server.log). Then, click **Next >**\n4. Select **New line** as the record delimiter and click **Next >**\n5. Select **Windows** or **Linux** and enter the path to OracleWebLogicServer logs based on your configuration. Example: \n - **Linux** Directory:  'DOMAIN_HOME/servers/server_name/logs/*.log'\n - **Windows** Directory: 'DOMAIN_NAME\\servers\\SERVER_NAME\\logs\\*.log'\n6. After entering the path, click the '+' symbol to apply, then click **Next >** \n7. Add **OracleWebLogicServer_CL** as the custom log Name and click **Done**"
      }
    ]
  },
  {
    "id": "OrcaSecurityAlerts",
    "title": "Orca Security Alerts",
    "publisher": "Orca Security",
    "descriptionMarkdown": "The Orca Security Alerts connector allows you to easily export Alerts logs to Microsoft Sentinel.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "OrcaAlerts_CL",
        "baseQuery": "OrcaAlerts_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Fetch all service vulnerabilities on running asset",
        "query": "OrcaAlerts_CL | where alert_type_s == \"service_vulnerability\" | where asset_state_s == \"running\" | sort by TimeGenerated "
      },
      {
        "description": "Fetch all alerts with \"remote_code_execution\" label",
        "query": "OrcaAlerts_CL | where split(alert_labels_s, \",\") contains(\"remote_code_execution\") | sort by TimeGenerated "
      }
    ],
    "dataTypes": [
      {
        "name": "OrcaAlerts_CL",
        "lastDataReceivedQuery": "OrcaAlerts_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "OrcaAlerts_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "Follow [guidance](https://orcasecurity.zendesk.com/hc/en-us/articles/360043941992-Azure-Sentinel-configuration) for integrating Orca Security Alerts logs with Microsoft Sentinel.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ],
    "metadata": {
      "id": "f664e101-f4af-4d74-809c-8fad6ee3c381",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Orca Security"
      },
      "support": {
        "name": "Orca Security",
        "link": "http://support.orca.security/",
        "tier": "developer"
      }
    }
  },
  {
    "id": "OSSEC",
    "title": "[Deprecated] OSSEC via Legacy Agent",
    "publisher": "OSSEC",
    "descriptionMarkdown": "OSSEC data connector provides the capability to ingest [OSSEC](https://www.ossec.net/) events into Microsoft Sentinel. Refer to [OSSEC documentation](https://www.ossec.net/docs) for more information.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "OSSEC",
        "baseQuery": "OSSECEvent"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Rules",
        "query": "OSSECEvent\n | summarize count() by RuleName\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (OSSEC)",
        "lastDataReceivedQuery": "OSSECEvent\n | summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "OSSECEvent\n | summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias OSSEC and load the function code or click [here](https://aka.ms/sentinel-OSSECEvent-parser), on the second line of the query, enter the hostname(s) of your OSSEC device(s) and any other unique identifiers for the logstream. The function usually takes 10-15 minutes to activate after solution installation/update.",
        "instructions": []
      },
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Common Event Format (CEF) logs to Syslog agent",
        "description": "[Follow these steps](https://www.ossec.net/docs/docs/manual/output/syslog-output.html) to configure OSSEC sending alerts via syslog."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "OSSECAma",
    "title": "[Deprecated] OSSEC via AMA",
    "publisher": "OSSEC",
    "descriptionMarkdown": "OSSEC data connector provides the capability to ingest [OSSEC](https://www.ossec.net/) events into Microsoft Sentinel. Refer to [OSSEC documentation](https://www.ossec.net/docs) for more information.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "OSSEC",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'OSSEC'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Rules",
        "query": "OSSECEvent\n | summarize count() by RuleName\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (OSSEC)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'OSSEC'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'OSSEC'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias OSSEC and load the function code or click [here](https://aka.ms/sentinel-OSSECEvent-parser), on the second line of the query, enter the hostname(s) of your OSSEC device(s) and any other unique identifiers for the logstream. The function usually takes 10-15 minutes to activate after solution installation/update.",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine",
                  "instructions": []
                },
                {
                  "title": "Step B. Forward Common Event Format (CEF) logs to Syslog agent",
                  "description": "[Follow these steps](https://www.ossec.net/docs/docs/manual/output/syslog-output.html) to configure OSSEC sending alerts via syslog.",
                  "instructions": []
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "PaloAltoCDL",
    "title": "[Deprecated] Palo Alto Networks Cortex Data Lake (CDL) via Legacy Agent",
    "publisher": "Palo Alto Networks",
    "descriptionMarkdown": "The [Palo Alto Networks CDL](https://www.paloaltonetworks.com/cortex/cortex-data-lake) data connector provides the capability to ingest [CDL logs](https://docs.paloaltonetworks.com/strata-logging-service/log-reference/log-forwarding-schema-overview) into Microsoft Sentinel.",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected [**PaloAltoCDLEvent**](https://aka.ms/sentinel-paloaltocdl-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "PaloAltoNetworksCDL",
        "baseQuery": "PaloAltoCDLEvent"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Destinations",
        "query": "PaloAltoCDLEvent\n | where isnotempty(DstIpAddr)\n    | summarize count() by DstIpAddr\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (PaloAltoNetworksCDL)",
        "lastDataReceivedQuery": "PaloAltoCDLEvent\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "PaloAltoCDLEvent\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**PaloAltoCDLEvent**](https://aka.ms/sentinel-paloaltocdl-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2.  Configure Cortex Data Lake to forward logs to a Syslog Server using CEF",
        "description": "[Follow the instructions](https://docs.paloaltonetworks.com/cortex/cortex-data-lake/cortex-data-lake-getting-started/get-started-with-log-forwarding-app/forward-logs-from-logging-service-to-syslog-server.html) to configure logs forwarding from Cortex Data Lake to a Syslog Server."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "PaloAltoCDLAma",
    "title": "[Deprecated] Palo Alto Networks Cortex Data Lake (CDL) via AMA",
    "publisher": "Palo Alto Networks",
    "descriptionMarkdown": "The [Palo Alto Networks CDL](https://www.paloaltonetworks.com/cortex/cortex-data-lake) data connector provides the capability to ingest [CDL logs](https://docs.paloaltonetworks.com/strata-logging-service/log-reference/log-forwarding-schema-overview) into Microsoft Sentinel.",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected [**PaloAltoCDLEvent**](https://aka.ms/sentinel-paloaltocdl-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "PaloAltoNetworksCDL",
        "baseQuery": "CommonSecurityLog\n |where  DeviceVendor =~ 'Palo Alto Networks'\n |where DeviceProduct =~ 'LF'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Destinations",
        "query": "PaloAltoCDLEvent\n | where isnotempty(DstIpAddr)\n    | summarize count() by DstIpAddr\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (PaloAltoNetworksCDL)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Palo Alto Networks'\n |where DeviceProduct =~ 'LF'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'Palo Alto Networks'\n |where DeviceProduct =~ 'LF'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**PaloAltoCDLEvent**](https://aka.ms/sentinel-paloaltocdl-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine",
                  "instructions": []
                },
                {
                  "title": "Step B. Configure Cortex Data Lake to forward logs to a Syslog Server using CEF",
                  "description": "[Follow the instructions](https://docs.paloaltonetworks.com/cortex/cortex-data-lake/cortex-data-lake-getting-started/get-started-with-log-forwarding-app/forward-logs-from-logging-service-to-syslog-server.html) to configure logs forwarding from Cortex Data Lake to a Syslog Server.",
                  "instructions": []
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "PaloAltoExpanseCCPDefinition",
    "title": "Palo Alto Cortex Xpanse (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The Palo Alto Cortex Xpanse data connector ingests alerts data into Microsoft Sentinel.",
    "graphQueries": [
      {
        "metricName": "Total alerts received",
        "legend": "Xpanse alerts Logs",
        "baseQuery": "CortexXpanseAlerts_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of Xpanse alerts",
        "query": "CortexXpanseAlerts_CL\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "CortexXpanseAlerts_CL",
        "lastDataReceivedQuery": "CortexXpanseAlerts_CL\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "PaloAltoNetworks",
    "title": "[Deprecated] Palo Alto Networks (Firewall) via Legacy Agent",
    "publisher": "Palo Alto Networks",
    "descriptionMarkdown": "The Palo Alto Networks firewall connector allows you to easily connect your Palo Alto Networks logs with Microsoft Sentinel, to view dashboards, create custom alerts, and improve investigation. This gives you more insight into your organization's network and improves your security operation capabilities.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Palo Alto Networks",
        "baseQuery": "\nCommonSecurityLog\n| where DeviceVendor == \"Palo Alto Networks\"\n| where DeviceProduct has \"PAN-OS\"\n"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"Palo Alto Networks\"\n| where DeviceProduct has \"PAN-OS\"\n\n            | sort by TimeGenerated"
      },
      {
        "description": "THREAT activity",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"Palo Alto Networks\"\n| where DeviceProduct has \"PAN-OS\"\n\n            | where Activity == \"THREAT\"\n            | sort by TimeGenerated"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "\nCommonSecurityLog\n| where DeviceVendor == \"Palo Alto Networks\"\n| where DeviceProduct has \"PAN-OS\"\n\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(3d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (PaloAlto)",
        "lastDataReceivedQuery": "\nCommonSecurityLog\n| where DeviceVendor == \"Palo Alto Networks\"\n| where DeviceProduct has \"PAN-OS\"\n\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Palo Alto Networks logs to Syslog agent",
        "description": "Configure Palo Alto Networks to forward Syslog messages in CEF format to your Microsoft Sentinel workspace via the Syslog agent.\n\nGo to [configure Palo Alto Networks NGFW for sending CEF events.](https://aka.ms/sentinel-paloaltonetworks-readme)\n\nGo to [Palo Alto CEF Configuration](https://aka.ms/asi-syslog-paloalto-forwarding)  and Palo Alto [Configure Syslog Monitoring](https://aka.ms/asi-syslog-paloalto-configure)  steps 2, 3, choose your version, and follow the instructions using the following guidelines:\n\n1.  Set the Syslog server format to  **BSD**.\n\n2.  The copy/paste operations from the PDF might change the text and insert random characters. To avoid this, copy the text to an editor and remove any characters that might break the log format before pasting it.\n\n[Learn more >](https://aka.ms/CEFPaloAlto)"
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "ef80260c-3aec-43bc-a1e5-c2f2372c9adc",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Palo Alto Networks"
      },
      "support": {
        "name": "Palo Alto Networks",
        "link": "https://www.paloaltonetworks.com/company/contact-support",
        "tier": "developer"
      }
    }
  },
  {
    "id": "PaloAltoNetworksAma",
    "title": "[Deprecated] Palo Alto Networks (Firewall) via AMA",
    "publisher": "Palo Alto Networks",
    "descriptionMarkdown": "The Palo Alto Networks firewall connector allows you to easily connect your Palo Alto Networks logs with Microsoft Sentinel, to view dashboards, create custom alerts, and improve investigation. This gives you more insight into your organization's network and improves your security operation capabilities.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Palo Alto Networks",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Palo Alto Networks' \n |where DeviceProduct has 'PAN-OS'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"Palo Alto Networks\"\n| where DeviceProduct has \"PAN-OS\"\n\n            | sort by TimeGenerated"
      },
      {
        "description": "THREAT activity",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"Palo Alto Networks\"\n| where DeviceProduct has \"PAN-OS\"\n\n            | where Activity == \"THREAT\"\n            | sort by TimeGenerated"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'Palo Alto Networks' \n |where DeviceProduct =~ 'PAN-OS'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(3d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (PaloAlto)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Palo Alto Networks' \n |where DeviceProduct has 'PAN-OS'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine",
                  "instructions": []
                },
                {
                  "title": "Step B. Forward Palo Alto Networks logs to Syslog agent",
                  "description": "Configure Palo Alto Networks to forward Syslog messages in CEF format to your Microsoft Sentinel workspace via the Syslog agent.\n\nGo to [configure Palo Alto Networks NGFW for sending CEF events.](https://aka.ms/sentinel-paloaltonetworks-readme)\n\nGo to [Palo Alto CEF Configuration](https://aka.ms/asi-syslog-paloalto-forwarding)  and Palo Alto [Configure Syslog Monitoring](https://aka.ms/asi-syslog-paloalto-configure)  steps 2, 3, choose your version, and follow the instructions using the following guidelines:\n\n1.  Set the Syslog server format to  **BSD**.\n\n2.  The copy/paste operations from the PDF might change the text and insert random characters. To avoid this, copy the text to an editor and remove any characters that might break the log format before pasting it.\n\n[Learn more >](https://aka.ms/CEFPaloAlto)",
                  "instructions": []
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "ef80260c-3aec-43bc-a1e5-c2f2372c9adc",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Palo Alto Networks"
      },
      "support": {
        "name": "Palo Alto Networks",
        "link": "https://www.paloaltonetworks.com/company/contact-support",
        "tier": "developer"
      }
    }
  },
  {
    "id": "PaloAltoNetworksCortex",
    "title": "Palo Alto Networks Cortex XDR",
    "publisher": "Palo Alto Networks",
    "descriptionMarkdown": "The Palo Alto Networks Cortex XDR connector gives you an easy way to connect to your Cortex XDR logs with Microsoft Sentinel. This increases the visibility of your endpoint security. It will give you better ability to monitor your resources by creating custom Workbooks, analytics rules, Incident investigation, and evidence gathering.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "PaloAltoNetworksCortex",
        "baseQuery": "CommonSecurityLog\n| where DeviceVendor == \"Palo Alto Networks\"\n| where DeviceProduct == \"Cortex XDR\""
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "\nCommonSecurityLog\n | where DeviceVendor == \"Palo Alto Networks\"\n | where DeviceProduct == \"Cortex XDR\"\n | sort by TimeGenerated"
      },
      {
        "description": "Alert By Severity",
        "query": "\nCommonSecurityLog\n | where DeviceVendor == \"Palo Alto Networks\"\n | where DeviceProduct == \"Cortex XDR\"\n | where DeviceAction == \"Prevented (Blocked)\"\n | where LogSeverity =~ \"6\"\n | summarize by TimeGenerated,DeviceProduct, DeviceEventClassID, LogSeverity, Activity, DeviceAction, Computer, DeviceVersion, FileHash, FileName, FilePath, RequestURL, SourceHostName, SourceUserName\n | sort by TimeGenerated"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (PaloAltoNetworksCortex)",
        "lastDataReceivedQuery": "CommonSecurityLog\n| where DeviceVendor == \"Palo Alto Networks\"\n| where DeviceProduct == \"Cortex XDR\"\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n| where DeviceVendor == \"Palo Alto Networks\"\n| where DeviceProduct == \"Cortex XDR\"\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Azure Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Azure Sentinel will use as the proxy between your security solution and Azure Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Azure Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Palo Alto Networks (Cortex) logs to Syslog agent",
        "description": "\n\n> 1. Go to [Cortex Settings and Configurations](https://inspira.xdr.in.paloaltonetworks.com/configuration/external-alerting) and Click to add New Server under External Applications.\n\n> 2. Then specify the name and Give public IP of your syslog server in Destination. \n\n> 3. Give Port number as 514 and from Facility field select FAC_SYSLOG from dropdown. \n\n> 4. Select Protocol as UDP and hit Create."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "32512c5f-aa20-4d6b-a9e5-f21958cefa63",
      "version": "V2.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "PaloAltoXDR"
      },
      "author": {
        "name": "Vikas Chaturvedi"
      },
      "support": {
        "tier": "community",
        "name": "Microsoft",
        "email": "v-chaturvedi01@outlook.com"
      }
    }
  },
  {
    "id": "PaloAltoPrismaCloud",
    "title": "[DEPRECATED] Palo Alto Prisma Cloud CSPM",
    "publisher": "Palo Alto",
    "descriptionMarkdown": "The Palo Alto Prisma Cloud CSPM data connector provides the capability to ingest [Prisma Cloud CSPM alerts](https://prisma.pan.dev/api/cloud/cspm/alerts#operation/get-alerts) and [audit logs](https://prisma.pan.dev/api/cloud/cspm/audit-logs#operation/rl-audit-logs) into Microsoft sentinel using the Prisma Cloud CSPM API. Refer to [Prisma Cloud CSPM API documentation](https://prisma.pan.dev/api/cloud/cspm) for more information.\n\n<p><span style='color:red; font-weight:bold;'>NOTE</span>: This data connector has been deprecated, consider moving to the CCF data connector available in the solution which replaces ingestion via the <a href='https://learn.microsoft.com/en-us/azure/azure-monitor/logs/custom-logs-migrate' style='color:#1890F1;'>deprecated HTTP Data Collector API</a>.</p>",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected [**PaloAltoPrismaCloud**](https://aka.ms/sentinel-PaloAltoPrismaCloud-parser) which is deployed with the Microsoft sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Prisma Cloud alerts",
        "legend": "PaloAltoPrismaCloudAlert_CL",
        "baseQuery": "PaloAltoPrismaCloudAlert_CL"
      },
      {
        "metricName": "Prisma Cloud audit logs",
        "legend": "PaloAltoPrismaCloudAudit_CL",
        "baseQuery": "PaloAltoPrismaCloudAudit_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Prisma Cloud alerts",
        "query": "PaloAltoPrismaCloudAlert_CL\n| sort by TimeGenerated desc"
      },
      {
        "description": "All Prisma Cloud audit logs",
        "query": "PaloAltoPrismaCloudAudit_CL\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "PaloAltoPrismaCloudAlert_CL",
        "lastDataReceivedQuery": "PaloAltoPrismaCloudAlert_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "PaloAltoPrismaCloudAudit_CL",
        "lastDataReceivedQuery": "PaloAltoPrismaCloudAudit_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "PaloAltoPrismaCloudAlert_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(3d)",
          "PaloAltoPrismaCloudAudit_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(3d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Palo Alto Prisma Cloud API Credentials",
          "description": "**Prisma Cloud API Url**, **Prisma Cloud Access Key ID**, **Prisma Cloud Secret Key** are required for Prisma Cloud API connection. See the documentation to learn more about [creating Prisma Cloud Access Key](https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-admin/manage-prisma-cloud-administrators/create-access-keys.html) and about [obtaining Prisma Cloud API Url](https://prisma.pan.dev/api/cloud/api-urls)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Palo Alto Prisma Cloud REST API to pull logs into Microsoft sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**PaloAltoPrismaCloud**](https://aka.ms/sentinel-PaloAltoPrismaCloud-parser) which is deployed with the Microsoft sentinel Solution."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration of the Prisma Cloud**\n\nFollow the documentation to [create Prisma Cloud Access Key](https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-admin/manage-prisma-cloud-administrators/create-access-keys.html) and [obtain Prisma Cloud API Url](https://api.docs.prismacloud.io/reference)\n\n NOTE: Please use SYSTEM ADMIN role for giving access to Prisma Cloud API because only SYSTEM ADMIN role is allowed to View Prisma Cloud Audit Logs. Refer to [Prisma Cloud Administrator Permissions (paloaltonetworks.com)](https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-admin/manage-prisma-cloud-administrators/prisma-cloud-admin-permissions) for more details of administrator permissions."
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Prisma Cloud data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following), as well as Prisma Cloud API credentials, readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Option 1 - Azure Resource Manager (ARM) Template",
                  "description": "Use this method for automated deployment of the Prisma Cloud data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-PaloAltoPrismaCloud-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Prisma Cloud API Url**, **Prisma Cloud Access Key ID**, **Prisma Cloud Secret Key**, **Microsoft sentinel Workspace Id**, **Microsoft sentinel Shared Key**\n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**.\n5. Click **Purchase** to deploy."
                },
                {
                  "title": "Option 2 - Manual Deployment of Azure Functions",
                  "description": "Use the following step-by-step instructions to deploy the Prisma Cloud data connector manually with Azure Functions (Deployment via Visual Studio Code).",
                  "instructions": [
                    {
                      "parameters": {
                        "instructionSteps": [
                          {
                            "title": "Step 1 - Deploy a Function App",
                            "description": "**NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/create-first-function-vs-code-python) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-PaloAltoPrismaCloud-functionapp) file. Extract archive to your local development computer.\n2. Follow the [function app manual deployment instructions](https://github.com/Azure/Azure-Sentinel/blob/master/DataConnectors/AzureFunctionsManualDeployment.md#function-app-manual-deployment-instructions) to deploy the Azure Functions app using VSCode.\n3. After successful deployment of the function app, follow next steps for configuring it."
                          },
                          {
                            "title": "Step 2 - Configure the Function App",
                            "description": "1. Go to Azure Portal for the Function App configuration.\n2. In the Function App, select the Function App Name and select **Configuration**.\n3. In the **Application settings** tab, select **+ New application setting**.\n4. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tPrismaCloudAPIUrl\n\t\tPrismaCloudAccessKeyID\n\t\tPrismaCloudSecretKey\n\t\tAzureSentinelWorkspaceId\n\t\tAzureSentinelSharedKey\n\t\tlogAnalyticsUri (Optional)\n - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://WORKSPACE_ID.ods.opinsights.azure.us`. \n5. Once all application settings have been entered, click **Save**."
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "PaloAltoPrismaCloudCSPMCCPDefinition",
    "title": "Palo Alto Prisma Cloud CSPM (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The Palo Alto Prisma Cloud CSPM data connector allows you to connect to your Palo Alto Prisma Cloud CSPM instance and ingesting Alerts (https://pan.dev/prisma-cloud/api/cspm/alerts/) & Audit Logs(https://pan.dev/prisma-cloud/api/cspm/audit-logs/) into Microsoft Sentinel.",
    "graphQueries": [
      {
        "metricName": "Total Alerts received",
        "legend": "Prisma Alert ",
        "baseQuery": "{{graphQueriesTableName}}"
      },
      {
        "metricName": "Total Audit received",
        "legend": "Prisma Audit ",
        "baseQuery": "PaloAltoPrismaCloudAuditV2_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of Prisma Alerts Events",
        "query": "{{graphQueriesTableName}}\n | take 10"
      },
      {
        "description": "Get Sample of Prisma Alerts Events",
        "query": "PaloAltoPrismaCloudAuditV2_CL\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n   | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "PaloAltoPrismaCloudAuditV2_CL",
        "lastDataReceivedQuery": "PaloAltoPrismaCloudAuditV2_CL\n   | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "PaloAltoPrismaCloudCWPP",
    "title": "Palo Alto Prisma Cloud CWPP (using REST API)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The [Palo Alto Prisma Cloud CWPP](https://prisma.pan.dev/api/cloud/cwpp/audits/#operation/get-audits-incidents) data connector allows you to connect to your Palo Alto Prisma Cloud CWPP instance and ingesting alerts into Microsoft Sentinel. The data connector is built on Microsoft Sentinel's Codeless Connector Platform and uses the Prisma Cloud API to fetch security events and supports DCR-based [ingestion time transformations](https://docs.microsoft.com/azure/azure-monitor/logs/custom-logs-overview) that parses the received security event data into a custom columns so that queries don't need to parse it again, thus resulting in better performance.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "Prisma Compute Events",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of Prisma Compute Events",
        "query": "{{graphQueriesTableName}}\n | take 10"
      },
      {
        "description": "Total Events by Event Type",
        "query": "{{graphQueriesTableName}}\n | summarize count() by EventOriginalType"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n   | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "Pathlock_TDnR",
    "title": "Pathlock Inc.: Threat Detection and Response for SAP",
    "publisher": "Pathlock Inc.",
    "descriptionMarkdown": "The [Pathlock Threat Detection and Response (TD&R)](https://pathlock.com/products/cybersecurity-application-controls/) integration with **Microsoft Sentinel Solution for SAP** delivers unified, real-time visibility into SAP security events, enabling organizations to detect and act on threats across all SAP landscapes. This out-of-the-box integration allows Security Operations Centers (SOCs) to correlate SAP-specific alerts with enterprise-wide telemetry, creating actionable intelligence that connects IT security with business processes.\n\nPathlocks connector is purpose-built for SAP and forwards only **security-relevant events by default**, minimizing data volume and noise while maintaining the flexibility to forward all log sources when needed. Each event is enriched with **business process context**, allowing Microsoft Sentinel Solution for SAP analytics to distinguish operational patterns from real threats and to prioritize what truly matters.\n\nThis precision-driven approach helps security teams drastically reduce false positives, focus investigations, and accelerate **mean time to detect (MTTD)** and **mean time to respond (MTTR)**. Pathlocks library consists of more than 1,500 SAP-specific detection signatures across 70+ log sources, the solution uncovers complex attack behaviors, configuration weaknesses, and access anomalies.\n\nBy combining business-context intelligence with advanced analytics, Pathlock enables enterprises to strengthen detection accuracy, streamline response actions, and maintain continuous control across their SAP environmentswithout adding complexity or redundant monitoring layers.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "SAP SID's",
        "baseQuery": "{{graphQueriesTableName}} | project TimeGenerated, SAP_SID= SystemUniqueId"
      },
      {
        "metricName": "Alerts received last 24 hrs.",
        "legend": "Total Alerts",
        "baseQuery": "{{graphQueriesTableName}} | summarize count() by bin(TimeGenerated, 1d)"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample Events",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "isPreview": true
    },
    "metadata": null
  },
  {
    "id": "Pathlock_TDnR",
    "title": "Pathlock Threat Detection and Response Integration",
    "publisher": "Pathlock Inc.",
    "logo": "pathlock_logo.svg",
    "descriptionMarkdown": "Pathlock Threat Detection and Response enables seamless forwarding of security alerts and logs detected and collected by the Pathlock Platform into Microsoft Sentinel Solution for SAP.",
    "graphQueriesTableName": "Pathlock_TDnR_CL",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "SID",
        "baseQuery": "{{graphQueriesTableName}} | project TimeGenerated, SYSID= sid"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample Events",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | where TimeGenerated > ago(12h) | where name_s == \"no data test\" | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriteria": [
      {
        "type": "HasDataConnectors"
      }
    ],
    "availability": {
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "Read and Write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "Read permissions to shared keys for the workspace are required.",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft Entra",
          "description": "Permission to create an app registration in Microsoft Entra ID. Typically requires Entra ID Application Developer role or higher."
        },
        {
          "name": "Microsoft Azure",
          "description": "Permission to assign Monitoring Metrics Publisher role on data collection rules. Typically requires Azure RBAC Owner or User Access Administrator role."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Create ARM Resources and Provide the Required Permissions",
        "description": "We will create data collection rule (DCR) and data collection endpoint (DCE) resources. We will also create a Microsoft Entra app registration and assign the required permissions to it.",
        "instructions": [
          {
            "type": "Markdown",
            "parameters": {
              "content": "#### Automated deployment of Azure resources\nClicking on \"Deploy push connector resources\" will trigger the creation of DCR and DCE resources.\nIt will then create a Microsoft Entra app registration with client secret and grant permissions on the DCR. This setup enables data to be sent securely to the DCR using a OAuth v2 client credentials."
            }
          },
          {
            "parameters": {
              "label": "Deploy push connector resources",
              "applicationDisplayName": "Pathlock Threat Detection and Response forwarding to Microsoft Sentinel Solution for SAP"
            },
            "type": "DeployPushConnectorButton_test"
          }
        ]
      },
      {
        "title": "2. Maintain the data collection endpoint details and authentication info in Pathlock Threat Detection and Response",
        "description": "Share the data collection endpoint URL and authentication info with the Pathlock Threat Detection and Response Integration administrator to configure the Integration.",
        "instructions": [
          {
            "parameters": {
              "label": "Use this value to configure as Tenant ID in the LogIngestionAPI credential.",
              "fillWith": [
                "TenantId"
              ]
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "label": "Entra Application ID",
              "fillWith": [
                "ApplicationId"
              ],
              "placeholder": "Deploy push connector to get the Application ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "label": "Entra Application Secret",
              "fillWith": [
                "ApplicationSecret"
              ],
              "placeholder": "Deploy push connector to get the Application Secret"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "label": "Use this value to configure the LogsIngestionURL parameter.",
              "fillWith": [
                "DataCollectionEndpoint"
              ],
              "placeholder": "Deploy push connector to get the DCE URI"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "label": "DCR Immutable ID",
              "fillWith": [
                "DataCollectionRuleId"
              ],
              "placeholder": "Deploy push connector to get the DCR ID"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ],
    "metadata": {
      "id": "Pathlock_TDnR",
      "version": "3.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "Pathlock Threat Detection and Response Integration for Microsoft Sentinel Solution for SAP"
      },
      "author": {
        "name": "Pathlock Inc.",
        "email": "support@pathlock.com"
      },
      "support": {
        "tier": "Partner",
        "name": "Pathlock Threat Detection and Response",
        "email": "support@pathlock.com",
        "link": "https://pathlock.com/support/"
      }
    }
  },
  {
    "id": "Perimeter81ActivityLogs",
    "title": "Perimeter 81 Activity Logs",
    "publisher": "Perimeter 81",
    "descriptionMarkdown": "The Perimeter 81 Activity Logs connector allows you to easily connect your Perimeter 81 activity logs with Microsoft Sentinel, to view dashboards, create custom alerts, and improve investigation.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Perimeter81_CL",
        "baseQuery": "Perimeter81_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "User login failures",
        "query": "Perimeter81_CL | where eventName_s == \"api.activity.login.fail\""
      },
      {
        "description": "Application authorization failures",
        "query": "Perimeter81_CL | where eventName_s == \"api.activity.application.auth.fail\""
      },
      {
        "description": "Application session start",
        "query": "Perimeter81_CL | where eventName_s == \"api.activity.application.session.start\""
      },
      {
        "description": "Authentication failures by IP & email (last 24 hours)",
        "query": "Perimeter81_CL\n| where TimeGenerated > ago(24h) and eventName_s in (\"api.activity.login.fail\", \"api.activity.vpn.auth.fail\", \"api.activity.application.auth.fail\")\n| summarize count() by ip_s, releasedBy_email_s\n| where count_ > 1"
      },
      {
        "description": "Resource deletions by IP & email (last 24 hours)",
        "query": "Perimeter81_CL\n| where TimeGenerated > ago(24h) and eventName_s matches regex \"api.activity.*.remove*|api.activity.*.delete*|api.activity.*.destroy*\"  \n| summarize count() by ip_s, releasedBy_email_s\n| where count_ > 1"
      }
    ],
    "dataTypes": [
      {
        "name": "Perimeter81_CL",
        "lastDataReceivedQuery": "Perimeter81_CL\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Perimeter81_CL\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "Please note the values below and follow the instructions <a href='https://support.perimeter81.com/hc/en-us/articles/360012680780'>here</a> to connect your Perimeter 81 activity logs with Microsoft Sentinel.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ],
    "metadata": {
      "id": "1d855d54-0f17-43b3-ad33-93a0ab7b6ce8",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Perimeter 81"
      },
      "support": {
        "name": "Perimeter 81",
        "link": "https://support.perimeter81.com/",
        "tier": "developer"
      }
    }
  },
  {
    "id": "PingFederate",
    "title": "[Deprecated] PingFederate via Legacy Agent",
    "publisher": "Ping Identity",
    "descriptionMarkdown": "The [PingFederate](https://www.pingidentity.com/en/software/pingfederate.html) data connector provides the capability to ingest [PingFederate events](https://docs.pingidentity.com/bundle/pingfederate-102/page/lly1564002980532.html) into Microsoft Sentinel. Refer to [PingFederate documentation](https://docs.pingidentity.com/bundle/pingfederate-102/page/tle1564002955874.html) for more information.",
    "additionalRequirementBanner": "This data connector depends on a parser based on Kusto Function to work as expected [**PingFederateEvent**](https://aka.ms/sentinel-PingFederate-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "PingFederate",
        "baseQuery": "PingFederateEvent"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Devices",
        "query": "PingFederateEvent\n | summarize count() by DvcHostname\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (PingFederate)",
        "lastDataReceivedQuery": "PingFederateEvent\n | summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "PingFederateEvent\n | summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**PingFederateEvent**](https://aka.ms/sentinel-PingFederate-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Common Event Format (CEF) logs to Syslog agent",
        "description": "[Follow these steps](https://docs.pingidentity.com/bundle/pingfederate-102/page/gsn1564002980953.html) to configure PingFederate sending audit log via syslog in CEF format."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "PingFederateAma",
    "title": "[Deprecated] PingFederate via AMA",
    "publisher": "Ping Identity",
    "descriptionMarkdown": "The [PingFederate](https://www.pingidentity.com/en/software/pingfederate.html) data connector provides the capability to ingest [PingFederate events](https://docs.pingidentity.com/bundle/pingfederate-102/page/lly1564002980532.html) into Microsoft Sentinel. Refer to [PingFederate documentation](https://docs.pingidentity.com/bundle/pingfederate-102/page/tle1564002955874.html) for more information.",
    "additionalRequirementBanner": "This data connector depends on a parser based on Kusto Function to work as expected [**PingFederateEvent**](https://aka.ms/sentinel-PingFederate-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "PingFederate",
        "baseQuery": "CommonSecurityLog\n |where DeviceProduct has 'PingFederate'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Devices",
        "query": "PingFederateEvent\n | summarize count() by DvcHostname\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (PingFederate)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceProduct has 'PingFederate'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceProduct has 'PingFederate'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**PingFederateEvent**](https://aka.ms/sentinel-PingFederate-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine",
                  "instructions": []
                },
                {
                  "title": "Step B. Forward Common Event Format (CEF) logs to Syslog agent",
                  "description": "[Follow these steps](https://docs.pingidentity.com/bundle/pingfederate-102/page/gsn1564002980953.html) to configure PingFederate sending audit log via syslog in CEF format.",
                  "instructions": []
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "PingOneAuditLogsCCPDefinition",
    "title": "Ping One (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "This connector ingests **audit activity logs** from the PingOne Identity platform into Microsoft Sentinel using a Codeless Connector Framework.",
    "graphQueries": [
      {
        "metricName": "Total audit events received",
        "legend": "Audit Events",
        "baseQuery": "PingOne_AuditActivitiesV2_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get sample audit activity events",
        "query": "PingOne_AuditActivitiesV2_CL\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "PingOne_AuditActivitiesV2_CL",
        "lastDataReceivedQuery": "PingOne_AuditActivitiesV2_CL\n | where TimeGenerated > ago(12h)\n | summarize Time=max(TimeGenerated)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "PostgreSQL",
    "title": "[Deprecated] PostgreSQL Events",
    "publisher": "PostgreSQL",
    "descriptionMarkdown": "PostgreSQL data connector provides the capability to ingest [PostgreSQL](https://www.postgresql.org/) events into Microsoft Sentinel. Refer to [PostgreSQL documentation](https://www.postgresql.org/docs/current/index.html) for more information.",
    "additionalRequirementBanner": "This data connector depends on a parser based on Kusto Function to work as expected. Follow the steps to use this Kusto Function alias **PostgreSQLEvent** in queries and workbooks. [Follow steps to get this Kusto Function>](https://aka.ms/sentinel-postgresql-parser)",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "PostgreSQL_CL",
        "baseQuery": "PostgreSQLEvent"
      }
    ],
    "sampleQueries": [
      {
        "description": "PostgreSQL errors",
        "query": "PostgreSQLEvent\n | where EventSeverity in~ ('ERROR', 'FATAL')\n | sort by EventEndTime"
      }
    ],
    "dataTypes": [
      {
        "name": "PostgreSQL_CL",
        "lastDataReceivedQuery": "PostgreSQLEvent\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "PostgreSQLEvent\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on PostgreSQL parser based on a Kusto Function to work as expected. This parser is installed along with solution installation.",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux or Windows",
        "description": "Install the agent on the Tomcat Server where the logs are generated.\n\n> Logs from PostgreSQL Server deployed on Linux or Windows servers are collected by **Linux** or **Windows** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Linux agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Windows agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Windows Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Windows Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure PostgreSQL to write logs to files",
        "description": "1. Edit postgresql.conf file to write logs to files:\n\n>**log_destination** = 'stderr'\n\n>**logging_collector** = on\n\nSet the following parameters: **log_directory** and **log_filename**. Refer to the [PostgreSQL documentation for more details](https://www.postgresql.org/docs/current/runtime-config-logging.html)"
      },
      {
        "title": "3. Configure the logs to be collected",
        "description": "Configure the custom log directory to be collected",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenCustomLogsSettings"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "",
        "description": "1. Select the link above to open your workspace advanced settings \n2. From the left pane, select **Settings**, select **Custom Logs** and click **+Add custom log**\n3. Click **Browse** to upload a sample of a PostgreSQL log file. Then, click **Next >**\n4. Select **Timestamp** as the record delimiter and click **Next >**\n5. Select **Windows** or **Linux** and enter the path to PostgreSQL logs based on your configuration(e.g. for some Linux distros the default path is /var/log/postgresql/) \n6. After entering the path, click the '+' symbol to apply, then click **Next >** \n7. Add **PostgreSQL** as the custom log Name (the '_CL' suffix will be added automatically) and click **Done**."
      },
      {
        "title": "Validate connectivity",
        "description": "It may take upwards of 20 minutes until your logs start to appear in Microsoft Sentinel."
      }
    ],
    "metadata": {
      "id": "046d5618-89c8-4441-a680-0e839970dcd2",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "PostgreSQL"
      },
      "support": {
        "name": "PostgreSQL",
        "link": "https://www.postgresql.org/support/",
        "tier": "developer"
      }
    }
  },
  {
    "id": "PrancerLogData",
    "title": "Prancer Data Connector",
    "publisher": "Prancer",
    "descriptionMarkdown": "The Prancer Data Connector has provides the capability to ingest Prancer (CSPM)[https://docs.prancer.io/web/CSPM/] and [PAC](https://docs.prancer.io/web/PAC/introduction/) data to process through Microsoft Sentinel. Refer to [Prancer Documentation](https://docs.prancer.io/web) for more information.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Prancer",
        "baseQuery": "prancer_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "High Severity Alerts",
        "query": "prancer_CL\n| where severity_s == 'High'"
      }
    ],
    "dataTypes": [
      {
        "name": "prancer_CL",
        "lastDataReceivedQuery": "prancer_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "prancer_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Include custom pre-requisites if the connectivity requires - else delete customs",
          "description": "Description for any custom pre-requisite"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Prancer REST API to pull logs into Microsoft sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": "STEP 1: Follow the documentation on the [Prancer Documentation Site](https://docs.prancer.io/web/) in order to set up an scan with an azure cloud connector."
      },
      {
        "title": "",
        "description": "STEP 2: Once the scan is created go to the 'Third Part Integrations' menu for the scan and select Sentinel."
      },
      {
        "title": "",
        "description": "STEP 3: Create follow the configuration wizard to select where in Azure the results should be sent to."
      },
      {
        "title": "",
        "description": "STEP 4: Data should start to get fed into Microsoft Sentinel for processing."
      }
    ],
    "metadata": {
      "id": "b2f8efcc-185e-42d9-9de0-58b1d678de41",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution"
      },
      "author": {
        "name": "Prancer"
      },
      "support": {
        "tier": "Partner",
        "name": "Prancer",
        "email": "support@prancer.io"
      }
    }
  },
  {
    "id": "PremiumMicrosoftDefenderForThreatIntelligence",
    "title": "Premium Microsoft Defender Threat Intelligence",
    "publisher": "Microsoft",
    "logo": {
      "type": 258,
      "options": null
    },
    "descriptionMarkdown": "Microsoft Sentinel provides you the capability to import threat intelligence generated by Microsoft to enable monitoring, alerting and hunting. Use this data connector to import Indicators of Compromise (IOCs) from Premium Microsoft Defender Threat Intelligence (MDTI) into Microsoft Sentinel. Threat indicators can include IP addresses, domains, URLs, and file hashes, etc. Note: This is a paid connector. To use and ingest data from it, please purchase the \"MDTI API Access\" SKU from the Partner Center.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ThreatIntelIndicators",
        "baseQuery": "ThreatIntelIndicators\n                      | where SourceSystem == \"Premium Microsoft Defender Threat Intelligence\""
      },
      {
        "metricName": "Total data received",
        "legend": "ThreatIntelObjects",
        "baseQuery": "ThreatIntelObjects\n                      | where SourceSystem == \"Premium Microsoft Defender Threat Intelligence\""
      }
    ],
    "sampleQueries": [
      {
        "description": "Summarize by threat type",
        "query": "ThreatIntelIndicators\n| where ExpirationDateTime > now()\n| where SourceSystem == \"Premium Microsoft Defender Threat Intelligence\"\n| where ExpirationDateTime > now()\n| join ( SigninLogs ) on $left.NetworkIP == $right.IPAddress | summarize count() by ThreatType"
      },
      {
        "description": "Summarize by 1 hour bins",
        "query": "ThreatIntelIndicators\n| where SourceSystem == \"Premium Microsoft Defender Threat Intelligence\"\n| where TimeGenerated >= ago(1d) | summarize count()"
      },
      {
        "description": "Summarize by threat type",
        "query": "ThreatIntelObjects\n| where ExpirationDateTime > now()\n| where SourceSystem == \"Premium Microsoft Defender Threat Intelligence\"\n| where ExpirationDateTime > now()\n| join ( SigninLogs ) on $left.NetworkIP == $right.IPAddress | summarize count() by ThreatType"
      },
      {
        "description": "Summarize by 1 hour bins",
        "query": "ThreatIntelObjects\n| where SourceSystem == \"Premium Microsoft Defender Threat Intelligence\"\n| where TimeGenerated >= ago(1d) | summarize count()"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "SentinelKinds",
        "value": [
          "PremiumMicrosoftDefenderForThreatIntelligence"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "ThreatIntelIndicators",
        "lastDataReceivedQuery": "ThreatIntelIndicators \n                | where SourceSystem == \"Premium Microsoft Defender Threat Intelligence\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ThreatIntelObjects",
        "lastDataReceivedQuery": "ThreatIntelObjects \n                | where SourceSystem == \"Premium Microsoft Defender Threat Intelligence\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 2,
      "isPreview": false,
      "featureFlag": {
        "feature": "premiummdticonnector",
        "featureStates": {
          "1": 3,
          "2": 3,
          "3": 3,
          "4": 3,
          "5": 3,
          "6": 0,
          "7": 1,
          "8": 1
        }
      }
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Use this data connector to import Indicators of Compromise (IOCs) from Premium Microsoft Defender Threat Intelligence (MDTI) into Microsoft Sentinel."
      },
      {
        "instructions": [
          {
            "type": "PremiumMicrosoftDefenderForThreatIntelligence",
            "parameters": {
              "connectorKind": "PremiumMicrosoftDefenderForThreatIntelligence"
            }
          }
        ]
      }
    ]
  },
  {
    "id": "PremiumMicrosoftDefenderForThreatIntelligence",
    "title": "Premium Microsoft Defender Threat Intelligence",
    "publisher": "Microsoft",
    "logo": {
      "type": 258,
      "options": null
    },
    "descriptionMarkdown": "Microsoft Sentinel provides you the capability to import threat intelligence generated by Microsoft to enable monitoring, alerting and hunting. Use this data connector to import Indicators of Compromise (IOCs) from Premium Microsoft Defender Threat Intelligence (MDTI) into Microsoft Sentinel. Threat indicators can include IP addresses, domains, URLs, and file hashes, etc. Note: This is a paid connector. To use and ingest data from it, please purchase the \"MDTI API Access\" SKU from the Partner Center.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ThreatIntelligenceIndicator",
        "baseQuery": "ThreatIntelligenceIndicator\n                      | where SourceSystem == \"Premium Microsoft Defender Threat Intelligence\""
      }
    ],
    "sampleQueries": [
      {
        "description": "Summarize by threat type",
        "query": "ThreatIntelligenceIndicator\n| where ExpirationDateTime > now()\n| where SourceSystem == \"Premium Microsoft Defender Threat Intelligence\"\n| where ExpirationDateTime > now()\n| join ( SigninLogs ) on $left.NetworkIP == $right.IPAddress | summarize count() by ThreatType"
      },
      {
        "description": "Summarize by 1 hour bins",
        "query": "ThreatIntelligenceIndicator\n| where SourceSystem == \"Premium Microsoft Defender Threat Intelligence\"\n| where TimeGenerated >= ago(1d) | summarize count()"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "SentinelKinds",
        "value": [
          "PremiumMicrosoftDefenderForThreatIntelligence"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "ThreatIntelligenceIndicator",
        "lastDataReceivedQuery": "ThreatIntelligenceIndicator \n                | where SourceSystem == \"Premium Microsoft Defender Threat Intelligence\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 2,
      "isPreview": false,
      "featureFlag": {
        "feature": "premiummdticonnector",
        "featureStates": {
          "1": 3,
          "2": 3,
          "3": 3,
          "4": 3,
          "5": 3,
          "6": 0,
          "7": 1,
          "8": 1
        }
      }
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Use this data connector to import Indicators of Compromise (IOCs) from Premium Microsoft Defender Threat Intelligence (MDTI) into Microsoft Sentinel."
      },
      {
        "instructions": [
          {
            "type": "PremiumMicrosoftDefenderForThreatIntelligence",
            "parameters": {
              "connectorKind": "PremiumMicrosoftDefenderForThreatIntelligence"
            }
          }
        ]
      }
    ]
  },
  {
    "id": "PrismaCloudComputeNativePoller",
    "title": "Palo Alto Prisma Cloud CWPP (using REST API)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The [Palo Alto Prisma Cloud CWPP](https://prisma.pan.dev/api/cloud/cwpp/audits/#operation/get-audits-incidents) data connector allows you to connect to your Prisma Cloud CWPP instance and ingesting alerts into Microsoft Sentinel. The data connector is built on Microsoft Sentinels Codeless Connector Platform and uses the Prisma Cloud API to fetch security events and supports DCR-based [ingestion time transformations](https://docs.microsoft.com/azure/azure-monitor/logs/custom-logs-overview) that parses the received security event data into a custom columns so that queries don't need to parse it again, thus resulting in better performance.",
    "graphQueriesTableName": "PrismaCloudCompute_CL",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "Prisma Compute Events",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of Prisma Compute Events",
        "query": "{{graphQueriesTableName}}\n | take 10"
      },
      {
        "description": "Total Events by Event Type",
        "query": "{{graphQueriesTableName}}\n | summarize count() by EventOriginalType"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n   | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriteria": [
      {
        "type": "HasDataConnectors"
      }
    ],
    "availability": {
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "Read and Write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "Read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key)",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "PrismaCloudCompute API Key",
          "description": "A Palo Alto Prisma Cloud CWPP Monitor API username and password is required. [See the documentation to learn more about PrismaCloudCompute SIEM API](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Palo%20Alto%20Prisma%20Cloud%20CWPP/Data%20Connectors/readme.md)."
        }
      ]
    },
    "instructionSteps": [
      {
        "description": "To enable the Palo Alto Prisma Cloud CWPP Security Events for Microsoft Sentinel, provide the required information below and click on Connect.\n>",
        "instructions": [
          {
            "type": "Textbox",
            "parameters": {
              "label": "Path to console",
              "placeholder": "https://europe-west3.cloud.twistlock.com/{sasid}",
              "type": "text",
              "name": "domainname"
            }
          },
          {
            "type": "Textbox",
            "parameters": {
              "label": "Prisma Access Key (API)",
              "placeholder": "Prisma Access Key (API)",
              "type": "text",
              "name": "username"
            }
          },
          {
            "type": "Textbox",
            "parameters": {
              "label": "Secret",
              "placeholder": "Secret",
              "type": "password",
              "name": "password"
            }
          },
          {
            "parameters": {
              "label": "toggle",
              "name": "toggle"
            },
            "type": "ConnectionToggleButton"
          }
        ],
        "title": "Connect Palo Alto Prisma Cloud CWPP Security Events to Microsoft Sentinel"
      }
    ]
  },
  {
    "id": "ProofpointCCPDefinition",
    "title": "Proofpoint On Demand Email Security (via Codeless Connector Platform)",
    "publisher": "Proofpoint",
    "descriptionMarkdown": "Proofpoint On Demand Email Security data connector provides the capability to get Proofpoint on Demand Email Protection data, allows users to check message traceability, monitoring into email activity, threats,and data exfiltration by attackers and malicious insiders. The connector provides ability to review events in your org on an accelerated basis, get event log files in hourly increments for recent activity.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ProofpointPODMailLog_CL",
        "baseQuery": "ProofpointPODMailLog_CL"
      },
      {
        "metricName": "Total data received",
        "legend": "ProofpointPODMessage_CL",
        "baseQuery": "ProofpointPODMessage_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Last ProofpointPOD message Events",
        "query": "ProofpointPODMessage_CL\n | where EventType == 'message'\n | sort by TimeGenerated desc"
      },
      {
        "description": "Last ProofpointPOD maillog Events",
        "query": "ProofpointPODMailLog_CL\n | where EventType == 'maillog'\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "ProofpointPODMailLog_CL",
        "lastDataReceivedQuery": "ProofpointPODMailLog_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ProofpointPODMessage_CL",
        "lastDataReceivedQuery": "ProofpointPODMessage_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "ProofpointPOD",
    "title": "[Deprecated] Proofpoint On Demand Email Security",
    "publisher": "Proofpoint",
    "descriptionMarkdown": "Proofpoint On Demand Email Security data connector provides the capability to get Proofpoint on Demand Email Protection data, allows users to check message traceability, monitoring into email activity, threats,and data exfiltration by attackers and malicious insiders. The connector provides ability to review events in your org on an accelerated basis, get event log files in hourly increments for recent activity.<p><span style='color:red; font-weight:bold;'>NOTE</span>: This data connector has been deprecated, consider moving to the CCP data connector available in the solution which replaces ingestion via the <a href='https://learn.microsoft.com/en-us/azure/azure-monitor/logs/custom-logs-migrate' style='color:#1890F1;'>deprecated HTTP Data Collector API</a>.</p>",
    "additionalRequirementBanner": "These queries and workbooks are dependent on a parser based on Kusto to work as expected. Follow the steps to use this Kusto functions alias **ProofpointPOD** in queries and workbooks [Follow steps to get this Kusto functions>](https://aka.ms/sentinel-proofpointpod-parser)",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ProofpointPOD_message_CL",
        "baseQuery": "ProofpointPOD_message_CL"
      },
      {
        "metricName": "Total data received",
        "legend": "ProofpointPOD_maillog_CL",
        "baseQuery": "ProofpointPOD_maillog_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Last ProofpointPOD message Events",
        "query": "ProofpointPOD\n | where EventType == 'message'\n | sort by TimeGenerated desc"
      },
      {
        "description": "Last ProofpointPOD maillog Events",
        "query": "ProofpointPOD\n | where EventType == 'maillog'\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "ProofpointPOD_message_CL",
        "lastDataReceivedQuery": "ProofpointPOD_message_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ProofpointPOD_maillog_CL",
        "lastDataReceivedQuery": "ProofpointPOD_maillog_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ProofpointPOD_message_CL\n      | union ProofpointPOD_maillog_CL \n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Websocket API Credentials/permissions",
          "description": "**ProofpointClusterID**, **ProofpointToken** is required. [See the documentation to learn more about API](https://proofpointcommunities.force.com/community/s/article/Proofpoint-on-Demand-Pod-Log-API)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Proofpoint Websocket API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "description": ">This data connector depends on a parser based on a Kusto Function to work as expected. [Follow these steps](https://aka.ms/sentinel-proofpointpod-parser) to create the Kusto functions alias, **ProofpointPOD**"
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the Proofpoint Websocket API**\n\n1. Proofpoint Websocket API service requires Remote Syslog Forwarding license. Please refer the [documentation](https://proofpointcommunities.force.com/community/s/article/Proofpoint-on-Demand-Pod-Log-API) on how to enable and check PoD Log API. \n2. You must provide your cluster id and security token."
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Proofpoint On Demand Email Security data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following), as well as the Proofpoint POD Log API credentials, readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the Proofpoint On Demand Email Security data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-proofpointpod-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace ID**, **Workspace Key**, **ProofpointClusterID**, **ProofpointToken** and deploy. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the Proofpoint On Demand Email Security data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> NOTE:You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-proofpointpod-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. ProofpointXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.11.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tProofpointClusterID\n\t\tProofpointToken\n\t\tWorkspaceID\n\t\tWorkspaceKey\n\t\tlogAnalyticsUri (optional)\n - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n3. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "ProofpointTAP",
    "title": "[Deprecated] Proofpoint TAP",
    "publisher": "Proofpoint",
    "descriptionMarkdown": "The [Proofpoint Targeted Attack Protection (TAP)](https://www.proofpoint.com/us/products/advanced-threat-protection/targeted-attack-protection) connector provides the capability to ingest Proofpoint TAP logs and events into Microsoft Sentinel. The connector provides visibility into Message and Click events in Microsoft Sentinel to view dashboards, create custom alerts, and to improve monitoring and investigation capabilities.<p><span style='color:red; font-weight:bold;'>NOTE</span>: This data connector has been deprecated, consider moving to the CCP data connector available in the solution which replaces ingestion via the <a href='https://learn.microsoft.com/en-us/azure/azure-monitor/logs/custom-logs-migrate' style='color:#1890F1;'>deprecated HTTP Data Collector API</a>.</p>",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Proofpoint TAP Messages Delivered",
        "baseQuery": "ProofPointTAPMessagesDelivered_CL"
      },
      {
        "metricName": "Total data received",
        "legend": "Proofpoint TAP Messages Blocked",
        "baseQuery": "ProofPointTAPMessagesBlocked_CL"
      },
      {
        "metricName": "Total data received",
        "legend": "Proofpoint TAP Clicks Permitted",
        "baseQuery": "ProofPointTAPClicksPermitted_CL"
      },
      {
        "metricName": "Total data received",
        "legend": "Proofpoint TAP Clicks Blocked",
        "baseQuery": "ProofPointTAPClicksBlocked_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Malware click events permitted",
        "query": "ProofPointTAPClicksPermitted_CL\n | where classification_s == \"malware\" \n | take 10"
      },
      {
        "description": "Phishing click events blocked",
        "query": "ProofPointTAPClicksBlocked_CL\n | where classification_s == \"phish\" \n | take 10"
      },
      {
        "description": "Malware messages events delivered",
        "query": "ProofPointTAPMessagesDelivered_CL\n | mv-expand todynamic(threatsInfoMap_s)\n | extend classification = tostring(threatsInfoMap_s.classification)\n | where classification == \"malware\" \n | take 10"
      },
      {
        "description": "Phishing message events blocked",
        "query": "ProofPointTAPMessagesBlocked_CL\n | mv-expand todynamic(threatsInfoMap_s)\n | extend classification = tostring(threatsInfoMap_s.classification)\n | where classification == \"phish\""
      }
    ],
    "dataTypes": [
      {
        "name": "ProofPointTAPClicksPermitted_CL",
        "lastDataReceivedQuery": "ProofPointTAPClicksPermitted_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ProofPointTAPClicksBlocked_CL",
        "lastDataReceivedQuery": "ProofPointTAPClicksBlocked_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ProofPointTAPMessagesDelivered_CL",
        "lastDataReceivedQuery": "ProofPointTAPMessagesDelivered_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ProofPointTAPMessagesBlocked_CL",
        "lastDataReceivedQuery": "ProofPointTAPMessagesBlocked_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ProofPointTAPMessagesDelivered_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "ProofPointTAPMessagesBlocked_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "ProofPointTAPClicksPermitted_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "ProofPointTAPMessagesBlocked_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Proofpoint TAP API Key",
          "description": "A Proofpoint TAP API username and password is required. [See the documentation to learn more about Proofpoint SIEM API](https://help.proofpoint.com/Threat_Insight_Dashboard/API_Documentation/SIEM_API)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to Proofpoint TAP to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the Proofpoint TAP API**\n\n1. Log into the Proofpoint TAP console \n2. Navigate to **Connect Applications** and select **Service Principal**\n3. Create a **Service Principal** (API Authorization Key)"
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Proofpoint TAP connector, have the Workspace ID and Workspace Primary Key (can be copied from the following), as well as the Proofpoint TAP API Authorization Key(s), readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Option 1 - Azure Resource Manager (ARM) Template",
                  "description": "Use this method for automated deployment of the Proofpoint TAP connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinelproofpointtapazuredeploy) [![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://aka.ms/sentinelproofpointtapazuredeploy-gov)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace ID**, **Workspace Key**, **API Username**, **API Password**, and validate the **Uri**.\n> - The default URI is pulling data for the last 300 seconds (5 minutes) to correspond with the default Function App Timer trigger of 5 minutes. If the time interval needs to be modified, it is recommended to change the Function App Timer Trigger accordingly (in the function.json file, post deployment) to prevent overlapping data ingestion. \n> - Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
                },
                {
                  "title": "Option 2 - Manual Deployment of Azure Functions",
                  "description": "This method provides the step-by-step instructions to deploy the Proofpoint TAP connector manually with Azure Function (Deployment via Visual Studio Code).",
                  "instructions": [
                    {
                      "parameters": {
                        "instructionSteps": [
                          {
                            "title": "Step 1 - Deploy a Function App",
                            "description": "1. Download the [Azure Function App](https://aka.ms/sentinelproofpointtapazurefunctionzip) file. Extract archive to your local development computer.\n2. Follow the [function app manual deployment instructions](https://github.com/Azure/Azure-Sentinel/blob/master/DataConnectors/AzureFunctionsManualDeployment.md#function-app-manual-deployment-instructions) to deploy the Azure Functions app using VSCode.\n3. After successful deployment of the function app, follow next steps for configuring it."
                          },
                          {
                            "title": "Step 2 - Configure the Function App",
                            "description": "1. Go to Azure Portal for the Function App configuration.\n2. In the Function App, select the Function App Name and select **Configuration**.\n3. In the **Application settings** tab, select **+ New application setting**.\n4. Add each of the following six (6) application settings individually, with their respective string values (case-sensitive): \n\t\tapiUsername\n\t\tapipassword\n\t\tworkspaceID\n\t\tworkspaceKey\n\t\turi\n\t\tlogAnalyticsUri (optional)\n> - Set the `uri` value to: `https://tap-api-v2.proofpoint.com/v2/siem/all?format=json&sinceSeconds=300`\n> - The default URI is pulling data for the last 300 seconds (5 minutes) to correspond with the default Function App Timer trigger of 5 minutes. If the time interval needs to be modified, it is recommended to change the Function App Timer Trigger accordingly to prevent overlapping data ingestion.\n> - Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details.\n> - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`\n5. Once all application settings have been entered, click **Save**."
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "ProofpointTAPv2",
    "title": "Proofpoint TAP (via Codeless Connector Platform)",
    "publisher": "Proofpoint",
    "descriptionMarkdown": "The [Proofpoint Targeted Attack Protection (TAP)](https://www.proofpoint.com/us/products/advanced-threat-protection/targeted-attack-protection) connector provides the capability to ingest Proofpoint TAP logs and events into Microsoft Sentinel. The connector provides visibility into Message and Click events in Microsoft Sentinel to view dashboards, create custom alerts, and to improve monitoring and investigation capabilities.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Proofpoint TAP Messages Delivered",
        "baseQuery": "ProofPointTAPMessagesDeliveredV2_CL"
      },
      {
        "metricName": "Total data received",
        "legend": "Proofpoint TAP Messages Blocked",
        "baseQuery": "ProofPointTAPMessagesBlockedV2_CL"
      },
      {
        "metricName": "Total data received",
        "legend": "Proofpoint TAP Clicks Permitted",
        "baseQuery": "ProofPointTAPClicksPermittedV2_CL"
      },
      {
        "metricName": "Total data received",
        "legend": "Proofpoint TAP Clicks Blocked",
        "baseQuery": "ProofPointTAPClicksBlockedV2_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Malware click events permitted",
        "query": "ProofPointTAPClicksPermittedV2_CL\n | where classification_s == \"malware\" \n | take 10"
      },
      {
        "description": "Phishing click events blocked",
        "query": "ProofPointTAPClicksBlockedV2_CL\n | where classification_s == \"phish\" \n | take 10"
      },
      {
        "description": "Malware messages events delivered",
        "query": "ProofPointTAPMessagesDeliveredV2_CL\n | mv-expand todynamic(threatsInfoMap_s)\n | extend classification = tostring(threatsInfoMap_s.classification)\n | where classification == \"malware\" \n | take 10"
      },
      {
        "description": "Phishing message events blocked",
        "query": "ProofPointTAPMessagesBlockedV2_CL\n | mv-expand todynamic(threatsInfoMap_s)\n | extend classification = tostring(threatsInfoMap_s.classification)\n | where classification == \"phish\""
      }
    ],
    "dataTypes": [
      {
        "name": "ProofPointTAPClicksPermittedV2_CL",
        "lastDataReceivedQuery": "ProofPointTAPClicksPermittedV2_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ProofPointTAPClicksBlockedV2_CL",
        "lastDataReceivedQuery": "ProofPointTAPClicksBlockedV2_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ProofPointTAPMessagesDeliveredV2_CL",
        "lastDataReceivedQuery": "ProofPointTAPMessagesDeliveredV2_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ProofPointTAPMessagesBlockedV2_CL",
        "lastDataReceivedQuery": "ProofPointTAPMessagesBlockedV2_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "PulseConnectSecure",
    "title": "[Deprecated] Pulse Connect Secure",
    "publisher": "Pulse Secure",
    "descriptionMarkdown": "The [Pulse Connect Secure](https://www.pulsesecure.net/products/pulse-connect-secure/) connector allows you to easily connect your Pulse Connect Secure logs with Microsoft Sentinel, to view dashboards, create custom alerts, and improve investigations. Integrating Pulse Connect Secure with Microsoft Sentinel provides more insight into your organization's network and improves your security operation capabilities.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "PulseConnectSecure",
        "baseQuery": "PulseConnectSecure"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Failed Logins by User",
        "query": "PulseConnectSecure \n | where vpn_message startswith 'Login failed'\n | summarize count() by vpn_user \n | top 10 by count_ "
      },
      {
        "description": "Top 10 Failed Logins by IP Address",
        "query": "PulseConnectSecure \n | where vpn_message startswith 'Login failed'\n | summarize count() by client_ip \n | top 10 by count_  "
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog (PulseConnectSecure)",
        "lastDataReceivedQuery": "PulseConnectSecure\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "PulseConnectSecure\n            | where TimeGenerated > ago(3d)\n    |take 1\n        | project IsConnected = true"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "write permission is required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "Pulse Connect Secure",
          "description": "must be configured to export logs via Syslog"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias Pulse Connect Secure and load the function code or click [here](https://aka.ms/sentinel-PulseConnectSecure-parser), on the second line of the query, enter the hostname(s) of your Pulse Connect Secure device(s) and any other unique identifiers for the logstream. The function usually takes 10-15 minutes to activate after solution installation/update.",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux",
        "description": "Typically, you should install the agent on a different computer from the one on which the logs are generated.\n\n>  Syslog logs are collected only from **Linux** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Configure the facilities you want to collect and their severities.\n 1. Under workspace advanced settings **Configuration**, select **Data** and then **Syslog**.\n 2. Select **Apply below configuration to my machines** and select the facilities and severities.\n 3.  Click **Save**.",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenSyslogSettings"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "3. Configure and connect the Pulse Connect Secure",
        "description": "[Follow the instructions](https://help.ivanti.com/ps/help/en_US/PPS/9.1R13/ag/configuring_an_external_syslog_server.htm) to enable syslog streaming of Pulse Connect Secure logs. Use the IP address or hostname for the Linux device with the Linux agent installed as the Destination IP address."
      }
    ]
  },
  {
    "id": "QscoutAppEventsCCFDefinition",
    "title": "QscoutAppEventsConnector",
    "publisher": "Quokka",
    "descriptionMarkdown": "Ingest Qscout application events into Microsoft Sentinel",
    "graphQueries": [
      {
        "metricName": "Events received",
        "legend": "Data connector events",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "All event logs",
        "query": "{{graphQueriesTableName}} | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "QscoutAppEvents_CL",
        "lastDataReceivedQuery": "QscoutAppEvents_CL | summarize Time = max(TimeGenerated) \n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": null,
    "metadata": null
  },
  {
    "id": "QualysKB",
    "title": "Qualys VM KnowledgeBase",
    "publisher": "Qualys",
    "descriptionMarkdown": "The [Qualys Vulnerability Management (VM)](https://www.qualys.com/apps/vulnerability-management/) KnowledgeBase (KB) connector provides the capability to ingest the latest vulnerability data from the Qualys KB into Microsoft Sentinel. \n\n This data can used to correlate and enrich vulnerability detections found by the [Qualys Vulnerability Management (VM)](https://docs.microsoft.com/azure/sentinel/connect-qualys-vm) data connector.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "QualysKB_CL",
        "baseQuery": "QualysKB_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Vulnerabilities by Category",
        "query": "QualysKB\n | summarize count() by Category"
      },
      {
        "description": "Top 10 Software Vendors",
        "query": "QualysKB\n | summarize count() by SoftwareVendor \n| top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "QualysKB_CL",
        "lastDataReceivedQuery": "QualysKB_CL\n | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "QualysKB_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Qualys API Key",
          "description": "A Qualys VM API username and password is required. [See the documentation to learn more about Qualys VM API](https://www.qualys.com/docs/qualys-api-vmpc-user-guide.pdf)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias QualysVM Knowledgebase and load the function code or click [here](https://aka.ms/sentinel-crowdstrikefalconendpointprotection-parser), on the second line of the query, enter the hostname(s) of your QualysVM Knowledgebase device(s) and any other unique identifiers for the logstream. The function usually takes 10-15 minutes to activate after solution installation/update."
      },
      {
        "title": "",
        "description": ">This data connector depends on a parser based on a Kusto Function to work as expected. [Follow the steps](https://aka.ms/sentinel-qualyskb-parser) to use the Kusto function alias, **QualysKB**"
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the Qualys API**\n\n1. Log into the Qualys Vulnerability Management console with an administrator account, select the **Users** tab and the **Users** subtab. \n2. Click on the **New** drop-down menu and select **Users**.\n3. Create a username and password for the API account. \n4. In the **User Roles** tab, ensure the account role is set to **Manager** and access is allowed to **GUI** and **API**\n4. Log out of the administrator account and log into the console with the new API credentials for validation, then log out of the API account. \n5. Log back into the console using an administrator account and modify the API accounts User Roles, removing access to **GUI**. \n6. Save all changes."
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Qualys KB connector, have the Workspace ID and Workspace Primary Key (can be copied from the following), as well as the Qualys API username and password, readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Option 1 - Azure Resource Manager (ARM) Template",
                  "description": "Use this method for automated deployment of the Qualys KB connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-qualyskb-azuredeploy) [![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://aka.ms/sentinel-qualyskb-azuredeploy-gov)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace ID**, **Workspace Key**, **API Username**, **API Password** , update the **URI**, and any additional URI **Filter Parameters** (This value should include a \"&\" symbol between each parameter and should not include any spaces) \n> - Enter the URI that corresponds to your region. The complete list of API Server URLs can be [found here](https://www.qualys.com/docs/qualys-api-vmpc-user-guide.pdf#G4.735348)\n> - Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy.\n - Note: If deployment failed due to the storage account name being taken, change the **Function Name** to a unique value and redeploy."
                },
                {
                  "title": "Option 2 - Manual Deployment of Azure Functions",
                  "description": "This method provides the step-by-step instructions to deploy the Qualys KB connector manually with Azure Function.",
                  "instructions": [
                    {
                      "parameters": {
                        "instructionSteps": [
                          {
                            "title": "Step 1 - Deploy a Function App",
                            "description": "1. Download the [Azure Function App](https://aka.ms/sentinel-qualyskb-functioncode) file. Extract archive to your local development computer.\n2. Follow the [function app manual deployment instructions](https://github.com/Azure/Azure-Sentinel/blob/master/DataConnectors/AzureFunctionsManualDeployment.md#function-app-manual-deployment-instructions) to deploy the Azure Functions app using VSCode.\n3. After successful deployment of the function app, follow next steps for configuring it."
                          },
                          {
                            "title": "Step 2 - Configure the Function App",
                            "description": "1. Go to Azure Portal for the Function App configuration.\n2. In the Function App, select the Function App Name and select **Configuration**.\n3. In the **Application settings** tab, select **+ New application setting**.\n4. Add each of the following seven (7) application settings individually, with their respective string values (case-sensitive): \n\t\tapiUsername\n\t\tapiPassword\n\t\tworkspaceID\n\t\tworkspaceKey\n\t\turi\n\t\tfilterParameters\n\t\tlogAnalyticsUri (optional)\n> - Enter the URI that corresponds to your region. The complete list of API Server URLs can be [found here](https://www.qualys.com/docs/qualys-api-vmpc-user-guide.pdf#G4.735348). The `uri` value must follow the following schema: `https://<API Server>/api/2.0` \n> - Add any additional filter parameters, for the `filterParameters` variable, that need to be appended to the URI. The `filterParameter` value should include a \"&\" symbol between each parameter and should not include any spaces.\n> - Note: If using Azure Key Vault, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details.\n - Use logAnalyticsUri to override the log analytics API endpoint for delegated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n5. Once all application settings have been entered, click **Save**."
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "QualysVMLogsCCPDefinition",
    "title": "Qualys Vulnerability Management (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The [Qualys Vulnerability Management (VM)](https://www.qualys.com/apps/vulnerability-management/) data connector provides the capability to ingest vulnerability host detection data into Microsoft Sentinel through the Qualys API. The connector provides visibility into host detection data from vulerability scans.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "Qualys Host Detection Logs",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of Qualys Host Detection logs",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "QualysVulnerabilityManagement",
    "title": "[DEPRECATED] Qualys Vulnerability Management",
    "publisher": "Qualys",
    "descriptionMarkdown": "The [Qualys Vulnerability Management (VM)](https://www.qualys.com/apps/vulnerability-management/) data connector provides the capability to ingest vulnerability host detection data into Microsoft Sentinel through the Qualys API. The connector provides visibility into host detection data from vulerability scans. This connector provides Microsoft Sentinel the capability to view dashboards, create custom alerts, and improve investigation \n\n<p><span style='color:red; font-weight:bold;'>NOTE</span>: This data connector has been deprecated, consider moving to the CCF data connector available in the solution which replaces ingestion via the <a href='https://learn.microsoft.com/en-us/azure/azure-monitor/logs/custom-logs-migrate' style='color:#1890F1;'>deprecated HTTP Data Collector API</a>.</p>",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "QualysHostDetectionV2_CL",
        "baseQuery": "QualysHostDetectionV2_CL"
      },
      {
        "metricName": "Total data received",
        "legend": "QualysHostDetection_CL",
        "baseQuery": "QualysHostDetection_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Qualys V2 Vulerabilities detected",
        "query": "QualysHostDetectionV2_CL\n | extend Vulnerability = tostring(QID_s)\n | summarize count() by Vulnerability\n | top 10 by count_"
      },
      {
        "description": "Top 10 Vulerabilities detected",
        "query": "QualysHostDetection_CL\n | mv-expand todynamic(Detections_s)\n | extend Vulnerability = tostring(Detections_s.Results)\n | summarize count() by Vulnerability\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "QualysHostDetectionV2_CL",
        "lastDataReceivedQuery": "QualysHostDetectionV2_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "QualysHostDetection_CL",
        "lastDataReceivedQuery": "QualysHostDetection_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "QualysHostDetectionV2_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "QualysHostDetection_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Qualys API Key",
          "description": "A Qualys VM API username and password is required. [See the documentation to learn more about Qualys VM API](https://www.qualys.com/docs/qualys-api-vmpc-user-guide.pdf)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to Qualys VM to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the Qualys VM API**\n\n1. Log into the Qualys Vulnerability Management console with an administrator account, select the **Users** tab and the **Users** subtab. \n2. Click on the **New** drop-down menu and select **Users..**\n3. Create a username and password for the API account. \n4. In the **User Roles** tab, ensure the account role is set to **Manager** and access is allowed to **GUI** and **API**\n4. Log out of the administrator account and log into the console with the new API credentials for validation, then log out of the API account. \n5. Log back into the console using an administrator account and modify the API accounts User Roles, removing access to **GUI**. \n6. Save all changes."
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Qualys VM connector, have the Workspace ID and Workspace Primary Key (can be copied from the following), as well as the Qualys VM API Authorization Key(s), readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "",
        "description": ">**NOTE:** This connector has been updated, if you have previously deployed an earlier version, and want to update, please delete the existing Qualys VM Azure Function before redeploying this version. Please use Qualys V2 version Workbook, detections. "
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the Qualys VM connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-QualysVM-azuredeployV2) [![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://aka.ms/sentinel-QualysVM-azuredeployV2-gov)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace ID**, **Workspace Key**, **API Username**, **API Password** , update the **URI**, and any additional URI **Filter Parameters** (each filter should be separated by an \"&\" symbol, no spaces.) \n> - Enter the URI that corresponds to your region. The complete list of API Server URLs can be [found here](https://www.qualys.com/docs/qualys-api-vmpc-user-guide.pdf#G4.735348) -- There is no need to add a time suffix to the URI, the Function App will dynamically append the Time Value to the URI in the proper format. \n - The default **Time Interval** is set to pull the last five (5) minutes of data. If the time interval needs to be modified, it is recommended to change the Function App Timer Trigger accordingly (in the function.json file, post deployment) to prevent overlapping data ingestion. \n> - Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the Quayls VM connector manually with Azure Functions."
      },
      {
        "title": "",
        "description": "**1. Create a Function App**\n\n1.  From the Azure Portal, navigate to [Function App](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Web%2Fsites/kind/functionapp), and select **+ Add**.\n2. In the **Basics** tab, ensure Runtime stack is set to **Powershell Core**. \n3. In the **Hosting** tab, ensure the **Consumption (Serverless)** plan type is selected.\n4. Make other preferrable configuration changes, if needed, then click **Create**."
      },
      {
        "title": "",
        "description": "**2. Import Function App Code**\n\n1. In the newly created Function App, select **Functions** on the left pane and click **+ New Function**.\n2. Select **Timer Trigger**.\n3. Enter a unique Function **Name** and leave the default cron schedule of every 5 minutes, then click **Create**.\n5. Click on **Code + Test** on the left pane. \n6. Copy the [Function App Code](https://aka.ms/sentinel-QualysVM-functioncodeV2) and paste into the Function App `run.ps1` editor.\n7. Click **Save**."
      },
      {
        "title": "",
        "description": "**3. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following eight (8) application settings individually, with their respective string values (case-sensitive): \n\t\tapiUsername\n\t\tapiPassword\n\t\tworkspaceID\n\t\tworkspaceKey\n\t\turi\n\t\tfilterParameters\n\t\ttimeInterval\n\t\tlogAnalyticsUri (optional)\n> - Enter the URI that corresponds to your region. The complete list of API Server URLs can be [found here](https://www.qualys.com/docs/qualys-api-vmpc-user-guide.pdf#G4.735348). The `uri` value must follow the following schema: `https://<API Server>/api/2.0/fo/asset/host/vm/detection/?action=list&vm_processed_after=` -- There is no need to add a time suffix to the URI, the Function App will dynamically append the Time Value to the URI in the proper format.\n> - Add any additional filter parameters, for the `filterParameters` variable, that need to be appended to the URI. Each parameter should be seperated by an \"&\" symbol and should not include any spaces.\n> - Set the `timeInterval` (in minutes) to the value of `5` to correspond to the Timer Trigger of every `5` minutes. If the time interval needs to be modified, it is recommended to change the Function App Timer Trigger accordingly to prevent overlapping data ingestion.\n> - Note: If using Azure Key Vault, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details.\n> - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n4. Once all application settings have been entered, click **Save**."
      },
      {
        "title": "",
        "description": "**4. Configure the host.json**.\n\nDue to the potentially large amount of Qualys host detection data being ingested, it can cause the execution time to surpass the default Function App timeout of five (5) minutes. Increase the default timeout duration to the maximum of ten (10) minutes, under the Consumption Plan, to allow more time for the Function App to execute.\n\n1. In the Function App, select the Function App Name and select the **App Service Editor** blade.\n2. Click **Go** to open the editor, then select the **host.json** file under the **wwwroot** directory.\n3. Add the line `\"functionTimeout\": \"00:10:00\",` above the `managedDependancy` line \n4. Ensure **SAVED** appears on the top right corner of the editor, then exit the editor.\n\n> NOTE: If a longer timeout duration is required, consider upgrading to an [App Service Plan](https://docs.microsoft.com/azure/azure-functions/functions-scale#timeout)"
      }
    ],
    "metadata": {
      "id": "9118ddc8-ca2c-48d3-8b10-9b198bd1ab3e",
      "version": "2.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Qualys VM"
      },
      "support": {
        "tier": "developer",
        "name": "Qualys VM",
        "email": "support@qualys.com",
        "link": "https://www.qualys.com/support"
      }
    }
  },
  {
    "id": "RadiflowIsid",
    "title": "Radiflow iSID via AMA",
    "publisher": "Radiflow",
    "descriptionMarkdown": "iSID enables non-disruptive monitoring of distributed ICS networks for changes in topology and behavior, using multiple security packages, each offering a unique capability pertaining to a specific type of network activity",
    "additionalRequirementBanner": "This data connector depends on a parser based on Kusto Function to work as expected [**RadiflowEvent**] which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "RadiflowEvent",
        "baseQuery": "RadiflowEvent\n| where DeviceProduct =~ \"iSID\""
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 5 protocols by number of events",
        "query": "RadiflowEvent\n| where DeviceProduct =~ \"iSID\"\n| where isnotempty(Protocol)\n| summarize count() by Port, Protocol\n| project-keep count_, Port, Protocol\n| top 5 by Protocol"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (RadiflowEvent)",
        "lastDataReceivedQuery": "CommonSecurityLog\n| where DeviceProduct =~ \"iSID\"\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "RadiflowEvent\n| where DeviceProduct =~ \"iSID\"\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**RadiflowEvent**] which is deployed with the Microsoft Sentinel Solution.",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade.\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule).\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy._\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine.",
                  "instructions": []
                },
                {
                  "title": "Step B. Configure iSID to send logs using CEF",
                  "description": "Configure log forwarding using CEF:\n\n1. Navigate to the **System Notifications** section of the Configuration menu.\n\n2. Under Syslog, select **+Add**.\n\n3. In the **New Syslog Server** dialog specify the name, remote server **IP**, **Port**, **Transport** and select **Format** - **CEF**.\n\n4. Press **Apply** to exit the **Add Syslog dialog**.",
                  "instructions": []
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python --version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "RedCanaryDataConnector",
    "title": "Red Canary Threat Detection",
    "publisher": "Red Canary",
    "descriptionMarkdown": "The Red Canary data connector provides the capability to ingest published Detections into Microsoft Sentinel using the Data Collector REST API.",
    "graphQueries": [
      {
        "metricName": "Red Canary Detections",
        "legend": "RedCanaryDetections_CL",
        "baseQuery": "RedCanaryDetections_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Red Canary Detections",
        "query": "RedCanaryDetections_CL\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "RedCanaryDetections_CL",
        "lastDataReceivedQuery": "RedCanaryDetections_CL | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "RedCanaryDetections_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(90d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "Create an Automate Playbook and Trigger as detailed in [this article](https://help.redcanary.com/hc/en-us/articles/4410957523479-Azure-Sentinel). You can skip the **Add analysis rule to Microsoft Sentinel** section; this data connector allows you to import the analysis rule directly into your workspace.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ],
    "metadata": {
      "id": "9955c259-63ac-4f22-ba34-118f00e11230",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "Red Canary"
      },
      "author": {
        "name": "Red Canary"
      },
      "support": {
        "tier": "developer",
        "name": "Red Canary",
        "email": "",
        "link": "https://help.redcanary.com"
      }
    }
  },
  {
    "id": "RidgeBotDataConnector",
    "title": "[Deprecated] RIDGEBOT - data connector for Microsoft Sentinel",
    "publisher": "RidgeSecurity",
    "descriptionMarkdown": "The RidgeBot connector lets users connect RidgeBot with Microsoft Sentinel, allowing creation of Dashboards, Workbooks, Notebooks and Alerts.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "RidgeBot found vulnerabilities",
        "baseQuery": "CommonSecurityLog\n| where DeviceVendor == \"RidgeSecurity\" "
      }
    ],
    "sampleQueries": [
      {
        "description": "Lasted 10 Exploited Risks",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"RidgeSecurity\"\n| where DeviceEventClassID == \"4001\"\n | order by TimeGenerated desc \n| limit 10"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog",
        "lastDataReceivedQuery": "CommonSecurityLog\n| where DeviceVendor == \"RidgeSecurity\"\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n| where DeviceVendor == \"RidgeSecurity\"\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine"
                },
                {
                  "title": "Step B. Forward Common Event Format (CEF) logs to Syslog agent",
                  "description": "Configure the RidgeBot to forward events to syslog server as described here: https://portal.ridgesecurity.ai/downloadurl/89x72912. Generate some attack events for your application."
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "RSAIDPlus_AdmingLogs_Connector",
    "title": "RSA ID Plus Admin Logs Connector",
    "publisher": "RSA",
    "descriptionMarkdown": "The RSA ID Plus AdminLogs Connector provides the capability to ingest [Cloud Admin Console Audit Events](https://community.rsa.com/s/article/Cloud-Administration-Event-Log-API-5d22ba17) into Microsoft Sentinel using Cloud Admin APIs.",
    "graphQueries": [
      {
        "metricName": "Events Received",
        "legend": "RSA ID Plus Admin Activity Events Received",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "All RSA ID Plus Admin Activity Logs",
        "query": "{{graphQueriesTableName}}\n| sort by TimeGenerated desc"
      },
      {
        "description": "Total Events",
        "query": "{{graphQueriesTableName}}\n| summarize count() by eventId"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n| summarize Time = max(TimeGenerated)\n| where isnoempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": null,
    "metadata": null
  },
  {
    "id": "RSASecurIDAM",
    "title": "[Deprecated] RSA SecurID (Authentication Manager)",
    "publisher": "RSA",
    "descriptionMarkdown": "The [RSA SecurID Authentication Manager](https://www.securid.com/) data connector provides the capability to ingest [RSA SecurID Authentication Manager events](https://community.rsa.com/t5/rsa-authentication-manager/rsa-authentication-manager-log-messages/ta-p/630160) into Microsoft Sentinel. Refer to [RSA SecurID Authentication Manager documentation](https://community.rsa.com/t5/rsa-authentication-manager/getting-started-with-rsa-authentication-manager/ta-p/569582) for more information.",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected [**RSASecurIDAMEvent**](https://aka.ms/sentinel-rsasecuridam-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "RSASecurIDAM",
        "baseQuery": "RSASecurIDAMEvent"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Sources",
        "query": "RSASecurIDAMEvent\n | summarize count() by tostring(DvcHostname)\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog (RSASecurIDAMEvent)",
        "lastDataReceivedQuery": "RSASecurIDAMEvent\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "RSASecurIDAMEvent\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(3d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**RSASecurIDAMEvent**](https://aka.ms/sentinel-rsasecuridam-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "",
        "description": ">**NOTE:** This data connector has been developed using RSA SecurID Authentication Manager version: 8.4 and 8.5",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux or Windows",
        "description": "Install the agent on the Server where the RSA SecurID Authentication Manager logs are forwarded.\n\n> Logs from RSA SecurID Authentication Manager Server deployed on Linux or Windows servers are collected by **Linux** or **Windows** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Linux agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Windows agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Windows Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Windows Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure RSA SecurID Authentication Manager event forwarding",
        "description": "Follow the configuration steps below to get RSA SecurID Authentication Manager logs into Microsoft Sentinel.\n1. [Follow these instructions](https://community.rsa.com/t5/rsa-authentication-manager/configure-the-remote-syslog-host-for-real-time-log-monitoring/ta-p/571374) to forward alerts from the Manager to a syslog server."
      }
    ]
  },
  {
    "id": "RubrikSecurityCloudAzureFunctions",
    "title": "Rubrik Security Cloud data connector",
    "publisher": "Rubrik, Inc",
    "descriptionMarkdown": "The Rubrik Security Cloud data connector enables security operations teams to integrate insights from Rubrik's Data Observability services into Microsoft Sentinel. The insights include identification of anomalous filesystem behavior associated with ransomware and mass deletion, assess the blast radius of a ransomware attack, and sensitive data operators to prioritize and more rapidly investigate potential incidents.",
    "graphQueries": [
      {
        "metricName": "Total Anomaly Event data received",
        "legend": "Rubrik_Anomaly_Data_CL",
        "baseQuery": "Rubrik_Anomaly_Data_CL"
      },
      {
        "metricName": "Total Ransomware Event data received",
        "legend": "Rubrik_Ransomware_Data_CL",
        "baseQuery": "Rubrik_Ransomware_Data_CL"
      },
      {
        "metricName": "Total ThreatHunt Event data received",
        "legend": "Rubrik_ThreatHunt_Data_CL",
        "baseQuery": "Rubrik_ThreatHunt_Data_CL"
      },
      {
        "metricName": "Total Other Events data received",
        "legend": "Rubrik_Events_Data_CL",
        "baseQuery": "Rubrik_Events_Data_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Rubrik Anomaly Events - Anomaly Events for all severity types.",
        "query": "Rubrik_Anomaly_Data_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Rubrik Ransomware Analysis Events - Ransomware Analysis Events for all severity types.",
        "query": "Rubrik_Ransomware_Data_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Rubrik ThreatHunt Events - Threat Hunt Events for all severity types.",
        "query": "Rubrik_ThreatHunt_Data_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Rubrik Other Events - Other Events for all severity types.",
        "query": "Rubrik_Events_Data_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Rubrik_Anomaly_Data_CL",
        "lastDataReceivedQuery": "Rubrik_Anomaly_Data_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Rubrik_Ransomware_Data_CL",
        "lastDataReceivedQuery": "Rubrik_Ransomware_Data_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Rubrik_ThreatHunt_Data_CL",
        "lastDataReceivedQuery": "Rubrik_ThreatHunt_Data_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Rubrik_Events_Data_CL",
        "lastDataReceivedQuery": "Rubrik_Events_Data_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Rubrik_Anomaly_Data_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Rubrik_Ransomware_Data_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Rubrik_ThreatHunt_Data_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Rubrik_Events_Data_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Rubrik webhook which push its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Rubrik Microsoft Sentinel data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following) readily available..",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the Rubrik connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-RubrikWebhookEvents-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the below information : \n\t\tFunction Name \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tAnomaliesTableName \n\t\tRansomwareAnalysisTableName \n\t\tThreatHuntsTableName \n\t\tEventsTableName \n\t\tLogLevel \n \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the Rubrik Microsoft Sentinel data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-RubrikWebhookEvents-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. RubrikXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.8 or above.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following application settings individually, with their respective values (case-sensitive): \n\t\tWorkspaceID\n\t\tWorkspaceKey\n\t\tAnomaliesTableName\n\t\tRansomwareAnalysisTableName\n\t\tThreatHuntsTableName\n\t\tEventsTableName\n\t\tLogLevel\n\t\tlogAnalyticsUri (optional)\n - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: https://<CustomerId>.ods.opinsights.azure.us. \n4. Once all application settings have been entered, click **Save**."
      },
      {
        "title": "",
        "description": "**Post Deployment steps**\n\n"
      },
      {
        "title": "1) Get the Function app endpoint",
        "description": "1. Go to Azure function Overview page and Click on **\"Functions\"** tab.\n2. Click on the function called **\"RubrikHttpStarter\"**.\n3. Go to **\"GetFunctionurl\"** and copy the function url."
      },
      {
        "title": "2) Add a webhook in RubrikSecurityCloud to send data to Microsoft Sentinel.",
        "description": "Follow the Rubrik User Guide instructions to [Add a Webhook](https://docs.rubrik.com/en-us/saas/saas/common/adding_webhook.html) to begin receiving event information  \n 1. Select the Microsoft Sentinel as the webhook Provider \n 2. Enter the desired Webhook name \n 3. Enter the URL part from copied Function-url as the webhook URL endpoint and replace **{functionname}**  with **\"RubrikAnomalyOrchestrator\"**, for the Rubrik Microsoft Sentinel Solution \n 4. Select the EventType as Anomaly \n 5. Select the following severity levels: Critical, Warning, Informational \n 6. Choose multiple log types, if desired, when running **\"RubrikEventsOrchestrator\"** \n 7. Repeat the same steps to add webhooks for Anomaly Detection Analysis, Threat Hunt and Other Events.\n   \n\n NOTE: while adding webhooks for Anomaly Detection Analysis, Threat Hunt and Other Events, replace **{functionname}**  with **\"RubrikRansomwareOrchestrator\"**, **\"RubrikThreatHuntOrchestrator\"** and **\"RubrikEventsOrchestrator\"** respectively in copied function-url."
      },
      {
        "title": "",
        "description": "*Now we are done with the rubrik Webhook configuration. Once the webhook events triggered , you should be able to see the Anomaly, Anomaly Detection Analysis, Threat Hunt events and Other Events from the Rubrik into respective LogAnalytics workspace table called \"Rubrik_Anomaly_Data_CL\", \"Rubrik_Ransomware_Data_CL\", \"Rubrik_ThreatHunt_Data_CL\", and \"Rubrik_Events_Data_CL\".*\n\n"
      }
    ]
  },
  {
    "id": "SailPointIdentityNow",
    "title": "SailPoint IdentityNow",
    "publisher": "SailPoint",
    "descriptionMarkdown": "The [SailPoint](https://www.sailpoint.com/) IdentityNow data connector provides the capability to ingest [SailPoint IdentityNow] search events into Microsoft Sentinel through the REST API. The connector provides customers the ability to extract audit information from their IdentityNow tenant. It is intended to make it even easier to bring IdentityNow user activity and governance events into Microsoft Sentinel to improve insights from your security incident and event monitoring solution.",
    "graphQueries": [
      {
        "metricName": "SailPointIDN_Events logs",
        "legend": "SailPointIDN_Events_CL",
        "baseQuery": "SailPointIDN_Events_CL"
      },
      {
        "metricName": "SailPointIDN_Triggers logs",
        "legend": "SailPointIDN_Triggers_CL",
        "baseQuery": "SailPointIDN_Triggers_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "SailPointIDN Search Events - All Events",
        "query": "SailPointIDN_Events_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "SailPointIDN Triggers - All Triggers",
        "query": "SailPointIDN_Triggers_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "SailPointIDN_Events_CL",
        "lastDataReceivedQuery": "SailPointIDN_Events_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "SailPointIDN_Triggers_CL",
        "lastDataReceivedQuery": "SailPointIDN_Events_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "SailPointIDN_Events_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "SailPoint IdentityNow API Authentication Credentials",
          "description": "TENANT_ID, CLIENT_ID and CLIENT_SECRET are required for authentication."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the SailPoint IdentityNow REST API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the SailPoint IdentityNow API**\n\n [Follow the instructions](https://community.sailpoint.com/t5/IdentityNow-Articles/Best-Practice-Using-Personal-Access-Tokens-in-IdentityNow/ta-p/150471) to obtain the credentials. \n"
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the SailPoint IdentityNow data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following).",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the SailPoint IdentityNow data connector using an ARM Template.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-sailpointidentitynow-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n> **NOTE:** Within the same resource group, you can't mix Windows and Linux apps in the same region. Select existing resource group without Windows apps in it or create new resource group.\n3. Enter other information and deploy. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the SailPoint IdentityNow data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-sailpointidentitynow-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. searcheventXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.9.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select ** New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tTENANT_ID\n\t\tSHARED_KEY\n\t\tLIMIT\n\t\tGRANT_TYPE\n\t\tCUSTOMER_ID\n\t\tCLIENT_ID\n\t\tCLIENT_SECRET\n\t\tAZURE_STORAGE_ACCESS_KEY\n\t\tAZURE_STORAGE_ACCOUNT_NAME\n\t\tAzureWebJobsStorage\n\t\tlogAnalyticsUri (optional)\n> - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n3. Once all application settings have been entered, click **Save**."
      }
    ],
    "metadata": {
      "id": "43066e76-ae15-4df2-b4ef-83b629f56823",
      "version": "1.0.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "SailPoint"
      },
      "support": {
        "tier": "developer",
        "name": "SailPoint",
        "email": "support.idplusa@sailpoint.com "
      }
    }
  },
  {
    "id": "SalesforceServiceCloud",
    "title": "[DEPRECATED] Salesforce Service Cloud",
    "publisher": "Salesforce",
    "descriptionMarkdown": "The Salesforce Service Cloud data connector provides the capability to ingest information about your Salesforce operational events into Microsoft Sentinel through the REST API. The connector provides ability to review events in your org on an accelerated basis, get [event log files](https://developer.salesforce.com/docs/atlas.en-us.api_rest.meta/api_rest/event_log_file_hourly_overview.htm) in hourly increments for recent activity.\n\n<p><span style='color:red; font-weight:bold;'>NOTE</span>: This data connector has been deprecated, consider moving to the CCF data connector available in the solution which replaces ingestion via the <a href='https://learn.microsoft.com/en-us/azure/azure-monitor/logs/custom-logs-migrate' style='color:#1890F1;'>deprecated HTTP Data Collector API</a>.</p>",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "SalesforceServiceCloud_CL",
        "baseQuery": "SalesforceServiceCloud_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Last Salesforce Service Cloud EventLogFile Events",
        "query": "SalesforceServiceCloud\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "SalesforceServiceCloud_CL",
        "lastDataReceivedQuery": "SalesforceServiceCloud_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "SalesforceServiceCloud_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "**Salesforce API Username**, **Salesforce API Password**, **Salesforce Security Token**, **Salesforce Consumer Key**, **Salesforce Consumer Secret** is required for REST API. [See the documentation to learn more about API](https://developer.salesforce.com/docs/atlas.en-us.api_rest.meta/api_rest/quickstart.htm)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Salesforce Lightning Platform REST API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "description": "**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias SalesforceServiceCloud and load the function code or click [here](https://aka.ms/sentinel-SalesforceServiceCloud-parser). The function usually takes 10-15 minutes to activate after solution installation/update."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the Salesforce Lightning Platform REST API**\n\n1. See the [link](https://developer.salesforce.com/docs/atlas.en-us.api_rest.meta/api_rest/quickstart.htm) and follow the instructions for obtaining Salesforce API Authorization credentials. \n2. On the **Set Up Authorization** step choose **Session ID Authorization** method.\n3. You must provide your client id, client secret, username, and password with user security token."
      },
      {
        "title": "",
        "description": ">**NOTE:** Ingesting data from on an hourly interval may require additional licensing based on the edition of the Salesforce Service Cloud being used. Please refer to [Salesforce documentation](https://www.salesforce.com/editions-pricing/service-cloud/) and/or support for more details."
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Salesforce Service Cloud data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following), as well as the Salesforce API Authorization credentials, readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Option 1 - Azure Resource Manager (ARM) Template",
                  "description": "Use this method for automated deployment of the Salesforce Service Cloud data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-SalesforceServiceCloud-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace ID**, **Workspace Key**, **Salesforce API Username**, **Salesforce API Password**, **Salesforce Security Token**, **Salesforce Consumer Key**, **Salesforce Consumer Secret** and deploy. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
                },
                {
                  "title": "Option 2 - Manual Deployment of Azure Functions",
                  "description": "Use the following step-by-step instructions to deploy the Salesforce Service Cloud data connector manually with Azure Functions (Deployment via Visual Studio Code).",
                  "instructions": [
                    {
                      "parameters": {
                        "instructionSteps": [
                          {
                            "title": "Step 1 - Deploy a Function App",
                            "description": "**NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-SalesforceServiceCloud-functionapp) file. Extract archive to your local development computer.\n2. Follow the [function app manual deployment instructions](https://github.com/Azure/Azure-Sentinel/blob/master/DataConnectors/AzureFunctionsManualDeployment.md#function-app-manual-deployment-instructions) to deploy the Azure Functions app using VSCode.\n3. After successful deployment of the function app, follow next steps for configuring it."
                          },
                          {
                            "title": "Step 2 - Configure the Function App",
                            "description": "1. Go to Azure Portal for the Function App configuration.\n2. In the Function App, select the Function App Name and select **Configuration**.\n3. In the **Application settings** tab, select **+ New application setting**.\n4. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tSalesforceUser\n\t\tSalesforcePass\n\t\tSalesforceSecurityToken\n\t\tSalesforceConsumerKey\n\t\tSalesforceConsumerSecret\n\t\tWorkspaceID\n\t\tWorkspaceKey\n\t\tlogAnalyticsUri (optional)\n - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`\n5. Once all application settings have been entered, click **Save**."
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "SalesforceServiceCloudCCPDefinition",
    "title": "Salesforce Service Cloud (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The Salesforce Service Cloud data connector provides the capability to ingest information about your Salesforce operational events into Microsoft Sentinel through the REST API. The connector provides ability to review events in your org on an accelerated basis, get [event log files](https://developer.salesforce.com/docs/atlas.en-us.api_rest.meta/api_rest/event_log_file_hourly_overview.htm) in hourly increments for recent activity.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Salesforce Service Cloud EventLogFile Events",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get a sample of Salesforce Service Cloud Event Log File Events",
        "query": "{{graphQueriesTableName}}\n| take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "isPreview": false,
      "status": 1
    },
    "metadata": null
  },
  {
    "id": "SamsungDCDefinition",
    "title": "Samsung Knox Asset Intelligence",
    "publisher": "Samsung",
    "descriptionMarkdown": "Samsung Knox Asset Intelligence Data Connector lets you centralize your mobile security events and logs in order to view customized insights using the Workbook template, and identify incidents based on Analytics Rules templates.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Samsung Audit Events logs",
        "baseQuery": "Samsung_Knox_Audit_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "One-line title for your sample query 1",
        "query": "Samsung_Knox_Audit_CL\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "Samsung_Knox_Application_CL",
        "lastDataReceivedQuery": "Samsung_Knox_Application_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Samsung_Knox_Audit_CL",
        "lastDataReceivedQuery": "Samsung_Knox_Audit_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Samsung_Knox_Process_CL",
        "lastDataReceivedQuery": "Samsung_Knox_Process_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Samsung_Knox_Network_CL",
        "lastDataReceivedQuery": "Samsung_Knox_Network_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Samsung_Knox_User_CL",
        "lastDataReceivedQuery": "Samsung_Knox_User_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Samsung_Knox_System_CL",
        "lastDataReceivedQuery": "Samsung_Knox_System_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "union Samsung_Knox_Application_CL, Samsung_Knox_Audit_CL, Samsung_Knox_Process_CL, Samsung_Knox_Network_CL, Samsung_Knox_User_CL, Samsung_Knox_System_CL | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Entra app",
          "description": "An Entra app needs to be registered and provisioned with Microsoft Metrics Publisher role and configured with either Certificate or Client Secret as credentials for secure data transfer. See [the Log ingestion tutorial to learn more about Entra App creation, registration and credential configuration.](https://learn.microsoft.com/en-us/azure/azure-monitor/logs/tutorial-logs-ingestion-portal) "
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "This Data Connector uses the Microsoft Log Ingestion API to push security events into Microsoft Sentinel from Samsung Knox Asset Intelligence (KAI) solution."
      },
      {
        "title": "STEP 1 - Create and register an Entra Application",
        "description": ">**Note**: This Data Connector can support either Certificate-based or Client Secret-based authentication. For Certificate-based authentication, you can download the Samsung CA-signed certificate (public key) from [KAI documentation portal](https://docs.samsungknox.com/admin/knox-asset-intelligence/assets/samsung-knox-validation-certificate.crt). For Client Secret-based authentication, you can create the secret during the Entra application registration. Ensure you copy the Client Secret value as soon as it is generated.\n\n>**IMPORTANT:** Save the values for Tenant (Directory) ID and Client (Application) ID. If Client Secret-based authentication is enabled, save Client Secret (Secret Value) associated with the Entra app."
      },
      {
        "title": "STEP 2 - Automate deployment of this Data Connector using the below Azure Resource Manager (ARM) template",
        "description": ">**IMPORTANT:** Before deploying the Data Connector, copy the below Workspace name associated with your Microsoft Sentinel (also your Log Analytics) instance.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceName"
              ],
              "label": "Workspace Name"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "",
        "description": "1. Click the button below to install Samsung Knox Intelligence Solution. \n\n\t[![DeployToAzure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-SamsungDCDefinition-azuredeploy)\\n2. Provide the following required fields: Log Analytics Workspace Name, Log Analytics Workspace Location, Log Analytics Workspace Subscription (ID) and Log Analytics Workspace Resource Group."
      },
      {
        "title": "STEP 3 - Obtain Microsoft Sentinel Data Collection details",
        "description": "Once the ARM template is deployed, navigate to Data Collection Rules https://portal.azure.com/#browse/microsoft.insights%2Fdatacollectionrules? and save values associated with the Immutable ID (DCR) and Data Collection Endpoint (DCE). \n\n>**IMPORTANT:** To enable end-to-end integration, information related to Microsoft Sentinel DCE and DCR are required for configuration in Samsung Knox Asset Intelligence portal (STEP 4). \n\nEnsure the Entra Application created in STEP 1 has permissions to use the DCR created in order to send data to the DCE. Please refer to https://learn.microsoft.com/en-us/azure/azure-monitor/logs/tutorial-logs-ingestion-portal#assign-permissions-to-the-dcr to assign permissions accordingly."
      },
      {
        "title": "STEP 4 - Connect to Samsung Knox Asset Intelligence solution to configure Microsoft Sentinel to push select Knox Security Events as Alerts",
        "description": "1. Login to [Knox Asset Intelligence administration portal](https://central.samsungknox.com/kaiadmin/dai/home) and navigate to **Dashboard Settings**; this is available at the top-right corner of the Portal.\n>  **Note**: Ensure the login user has access to 'Security' and 'Manage dashboard view and data collection' permissions.\n\n2. Click on Security tab to view settings for Microsoft Sentinel Integration and Knox Security Logs.\n\n3. In the Security Operations Integration page, toggle on **'Enable Microsoft Sentinel Integration'** and enter appropriate values in the required fields.\n\n  >a. Based on the authentication method used, refer to information saved from STEP 1 while registering the Entra application. \n\n  >b. For Microsoft Sentinel DCE and DCR, refer to the information saved from STEP 3. \n\n4. Click on **'Test Connection'** and ensure the connection is successful.\n\n5. Before you can Save, configure Knox Security Logs by selecting either  Essential or Advanced configuration **(default: Essential).**\n\n6. To complete the Microsoft Sentinel integration, click **'Save'**."
      }
    ],
    "metadata": {
      "id": "790935a7-f8ec-4207-a48f-42a7e4ee0ab7",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution"
      },
      "author": {
        "name": "Samsung Knox Asset Intelligence"
      },
      "support": {
        "name": "Samsung Electronics Co., Ltd.",
        "email": "kai.sme@samsung.com",
        "tier": "Partner",
        "link": "https://www2.samsungknox.com/en/support"
      }
    }
  },
  {
    "id": "SAPBTPAuditEvents",
    "title": "SAP BTP",
    "publisher": "Microsoft",
    "descriptionMarkdown": "SAP Business Technology Platform (SAP BTP) brings together data management, analytics, artificial intelligence, application development, automation, and integration in one, unified environment.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "BTP Events",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of BTP Events",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "SAPETDAlerts",
    "title": "SAP Enterprise Threat Detection, cloud edition",
    "publisher": "SAP",
    "descriptionMarkdown": "The SAP Enterprise Threat Detection, cloud edition (ETD) data connector enables ingestion of security alerts from ETD into Microsoft Sentinel, supporting cross-correlation, alerting, and threat hunting.",
    "graphQueries": [
      {
        "metricName": "Total alerts received",
        "legend": "ETD Alerts",
        "baseQuery": "SAPETDAlerts_CL"
      },
      {
        "metricName": "Total investigations received",
        "legend": "ETD Investigations",
        "baseQuery": "SAPETDInvestigations_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of ETD Events",
        "query": "SAPETDAlerts_CL\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "SAPETDAlerts_CL",
        "lastDataReceivedQuery": "SAPETDAlerts_CL\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "SAPETDInvestigations_CL",
        "lastDataReceivedQuery": "SAPETDInvestigations_CL\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": null,
    "metadata": null
  },
  {
    "id": "SAPLogServ",
    "title": "SAP LogServ (RISE), S/4HANA Cloud private edition",
    "publisher": "SAP SE",
    "descriptionMarkdown": "SAP LogServ is an SAP Enterprise Cloud Services (ECS) service aimed at collection, storage, forwarding and access of logs. LogServ centralizes the logs from all systems, applications, and ECS services used by a registered customer. <br> Main Features include:<br>Near Realtime Log Collection: With ability to integrate into Microsoft Sentinel as SIEM solution.<br>LogServ complements the existing SAP application layer threat monitoring and detections in Microsoft Sentinel with the log types owned by SAP ECS as the system provider. This includes logs like: SAP Security Audit Log (AS ABAP), HANA database, AS JAVA, ICM, SAP Web Dispatcher, SAP Cloud Connector, OS, SAP Gateway, 3rd party Database, Network, DNS, Proxy, Firewall",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "Tenant",
        "baseQuery": "{{graphQueriesTableName}} | project TimeGenerated"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample Events",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "isPreview": true
    },
    "metadata": null
  },
  {
    "id": "SAPLogServ",
    "title": "SAP LogServ (RISE), S/4HANA Cloud private edition",
    "publisher": "SAP SE",
    "logo": "SapLogo.svg",
    "descriptionMarkdown": "SAP LogServ is an SAP Enterprise Cloud Services (ECS) service aimed at collection, storage, forwarding and access of logs. LogServ centralizes the logs from all systems, applications, and ECS services used by a registered customer. <br> Main Features include:<br>Near Realtime Log Collection: With ability to integrate into Microsoft Sentinel as SIEM solution.<br>LogServ complements the existing SAP application layer threat monitoring and detections in Microsoft Sentinel with the log types owned by SAP ECS as the system provider. This includes logs like: SAP Security Audit Log (AS ABAP), HANA database, AS JAVA, ICM, SAP Web Dispatcher, SAP Cloud Connector, OS, SAP Gateway, 3rd party Database, Network, DNS, Proxy, Firewall",
    "graphQueriesTableName": "SAPLogServ_CL",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "Tenant",
        "baseQuery": "{{graphQueriesTableName}} | project TimeGenerated"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample Events",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriteria": [
      {
        "type": "HasDataConnectors"
      }
    ],
    "availability": {
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "Read and Write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "Read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key)",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft Entra",
          "description": "Permission to create an app registration in Microsoft Entra ID. Typically requires Entra ID Application Developer role or higher."
        },
        {
          "name": "Microsoft Azure",
          "description": "Permission to assign Monitoring Metrics Publisher role on data collection rules. Typically requires Azure RBAC Owner or User Access Administrator role."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Create ARM Resources and Provide the Required Permissions",
        "description": "We will create data collection rule (DCR) and data collection endpoint (DCE) resources. We will also create a Microsoft Entra app registration and assign the required permissions to it.",
        "instructions": [
          {
            "type": "Markdown",
            "parameters": {
              "content": "#### Automated deployment of Azure resources\nClicking on \"Deploy push connector resources\" will trigger the creation of DCR and DCE resources.\nIt will then create a Microsoft Entra app registration with client secret and grant permissions on the DCR. This setup enables data to be sent securely to the DCR using a OAuth v2 client credentials."
            }
          },
          {
            "parameters": {
              "label": "Deploy push connector resources",
              "applicationDisplayName": "SAP LogServ push to Microsoft Sentinel"
            },
            "type": "DeployPushConnectorButton_test"
          }
        ]
      },
      {
        "title": "2. Maintain the data collection endpoint details and authentication info in SAP LogServ",
        "description": "Share the data collection endpoint URL and authentication info with the SAP LogServ administrator to configure the SAP LogServ to send data to the data collection endpoint.\n\nLearn more from [this blog series](https://community.sap.com/t5/enterprise-resource-planning-blog-posts-by-members/ultimate-blog-series-sap-logserv-integration-with-microsoft-sentinel/ba-p/14126401).",
        "instructions": [
          {
            "parameters": {
              "label": "Use this value to configure as Tenant ID in the LogIngestionAPI credential.",
              "fillWith": [
                "TenantId"
              ]
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "label": "Entra Application ID",
              "fillWith": [
                "ApplicationId"
              ],
              "placeholder": "Deploy push connector to get the Application ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "label": "Entra Application Secret",
              "fillWith": [
                "ApplicationSecret"
              ],
              "placeholder": "Deploy push connector to get the Application Secret"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "label": "Use this value to configure the LogsIngestionURL parameter when deploying the IFlow.",
              "fillWith": [
                "DataCollectionEndpoint"
              ],
              "placeholder": "Deploy push connector to get the DCE URI"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "label": "DCR Immutable ID",
              "fillWith": [
                "DataCollectionRuleId"
              ],
              "placeholder": "Deploy push connector to get the DCR ID"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ],
    "metadata": {
      "id": "SAPLogServ",
      "version": "3.1.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "SAP LogServ for Microsoft Sentinel"
      },
      "author": {
        "name": "SAP SE",
        "email": "support@sap.com"
      },
      "support": {
        "tier": "Partner",
        "name": "SAP SE",
        "email": "support@sap.com",
        "link": "https://me.sap.com/"
      }
    }
  },
  {
    "id": "SAPS4PublicAlerts",
    "title": "SAP S/4HANA Cloud Public Edition",
    "publisher": "SAP",
    "descriptionMarkdown": "The SAP S/4HANA Cloud Public Edition (GROW with SAP) data connector enables ingestion of SAP's security audit log into the Microsoft Sentinel Solution for SAP, supporting cross-correlation, alerting, and threat hunting. Looking for alternative authentication mechanisms? See [here](https://github.com/Azure-Samples/Sentinel-For-SAP-Community/tree/main/integration-artifacts).",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "SAP SAL Events",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of SAP SAL Events",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "isPreview": true
    },
    "metadata": null
  },
  {
    "id": "SecurePracticeMailRiskConnector",
    "title": "MailRisk by Secure Practice",
    "publisher": "Secure Practice",
    "descriptionMarkdown": "The MailRisk by Secure Practice connector allows you to ingest email threat intelligence data from the MailRisk API into Microsoft Sentinel. This connector provides visibility into reported emails, risk assessments, and security events related to email threats.",
    "graphQueries": [
      {
        "metricName": "Total emails received",
        "legend": "MailRisk Emails",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "All MailRisk emails",
        "query": "{{graphQueriesTableName}}\n| take 10"
      },
      {
        "description": "High risk emails",
        "query": "{{graphQueriesTableName}}\n| where RiskLevel == 'high'\n| sort by TimeGenerated desc"
      },
      {
        "description": "Emails by category",
        "query": "{{graphQueriesTableName}}\n| summarize count() by Category"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "SecurityBridge",
    "title": "SecurityBridge Solution for SAP",
    "publisher": "SecurityBridge Group GmbH",
    "descriptionMarkdown": "SecurityBridge enhances SAP security by integrating seamlessly with Microsoft Sentinel, enabling real-time monitoring and threat detection across SAP environments. This integration allows Security Operations Centers (SOCs) to consolidate SAP security events with other organizational data, providing a unified view of the threat landscape . Leveraging AI-powered analytics and Microsofts Security Copilot, SecurityBridge identifies sophisticated attack patterns and vulnerabilities within SAP applications, including ABAP code scanning and configuration assessments . The solution supports scalable deployments across complex SAP landscapes, whether on-premises, in the cloud, or hybrid environments . By bridging the gap between IT and SAP security teams, SecurityBridge empowers organizations to proactively detect, investigate, and respond to threats, enhancing overall security posture.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "SAP_SID",
        "baseQuery": "{{graphQueriesTableName}} | project TimeGenerated, SAP_SID= SystemUniqueId"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample Events",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "isPreview": true
    },
    "metadata": null
  },
  {
    "id": "SecurityBridgeSAP",
    "title": "SecurityBridge Threat Detection for SAP",
    "publisher": "SecurityBridge",
    "descriptionMarkdown": "SecurityBridge is the first and only holistic, natively integrated security platform, addressing all aspects needed to protect organizations running SAP from internal and external threats against their core business applications. The SecurityBridge platform is an SAP-certified add-on, used by organizations around the globe, and addresses the clients need for advanced cybersecurity, real-time monitoring, compliance, code security, and patching to protect against internal and external threats.This Microsoft Sentinel Solution allows you to integrate SecurityBridge Threat Detection events from all your on-premise and cloud based SAP instances into your security monitoring.Use this Microsoft Sentinel Solution to receive normalized and speaking security events, pre-built dashboards and out-of-the-box templates for your SAP security monitoring.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "SecurityBridgeLogs",
        "baseQuery": "SecurityBridgeLogs_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Event Names",
        "query": "SecurityBridgeLogs_CL \n| extend Name = tostring(split(RawData, '|')[5]) \n| summarize count() by Name | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "SecurityBridgeLogs_CL",
        "lastDataReceivedQuery": "SecurityBridgeLogs_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "SecurityBridgeLogs_CL\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(2d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "*NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias SecurityBridgeLogs and load the function code or click [here](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/SecurityBridge%20App/Parsers/SecurityBridgeLogs.txt).The function usually takes 10-15 minutes to activate after solution installation/update.",
        "instructions": []
      },
      {
        "title": "",
        "description": ">**NOTE:** This data connector has been developed using SecurityBridge Application Platform 7.4.0.",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux or Windows",
        "description": "This solution requires logs collection via an Microsoft Sentinel agent installation\n\n>  The Microsoft Sentinel agent is supported on the following Operating Systems:  \n1. Windows Servers \n2. SUSE Linux Enterprise Server\n3. Redhat Linux Enterprise Server\n4. Oracle Linux Enterprise Server\n5. If you have the SAP solution installed on HPUX / AIX then you will need to deploy a log collector on one of the Linux options listed above and forward your logs to that collector\n\n",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Linux agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Windows agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Windows Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Windows Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Configure the custom log directory to be collected",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenCustomLogsSettings"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "description": "1. Select the link above to open your workspace advanced settings \n2. Click **+Add custom**\n3. Click **Browse** to upload a sample of a SecurityBridge SAP log file (e.g. AED_20211129164544.cef). Then, click **Next >**\n4. Select **New Line** as the record delimiter then click **Next >**\n5. Select **Windows** or **Linux** and enter the path to SecurityBridge logs based on your configuration. Example:\n - '/usr/sap/tmp/sb_events/*.cef' \n\n>**NOTE:** You can add as many paths as you want in the configuration.\n\n6. After entering the path, click the '+' symbol to apply, then click **Next >** \n7. Add **SecurityBridgeLogs** as the custom log Name and click **Done**"
      },
      {
        "title": "3. Check logs in Microsoft Sentinel",
        "description": "Open Log Analytics to check if the logs are received using the SecurityBridgeLogs_CL Custom log table.\n\n>**NOTE:** It may take up to 30 minutes before new logs will appear in SecurityBridgeLogs_CL table.",
        "instructions": []
      }
    ]
  },
  {
    "id": "SecurityEvents",
    "title": "Security Events via Legacy Agent",
    "publisher": "Microsoft",
    "descriptionMarkdown": "You can stream all security events from the Windows machines connected to your Microsoft Sentinel workspace using the Windows agent. This connection enables you to view dashboards, create custom alerts, and improve investigation. This gives you more insight into your organizations network and improves your security operation capabilities. For more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2220093&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "SecurityEvents",
        "baseQuery": "SecurityEvent"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "SecurityEvent\n            | sort by TimeGenerated"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "SecurityEvents",
        "value": null
      }
    ],
    "dataTypes": [
      {
        "name": "SecurityEvents",
        "lastDataReceivedQuery": "SecurityEvent\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/datasources",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace data sources",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Download and install the agent",
        "description": ">  Security Events logs are collected only from **Windows** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Windows Virtual Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on non-Azure Windows Machine",
                  "description": "Select the machine to install the agent and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Select which events to stream",
        "description": "- All events - All Windows security and AppLocker events.\n- Common - A standard set of events for auditing purposes.\n- Minimal - A small set of events that might indicate potential threats. By enabling this option, you won't be able to have a full audit trail.\n- None - No security or AppLocker events.",
        "instructions": [
          {
            "type": "SecurityEvents"
          }
        ]
      }
    ]
  },
  {
    "id": "SecurityScorecardFactorAzureFunctions",
    "title": "SecurityScorecard Factor",
    "publisher": "SecurityScorecard",
    "descriptionMarkdown": "SecurityScorecard is the leader in cybersecurity risk ratings. The [SecurityScorecard](https://www.SecurityScorecard.com/) Factors data connector provides the ability for Sentinel to import SecurityScorecard factor ratings as logs. SecurityScorecard provides ratings for over 12 million companies and domains using countless data points from across the internet. Maintain full awareness of any company's security posture and be able to receive timely updates when factor scores change or drop. SecurityScorecard factor ratings are updated daily based on evidence collected across the web.",
    "graphQueries": [
      {
        "metricName": "Total Factor data received",
        "legend": "SecurityScorecardFactor_CL",
        "baseQuery": "SecurityScorecardFactor_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "SecurityScorecard Factor Events - All Factors Activities.",
        "query": "SecurityScorecardFactor_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "SecurityScorecardFactor_CL",
        "lastDataReceivedQuery": "SecurityScorecardFactor_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "SecurityScorecardFactor_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "**SecurityScorecard API Key** is required."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the SecurityScorecard API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the SecurityScorecard API**\n\n Follow these instructions to create/get a SecurityScorecard API token.\n 1. As an administrator in SecurityScorecard, navigate to My Settings and then Users\n 2. Click '+ Add User'\n 3. In the form, check off 'Check to create a bot user'\n 4. Provide a name for the Bot and provide it with Read Only permission\n 5. Click 'Add User'\n 6. Locate the newly created Bot user\n 7. Click 'create token' in the Bot user's row\n 8. Click 'Confirm' and note the API token that has been generated"
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the SecurityScorecard Factor data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following) readily available.., as well as the SecurityScorecard API Authorization Key(s)",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the SecurityScorecard Factor connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-SecurityScorecardFactorAPI-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the below information : \n\t\tFunction Name \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tSecurityScorecard API Key \n\t\tSecurityScorecard Base URL (https://api.securityscorecard.io) \n\t\tDomain \n\t\tPortfolio IDs (Coma separated IDs) \n\t\tSecurityScorecard Factor Table Name (Default: SecurityScorecardFactor) \n\t\tLevel Factor Change (Default: 7) \n\t\tFactor Schedule (Default: 0 15 * * * *) \n\t\tDiff Override Own Factor (Default: true) \n\t\tDiff Override Portfolio Factor (Default: true) \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the SecurityScorecard Factor data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-SecurityScorecardFactorAPI-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. SecurityScorecardXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.8 or above.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following application settings individually, with their respective values (case-sensitive): \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tSecurityScorecard API Key \n\t\tSecurityScorecard Base URL (https://api.securityscorecard.io) \n\t\tDomain \n\t\tPortfolio IDs (Coma separated IDs) \n\t\tSecurityScorecard Factor Table Name (Default: SecurityScorecardFactor) \n\t\tLevel Factor Change (Default: 7) \n\t\tFactor Schedule (Default: 0 15 * * * *) \n\t\tDiff Override Own Factor (Default: true) \n\t\tDiff Override Portfolio Factor (Default: true) \n\t\tlogAnalyticsUri (optional) \n - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n4. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "SecurityScorecardIssueAzureFunctions",
    "title": "SecurityScorecard Issue",
    "publisher": "SecurityScorecard",
    "descriptionMarkdown": "SecurityScorecard is the leader in cybersecurity risk ratings. The [SecurityScorecard](https://www.SecurityScorecard.com/) Issues data connector provides the ability for Sentinel to import SecurityScorecard issue data as logs. SecurityScorecard provides ratings for over 12 million companies and domains using countless data points from across the internet. Maintain full awareness of any company's security posture and be able to receive timely updates when new cybersecurity issues are discovered.",
    "graphQueries": [
      {
        "metricName": "Total Issue data received",
        "legend": "SecurityScorecardIssues_CL",
        "baseQuery": "SecurityScorecardIssues_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "SecurityScorecard Issue Events - All Issue Activities.",
        "query": "SecurityScorecardIssues_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "SecurityScorecardIssues_CL",
        "lastDataReceivedQuery": "SecurityScorecardIssues_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "SecurityScorecardIssues_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "**SecurityScorecard API Key** is required."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the SecurityScorecard API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the SecurityScorecard API**\n\n Follow these instructions to create/get a SecurityScorecard API token.\n 1. As an administrator in SecurityScorecard, navigate to My Settings and then Users\n 2. Click '+ Add User'\n 3. In the form, check off 'Check to create a bot user'\n 4. Provide a name for the Bot and provide it with Read Only permission\n 5. Click 'Add User'\n 6. Locate the newly created Bot user\n 7. Click 'create token' in the Bot user's row\n 8. Click 'Confirm' and note the API token that has been generated"
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the SecurityScorecard Issue data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following) readily available.., as well as the SecurityScorecard API Authorization Key(s)",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the SecurityScorecard Issue connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-SecurityScorecardIssueAPI-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the below information : \n\t\tFunction Name \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tSecurityScorecard API Key \n\t\tSecurityScorecard Base URL (https://api.securityscorecard.io) \n\t\tDomain \n\t\tPortfolio IDs (Coma separated IDs) \n\t\tSecurityScorecard Issue Table Name (Default: SecurityScorecardIssue) \n\t\tLevel Issue Change (Default: 7) \n\t\tIssue Schedule (Default: 0 0,30 * * * *) \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the SecurityScorecard Issue data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-SecurityScorecardIssueAPI-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. SecurityScorecardXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.8 or above.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following application settings individually, with their respective values (case-sensitive): \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tSecurityScorecard API Key \n\t\tSecurityScorecard Base URL (https://api.securityscorecard.io) \n\t\tDomain \n\t\tPortfolio IDs (Coma separated IDs) \n\t\tSecurityScorecard Issue Table Name (Default: SecurityScorecardIssue) \n\t\tLevel Issue Change (Default: 7) \n\t\tIssue Schedule (Default: 0 0,30 * * * *) \n\t\tlogAnalyticsUri (optional) \n - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n4. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "SecurityScorecardRatingsAzureFunctions",
    "title": "SecurityScorecard Cybersecurity Ratings",
    "publisher": "SecurityScorecard",
    "descriptionMarkdown": "SecurityScorecard is the leader in cybersecurity risk ratings. The [SecurityScorecard](https://www.SecurityScorecard.com/) data connector provides the ability for Sentinel to import SecurityScorecard ratings as logs. SecurityScorecard provides ratings for over 12 million companies and domains using countless data points from across the internet. Maintain full awareness of any company's security posture and be able to receive timely updates when scores change or drop. SecurityScorecard ratings are updated daily based on evidence collected across the web.",
    "graphQueries": [
      {
        "metricName": "Total Ratings data received",
        "legend": "SecurityScorecardRatings_CL",
        "baseQuery": "SecurityScorecardRatings_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "SecurityScorecard Ratings Events - All Ratings Activities.",
        "query": "SecurityScorecardRatings_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "SecurityScorecardRatings_CL",
        "lastDataReceivedQuery": "SecurityScorecardRatings_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "SecurityScorecardRatings_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "**SecurityScorecard API Key** is required."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the SecurityScorecard API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the SecurityScorecard API**\n\n Follow these instructions to create/get a SecurityScorecard API token.\n 1. As an administrator in SecurityScorecard, navigate to My Settings and then Users\n 2. Click '+ Add User'\n 3. In the form, check off 'Check to create a bot user'\n 4. Provide a name for the Bot and provide it with Read Only permission\n 5. Click 'Add User'\n 6. Locate the newly created Bot user\n 7. Click 'create token' in the Bot user's row\n 8. Click 'Confirm' and note the API token that has been generated"
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the SecurityScorecard Ratings data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following) readily available.., as well as the SecurityScorecard API Authorization Key(s)",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the SecurityScorecard Ratings connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-SecurityScorecardRatingsAPI-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the below information : \n\t\tFunction Name \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tSecurityScorecard API Key \n\t\tSecurityScorecard Base URL (https://api.securityscorecard.io) \n\t\tDomain \n\t\tPortfolio IDs (Coma separated IDs) \n\t\tSecurityScorecard Ratings Table Name (Default: SecurityScorecardRatings) \n\t\tLevel Ratings Change (Default: 7) \n\t\tRatings Schedule (Default: 0 45 * * * *) \n\t\tDiff Override Own Ratings (Default: true) \n\t\tDiff Override Portfolio Ratings (Default: true) \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the SecurityScorecard Ratings data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-SecurityScorecardRatingsAPI-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. SecurityScorecardXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.8 or above.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following application settings individually, with their respective values (case-sensitive): \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tSecurityScorecard API Key \n\t\tSecurityScorecard Base URL (https://api.securityscorecard.io) \n\t\tDomain \n\t\tPortfolio IDs (Coma separated IDs) \n\t\tSecurityScorecard Ratings Table Name (Default: SecurityScorecardRatings) \n\t\tLevel Ratings Change (Default: 7) \n\t\tRatings Schedule (Default: 0 45 * * * *) \n\t\tDiff Override Own Ratings (Default: true) \n\t\tDiff Override Portfolio Ratings (Default: true) \n\t\tlogAnalyticsUri (optional) \n - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n4. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "SemperisDSP",
    "title": "Semperis Directory Services Protector",
    "publisher": "SEMPERIS",
    "descriptionMarkdown": "Semperis Directory Services Protector data connector allows for the export of its Windows event logs (i.e. Indicators of Exposure and Indicators of Compromise) to Microsoft Sentinel in real time.\nIt provides a data parser to manipulate the Windows event logs more easily. The different workbooks ease your Active Directory security monitoring and provide different ways to visualize the data. The analytic templates allow to automate responses regarding different events, exposures, or attacks.",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected [**dsp_parser**](https://aka.ms/sentinel-SemperisDSP-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Semperis-DSP-Security",
        "baseQuery": "dsp_parser"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get all Indicators of Exposure (IoEs) failed alerts for the last hour",
        "query": "dsp_parser\n | where EventID == 9212\n | where TimeGenerated >= ago(1h)\n | summarize count() by TimeGenerated, tostring(ForestName), tostring(Domains), tostring(SecurityIndicatorName), tostring(SecurityIndicatorDescription), tostring(ResultMessage), tostring(SecurityFrameworkTags), tostring(LikelihoodOfCompromise), tostring(FirstFound), tostring(Remediation), tostring(Score)"
      },
      {
        "description": "Get Indicators of Exposure (IoEs) failed alerts for the last 24 hours",
        "query": "dsp_parser\n | where EventID == 9212\n | where TimeGenerated >= ago(24h)\n | summarize count() by TimeGenerated, tostring(ForestName), tostring(Domains), tostring(SecurityIndicatorName), tostring(SecurityIndicatorDescription), tostring(ResultMessage), tostring(SecurityFrameworkTags), tostring(LikelihoodOfCompromise), tostring(FirstFound), tostring(Remediation), tostring(Score)"
      },
      {
        "description": "Get all Indicators of Exposure (IoEs) failed alerts for the last 7 days",
        "query": "dsp_parser\n | where EventID == 9212\n | where TimeGenerated >= ago(7d)\n | summarize count() by TimeGenerated, tostring(ForestName), tostring(Domains), tostring(SecurityIndicatorName), tostring(SecurityIndicatorDescription), tostring(ResultMessage), tostring(SecurityFrameworkTags), tostring(LikelihoodOfCompromise), tostring(FirstFound), tostring(Remediation), tostring(Score)"
      },
      {
        "description": "Get all Indicators of Exposure (IoEs) tested and passed for the last hour",
        "query": "dsp_parser\n | where EventID == 9211\n | where TimeGenerated >= ago(1h)\n | summarize count() by TimeGenerated, tostring(ForestName), tostring(Domains), tostring(SecurityIndicatorName), tostring(SecurityIndicatorDescription), tostring(ResultMessage), tostring(SecurityFrameworkTags), tostring(LikelihoodOfCompromise), tostring(Score)"
      },
      {
        "description": "Get all Indicators of Exposure (IoEs) tested and passed for the last 24 hours",
        "query": "dsp_parser\n | where EventID == 9211\n | where TimeGenerated >= ago(24h)\n | summarize count() by TimeGenerated, tostring(ForestName), tostring(Domains), tostring(SecurityIndicatorName), tostring(SecurityIndicatorDescription), tostring(ResultMessage), tostring(SecurityFrameworkTags), tostring(LikelihoodOfCompromise), tostring(Score)"
      },
      {
        "description": "Get all Indicators of Exposure (IoEs) tested and passed for the last 7 days",
        "query": "dsp_parser\n | where EventID == 9211\n | where TimeGenerated >= ago(7d)\n | summarize count() by TimeGenerated, tostring(ForestName), tostring(Domains), tostring(SecurityIndicatorName), tostring(SecurityIndicatorDescription), tostring(ResultMessage), tostring(SecurityFrameworkTags), tostring(LikelihoodOfCompromise), tostring(Score)"
      }
    ],
    "dataTypes": [
      {
        "name": "Event (Semperis-DSP-Security)",
        "lastDataReceivedQuery": "dsp_parser\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "dsp_parser\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**dsp_parser**](https://aka.ms/sentinel-SemperisDSP-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "**Configure Windows Security Events via AMA connector**",
        "description": "Collect Windows security events logs from your **Semperis DSP Management Server** ."
      },
      {
        "title": "1. Install the Azure Monitor Agent (AMA)",
        "description": "On your **Semperis DSP Management Server** install the AMA on the DSP machine that will act as the event log forwarder.\nYou can skip this step if you have already installed the Microsoft agent for Windows"
      },
      {
        "title": "2. Create a Data Collection Rule (DCR)",
        "description": "Start collecting logs from the **Semperis DSP Management Server** .\n\n1. In the Azure portal, navigate to your **Log Analytics workspace**.\n2. In the left pane, click on **Configuration** and then **Data connectors**.\n3. Find and install the **the Windows Security Events via AMA** connector.\n4. Click on **Open connector** and then on **Create data collection rule**.\n5. Configure the DCR with the necessary details, such as the log sources and the destination workspace.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Semperis DSP Management Server",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "**Configure Common Event Format via AMA connector**",
        "description": "Collect syslog messages send from your **Semperis DSP Management Server** ."
      },
      {
        "title": "1. Install the Azure Monitor Agent (AMA)",
        "description": "Install the AMA on the Linux machine that will act as the log forwarder. This machine will collect and forward CEF logs to Microsoft Sentinel.\nYou can skip this step if you have already installed the Microsoft agent for Linux"
      },
      {
        "title": "2. Create a Data Collection Rule (DCR)",
        "description": "Start collecting logs from the **Semperis DSP Management Server** .\n\n1. In the Azure portal, navigate to your **Log Analytics workspace**.\n2. In the left pane, click on **Configuration** and then **Data connectors**.\n3. Find and install the **the Common Event Format via AMA** connector.\n4. Click on **Open connector** and then on **Create data collection rule**.\n5. Configure the DCR with the necessary details, such as the log sources and the destination workspace.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Semperis DSP Management Server",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "3. Configure sending CEF logs on your Semperis DSP Management Server",
        "description": "Configure your **Semperis DSP Management Server** to send CEF logs to the Linux machine where the AMA is installed. This involves setting the destination IP address and port for the CEF logs"
      },
      {
        "title": "",
        "description": "> You should now be able to receive logs in the *Windows event log* table and *common log* table, log data can be parsed using the **dsp_parser()** function, used by all query samples, workbooks and analytic templates."
      }
    ],
    "metadata": {
      "id": "TBD",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Semperis"
      },
      "support": {
        "name": "Semperis",
        "link": "https://www.semperis.com/contact-us/",
        "tier": "developer"
      }
    }
  },
  {
    "id": "SenservaPro",
    "title": "SenservaPro (Preview)",
    "publisher": "Senserva",
    "descriptionMarkdown": "The SenservaPro data connector provides a viewing experience for your SenservaPro scanning logs. View dashboards of your data, use queries to hunt & explore, and create custom alerts.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "SenservaPro_CL",
        "baseQuery": "SenservaPro_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All SenservaPro data",
        "query": "SenservaPro_CL"
      },
      {
        "description": "All SenservaPro data received in the last 24 hours",
        "query": "SenservaPro_CL\n            | where TimeGenerated > ago(1d)"
      },
      {
        "description": "All SenservaPro data with 'High' Severity, ordered by the most recent received",
        "query": "SenservaPro_CL\n            | where Severity == 3\n            | order by TimeGenerated desc"
      },
      {
        "description": "All 'ApplicationNotUsingClientCredentials' controls received in the last 14 days",
        "query": "let timeframe = 14d;\n            SenservaPro_CL\n            | where TimeGenerated >= ago(timeframe)\n            | where ControlName_s == 'ApplicationNotUsingClientCredentials'"
      },
      {
        "description": "All 'AzureSecureScoreAdminMFAV2' controls received in the last 14 days",
        "query": "let timeframe = 14d;\n            SenservaPro_CL\n            | where TimeGenerated >= ago(timeframe)\n            | where ControlName_s == 'AzureSecureScoreAdminMFAV2'"
      },
      {
        "description": "All 'AzureSecureScoreBlockLegacyAuthentication' controls received in the last 14 days",
        "query": "let timeframe = 14d;\n            SenservaPro_CL\n            | where TimeGenerated >= ago(timeframe)\n            | where ControlName_s == 'AzureSecureScoreBlockLegacyAuthentication'"
      },
      {
        "description": "All 'AzureSecureScoreIntegratedApps' controls received in the last 14 days",
        "query": "let timeframe = 14d;\n            SenservaPro_CL\n            | where TimeGenerated >= ago(timeframe)\n            | where ControlName_s == 'AzureSecureScoreIntegratedApps'"
      },
      {
        "description": "All 'AzureSecureScoreMFARegistrationV2' controls received in the last 14 days",
        "query": "let timeframe = 14d;\n            SenservaPro_CL\n            | where TimeGenerated >= ago(timeframe)\n            | where ControlName_s == 'AzureSecureScoreMFARegistrationV2'"
      },
      {
        "description": "All 'AzureSecureScoreOneAdmin' controls received in the last 14 days",
        "query": "let timeframe = 14d;\n            SenservaPro_CL\n            | where TimeGenerated >= ago(timeframe)\n            | where ControlName_s == 'AzureSecureScoreOneAdmin'"
      },
      {
        "description": "All 'AzureSecureScorePWAgePolicyNew' controls received in the last 14 days",
        "query": "let timeframe = 14d;\n            SenservaPro_CL\n            | where TimeGenerated >= ago(timeframe)\n            | where ControlName_s == 'AzureSecureScorePWAgePolicyNew'"
      },
      {
        "description": "All 'AzureSecureScoreRoleOverlap' controls received in the last 14 days",
        "query": "let timeframe = 14d;\n            SenservaPro_CL\n            | where TimeGenerated >= ago(timeframe)\n            | where ControlName_s == 'AzureSecureScoreRoleOverlap'"
      },
      {
        "description": "All 'AzureSecureScoreSelfServicePasswordReset' controls received in the last 14 days",
        "query": "let timeframe = 14d;\n            SenservaPro_CL\n            | where TimeGenerated >= ago(timeframe)\n            | where ControlName_s == 'AzureSecureScoreSelfServicePasswordReset'"
      },
      {
        "description": "All 'AzureSecureScoreSigninRiskPolicy' controls received in the last 14 days",
        "query": "let timeframe = 14d;\n            SenservaPro_CL\n            | where TimeGenerated >= ago(timeframe)\n            | where ControlName_s == 'AzureSecureScoreSignInRiskPolicy'"
      },
      {
        "description": "All 'AzureSecureScoreUserRiskPolicy' controls received in the last 14 days",
        "query": "let timeframe = 14d;\n            SenservaPro_CL\n            | where TimeGenerated >= ago(timeframe)\n            | where ControlName_s == 'AzureSecureScoreUserRiskPolicy'"
      },
      {
        "description": "All 'Disabled' controls received in the last 14 days",
        "query": "let timeframe = 14d;\n            SenservaPro_CL\n            | where TimeGenerated >= ago(timeframe)\n            | where ControlName_s == 'UserDisabled'"
      },
      {
        "description": "All 'NonAdminGuest' controls received in the last 14 days",
        "query": "let timeframe = 14d;\n            SenservaPro_CL\n            | where TimeGenerated >= ago(timeframe)\n            | where ControlName_s == 'UserNonAdminGuest'"
      },
      {
        "description": "All 'ServicePrincipalNotUsingClientCredentials' controls received in the last 14 days",
        "query": "let timeframe = 14d;\n            SenservaPro_CL\n            | where TimeGenerated >= ago(timeframe)\n            | where ControlName_s == 'ServicePrincipalNotUsingClientCredentials'"
      },
      {
        "description": "All 'StaleLastPasswordChange' controls received in the last 14 days",
        "query": "let timeframe = 14d;\n            SenservaPro_CL\n            | where TimeGenerated >= ago(timeframe)\n            | where ControlName_s == 'UserStaleLastPasswordChange'"
      }
    ],
    "dataTypes": [
      {
        "name": "SenservaPro_CL",
        "lastDataReceivedQuery": "SenservaPro_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "SenservaPro_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Setup the data connection",
        "description": "Visit [Senserva Setup](https://www.senserva.com/senserva-microsoft-sentinel-edition-setup/) for information on setting up the Senserva data connection, support, or any other questions. The Senserva installation will configure a Log Analytics Workspace for output. Deploy Microsoft Sentinel onto the configured Log Analytics Workspace to finish the data connection setup by following [this onboarding guide.](https://docs.microsoft.com/azure/sentinel/quickstart-onboard)",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ],
    "metadata": {
      "id": "6a9b5994-e3c2-45ad-8a85-6fbfa6fde979",
      "version": "3.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Senserva"
      },
      "support": {
        "name": "Senserva",
        "link": "https://www.senserva.com/contact-us/",
        "tier": "developer",
        "email": "support@senserva.com"
      }
    }
  },
  {
    "id": "SentinelOne",
    "title": "SentinelOne",
    "publisher": "SentinelOne",
    "descriptionMarkdown": "The [SentinelOne](https://www.sentinelone.com/) data connector provides the capability to ingest common SentinelOne server objects such as Threats, Agents, Applications, Activities, Policies, Groups, and more events into Microsoft Sentinel through the REST API. Refer to API documentation: `https://<SOneInstanceDomain>.sentinelone.net/api-doc/overview` for more information. The connector provides ability to get events which helps to examine potential security risks, analyze your team's use of collaboration, diagnose configuration problems and more.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "SentinelOne_CL",
        "baseQuery": "SentinelOne_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "SentinelOne Events - All Activities.",
        "query": "SentinelOne\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "SentinelOne_CL",
        "lastDataReceivedQuery": "SentinelOne_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "SentinelOne_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "**SentinelOneAPIToken** is required.  See the documentation to learn more about API on the `https://<SOneInstanceDomain>.sentinelone.net/api-doc/overview`."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the SentinelOne API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias SentinelOne and load the function code or click [here](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/SentinelOne/Parsers/SentinelOne.txt). The function usually takes 10-15 minutes to activate after solution installation/update."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the SentinelOne API**\n\n Follow the instructions to obtain the credentials.\n\n1. Log in to the SentinelOne Management Console with Admin user credentials.\n2. In the Management Console, click **Settings**.\n3. In the **SETTINGS** view, click **USERS**\n4. Click **New User**.\n5. Enter the information for the new console user.\n5. In Role, select **Admin**.\n6. Click **SAVE**\n7. Save credentials of the new user for using in the data connector."
      },
      {
        "title": "",
        "description": "**NOTE :-** Admin access can be delegated using custom roles. Please review SentinelOne [documentation](https://www.sentinelone.com/blog/feature-spotlight-fully-custom-role-based-access-control/) to learn more about custom RBAC."
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the SentinelOne data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following).",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the SentinelOne Audit data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-SentinelOneAPI-azuredeploy) [![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://aka.ms/sentinel-SentinelOneAPI-azuredeploy-gov)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n> **NOTE:** Within the same resource group, you can't mix Windows and Linux apps in the same region. Select existing resource group without Windows apps in it or create new resource group.\n3. Enter the **SentinelOneAPIToken**, **SentinelOneUrl** `(https://<SOneInstanceDomain>.sentinelone.net)` and deploy. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the SentinelOne Reports data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-SentinelOneAPI-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. SOneXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.11.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n 1. In the Function App, select the Function App Name and select **Configuration**.\n\n 2. In the **Application settings** tab, select ** New application setting**.\n\n 3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\t SentinelOneAPIToken\n\t\t SentinelOneUrl\n\t\t WorkspaceID\n\t\t WorkspaceKey\n\t\t logAnalyticsUri (optional)\n\n> - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n\n 4. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "SentinelOneCCP",
    "title": "SentinelOne",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The [SentinelOne](https://usea1-nessat.sentinelone.net/api-doc/overview) data connector allows ingesting logs from the SentinelOne API into Microsoft Sentinel. The data connector is built on Microsoft Sentinel Codeless Connector Platform. It uses the SentinelOne API to fetch logs and it supports DCR-based [ingestion time transformations](https://docs.microsoft.com/azure/azure-monitor/logs/custom-logs-overview) that parses the received security data into a custom table so that queries don't need to parse it again, thus resulting in better performance.",
    "graphQueries": [
      {
        "metricName": "Total activities logs received",
        "legend": "SentinelOne Activities Logs",
        "baseQuery": "SentinelOneActivities_CL"
      },
      {
        "metricName": "Total agents logs received",
        "legend": "SentinelOne Agents Logs",
        "baseQuery": "SentinelOneAgents_CL"
      },
      {
        "metricName": "Total groups logs received",
        "legend": "SentinelOne Groups Logs",
        "baseQuery": "SentinelOneGroups_CL"
      },
      {
        "metricName": "Total threats logs received",
        "legend": "SentinelOne Threats Logs",
        "baseQuery": "SentinelOneThreats_CL"
      },
      {
        "metricName": "Total alerts logs received",
        "legend": "SentinelOne Alerts Logs",
        "baseQuery": "SentinelOneAlerts_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of SentinelOne activities logs",
        "query": "SentinelOneActivities_CL| take 10"
      },
      {
        "description": "Get Sample of SentinelOne groups logs",
        "query": "SentinelOneGroups_CL| take 10"
      },
      {
        "description": "Get Sample of SentinelOne threats logs",
        "query": "SentinelOneThreats_CL| take 10"
      },
      {
        "description": "Get Sample of SentinelOne agents logs",
        "query": "SentinelOneAgents_CL| take 10"
      },
      {
        "description": "Get Sample of SentinelOne alerts logs",
        "query": "SentinelOneAlerts_CL| take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "SentinelOneActivities_CL",
        "lastDataReceivedQuery": "SentinelOneActivities_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "SentinelOneAgents_CL",
        "lastDataReceivedQuery": "SentinelOneAgents_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "SentinelOneGroups_CL",
        "lastDataReceivedQuery": "SentinelOneGroups_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "SentinelOneThreats_CL",
        "lastDataReceivedQuery": "SentinelOneThreats_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "SentinelOneAlerts_CL",
        "lastDataReceivedQuery": "SentinelOneAlerts_CL\n       | where TimeGenerated > ago(12h)                | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "SevcoDevices",
    "title": "Sevco Platform - Devices",
    "publisher": "Sevco Security",
    "descriptionMarkdown": "The Sevco Platform - Devices connector allows you to easily connect your Sevco Device Assets with Microsoft Sentinel, to view dashboards, create custom alerts, and improve investigation. This gives you more insight into your organizations assets and improves your security operation capabilities.\n\n[For more information >](https://docs.sev.co/docs/microsoft-sentinel-inventory)",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Sevco Devices CL",
        "baseQuery": "Sevco_Devices_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Summarize by local IP address",
        "query": "Sevco_Devices_CL\n\n| summarize arg_max(TimeGenerated, *) by asset_id_g\n\n| extend IPs = parse_json(asset_attributes_ips_s), asset_attributes_hostname_s\n\n| mv-expand IPs\n\n| summarize count() by tostring(IPs)"
      },
      {
        "description": "Summarize by public IP address",
        "query": "Sevco_Devices_CL\n\n| summarize arg_max(TimeGenerated, *) by asset_id_g\n\n| extend source = parse_json(asset_source_ids_s), asset_attributes_hostname_s\n\n| mv-expand source\n\n| summarize count() by tostring(source)"
      },
      {
        "description": "Most recent inventory",
        "query": "Sevco_Devices_CL\n\n| summarize arg_max(TimeGenerated, *) by asset_id_g\n\n"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Sevco_Devices_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "Sevco_Devices_CL",
        "lastDataReceivedQuery": "Sevco_Devices_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Configure and connect to Sevco",
        "description": "The Sevco Platform can integrate with and export assets directly to Microsoft Sentinel..\n\n1.  Go to [Sevco - Microsoft Sentinel Integration](https://docs.sev.co/docs/microsoft-sentinel-inventory), and follow the instructions, using the parameters below to set up the connection:.\n\n",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ]
  },
  {
    "id": "SilverfortAma",
    "title": "Silverfort Admin Console",
    "publisher": "Silverfort",
    "descriptionMarkdown": "The [Silverfort](https://silverfort.com) ITDR Admin Console connector solution allows ingestion of Silverfort events and logging into Microsoft Sentinel.\n Silverfort provides syslog based events and logging using Common Event Format (CEF). By forwarding your Silverfort ITDR Admin Console CEF data into Microsoft Sentinel, you can take advantage of Sentinels's search & correlation, alerting, and threat intelligence enrichment on Silverfort data. \n Please contact Silverfort or consult the Silverfort documentation for more information.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Silverfort Inc.",
        "baseQuery": "CommonSecurityLog\n| where DeviceVendor == \"Silverfort\"\n| where DeviceProduct == \"Admin Console\""
      }
    ],
    "sampleQueries": [
      {
        "description": "Get all User Brute Force incidents",
        "query": "CommonSecurityLog \n  | where DeviceVendor has 'Silverfort'\n  | where DeviceProduct has 'Admin Console'\n  | where DeviceEventClassID == \"NewIncident\"\n  | where Message has \"UserBruteForce\"\n"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (DATATYPE_NAME)",
        "lastDataReceivedQuery": "CommonSecurityLog\n| where DeviceVendor == \"Silverfort\"\n| where DeviceProduct == \"Admin Console\"\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n| where DeviceVendor == \"Silverfort\"\n| where DeviceProduct == \"Admin Console\"\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Common Event Format (CEF) logs to Syslog agent",
        "description": "Set your security solution to send Syslog messages in CEF format to the proxy machine. Make sure you to send the logs to port 514 TCP on the machine's IP address."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "Unique Identifier (GUID) used to identify dependencies and content from solutions or community.",
      "version": "4.8.x",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "Silverfort"
      },
      "author": {
        "name": "Mark Weeks - Technical Alliances Team"
      },
      "support": {
        "tier": "developer",
        "name": "Silverfort",
        "email": "support@silverfort.com",
        "link": "https://silverfort.com"
      }
    }
  },
  {
    "id": "SlackAuditAPI",
    "title": "[DEPRECATED] Slack Audit",
    "publisher": "Slack",
    "descriptionMarkdown": "The [Slack](https://slack.com) Audit data connector provides the capability to ingest [Slack Audit Records](https://api.slack.com/admins/audit-logs) events into Microsoft Sentinel through the REST API. Refer to [API documentation](https://api.slack.com/admins/audit-logs#the_audit_event) for more information. The connector provides ability to get events which helps to examine potential security risks, analyze your team's use of collaboration, diagnose configuration problems and more.<p><span style='color:red; font-weight:bold;'>NOTE</span>: This data connector has been deprecated, consider moving to the CCF data connector available in the solution which replaces ingestion via the <a href='https://learn.microsoft.com/en-us/azure/azure-monitor/logs/custom-logs-migrate' style='color:#1890F1;'>deprecated HTTP Data Collector API</a>.</p>",
    "additionalRequirementBanner": "These queries and workbooks are dependent on a parser based on Kusto to work as expected. Follow the steps to use this Kusto functions alias **SlackAudit** in queries and workbooks [Follow steps to get this Kusto functions>](https://aka.ms/sentinel-SlackAuditAPI-parser).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "SlackAudit_CL",
        "baseQuery": "SlackAudit_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Slack Audit Events - All Activities.",
        "query": "SlackAudit\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "SlackAudit_CL",
        "lastDataReceivedQuery": "SlackAudit_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "SlackAudit_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "**SlackAPIBearerToken** is required for REST API. [See the documentation to learn more about API](https://api.slack.com/web#authentication). Check all [requirements and follow  the instructions](https://api.slack.com/web#authentication) for obtaining credentials."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Slack REST API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected. [Follow these steps](https://aka.ms/sentinel-SlackAuditAPI-parser) to create the Kusto functions alias, **SlackAudit**"
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the Slack API**\n\n [Follow the instructions](https://api.slack.com/web#authentication) to obtain the credentials. \n"
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Slack Audit data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following).",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Option 1 - Azure Resource Manager (ARM) Template",
                  "description": "Use this method for automated deployment of the Slack Audit data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-SlackAuditAPI-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n> **NOTE:** Within the same resource group, you can't mix Windows and Linux apps in the same region. Select existing resource group without Windows apps in it or create new resource group.\n3. Enter the **SlackAPIBearerToken** and deploy. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
                },
                {
                  "title": "Option 2 - Manual Deployment of Azure Functions",
                  "description": "Use the following step-by-step instructions to deploy the Slack Audit data connector manually with Azure Functions (Deployment via Visual Studio Code).",
                  "instructions": [
                    {
                      "parameters": {
                        "instructionSteps": [
                          {
                            "title": "Step 1 - Deploy a Function App",
                            "description": "1. Download the [Azure Function App](https://aka.ms/sentinel-SlackAuditAPI-functionapp) file. Extract archive to your local development computer.\n2. Follow the [function app manual deployment instructions](https://github.com/Azure/Azure-Sentinel/blob/master/DataConnectors/AzureFunctionsManualDeployment.md#function-app-manual-deployment-instructions) to deploy the Azure Functions app using VSCode.\n3. After successful deployment of the function app, follow next steps for configuring it."
                          },
                          {
                            "title": "Step 2 - Configure the Function App",
                            "description": "1. Go to Azure Portal for the Function App configuration.\n2. In the Function App, select the Function App Name and select **Configuration**.\n3. In the **Application settings** tab, select ** New application setting**.\n4. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tSlackAPIBearerToken\n\t\tWorkspaceID\n\t\tWorkspaceKey\n\t\tlogAnalyticsUri (optional)\n> - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n3. Once all application settings have been entered, click **Save**."
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "SlackAuditLogsCCPDefinition",
    "title": "SlackAudit (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The SlackAudit data connector provides the capability to ingest [Slack Audit logs](https://api.slack.com/admins/audit-logs) into Microsoft Sentinel through the REST API. Refer to [API documentation](https://api.slack.com/admins/audit-logs-call) for more information.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "SlackAudit Logs",
        "baseQuery": "{{graphQueriesTableName}}"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample of SlackAudit logs",
        "query": "{{graphQueriesTableName}}\n | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "SnowflakeDataConnector",
    "title": "[DEPRECATED] Snowflake",
    "publisher": "Snowflake",
    "descriptionMarkdown": "The Snowflake data connector provides the capability to ingest Snowflake [login logs](https://docs.snowflake.com/en/sql-reference/account-usage/login_history.html) and [query logs](https://docs.snowflake.com/en/sql-reference/account-usage/query_history.html) into Microsoft Sentinel using the Snowflake Python Connector. Refer to [Snowflake  documentation](https://docs.snowflake.com/en/user-guide/python-connector.html) for more information.\n\n<p><span style='color:red; font-weight:bold;'>NOTE</span>: This data connector has been deprecated, consider moving to the CCF data connector available in the solution which replaces ingestion via the <a href='https://learn.microsoft.com/en-us/azure/azure-monitor/logs/custom-logs-migrate' style='color:#1890F1;'>deprecated HTTP Data Collector API</a>.</p>",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected [**Snowflake**](https://aka.ms/sentinel-SnowflakeDataConnector-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Snowflake Events",
        "legend": "Snowflake_CL",
        "baseQuery": "Snowflake_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Snowflake Events",
        "query": "Snowflake_CL\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Snowflake_CL",
        "lastDataReceivedQuery": "Snowflake_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Snowflake_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Snowflake Credentials",
          "description": "**Snowflake Account Identifier**, **Snowflake User** and **Snowflake Password** are required for connection. See the documentation to learn more about [Snowflake Account Identifier](https://docs.snowflake.com/en/user-guide/admin-account-identifier.html#). Instructions on how to create user for this connector you can find below."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Azure Blob Storage API to pull logs into Microsoft Sentinel. This might result in additional costs for data ingestion and for storing data in Azure Blob Storage costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) and [Azure Blob Storage pricing page](https://azure.microsoft.com/pricing/details/storage/blobs/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**Snowflake**](https://aka.ms/sentinel-SnowflakeDataConnector-parser) which is deployed with the Microsoft Sentinel Solution."
      },
      {
        "title": "",
        "description": "**STEP 1 - Creating user in Snowflake**\n\nTo query data from Snowflake you need a user that is assigned to a role with sufficient privileges and a virtual warehouse cluster. The initial size of this cluster will be set to small but if it is insufficient, the cluster size can be increased as necessary.\n\n1. Enter the Snowflake console.\n2. Switch role to SECURITYADMIN and [create a new role](https://docs.snowflake.com/en/sql-reference/sql/create-role.html):\n```\nUSE ROLE SECURITYADMIN;\nCREATE OR REPLACE ROLE EXAMPLE_ROLE_NAME;```\n3. Switch role to SYSADMIN and [create warehouse](https://docs.snowflake.com/en/sql-reference/sql/create-warehouse.html) and [grand access](https://docs.snowflake.com/en/sql-reference/sql/grant-privilege.html) to it:\n```\nUSE ROLE SYSADMIN;\nCREATE OR REPLACE WAREHOUSE EXAMPLE_WAREHOUSE_NAME\n  WAREHOUSE_SIZE = 'SMALL' \n  AUTO_SUSPEND = 5\n  AUTO_RESUME = true\n  INITIALLY_SUSPENDED = true;\nGRANT USAGE, OPERATE ON WAREHOUSE EXAMPLE_WAREHOUSE_NAME TO ROLE EXAMPLE_ROLE_NAME;```\n4. Switch role to SECURITYADMIN and [create a new user](https://docs.snowflake.com/en/sql-reference/sql/create-user.html):\n```\nUSE ROLE SECURITYADMIN;\nCREATE OR REPLACE USER EXAMPLE_USER_NAME\n   PASSWORD = 'example_password'\n   DEFAULT_ROLE = EXAMPLE_ROLE_NAME\n   DEFAULT_WAREHOUSE = EXAMPLE_WAREHOUSE_NAME\n;```\n5. Switch role to ACCOUNTADMIN and [grant access to snowflake database](https://docs.snowflake.com/en/sql-reference/account-usage.html#enabling-account-usage-for-other-roles) for role.\n```\nUSE ROLE ACCOUNTADMIN;\nGRANT IMPORTED PRIVILEGES ON DATABASE SNOWFLAKE TO ROLE EXAMPLE_ROLE_NAME;```\n6. Switch role to SECURITYADMIN and [assign role](https://docs.snowflake.com/en/sql-reference/sql/grant-role.html) to user:\n```\nUSE ROLE SECURITYADMIN;\nGRANT ROLE EXAMPLE_ROLE_NAME TO USER EXAMPLE_USER_NAME;```\n\n>**IMPORTANT:** Save user and API password created during this step as they will be used during deployment step."
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following), as well as Snowflake credentials, readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Option 1 - Azure Resource Manager (ARM) Template",
                  "description": "Use this method for automated deployment of the data connector using an ARM Template.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-SnowflakeDataConnector-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Snowflake Account Identifier**, **Snowflake User**, **Snowflake Password**, **Microsoft Sentinel Workspace Id**, **Microsoft Sentinel Shared Key**\n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**.\n5. Click **Purchase** to deploy."
                },
                {
                  "title": "Option 2 - Manual Deployment of Azure Functions",
                  "description": "Use the following step-by-step instructions to deploy the data connector manually with Azure Functions (Deployment via Visual Studio Code).",
                  "instructions": [
                    {
                      "parameters": {
                        "instructionSteps": [
                          {
                            "title": "Step 1 - Deploy a Function App",
                            "description": "1. Download the [Azure Function App](https://aka.ms/sentinel-SnowflakeDataConnector-functionapp) file. Extract archive to your local development computer.\n2. Follow the [function app manual deployment instructions](https://github.com/Azure/Azure-Sentinel/blob/master/DataConnectors/AzureFunctionsManualDeployment.md#function-app-manual-deployment-instructions) to deploy the Azure Functions app using VSCode.\n3. After successful deployment of the function app, follow next steps for configuring it."
                          },
                          {
                            "title": "Step 2 - Configure the Function App",
                            "description": "1. Go to Azure Portal for the Function App configuration. \n2. In the Function App, select the Function App Name and select **Configuration**.\n3. In the **Application settings** tab, select **+ New application setting**.\n4. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tSNOWFLAKE_ACCOUNT\n\t\tSNOWFLAKE_USER\n\t\tSNOWFLAKE_PASSWORD\n\t\tWORKSPACE_ID\n\t\tSHARED_KEY\n\t\tlogAnalyticsUri (optional)\n - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://WORKSPACE_ID.ods.opinsights.azure.us`. \n4. Once all application settings have been entered, click **Save**."
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "SnowflakeLogsCCPDefinition",
    "title": "Snowflake (via Codeless Connector Framework)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The Snowflake data connector provides the capability to ingest Snowflake [Login History Logs](https://docs.snowflake.com/en/sql-reference/account-usage/login_history), [Query History Logs](https://docs.snowflake.com/en/sql-reference/account-usage/query_history), [User-Grant Logs](https://docs.snowflake.com/en/sql-reference/account-usage/grants_to_users), [Role-Grant Logs](https://docs.snowflake.com/en/sql-reference/account-usage/grants_to_roles), [Load History Logs](https://docs.snowflake.com/en/sql-reference/account-usage/load_history), [Materialized View Refresh History Logs](https://docs.snowflake.com/en/sql-reference/account-usage/materialized_view_refresh_history), [Roles Logs](https://docs.snowflake.com/en/sql-reference/account-usage/roles), [Tables Logs](https://docs.snowflake.com/en/sql-reference/account-usage/tables), [Table Storage Metrics Logs](https://docs.snowflake.com/en/sql-reference/account-usage/table_storage_metrics), [Users Logs](https://docs.snowflake.com/en/sql-reference/account-usage/users) into Microsoft Sentinel using the Snowflake SQL API. Refer to [Snowflake SQL API documentation](https://docs.snowflake.com/en/developer-guide/sql-api/reference) for more information.",
    "graphQueries": [
      {
        "metricName": "Total Login events received",
        "legend": "Snowflake Login History Logs",
        "baseQuery": "SnowflakeLogin_CL"
      },
      {
        "metricName": "Total Query events received",
        "legend": "Snowflake Query History Logs",
        "baseQuery": "SnowflakeQuery_CL"
      },
      {
        "metricName": "Total Grants to User events received",
        "legend": "Snowflake User Grant Logs",
        "baseQuery": "SnowflakeUserGrant_CL"
      },
      {
        "metricName": "Total Grants to Role events received",
        "legend": "Snowflake Role Grant Logs",
        "baseQuery": "SnowflakeRoleGrant_CL"
      },
      {
        "metricName": "Total Load History events received",
        "legend": "Snowflake Load History Logs",
        "baseQuery": "SnowflakeLoad_CL"
      },
      {
        "metricName": "Total Materialized View Refresh History events received",
        "legend": "Snowflake Materialized View Refresh History Logs",
        "baseQuery": "SnowflakeMaterializedView_CL"
      },
      {
        "metricName": "Total Role Events received",
        "legend": "Snowflake Roles Logs",
        "baseQuery": "SnowflakeRoles_CL"
      },
      {
        "metricName": "Total Table Events received",
        "legend": "Snowflake Tables Logs",
        "baseQuery": "SnowflakeTables_CL"
      },
      {
        "metricName": "Total Table Storage Metrics Events received",
        "legend": "Snowflake Table Storage Metrics Logs",
        "baseQuery": "SnowflakeTableStorageMetrics_CL"
      },
      {
        "metricName": "Total Users Events received",
        "legend": "Snowflake Users Logs",
        "baseQuery": "SnowflakeUsers_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get Sample Login Events of Snowflake",
        "query": "SnowflakeLogin_CL\r\n| mv-expand OuterArray = todynamic(Data)\r\n| mv-expand innerArray = OuterArray\r\n| extend JsonString = tostring(innerArray)\r\n| extend Time = toreal(extractjson(\"$.EVENT_TIMESTAMP\", JsonString))\r\n| extend\r\n    SrcDvcIpAddr = extractjson(\"$.CLIENT_IP\", JsonString),\r\n    LoginClientPrivateLinkId = extractjson(\"$.CLIENT_PRIVATE_LINK_ID\", JsonString),\r\n    LoginConnection = extractjson(\"$.CONNECTION\", JsonString),\r\n    LoginErrorCode = extractjson(\"$.ERROR_CODE\", JsonString),\r\n    LoginErrorMessage = extractjson(\"$.ERROR_MESSAGE\", JsonString),\r\n    LoginEventId = extractjson(\"$.EVENT_ID\", JsonString),\r\n    LoginEventEndTime = unixtime_seconds_todatetime(Time),\r\n    LoginEventType = extractjson(\"$.EVENT_TYPE\", JsonString),\r\n    LoginFirstAuthenticationFactor = extractjson(\"$.FIRST_AUTHENTICATION_FACTOR\", JsonString),\r\n    LoginIsSuccess = extractjson(\"$.IS_SUCCESS\", JsonString),\r\n    LoginRelatedEventId = extractjson(\"$.RELATED_EVENT_ID\", JsonString),\r\n    LoginReportedClientType = extractjson(\"$.REPORTED_CLIENT_TYPE\", JsonString),\r\n    LoginReportedClientVersion = extractjson(\"$.REPORTED_CLIENT_VERSION\", JsonString),\r\n    LoginSecondAuthenticationFactor = extractjson(\"$.SECOND_AUTHENTICATION_FACTOR\", JsonString),\r\n    TargetUsername = extractjson(\"$.USER_NAME\", JsonString)\r\n| extend User = TargetUsername\r\n| project-away Data, OuterArray, JsonString\r\n| take 10"
      },
      {
        "description": "Get Sample Query Events of Snowflake",
        "query": "SnowflakeQuery_CL\r\n| mv-expand OuterArray = todynamic(Data)\r\n| mv-expand innerArray = OuterArray\r\n| extend JsonString = tostring(innerArray)\r\n| extend\r\n    QueryStartTime = unixtime_seconds_todatetime(toreal(extractjson(\"$.START_TIME\", JsonString))),\r\n    QueryEndTime = unixtime_seconds_todatetime(toreal(extractjson(\"$.END_TIME\", JsonString))),\r\n    QueryTotalElapsedTime = toreal(extractjson(\"$.TOTAL_ELAPSED_TIME\", JsonString)),\r\n    QueryExecutionTime = toreal(extractjson(\"$.EXECUTION_TIME\", JsonString))\r\n| extend\r\n    QueryId = extractjson(\"$.QUERY_ID\", JsonString),\r\n    QueryText = extractjson(\"$.QUERY_TEXT\", JsonString),\r\n    QueryDatabaseId = extractjson(\"$.DATABASE_ID\", JsonString),\r\n    QueryDatabaseName = extractjson(\"$.DATABASE_NAME\", JsonString),\r\n    QuerySchemaId = extractjson(\"$.SCHEMA_ID\", JsonString),\r\n    QuerySchemaName = extractjson(\"$.SCHEMA_NAME\", JsonString),\r\n    QueryType = extractjson(\"$.QUERY_TYPE\", JsonString),\r\n    QuerySessionId = extractjson(\"$.SESSION_ID\", JsonString),\r\n    QueryUserName = extractjson(\"$.USER_NAME\", JsonString),\r\n    QueryRoleName = extractjson(\"$.ROLE_NAME\", JsonString),\r\n    QueryWarehouseId = extractjson(\"$.WAREHOUSE_ID\", JsonString),\r\n    QueryWarehouseName = extractjson(\"$.WAREHOUSE_NAME\", JsonString),\r\n    QueryWarehouseSize = extractjson(\"$.WAREHOUSE_SIZE\", JsonString),\r\n    QueryWarehouseType = extractjson(\"$.WAREHOUSE_TYPE\", JsonString),\r\n    QueryClusterNumber = extractjson(\"$.CLUSTER_NUMBER\", JsonString),\r\n    QueryTag = extractjson(\"$.TAG\", JsonString),\r\n    QueryBytesScanned = extractjson(\"$.BYTES_SCANNED\", JsonString),\r\n    QueryPercentageScannedFromCache = extractjson(\"$.PERCENTAGE_SCANNED_FROM_CACHE\", JsonString),\r\n    QueryBytesWritten = extractjson(\"$.BYTES_WRITTEN\", JsonString),\r\n    QueryBytesWrittenToResult = extractjson(\"$.BYTES_WRITTEN_TO_RESULT\", JsonString),\r\n    QueryBytesReadFromResult = extractjson(\"$.BYTES_READ_FROM_RESULT\", JsonString),\r\n    QueryRowsProduced = extractjson(\"$.ROWS_PRODUCED\", JsonString),\r\n    QueryRowsInserted = extractjson(\"$.ROWS_INSERTED\", JsonString),\r\n    QueryRowsUpdated = extractjson(\"$.ROWS_UPDATED\", JsonString),\r\n    QueryRowsDeleted = extractjson(\"$.ROWS_DELETED\", JsonString),\r\n    QueryRowsUnloaded = extractjson(\"$.ROWS_UNLOADED\", JsonString),\r\n    QueryBytesDeleted = extractjson(\"$.BYTES_DELETED\", JsonString),\r\n    QueryQueuedProvisioningTime = extractjson(\"$.PROVISIONING_TIME\", JsonString),\r\n    QueryQueuedRepairTime = extractjson(\"$.QUEUED_REPAIR_TIME\", JsonString),\r\n    QueryQueuedOverloadTime = extractjson(\"$.QUEUED_OVERLOAD_TIME\", JsonString),\r\n    QueryTransactionBlockedTime = extractjson(\"$.TRANSACTION_BLOCKED_TIME\", JsonString),\r\n    QueryOutboundDataTransferCloud = extractjson(\"$.OUTBOUND_DATA_TRANSFER_CLOUD\", JsonString),\r\n    QueryOutboundDataTransferRegion = extractjson(\"$.OUTBOUND_DATA_TRANSFER_REGION\", JsonString),\r\n    QueryOutboundDataTransferBytes = extractjson(\"$.OUTBOUND_DATA_TRANSFER_BYTES\", JsonString),\r\n    QueryInboundDataTransferCloud = extractjson(\"$.INBOUND_DATA_TRANSFER_CLOUD\", JsonString),\r\n    QueryInboundDataTransferRegion = extractjson(\"$.INBOUND_DATA_TRANSFER_REGION\", JsonString),\r\n    QueryInboundDataTransferBytes = extractjson(\"$.INBOUND_DATA_TRANSFER_BYTES\", JsonString),\r\n    QueryPartitionsScanned = extractjson(\"$.PARTITIONS_SCANNED\", JsonString),\r\n    QueryPartitionsTotal = extractjson(\"$.PARTITIONS_TOTAL\", JsonString),\r\n    QueryBytesSpilledToLocalStorage = extractjson(\"$.BYTES_SPILLED_TO_LOCAL_STORAGE\", JsonString),\r\n    QueryBytesSpilledToRemoteStorage = extractjson(\"$.BYTES_SPILLED_TO_REMOTE_STORAGE\", JsonString),\r\n    QueryBytesSentOverTheNetwork = extractjson(\"$.BYTES_SENT_OVER_THE_NETWORK\", JsonString),\r\n    QueryCompilationTime = extractjson(\"$.COMPILATION_TIME\", JsonString),\r\n    QueryExecutionStatus = extractjson(\"$.EXECUTION_STATUS\", JsonString),\r\n    QueryErrorCode = extractjson(\"$.ERROR_CODE\", JsonString),\r\n    QueryErrorMessage = extractjson(\"$.ERROR_MESSAGE\", JsonString),\r\n    QueryListExternalFilesTime = extractjson(\"$.LIST_EXTERNAL_FILES_TIME\", JsonString),\r\n    QueryCreditsUsedCloudServices = extractjson(\"$.CREDITS_USED_CLOUD_SERVICES\", JsonString),\r\n    QueryReleaseVersion = extractjson(\"$.RELEASE_VERSION\", JsonString),\r\n    QueryExternalFunctionTotalInvocations = extractjson(\"$.EXTERNAL_FUNCTION_TOTAL_INVOCATIONS\", JsonString),\r\n    QueryExternalFunctionTotalSentRows = extractjson(\"$.EXTERNAL_FUNCTION_TOTAL_SENT_ROWS\", JsonString),\r\n    QueryExternalFunctionTotalReceivedRows = extractjson(\"$.EXTERNAL_FUNCTION_TOTAL_RECEIVED_ROWS\", JsonString),\r\n    QueryExternalFunctionTotalSentBytes = extractjson(\"$.EXTERNAL_FUNCTION_TOTAL_SENT_BYTES\", JsonString),\r\n    QueryExternalFunctionTotalReceivedBytes = extractjson(\"$.EXTERNAL_FUNCTION_TOTAL_RECEIVED_BYTES\", JsonString),\r\n    QueryIsClientGeneratedStatement = extractjson(\"$.IS_CLIENT_GENERATED_STATEMENT\", JsonString),\r\n    QueryAccelerationBytesScanned = extractjson(\"$.ACCELERATION_BYTES_SCANNED\", JsonString),\r\n    QueryAccelerationPartitionsScanned = extractjson(\"$.ACCELERATION_PARTITIONS_SCANNED\", JsonString),\r\n    QueryAccelerationUpperLimitScaleFactor = extractjson(\"$.ACCELERATION_UPPER_LIMIT_SCALE_FACTOR\", JsonString),\r\n    QueryTransactionId = extractjson(\"$.TRANSACTION_ID\", JsonString),\r\n    QueryLoadPercent = extractjson(\"$.QUERY_LOAD_PERCENT\", JsonString),\r\n    ChildQueriesWaitTime = extractjson(\"$.CHILD_QUERIES_WAIT_TIME\", JsonString),\r\n    QueryRoleType = extractjson(\"$.ROLE_TYPE\", JsonString),\r\n    QueryHash = extractjson(\"$.HASH\", JsonString),\r\n    QueryHashVersion = extractjson(\"$.HASH_VERSION\", JsonString),\r\n    QueryParameterizedHash = extractjson(\"$.PARAMETERIZED_HASH\", JsonString),\r\n    QueryParameterizedHashVersion = extractjson(\"$.PARAMETERIZED_HASH_VERSION\", JsonString),\r\n    QuerySecondaryRoleStats = extractjson(\"$.SECONDARY_ROLE_STATS\", JsonString),\r\n    QueryRowsWrittenToResult = extractjson(\"$.ROWS_WRITTEN_TO_RESULT\", JsonString),\r\n    QueryRetryTime = extractjson(\"$.RETRY_TIME\", JsonString),\r\n    QueryRetryCause = extractjson(\"$.RETRY_CAUSE\", JsonString),\r\n    QueryFaultHandlingTime = extractjson(\"$.FAULT_HANDLING_TIME\", JsonString),\r\n    QueryUserType = extractjson(\"$.USER_TYPE\", JsonString),\r\n    QueryUserDatabaseName = extractjson(\"$.USER_DATABASE_NAME\", JsonString),\r\n    QueryUserDatabaseId = extractjson(\"$.USER_DATABASE_ID\", JsonString),\r\n    QueryUserSchemaId = extractjson(\"$.USER_SCHEMA_ID\", JsonString),\r\n    QueryUserSchemaName = extractjson(\"$.USER_SCHEMA_NAME\", JsonString)\r\n| project-away Data, OuterArray, JsonString\r\n| take 10"
      },
      {
        "description": "Get Sample User Grant Events of Snowflake",
        "query": "SnowflakeUserGrant_CL\r\n| mv-expand OuterArray = todynamic(Data)\r\n| mv-expand innerArray = OuterArray\r\n| extend JsonString = tostring(innerArray)\r\n| extend\r\n    CTime = toreal(extractjson(\"$.CREATED_ON\", JsonString)),\r\n    DTime = toreal(extractjson(\"$.DELETED_ON\", JsonString))\r\n| extend\r\n    UserGrantCreatedOn = unixtime_seconds_todatetime(CTime),\r\n    UserGrantDeletedOn = unixtime_seconds_todatetime(DTime),\r\n    UserRole = extractjson(\"$.ROLE\", JsonString),\r\n    UserGrantGrantedTo = extractjson(\"$.GRANTED_TO\", JsonString),\r\n    UserGrantGranteeName = extractjson(\"$.GRANTEE_NAME\", JsonString),\r\n    UserGrantGrantedBy = extractjson(\"$.GRANTED_BY\", JsonString)\r\n| project-away Data, OuterArray, JsonString\r\n| take 10"
      },
      {
        "description": "Get Sample Role Grant Events of Snowflake",
        "query": "SnowflakeRoleGrant_CL\r\n| mv-expand OuterArray = todynamic(Data)\r\n| mv-expand innerArray = OuterArray\r\n| extend JsonString = tostring(innerArray)\r\n| extend \r\n    CTime = toreal(extractjson(\"$.CREATED_ON\", JsonString)),\r\n    MTime = toreal(extractjson(\"$.MODIFIED_ON\", JsonString)),\r\n    DTime = toreal(extractjson(\"$.DELETED_ON\", JsonString))\r\n| extend\r\n    RoleGrantCreatedOn = unixtime_seconds_todatetime(CTime),\r\n    RoleGrantModifiedOn = unixtime_seconds_todatetime(MTime),\r\n    RoleGrantPrivilege = extractjson(\"$.PRIVILEGE\", JsonString),\r\n    RoleGrantGrantedOn = extractjson(\"$.GRANTED_ON\", JsonString),\r\n    RoleGrantName = extractjson(\"$.NAME\", JsonString),\r\n    RoleGrantTableCatalog = extractjson(\"$.TABLE_CATALOG\", JsonString),\r\n    RoleGrantTableSchema = extractjson(\"$.TABLE_SCHEMA\", JsonString),\r\n    RoleGrantGrantedTo = extractjson(\"$.GRANTED_TO\", JsonString),\r\n    RoleGrantGranteeName = extractjson(\"$.GRANTEE_NAME\", JsonString),\r\n    RoleGrantGrantOption = extractjson(\"$.GRANT_OPTION\", JsonString),\r\n    RoleGrantGrantedBy = extractjson(\"$.GRANTED_BY\", JsonString),\r\n    RoleGrantDeletedOn = unixtime_seconds_todatetime(DTime),\r\n    RoleGrantGrantedByRoleType = extractjson(\"$.GRANTED_BY_ROLE_TYPE\", JsonString),\r\n    RoleGrantObjectInstance = extractjson(\"$.OBJECT_INSTANCE\", JsonString)\r\n| project-away Data, OuterArray, JsonString\r\n| take 10"
      },
      {
        "description": "Get Sample Load History Events of Snowflake",
        "query": "SnowflakeLoad_CL\r\n| mv-expand OuterArray = todynamic(Data)\r\n| mv-expand innerArray = OuterArray\r\n| extend JsonString = tostring(innerArray)\r\n| extend LTime = toreal(extractjson(\"$.LAST_LOAD_TIME\", JsonString))\r\n| extend\r\n    LoadTableId = extractjson(\"$.TABLE_ID\", JsonString),\r\n    LoadTableName = extractjson(\"$.TABLE_NAME\", JsonString),\r\n    LoadSchemaId = extractjson(\"$.SCHEMA_ID\", JsonString),\r\n    LoadSchemaName = extractjson(\"$.SCHEMA_NAME\", JsonString),\r\n    LoadCatalogId = extractjson(\"$.CATALOG_ID\", JsonString),\r\n    LoadCatalogName = extractjson(\"$.CATALOG_NAME\", JsonString),\r\n    LoadFileName = extractjson(\"$.FILE_NAME\", JsonString),\r\n    LastLoadTime = unixtime_seconds_todatetime(LTime),\r\n    LoadStatus = extractjson(\"$.STATUS\", JsonString),\r\n    LoadRowCount = extractjson(\"$.ROW_COUNT\", JsonString),\r\n    LoadRowParsed = extractjson(\"$.ROW_PARSED\", JsonString),\r\n    LoadFirstErrorMessage = extractjson(\"$.FIRST_ERROR_MESSAGE\", JsonString),\r\n    LoadFirstErrorLineNumber = extractjson(\"$.FIRST_ERROR_LINE_NUMBER\", JsonString),\r\n    LoadFirstErrorCharacterPosition = extractjson(\"$.FIRST_ERROR_CHARACTER_POSITION\", JsonString),\r\n    LoadFirstErrorColName = extractjson(\"$.FIRST_ERROR_COL_NAME\", JsonString),\r\n    LoadErrorCount = extractjson(\"$.ERROR_COUNT\", JsonString),\r\n    LoadErrorLimit = extractjson(\"$.ERROR_LIMIT\", JsonString)\r\n| project-away Data, OuterArray, JsonString\r\n| take 10"
      },
      {
        "description": "Get Sample Materialized View Refresh History Events of Snowflake",
        "query": "SnowflakeMaterializedView_CL\r\n| mv-expand OuterArray = todynamic(Data)\r\n| mv-expand innerArray = OuterArray\r\n| extend JsonString = tostring(innerArray)\r\n| extend\r\n    STime = toreal(extractjson(\"$.START_TIME\", JsonString)),\r\n    ETime = toreal(extractjson(\"$.END_TIME\", JsonString))\r\n| extend\r\n    MaterializedViewStartTime = unixtime_seconds_todatetime(STime),\r\n    MaterializedViewEndTime = unixtime_seconds_todatetime(ETime),\r\n    MaterializedViewCreditsUsed = extractjson(\"$.CREDITS_USED\", JsonString),\r\n    MaterializedViewTableId = extractjson(\"$.TABLE_ID\", JsonString),\r\n    MaterializedViewTableName = extractjson(\"$.TABLE_NAME\", JsonString),\r\n    MaterializedViewSchemaId = extractjson(\"$.SCHEMA_ID\", JsonString),\r\n    MaterializedViewSchemaName = extractjson(\"$.SCHEMA_NAME\", JsonString),\r\n    MaterializedViewDatabaseId = extractjson(\"$.DATABASE_ID\", JsonString),\r\n    MaterializedViewDatabaseName = extractjson(\"$.DATABASE_NAME\", JsonString)\r\n| project-away Data, OuterArray, JsonString\r\n| take 10"
      },
      {
        "description": "Get Sample Role Events of Snowflake",
        "query": "SnowflakeRoles_CL\r\n| mv-expand OuterArray = todynamic(Data)\r\n| mv-expand innerArray = OuterArray\r\n| extend JsonString = tostring(innerArray)\r\n| extend \r\n    CTime = toreal(extractjson(\"$.CREATED_ON\", JsonString)),\r\n    DTime = toreal(extractjson(\"$.DELETED_ON\", JsonString))\r\n| extend\r\n    RoleId = extractjson(\"$.ROLE_ID\", JsonString),\r\n    RoleCreatedOn = unixtime_seconds_todatetime(CTime),\r\n    RoleDeletedOn = unixtime_seconds_todatetime(DTime),\r\n    RoleName = extractjson(\"$.NAME\", JsonString),\r\n    RoleComment = extractjson(\"$.COMMENT\", JsonString),\r\n    RoleOwner = extractjson(\"$.OWNER\", JsonString),\r\n    RoleType = extractjson(\"$.ROLE_TYPE\", JsonString),\r\n    RoleDatabaseName = extractjson(\"$.ROLE_DATABASE_NAME\", JsonString),\r\n    RoleInstanceId = extractjson(\"$.ROLE_INSTANCE_ID\", JsonString),\r\n    OwnerRoleType = extractjson(\"$.OWNER_ROLE_TYPE\", JsonString)\r\n| project-away Data, OuterArray, JsonString\r\n| take 10"
      },
      {
        "description": "Get Sample Table Events of Snowflake",
        "query": "SnowflakeTables_CL\r\n| mv-expand OuterArray = todynamic(Data)\r\n| mv-expand innerArray = OuterArray\r\n| extend JsonString = tostring(innerArray)\r\n| extend\r\n    TCTime = toreal(extractjson(\"$.CREATED\", JsonString)),\r\n    LATime = toreal(extractjson(\"$.LAST_ALTERED\", JsonString)),\r\n    LDTime = toreal(extractjson(\"$.LAST_DDL\", JsonString)),\r\n    TDTime = toreal(extractjson(\"$.DELETED\", JsonString))\r\n| extend\r\n    TableId = extractjson(\"$.TABLE_ID\", JsonString),\r\n    TableName = extractjson(\"$.TABLE_NAME\", JsonString),\r\n    TableSchemaId = extractjson(\"$.TABLE_SCHEMA_ID\", JsonString),\r\n    TableSchema = extractjson(\"$.TABLE_SCHEMA\", JsonString),\r\n    TableCatalogId = extractjson(\"$.TABLE_CATALOG_ID\", JsonString),\r\n    TableCatalog = extractjson(\"$.TABLE_CATALOG\", JsonString),\r\n    TableOwner = extractjson(\"$.TABLE_OWNER\", JsonString),\r\n    TableType = extractjson(\"$.TABLE_TYPE\", JsonString),\r\n    TableIsTransient = extractjson(\"$.IS_TRANSIENT\", JsonString),\r\n    TableIsIceberg = extractjson(\"$.IS_ICEBERG\", JsonString),\r\n    TableIsDynamic = extractjson(\"$.IS_DYNAMIC\", JsonString),\r\n    TableIsHybrid = extractjson(\"$.IS_HYBRID\", JsonString),\r\n    TableClusteringKey = extractjson(\"$.CLUSTERING_KEY\", JsonString),\r\n    TableRowCount = extractjson(\"$.ROW_COUNT\", JsonString),\r\n    TableBytes = extractjson(\"$.BYTES\", JsonString),\r\n    TableRetentionTime = extractjson(\"$.RETENTION_TIME\", JsonString),\r\n    TableSelfReferencingColumnName = extractjson(\"$.SELF_REFERENCING_COLUMN_NAME\", JsonString),\r\n    TableReferenceGeneration = extractjson(\"$.REFERENCE_GENERATION\", JsonString),\r\n    TableUserDefinedTypeCatalog = extractjson(\"$.USER_DEFINED_TYPE_CATALOG\", JsonString),\r\n    TableUserDefinedTypeSchema = extractjson(\"$.USER_DEFINED_TYPE_SCHEMA\", JsonString),\r\n    TableUserDefinedTypeName = extractjson(\"$.USER_DEFINED_TYPE_NAME\", JsonString),\r\n    TableIsInsertableInto = extractjson(\"$.IS_INSERTABLE_INTO\", JsonString),\r\n    TableIsTyped = extractjson(\"$.IS_TYPED\", JsonString),\r\n    TableCommitAction = extractjson(\"$.COMMIT_ACTION\", JsonString),\r\n    TableCreated = unixtime_seconds_todatetime(TCTime),\r\n    TableLastAltered = unixtime_seconds_todatetime(LATime),\r\n    TableLastDDL = unixtime_seconds_todatetime(LDTime),\r\n    TableLastDDLBy = extractjson(\"$.LAST_DDL_BY\", JsonString),\r\n    TableDeleted = unixtime_seconds_todatetime(TDTime),\r\n    TableAutoClusteringOn = extractjson(\"$.AUTO_CLUSTERING_ON\", JsonString),\r\n    TableComment = extractjson(\"$.COMMENT\", JsonString),\r\n    TableOwnerRoleType = extractjson(\"$.OWNER_ROLE_TYPE\", JsonString),\r\n    TableInstanceId = extractjson(\"$.INSTANCE_ID\", JsonString)\r\n| project-away Data, OuterArray, JsonString\r\n| take 10"
      },
      {
        "description": "Get Sample Table Storage Metrics Events of Snowflake",
        "query": "SnowflakeTableStorageMetrics_CL\r\n| mv-expand OuterArray = todynamic(Data)\r\n| mv-expand innerArray = OuterArray\r\n| extend JsonString = tostring(innerArray)\r\n| extend\r\n    TCTime = toreal(extractjson(\"$.TABLE_CREATED\", JsonString)),\r\n    TDTime = toreal(extractjson(\"$.TABLE_DROPPED\", JsonString)),\r\n    TFTime = toreal(extractjson(\"$.TABLE_ENTERED_FAILSAFE\", JsonString)),\r\n    SCTime = toreal(extractjson(\"$.SCHEMA_CREATED\", JsonString)),\r\n    SDTime = toreal(extractjson(\"$.SCHEMA_DROPPED\", JsonString)),\r\n    CCTime = toreal(extractjson(\"$.CATALOG_CREATED\", JsonString)),\r\n    CDTime = toreal(extractjson(\"$.CATALOG_DROPPED\", JsonString))\r\n| extend\r\n    TableStorageMetricsId = extractjson(\"$.ID\", JsonString),\r\n    TableStorageMetricsTableName = extractjson(\"$.TABLE_NAME\", JsonString),\r\n    TableStorageMetricsTableSchemaId = extractjson(\"$.TABLE_SCHEMA_ID\", JsonString),\r\n    TableStorageMetricsTableSchema = extractjson(\"$.TABLE_SCHEMA\", JsonString),\r\n    TableStorageMetricsTableCatalogId = extractjson(\"$.TABLE_CATALOG_ID\", JsonString),\r\n    TableStorageMetricsTableCatalog = extractjson(\"$.TABLE_CATALOG\", JsonString),\r\n    TableStorageMetricsCloneGroupId = extractjson(\"$.CLONE_GROUP_ID\", JsonString),\r\n    TableStorageMetricsIsTransient = extractjson(\"$.IS_TRANSIENT\", JsonString),\r\n    TableStorageMetricsActiveBytes = extractjson(\"$.ACTIVE_BYTES\", JsonString),\r\n    TableStorageMetricsTimeTravelBytes = extractjson(\"$.TIME_TRAVEL_BYTES\", JsonString),\r\n    TableStorageMetricsFailsafeBytes = extractjson(\"$.FAILSAFE_BYTES\", JsonString),\r\n    TableStorageMetricsRetainedForCloneBytes = extractjson(\"$.RETAINED_FOR_CLONE_BYTES\", JsonString),\r\n    TableStorageMetricsDeleted = extractjson(\"$.DELETED\", JsonString),\r\n    TableStorageMetricsTableCreated = unixtime_seconds_todatetime(TCTime),\r\n    TableStorageMetricsTableDropped = unixtime_seconds_todatetime(TDTime),\r\n    TableStorageMetricsTableEnteredFailsafe = unixtime_seconds_todatetime(TFTime),\r\n    TableStorageMetricsSchemaCreated = unixtime_seconds_todatetime(SCTime),\r\n    TableStorageMetricsSchemaDropped = unixtime_seconds_todatetime(SDTime),\r\n    TableStorageMetricsCatalogCreated = unixtime_seconds_todatetime(CCTime),\r\n    TableStorageMetricsCatalogDropped = unixtime_seconds_todatetime(CDTime),\r\n    TableStorageMetricsComment = extractjson(\"$.COMMENT\", JsonString),\r\n    TableStorageMetricsInstanceId = extractjson(\"$.INSTANCE_ID\", JsonString)\r\n| project-away Data, OuterArray, JsonString\r\n| take 10"
      },
      {
        "description": "Get Sample Users of Snowflake",
        "query": "SnowflakeUsers_CL\r\n| mv-expand OuterArray = todynamic(Data)\r\n| mv-expand innerArray = OuterArray\r\n| extend JsonString = tostring(innerArray)\r\n| extend\r\n    CTime = toreal(extractjson(\"$.CREATED_ON\", JsonString)),\r\n    DTime = toreal(extractjson(\"$.DELETED_ON\", JsonString)),\r\n    BMTime = toreal(extractjson(\"$.BYPASS_MFA_UNTIL\", JsonString)),\r\n    LSLTime = toreal(extractjson(\"$.LAST_SUCCESS_LOGIN\", JsonString)),\r\n    ETime = toreal(extractjson(\"$.EXPIRES_AT\", JsonString)),\r\n    LUTime = toreal(extractjson(\"$.LOCKED_UNTIL_TIME\", JsonString)),\r\n    PLSTime = toreal(extractjson(\"$.PASSWORD_LAST_SET_TIME\", JsonString))\r\n| extend\r\n    UserId = extractjson(\"$.USER_ID\", JsonString),\r\n    UserName = extractjson(\"$.NAME\", JsonString),\r\n    UserCreatedOn = extractjson(\"$.CREATED_ON\", JsonString),\r\n    UserDeletedOn = extractjson(\"$.DELETED_ON\", JsonString),\r\n    UserLoginName = extractjson(\"$.LOGIN_NAME\", JsonString),\r\n    UserDisplayName = extractjson(\"$.DISPLAY_NAME\", JsonString),\r\n    UserFirstName = extractjson(\"$.FIRST_NAME\", JsonString),\r\n    UserLastName = extractjson(\"$.LAST_NAME\", JsonString),\r\n    UserEmail = extractjson(\"$.EMAIL\", JsonString),\r\n    UserMustChangePassword = extractjson(\"$.MUST_CHANGE_PASSWORD\", JsonString),\r\n    UserHasPassword = extractjson(\"$.HAS_PASSWORD\", JsonString),\r\n    UserComment = extractjson(\"$.COMMENT\", JsonString),\r\n    UserDisabled = extractjson(\"$.DISABLED\", JsonString),\r\n    UserSnowflakeLock = extractjson(\"$.SNOWFLAKE_LOCK\", JsonString),\r\n    UserDefaultWarehouse = extractjson(\"$.DEFAULT_WAREHOUSE\", JsonString),\r\n    UserDefaultNamespace = extractjson(\"$.DEFAULT_NAMESPACE\", JsonString),\r\n    UserDefaultRole = extractjson(\"$.DEFAULT_ROLE\", JsonString),\r\n    UserExtAuthnDuo = extractjson(\"$.EXT_AUTHN_DUO\", JsonString),\r\n    UserExtAuthnUid = extractjson(\"$.EXT_AUTHN_UID\", JsonString),\r\n    UserHasMFA = extractjson(\"$.HAS_MFA\", JsonString),\r\n    UserBypassMFAUntil = unixtime_seconds_todatetime(BMTime),\r\n    UserLastSuccessLogin = unixtime_seconds_todatetime(LSLTime),\r\n    UserExpiresAt = unixtime_seconds_todatetime(ETime),\r\n    UserLockedUntilTime = unixtime_seconds_todatetime(LUTime),\r\n    UserHasRSAPublicKey = extractjson(\"$.HAS_RSA_PUBLIC_KEY\", JsonString),\r\n    UserPasswordLastSetTime = unixtime_seconds_todatetime(PLSTime),\r\n    UserOwner = extractjson(\"$.OWNER\", JsonString),\r\n    UserDefaultSecondaryRole = extractjson(\"$.DEFAULT_SECONDARY_ROLE\", JsonString),\r\n    UserType = extractjson(\"$.TYPE\", JsonString),\r\n    UserDatabaseName = extractjson(\"$.DATABASE_NAME\", JsonString),\r\n    UserDatabaseId = extractjson(\"$.DATABASE_ID\", JsonString),\r\n    UserSchemaName = extractjson(\"$.SCHEMA_NAME\", JsonString),\r\n    UserSchemaId = extractjson(\"$.SCHEMA_ID\", JsonString)\r\n| project-away Data, OuterArray, JsonString\r\n| take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "SnowflakeLoad_CL",
        "lastDataReceivedQuery": "SnowflakeLoad_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "SnowflakeLogin_CL",
        "lastDataReceivedQuery": "SnowflakeLogin_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "SnowflakeMaterializedView_CL",
        "lastDataReceivedQuery": "SnowflakeMaterializedView_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "SnowflakeQuery_CL",
        "lastDataReceivedQuery": "SnowflakeQuery_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "SnowflakeRoleGrant_CL",
        "lastDataReceivedQuery": "SnowflakeRoleGrant_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "SnowflakeRoles_CL",
        "lastDataReceivedQuery": "SnowflakeRoles_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "SnowflakeTables_CL",
        "lastDataReceivedQuery": "SnowflakeTables_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "SnowflakeTableStorageMetrics_CL",
        "lastDataReceivedQuery": "SnowflakeTableStorageMetrics_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "SnowflakeUserGrant_CL",
        "lastDataReceivedQuery": "SnowflakeUserGrant_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "SnowflakeUsers_CL",
        "lastDataReceivedQuery": "SnowflakeUsers_CL\n | where TimeGenerated > ago(12h) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "isPreview": false,
      "status": 1
    },
    "metadata": null
  },
  {
    "id": "SonicWallFirewall",
    "title": "[Deprecated] SonicWall Firewall via Legacy Agent",
    "publisher": "SonicWall",
    "descriptionMarkdown": "Common Event Format (CEF) is an industry standard format on top of Syslog messages, used by SonicWall to allow event interoperability among different platforms. By connecting your CEF logs to Microsoft Sentinel, you can take advantage of search & correlation, alerting, and threat intelligence enrichment for each log.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "SonicWall",
        "baseQuery": "CommonSecurityLog\n| where DeviceVendor == \"SonicWall\""
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"SonicWall\"\n| sort by TimeGenerated desc"
      },
      {
        "description": "Summarize by destination IP and port",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"SonicWall\"\n| summarize count() by DestinationIP, DestinationPort, TimeGenerated\n| sort by TimeGenerated desc"
      },
      {
        "description": "Show all dropped traffic from the SonicWall Firewall",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"SonicWall\"\n| where AdditionalExtensions contains \"fw_action='drop'\""
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (SonicWall)",
        "lastDataReceivedQuery": "CommonSecurityLog\n| where DeviceVendor == \"SonicWall\"\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n| where DeviceVendor == \"SonicWall\"\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward SonicWall Firewall Common Event Format (CEF) logs to Syslog agent",
        "description": "Set your SonicWall Firewall to send Syslog messages in CEF format to the proxy machine. Make sure you send the logs to port 514 TCP on the machine's IP address.\n\n Follow Instructions . Then Make sure you select local use 4 as the facility. Then select ArcSight as the Syslog format."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "bbe6d9ef-2581-41b8-95b0-9d50c919d377",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "SonicWall"
      },
      "support": {
        "name": "SonicWall",
        "link": "https://www.sonicwall.com/support/",
        "tier": "developer"
      }
    }
  },
  {
    "id": "SonicWallFirewallAma",
    "title": "[Deprecated] SonicWall Firewall via AMA",
    "publisher": "SonicWall",
    "descriptionMarkdown": "Common Event Format (CEF) is an industry standard format on top of Syslog messages, used by SonicWall to allow event interoperability among different platforms. By connecting your CEF logs to Microsoft Sentinel, you can take advantage of search & correlation, alerting, and threat intelligence enrichment for each log.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "SonicWall",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'SonicWall'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"SonicWall\"\n| sort by TimeGenerated desc"
      },
      {
        "description": "Summarize by destination IP and port",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"SonicWall\"\n| summarize count() by DestinationIP, DestinationPort, TimeGenerated\n| sort by TimeGenerated desc"
      },
      {
        "description": "Show all dropped traffic from the SonicWall Firewall",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"SonicWall\"\n| where AdditionalExtensions contains \"fw_action='drop'\""
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (SonicWall)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'SonicWall'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'SonicWall'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine"
                },
                {
                  "title": "Step B. Forward SonicWall Firewall Common Event Format (CEF) logs to Syslog agent",
                  "description": "Set your SonicWall Firewall to send Syslog messages in CEF format to the proxy machine. Make sure you send the logs to port 514 TCP on the machine's IP address.\n\n Follow Instructions . Then Make sure you select local use 4 as the facility. Then select ArcSight as the Syslog format."
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "bbe6d9ef-2581-41b8-95b0-9d50c919d377",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "SonicWall"
      },
      "support": {
        "name": "SonicWall",
        "link": "https://www.sonicwall.com/support/",
        "tier": "developer"
      }
    }
  },
  {
    "id": "SonraiDataConnector",
    "title": "Sonrai Data Connector",
    "publisher": "Sonrai",
    "descriptionMarkdown": "Use this data connector to integrate with Sonrai Security and get Sonrai tickets sent directly to Microsoft Sentinel.",
    "graphQueries": [
      {
        "metricName": "Sonrai Tickets",
        "legend": "Sonrai_Tickets_CL",
        "baseQuery": "Sonrai_Tickets_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Query for tickets with AWSS3ObjectFingerprint resource type.",
        "query": "Sonrai_Tickets_CL \n| where digest_resourceType_s == \"AWSS3ObjectFingerprint\"\n| limit 10"
      }
    ],
    "dataTypes": [
      {
        "name": "Sonrai_Tickets_CL",
        "lastDataReceivedQuery": "Sonrai_Tickets_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Sonrai_Tickets_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Sonrai Security Data Connector",
        "description": "1. Navigate to Sonrai Security dashboard.\n2. On the bottom left panel, click on integrations.\n3. Select Microsoft Sentinel from the list of available Integrations.\n4. Fill in the form using the information provided below.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ],
    "metadata": {
      "id": "08ecd257-473b-43e5-83ed-6fdd1f0df413",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "SonraiSecuritySolution"
      },
      "author": {
        "name": "SonraiSecurity"
      },
      "support": {
        "tier": "developer",
        "name": "Sonrai",
        "email": "support@sonraisecurity.com"
      }
    }
  },
  {
    "id": "SophosCloudOptix",
    "title": "Sophos Cloud Optix",
    "publisher": "Sophos",
    "descriptionMarkdown": "The [Sophos Cloud Optix](https://www.sophos.com/products/cloud-optix.aspx) connector allows you to easily connect your Sophos Cloud Optix logs with Microsoft Sentinel, to view dashboards, create custom alerts, and improve investigation. This gives you more insight into your organization's cloud security and compliance posture and improves your cloud security operation capabilities.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "SophosCloudOptix_CL",
        "baseQuery": "SophosCloudOptix_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Optix alerts raised for your cloud environment(s)",
        "query": "SophosCloudOptix_CL\n | summarize count() by alertDescription_s\n | top 10 by count_"
      },
      {
        "description": "Top 5 environments with High severity Optix alerts raised",
        "query": "SophosCloudOptix_CL\n | where severity_s == 'HIGH'\n | summarize count() by accountId_s\n | top 5 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "SophosCloudOptix_CL",
        "lastDataReceivedQuery": "SophosCloudOptix_CL\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "SophosCloudOptix_CL\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Get the Workspace ID and the Primary Key",
        "description": "Copy the Workspace ID and Primary Key for your workspace.\n",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "2. Configure the Sophos Cloud Optix Integration",
        "description": "In Sophos Cloud Optix go to [Settings->Integrations->Microsoft Sentinel](https://optix.sophos.com/#/integrations/sentinel) and enter the Workspace ID and Primary Key copied in Step 1.\n"
      },
      {
        "title": "3. Select Alert Levels",
        "description": "In Alert Levels, select which Sophos Cloud Optix alerts you want to send to Microsoft Sentinel.\n"
      },
      {
        "title": "4. Turn on the integration",
        "description": "To turn on the integration, select Enable, and then click Save.\n"
      }
    ],
    "metadata": {
      "id": "a3646b81-9e6a-4f4b-beb1-9d2eba8ab669",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Sophos"
      },
      "support": {
        "name": "Sophos",
        "link": "https://secure2.sophos.com/en-us/support.aspx",
        "tier": "developer"
      }
    }
  },
  {
    "id": "SophosEndpointProtectionCCPDefinition",
    "title": "Sophos Endpoint Protection (using REST API)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The [Sophos Endpoint Protection](https://www.sophos.com/en-us/products/endpoint-antivirus.aspx) data connector provides the capability to ingest [Sophos events](https://developer.sophos.com/docs/siem-v1/1/routes/events/get) and [Sophos alerts](https://developer.sophos.com/docs/siem-v1/1/routes/alerts/get) into Microsoft Sentinel. Refer to [Sophos Central Admin documentation](https://docs.sophos.com/central/Customer/help/en-us/central/Customer/concepts/Logs.html) for more information.",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "Sophos Endpoint Protection Event logs",
        "baseQuery": "{{graphQueriesTableName}}"
      },
      {
        "metricName": "Total alerts received",
        "legend": "Sophos Endpoint Protection Alert logs",
        "baseQuery": "SophosEPAlerts_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get a sample of Sophos Endpoint Protection Event logs",
        "query": "{{graphQueriesTableName}}\n| take 10"
      },
      {
        "description": "Get a sample of Sophos Endpoint Protection Alert logs",
        "query": "SophosEPAlerts_CL\n| take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n|summarize Time = max  (TimeGenerated)\n|where isnotempty(Time)"
      },
      {
        "name": "SophosEPAlerts_CL",
        "lastDataReceivedQuery": "SophosEPAlerts_CL\n|summarize Time = max  (TimeGenerated)\n|where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": null,
    "metadata": null
  },
  {
    "id": "SophosEP",
    "title": "Sophos Endpoint Protection",
    "publisher": "Sophos",
    "descriptionMarkdown": "The [Sophos Endpoint Protection](https://www.sophos.com/en-us/products/endpoint-antivirus.aspx) data connector provides the capability to ingest [Sophos events](https://docs.sophos.com/central/Customer/help/en-us/central/Customer/common/concepts/Events.html) into Microsoft Sentinel. Refer to [Sophos Central Admin documentation](https://docs.sophos.com/central/Customer/help/en-us/central/Customer/concepts/Logs.html) for more information.",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected [**SophosEPEvent**](https://aka.ms/sentinel-SophosEP-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "SophosEP_CL",
        "baseQuery": "SophosEP_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "SophosEP_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "SophosEP_CL",
        "lastDataReceivedQuery": "SophosEP_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "SophosEP_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "**API token** is required. [See the documentation to learn more about API token](https://docs.sophos.com/central/Customer/help/en-us/central/Customer/concepts/ep_ApiTokenManagement.html)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Sophos Central APIs to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**SophosEPEvent**](https://aka.ms/sentinel-SophosEP-parser) which is deployed with the Microsoft Sentinel Solution."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the Sophos Central API**\n\n Follow the instructions to obtain the credentials.\n\n1. In Sophos Central Admin, go to **Global Settings > API Token Management**.\n2. To create a new token, click **Add token** from the top-right corner of the screen.\n3. Select a **token name** and click **Save**. The **API Token Summary** for this token is displayed.\n4. Click **Copy** to copy your **API Access URL + Headers** from the **API Token Summary** section into your clipboard."
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Sophos Endpoint Protection data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following).",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Option 1 - Azure Resource Manager (ARM) Template",
                  "description": "Use this method for automated deployment of the Sophos Endpoint Protection data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-SophosEP-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n> **NOTE:** Within the same resource group, you can't mix Windows and Linux apps in the same region. Select existing resource group without Windows apps in it or create new resource group.\n3. Enter the **Sophos API Access URL and Headers**, **AzureSentinelWorkspaceId**, **AzureSentinelSharedKey**. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
                },
                {
                  "title": "Option 2 - Manual Deployment of Azure Functions",
                  "description": "Use the following step-by-step instructions to deploy the Sophos Endpoint Protection data connector manually with Azure Functions (Deployment via Visual Studio Code).",
                  "instructions": [
                    {
                      "parameters": {
                        "instructionSteps": [
                          {
                            "title": "Step 1 - Deploy a Function App",
                            "description": "**NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-SophosEP-functionapp) file. Extract archive to your local development computer.\n2. Follow the [function app manual deployment instructions](https://github.com/Azure/Azure-Sentinel/blob/master/DataConnectors/AzureFunctionsManualDeployment.md#function-app-manual-deployment-instructions) to deploy the Azure Functions app using VSCode.\n3. After successful deployment of the function app, follow next steps for configuring it."
                          },
                          {
                            "title": "Step 2 - Configure the Function App",
                            "description": "1. Go to Azure Portal for the Function App configuration.\n2. In the Function App, select the Function App Name and select **Configuration**.\n3. In the **Application settings** tab, select **New application setting**.\n4. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tSOPHOS_TOKEN\n\t\tWorkspaceID\n\t\tWorkspaceKey\n\t\tlogAnalyticsUri (optional)\n> - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n5. Once all application settings have been entered, click **Save**."
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "SophosXGFirewall",
    "title": "[Deprecated] Sophos XG Firewall",
    "publisher": "Sophos",
    "descriptionMarkdown": "The [Sophos XG Firewall](https://www.sophos.com/products/next-gen-firewall.aspx) allows you to easily connect your Sophos XG Firewall logs with Microsoft Sentinel, to view dashboards, create custom alerts, and improve investigations. Integrating Sophos XG Firewall with Microsoft Sentinel provides more visibility into your organization's firewall traffic and will enhance security monitoring capabilities.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Sophos",
        "baseQuery": "SophosXGFirewall"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Denied Source IPs",
        "query": "SophosXGFirewall \n| where Log_Type == \"Firewall\" and Status == \"Deny\" \n| summarize count() by Src_IP \n| top 10 by count_"
      },
      {
        "description": "Top 10 Denied Destination IPs",
        "query": "SophosXGFirewall \n| where Log_Type == \"Firewall\" and Status == \"Deny\" \n| summarize count() by Dst_IP \n| top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog (SophosXGFirewall)",
        "lastDataReceivedQuery": "SophosXGFirewall \n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "SophosXGFirewall \n      | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "write permission is required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "Sophos XG Firewall",
          "description": "must be configured to export logs via Syslog"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias Sophos XG Firewall and load the function code or click [here](https://aka.ms/sentinel-SophosXG-parser), on the second line of the query, enter the hostname(s) of your Sophos XG Firewall device(s) and any other unique identifiers for the logstream. The function usually takes 10-15 minutes to activate after solution installation/update.",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux",
        "description": "Typically, you should install the agent on a different computer from the one on which the logs are generated.\n\n>  Syslog logs are collected only from **Linux** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Configure the facilities you want to collect and their severities.\n 1. Under workspace advanced settings **Configuration**, select **Data** and then **Syslog**.\n 2. Select **Apply below configuration to my machines** and select the facilities and severities.\n 3.  Click **Save**.",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenSyslogSettings"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "3. Configure and connect the Sophos XG Firewall",
        "description": "[Follow these instructions](https://doc.sophos.com/nsg/sophos-firewall/20.0/Help/en-us/webhelp/onlinehelp/AdministratorHelp/SystemServices/LogSettings/SyslogServerAdd/index.html) to enable syslog streaming. Use the IP address or hostname for the Linux device with the Linux agent installed as the Destination IP address."
      }
    ]
  },
  {
    "id": "SquadraTechnologiesSecRMM",
    "title": "Squadra Technologies secRMM",
    "publisher": "Squadra Technologies",
    "descriptionMarkdown": "Use the Squadra Technologies secRMM Data Connector to push USB removable storage security event data into Microsoft Sentinel Log Analytics.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "secRMM_CL",
        "baseQuery": "secRMM_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Alert on USB removable storage devices ONLINE events",
        "query": "secRMM_CL | where Event_s == 'ONLINE'"
      },
      {
        "description": "Which users are writing files to removable storage devices",
        "query": "secRMM_CL | where Event_s == 'WRITE COMPLETED' | summarize count() by User_s"
      },
      {
        "description": "Microsoft BitLocker Activity for removable storage devices",
        "query": "secRMM_CL | where DeviceDescription_s contains 'ENCRYPTED BitLocker'"
      },
      {
        "description": "Microsoft Windows Defender Activity for removable storage devices",
        "query": "secRMM_CL | where ((Event_s == 'EXTERNAL') and (Message contains 'Microsoft Defender'))"
      },
      {
        "description": "Hardware Encrypted Device Activity",
        "query": "secRMM_CL | where DeviceDescription_s contains ' ENCRYPTED Removable Media'"
      },
      {
        "description": "Users who have tried to execute macros or programs from a removable storage device",
        "query": "secRMM_CL | where ((Event_s == 'BLOCK MACROS ON DEVICE ACTIVE') or (Event_s == 'BLOCK PROGRAMS ON DEVICE ACTIVE')) | summarize count() by User_s"
      },
      {
        "description": "Removable storage devices that are not encrypted (hardware or software)",
        "query": "secRMM_CL | where ((Event_s == 'ONLINE') and (DeviceDescription_s !contains 'ENCRYPTED'))"
      },
      {
        "description": "Removable storage devices that are mounted into a Virtual Machine (from physical)",
        "query": "secRMM_CL | where ((Event_s == 'EXTERNAL') and (Message contains 'ONLINE') and (Message contains 'Virtual Machine'))"
      },
      {
        "description": "Removable storage devices that are mounted into a Virtual Machine (from virtual)",
        "query": "secRMM_CL | where ((Event_s == 'ONLINE') and (Drive_s contains '^'))"
      },
      {
        "description": "Show mobile devices that are being USB mounted",
        "query": "secRMM_CL | where ((Event_s == 'ONLINE') and (DeviceDescription_s contains 'MOBILE'))"
      },
      {
        "description": "Show mobile devices that are being USB mounted but are not MDM (Microsoft Intune) enrolled",
        "query": "secRMM_CL | where ((Event_s == 'ONLINE') and (AdditionalProgramInfo_s contains 'Mobile device is not MDM enrolled'))"
      }
    ],
    "dataTypes": [
      {
        "name": "secRMM_CL",
        "lastDataReceivedQuery": "secRMM_CL | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "secRMM_CL\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "Follow the step-by-step instructions provided in the [Squadra Technologies configuration guide for Azure Sentinel](https://www.squadratechnologies.com/StaticContent/ProductDownload/secRMM/9.11.0.0/secRMMAzureSentinelAdministratorGuide.pdf)",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ],
    "metadata": {
      "id": "5040166e-9344-4b4a-b260-8f2e3539ae45",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Squadra Technologies"
      },
      "support": {
        "name": "Squadra Technologies",
        "link": "https://www.squadratechnologies.com/Contact.aspx",
        "tier": "developer"
      }
    }
  },
  {
    "id": "SquidProxy",
    "title": "[Deprecated] Squid Proxy",
    "publisher": "Squid",
    "descriptionMarkdown": "The [Squid Proxy](http://www.squid-cache.org/) connector allows you to easily connect your Squid Proxy logs with Microsoft Sentinel. This gives you more insight into your organization's network proxy traffic and improves your security operation capabilities.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "SquidProxy_CL",
        "baseQuery": "SquidProxy"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Proxy Results",
        "query": "SquidProxy \n | where isnotempty(ResultCode) \n | summarize count() by ResultCode \n | top 10 by count_"
      },
      {
        "description": "Top 10 Peer Host",
        "query": "SquidProxy \n | where isnotempty(PeerHost) \n | summarize count() by PeerHost \n| top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "SquidProxy_CL",
        "lastDataReceivedQuery": "SquidProxy \n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "SquidProxy \n      | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias Squid Proxy and load the function code or click [here](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/SquidProxy/Parsers/SquidProxy.txt), on the second line of the query, enter the hostname(s) of your SquidProxy device(s) and any other unique identifiers for the logstream. The function usually takes 10-15 minutes to activate after solution installation/update.",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux or Windows",
        "description": "Install the agent on the Squid Proxy server where the logs are generated.\n\n> Logs from Squid Proxy deployed on Linux or Windows servers are collected by **Linux** or **Windows** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Linux agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Windows agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Windows Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Windows Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Configure the custom log directory to be collected",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenCustomLogsSettings"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "",
        "description": "1. Select the link above to open your workspace advanced settings \n2. From the left pane, select **Data**, select **Custom Logs** and click **Add+**\n3. Click **Browse** to upload a sample of a Squid Proxy log file(e.g. access.log or cache.log). Then, click **Next >**\n4. Select **New line** as the record delimiter and click **Next >**\n5. Select **Windows** or **Linux** and enter the path to Squid Proxy logs. Default paths are: \n - **Windows** directory: `C:\\Squid\\var\\log\\squid\\*.log`\n - **Linux** Directory:  `/var/log/squid/*.log` \n6. After entering the path, click the '+' symbol to apply, then click **Next >** \n7. Add **SquidProxy_CL** as the custom log Name and click **Done**"
      }
    ]
  },
  {
    "id": "SSG",
    "title": "SINEC Security Guard",
    "publisher": "Siemens AG",
    "descriptionMarkdown": "The SINEC Security Guard solution for Microsoft Sentinel allows you to ingest security events of your industrial networks from the [SINEC Security Guard](https://siemens.com/sinec-security-guard) into Microsoft Sentinel",
    "graphQueriesTableName": "SINECSecurityGuard_CL",
    "logo": "SSG.svg",
    "graphQueries": [
      {
        "metricName": "Total events received",
        "legend": "SINECSecurityGuard_CL",
        "baseQuery": "SINECSecurityGuard_CL\n | summarize count()"
      }
    ],
    "sampleQueries": [
      {
        "description": "List of Attacks",
        "query": "SINECSecurityGuard_CL\n | summarize count()"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "SINECSecurityGuard_CL\n | summarize lastLogGenerated = max(TimeGenerated) | project IsConnected = lastLogGenerated > ago(30d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "SINECSecurityGuard_CL",
        "lastDataReceivedQuery": "SINECSecurityGuard_CL\n | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
      }
    ],
    "availability": {
      "isPreview": true,
      "status": 1
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "description": "This Data Connector relies on the SINEC Security Guard Sensor Package to be able to receive Sensor events in Microsoft Sentinel. The Sensor Package can be purchased in the Siemens Xcelerator Marketplace.",
        "instructions": [
          {
            "parameters": {
              "title": "1. Please follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Set up the SINEC Security Guard Sensor",
                  "description": "Detailed step for setting up the sensor."
                },
                {
                  "title": "Create the Data Connector and configure it in the SINEC Security Guard web interface",
                  "description": "Instructions on configuring the data connector."
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "Stealthwatch",
    "title": "[Deprecated] Cisco Secure Cloud Analytics",
    "publisher": "Cisco",
    "descriptionMarkdown": "The [Cisco Secure Cloud Analytics](https://www.cisco.com/c/en/us/products/security/stealthwatch/index.html) data connector provides the capability to ingest [Cisco Secure Cloud Analytics events](https://www.cisco.com/c/dam/en/us/td/docs/security/stealthwatch/management_console/securit_events_alarm_categories/7_4_2_Security_Events_and_Alarm_Categories_DV_2_1.pdf) into Microsoft Sentinel. Refer to [Cisco Secure Cloud Analytics documentation](https://www.cisco.com/c/dam/en/us/td/docs/security/stealthwatch/system_installation_configuration/7_5_0_System_Configuration_Guide_DV_1_3.pdf) for more information.",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected [**StealthwatchEvent**](https://aka.ms/sentinel-stealthwatch-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Stealthwatch",
        "baseQuery": "StealthwatchEvent"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Sources",
        "query": "StealthwatchEvent\n | summarize count() by tostring(DvcHostname)\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog (StealthwatchEvent)",
        "lastDataReceivedQuery": "StealthwatchEvent\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "StealthwatchEvent\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**StealthwatchEvent**](https://aka.ms/sentinel-stealthwatch-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "",
        "description": ">**NOTE:** This data connector has been developed using Cisco Secure Cloud Analytics version 7.3.2",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux or Windows",
        "description": "Install the agent on the Server where the Cisco Secure Cloud Analytics logs are forwarded.\n\n> Logs from Cisco Secure Cloud Analytics Server deployed on Linux or Windows servers are collected by **Linux** or **Windows** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Linux agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Windows agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Windows Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Windows Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure Cisco Secure Cloud Analytics event forwarding",
        "description": "Follow the configuration steps below to get Cisco Secure Cloud Analytics logs into Microsoft Sentinel.\n1. Log in to the Stealthwatch Management Console (SMC) as an administrator.\n2. In the menu bar, click **Configuration** **>** **Response Management**.\n3. From the **Actions** section in the **Response Management** menu, click **Add > Syslog Message**.\n4. In the Add Syslog Message Action window, configure parameters.\n5. Enter the following custom format:\n|Lancope|Stealthwatch|7.3|{alarm_type_id}|0x7C|src={source_ip}|dst={target_ip}|dstPort={port}|proto={protocol}|msg={alarm_type_description}|fullmessage={details}|start={start_active_time}|end={end_active_time}|cat={alarm_category_name}|alarmID={alarm_id}|sourceHG={source_host_group_names}|targetHG={target_host_group_names}|sourceHostSnapshot={source_url}|targetHostSnapshot={target_url}|flowCollectorName={device_name}|flowCollectorIP={device_ip}|domain={domain_name}|exporterName={exporter_hostname}|exporterIPAddress={exporter_ip}|exporterInfo={exporter_label}|targetUser={target_username}|targetHostname={target_hostname}|sourceUser={source_username}|alarmStatus={alarm_status}|alarmSev={alarm_severity_name}\n\n6. Select the custom format from the list and click **OK**\n7. Click **Response Management > Rules**.\n8. Click **Add** and select **Host Alarm**.\n9. Provide a rule name in the **Name** field.\n10. Create rules by selecting values from the Type and Options menus. To add more rules, click the ellipsis icon. For a Host Alarm, combine as many possible types in a statement as possible."
      }
    ]
  },
  {
    "id": "StyxViewEndpointConnectorDefinition",
    "title": "StyxView Alerts (via Codeless Connector Platform)",
    "publisher": "Styx Intelligence",
    "descriptionMarkdown": "The [StyxView Alerts](https://styxintel.com/) data connector enables seamless integration between the StyxView Alerts platform and Microsoft Sentinel. This connector ingests alert data from the StyxView Alerts API, allowing organizations to centralize and correlate actionable threat intelligence directly within their Microsoft Sentinel workspace.",
    "graphQueries": [
      {
        "metricName": "Total alerts received",
        "legend": "StyxView Alert logs",
        "baseQuery": "StyxViewAlerts_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get a sample of StyxView Alert logs",
        "query": "StyxViewAlerts_CL\n| take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "StyxViewAlerts_CL",
        "lastDataReceivedQuery": "StyxViewAlerts_CL\n|summarize Time = max  (TimeGenerated)\n|where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "Symantec",
    "title": "Symantec Integrated Cyber Defense Exchange",
    "publisher": "Symantec",
    "descriptionMarkdown": "Symantec ICDx connector allows you to easily connect your Symantec security solutions logs with Microsoft Sentinel, to view dashboards, create custom alerts, and improve investigation. This gives you more insight into your organizations network and improves your security operation capabilities.",
    "logo": "SymantecLogo.svg",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "SymantecICDx",
        "baseQuery": "SymantecICDx_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Summarize by connection source ip",
        "query": "SymantecICDx_CL\n            | summarize count() by connection_src_ip_s"
      },
      {
        "description": "Summarize by threat id",
        "query": "SymantecICDx_CL\n            | summarize count() by threat_id_d"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "SymantecICDx_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "SymantecICDx_CL",
        "lastDataReceivedQuery": "SymantecICDx_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Configure and connect Symantec ICDx",
        "description": "1. On the ICDx navigation bar, click **Configuration**.\n2. At the top of the **Configuration** screen, click **Forwarders**, and next to Microsoft Sentinel (Log Analytics), click **Add**.\n3. In the Microsoft Sentinel (Log Analytics) window that opens, click **Show Advanced**. [See the documentation to set advanced features](https://aka.ms/SymantecICDX-learn-more).\n4. Make sure that you set a name for the forwarder and under Azure Destination, set these required fields:\n  -   Workspace ID: Paste the Workspace ID from the Microsoft Sentinel portal connector page.\n  -   Primary Key: Paste the Primary Key from the Microsoft Sentinel portal connector page.\n  -   Custom Log Name: Type the custom log name in the Microsoft Azure portal Log Analytics workspace to which you are going to forward events. The default is SymantecICDx.\n5. Click Save and to start the forwarder, go to Options > More and click **Start**.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ]
  },
  {
    "id": "SymantecEndpointProtection",
    "title": "[Deprecated] Symantec Endpoint Protection",
    "publisher": "Broadcom",
    "descriptionMarkdown": "The [Broadcom Symantec Endpoint Protection (SEP)](https://www.broadcom.com/products/cyber-security/endpoint/end-user/enterprise) connector allows you to easily connect your SEP logs with Microsoft Sentinel. This gives you more insight into your organization's network and improves your security operation capabilities.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "SymantecEndpointProtection",
        "baseQuery": "SymantecEndpointProtection"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Log Types ",
        "query": "SymantecEndpointProtection \n | summarize count() by LogType \n| top 10 by count_"
      },
      {
        "description": "Top 10 Users",
        "query": "SymantecEndpointProtection \n | summarize count() by UserName \n| top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog (SymantecEndpointProtection)",
        "lastDataReceivedQuery": "SymantecEndpointProtection \n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "SymantecEndpointProtection \n      | where TimeGenerated > ago(3d)\n    |take 1\n        | project IsConnected = true"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "write permission is required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "Symantec Endpoint Protection (SEP)",
          "description": "must be configured to export logs via Syslog"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias Symantec Endpoint Protection and load the function code or click [here](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Symantec%20Endpoint%20Protection/Parsers/SymantecEndpointProtection.yaml), on the second line of the query, enter the hostname(s) of your SymantecEndpointProtection device(s) and any other unique identifiers for the logstream. The function usually takes 10-15 minutes to activate after solution installation/update.",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux",
        "description": "Typically, you should install the agent on a different computer from the one on which the logs are generated.\n\n>  Syslog logs are collected only from **Linux** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Configure the facilities you want to collect and their severities.\n 1. Under workspace advanced settings **Configuration**, select **Data** and then **Syslog**.\n 2. Select **Apply below configuration to my machines** and select the facilities and severities.\n 3.  Click **Save**.",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenSyslogSettings"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "3. Configure and connect the Symantec Endpoint Protection",
        "description": "[Follow these instructions](https://techdocs.broadcom.com/us/en/symantec-security-software/endpoint-security-and-management/endpoint-protection/all/Monitoring-Reporting-and-Enforcing-Compliance/viewing-logs-v7522439-d37e464/exporting-data-to-a-syslog-server-v8442743-d15e1107.html) to configure the Symantec Endpoint Protection to forward syslog. Use the IP address or hostname for the Linux device with the Linux agent installed as the Destination IP address."
      }
    ]
  },
  {
    "id": "SymantecProxySG",
    "title": "[Deprecated] Symantec ProxySG",
    "publisher": "Symantec",
    "descriptionMarkdown": "The [Symantec ProxySG](https://www.broadcom.com/products/cyber-security/network/gateway/proxy-sg-and-advanced-secure-gateway) allows you to easily connect your Symantec ProxySG logs with Microsoft Sentinel, to view dashboards, create custom alerts, and improve investigations. Integrating Symantec ProxySG with Microsoft Sentinel provides more visibility into your organization's network proxy traffic and will enhance security monitoring capabilities.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Symantec",
        "baseQuery": "SymantecProxySG"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Denied Users",
        "query": "SymantecProxySG \n | where sc_filter_result == 'DENIED' \n | summarize count() by cs_userdn \n | top 10 by count_"
      },
      {
        "description": "Top 10 Denied Client IPs",
        "query": "SymantecProxySG \n | where sc_filter_result == 'DENIED' \n | summarize count() by c_ip \n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog (SymantecProxySG)",
        "lastDataReceivedQuery": "SymantecProxySG \n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "SymantecProxySG \n      | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(3d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "write permission is required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "Symantec ProxySG",
          "description": "must be configured to export logs via Syslog"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias Symantec Proxy SG and load the function code or click [here](https://aka.ms/sentinel-SymantecProxySG-parser), on the second line of the query, enter the hostname(s) of your Symantec Proxy SG device(s) and any other unique identifiers for the logstream. The function usually takes 10-15 minutes to activate after solution installation/update.",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux",
        "description": "Typically, you should install the agent on a different computer from the one on which the logs are generated.\n\n>  Syslog logs are collected only from **Linux** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Configure the facilities you want to collect and their severities.\n 1. Under workspace advanced settings **Configuration**, select **Data** and then **Syslog**.\n 2. Select **Apply below configuration to my machines** and select the facilities and severities.\n 3.  Click **Save**.",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenSyslogSettings"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "3. Configure and connect the Symantec ProxySG",
        "description": " \n 1. Log in to the Blue Coat Management Console .\n 2. Select Configuration > Access Logging > Formats.\n 3. Select New.\n 4.  Enter a unique name in the Format Name field.\n 5. Click the radio button for  **Custom format string**  and paste the following string into the field.\n <p><code>1 $(date) $(time) $(time-taken) $(c-ip) $(cs-userdn) $(cs-auth-groups) $(x-exception-id) $(sc-filter-result) $(cs-categories) $(quot)$(cs(Referer))$(quot) $(sc-status) $(s-action) $(cs-method) $(quot)$(rs(Content-Type))$(quot) $(cs-uri-scheme) $(cs-host) $(cs-uri-port) $(cs-uri-path) $(cs-uri-query) $(cs-uri-extension) $(quot)$(cs(User-Agent))$(quot) $(s-ip) $(sr-bytes) $(rs-bytes) $(x-virus-id) $(x-bluecoat-application-name) $(x-bluecoat-application-operation) $(cs-uri-port) $(x-cs-client-ip-country) $(cs-threat-risk)</code></p>\n 6. Click the **OK** button. \n 7. Click the **Apply** button. \n 8. [Follow these instructions](https://knowledge.broadcom.com/external/article/166529/sending-access-logs-to-a-syslog-server.html) to enable syslog streaming of **Access** Logs. Use the IP address or hostname for the Linux device with the Linux agent installed as the Destination IP address"
      }
    ]
  },
  {
    "id": "SymantecVIP",
    "title": "[Deprecated] Symantec VIP",
    "publisher": "Symantec",
    "descriptionMarkdown": "The [Symantec VIP](https://vip.symantec.com/) connector allows you to easily connect your Symantec VIP logs with Microsoft Sentinel, to view dashboards, create custom alerts, and improve investigation. This gives you more insight into your organization's network and improves your security operation capabilities.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "SymantecVIP",
        "baseQuery": "SymantecVIP"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Reasons for Failed RADIUS Authentication ",
        "query": "SymantecVIP \n | summarize count() by Reason \n| top 10 by count_"
      },
      {
        "description": "Top 10 Users",
        "query": "SymantecVIP \n | summarize count() by User \n| top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog (SymantecVIP)",
        "lastDataReceivedQuery": "SymantecVIP \n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "SymantecVIP \n      | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "write permission is required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "Symantec VIP",
          "description": "must be configured to export logs via Syslog"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias Symantec VIP and load the function code or click [here](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Symantec%20VIP/Parsers/SymantecVIP.yaml), on the second line of the query, enter the hostname(s) of your Symantec VIP device(s) and any other unique identifiers for the logstream. The function usually takes 10-15 minutes to activate after solution installation/update.",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux",
        "description": "Typically, you should install the agent on a different computer from the one on which the logs are generated.\n\n>  Syslog logs are collected only from **Linux** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Configure the facilities you want to collect and their severities.\n 1. Under workspace advanced settings **Configuration**, select **Data** and then **Syslog**.\n 2. Select **Apply below configuration to my machines** and select the facilities and severities.\n 3.  Click **Save**.",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenSyslogSettings"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "3. Configure and connect the Symantec VIP",
        "description": "[Follow these instructions](https://aka.ms/sentinel-symantecvip-configurationsteps) to configure the Symantec VIP Enterprise Gateway to forward syslog. Use the IP address or hostname for the Linux device with the Linux agent installed as the Destination IP address."
      }
    ]
  },
  {
    "id": "Syslog",
    "title": "Syslog via Legacy Agent",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Syslog is an event logging protocol that is common to Linux. Applications will send messages that may be stored on the local machine or delivered to a Syslog collector. When the Agent for Linux is installed, it configures the local Syslog daemon to forward messages to the agent. The agent then sends the message to the workspace.\n\n[Learn more >](https://aka.ms/sysLogInfo)",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Syslog",
        "baseQuery": "Syslog"
      }
    ],
    "sampleQueries": [
      {
        "description": "Last 1000 generated events",
        "query": "Syslog\n            | top 1000 by TimeGenerated"
      },
      {
        "description": "All events by facility except for cron",
        "query": "Syslog\n            | summarize count() by Facility | where Facility != \"cron\""
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Syslog | extend TimeGenerated = ingestion_time() \n        | where TimeGenerated > ago(7d) \n        | summarize by _ResourceId, bin(TimeGenerated, 1m) \n        | join kind=inner (Heartbeat \n            | where TimeGenerated > ago(7d) \n            | where Category != \"Azure Monitor Agent\" \n            | summarize by _ResourceId, bin(TimeGenerated, 1m)) on _ResourceId, TimeGenerated \n        | summarize LastLogReceived = max(TimeGenerated) \n        | project IsConnected = LastLogReceived > ago(7d) "
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog",
        "lastDataReceivedQuery": "Syslog\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "write permission is required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Install and onboard the agent for Linux",
        "description": "You can collect Syslog events from your local machine by installing the agent on it. You can also collect Syslog generated on a different source by running the installation script below on the local machine, where the agent is installed.\n\n>  Syslog logs are collected only from **Linux** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Configure the facilities you want to collect and their severities.\n\n1.  Select the link below to open your workspace **agents configuration**, and select the **Syslog** tab.\n2.  Select **Add facility** and choose from the drop-down list of facilities. Repeat for all the facilities you want to add.\n3.  Mark the check boxes for the desired severities for each facility.\n4.  Click **Apply**.",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenSyslogSettings"
            },
            "type": "InstallAgent"
          }
        ]
      }
    ]
  },
  {
    "id": "SyslogAma",
    "title": "Syslog via AMA",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Syslog is an event logging protocol that is common to Linux. Applications will send messages that may be stored on the local machine or delivered to a Syslog collector. When the Agent for Linux is installed, it configures the local Syslog daemon to forward messages to the agent. The agent then sends the message to the workspace.\n\n[Learn more >](https://aka.ms/sysLogInfo)",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Syslog",
        "baseQuery": "Syslog"
      }
    ],
    "sampleQueries": [
      {
        "description": "Last 1000 generated events",
        "query": "Syslog\n            | top 1000 by TimeGenerated"
      },
      {
        "description": "All events by facility except for cron",
        "query": "Syslog\n            | summarize count() by Facility | where Facility != \"cron\""
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Syslog | extend TimeGenerated = ingestion_time() \n        | where TimeGenerated > ago(7d) \n        | summarize by _ResourceId, bin(TimeGenerated, 1m) \n        | join kind=inner (Heartbeat \n            | where TimeGenerated > ago(7d) \n            | where Category == \"Azure Monitor Agent\" \n            | summarize by _ResourceId, bin(TimeGenerated, 1m)) on _ResourceId, TimeGenerated \n        | summarize LastLogReceived = max(TimeGenerated) \n        | project IsConnected = LastLogReceived > ago(7d) "
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog",
        "lastDataReceivedQuery": "Syslog\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 2,
      "isPreview": true,
      "featureFlag": {
        "feature": "SyslogAma",
        "featureStates": {
          "Dogfood": "PrivatePreview",
          "MPAC": "PrivatePreview",
          "Prod": "PrivatePreview"
        }
      }
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces/datasources",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace data sources",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Enable data collection rule",
        "description": "You can collect Syslog events from your local machine by installing the agent on it. You can also collect Syslog generated on a different source by running the installation script below on the local machine, where the agent is installed.\n\n>  Syslog logs are collected only from **Linux** agents.",
        "instructions": [
          {
            "type": "SysLogAma"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenCreateDataCollectionRule",
              "dataCollectionRuleType": 6
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "Run the following command to install and apply the Syslog collector:",
        "description": "> To collect logs generated on a different machine run this script on the machine where the agent is installed.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId",
                "PrimaryKey"
              ],
              "label": "",
              "value": "sudo wget -O Forwarder_AMA_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Forwarder_AMA_installer.py&&sudo python Forwarder_AMA_installer.py"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ]
  },
  {
    "id": "TalonLogs",
    "title": "Talon Insights",
    "publisher": "Talon Security",
    "descriptionMarkdown": "The Talon Security Logs connector allows you to easily connect your Talon events and audit logs with Microsoft Sentinel, to view dashboards, create custom alerts, and improve investigation.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Talon_CL",
        "baseQuery": "Talon_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Blocked user activities",
        "query": "Talon_CL | where action_s != \"blocked\""
      },
      {
        "description": "Failed login user ",
        "query": "Talon_CL | where  eventType_s == \"loginFailed\""
      },
      {
        "description": "Audit logs changes ",
        "query": "    Talon_CL | where  type_s == \"audit\""
      }
    ],
    "dataTypes": [
      {
        "name": "Talon_CL",
        "lastDataReceivedQuery": "Talon_CL | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Talon_CL\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "Please note the values below and follow the instructions <a href='https://docs.console.talon-sec.com/en/articles/254-microsoft-sentinel-integration'>here</a> to connect your Talon Security events and audit logs with Microsoft Sentinel.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ],
    "metadata": {
      "id": "1d2958e9-6149-478b-bbc3-5cf65ad81d89",
      "version": "2.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Talon Security"
      },
      "support": {
        "name": "Talon Security",
        "link": "https://talon-sec.com/",
        "tier": "developer"
      }
    }
  },
  {
    "id": "TeamCymruScout",
    "title": "Team Cymru Scout Data Connector",
    "publisher": "Team Cymru Scout",
    "descriptionMarkdown": "The [TeamCymruScout](https://scout.cymru.com/) Data Connector allows users to bring Team Cymru Scout IP, domain and account usage data in Microsoft Sentinel for enrichment.",
    "graphQueries": [
      {
        "metricName": "Total Domain data received",
        "legend": "Cymru_Scout_Domain_Data_CL",
        "baseQuery": "Cymru_Scout_Domain_Data_CL"
      },
      {
        "metricName": "Total IP Foundation data received",
        "legend": "Cymru_Scout_IP_Data_Foundation_CL",
        "baseQuery": "Cymru_Scout_IP_Data_Foundation_CL"
      },
      {
        "metricName": "Total IP Details data received",
        "legend": "Cymru_Scout_IP_Data_Details_CL",
        "baseQuery": "Cymru_Scout_IP_Data_Details_CL"
      },
      {
        "metricName": "Total IP Communications data received",
        "legend": "Cymru_Scout_IP_Data_Communications_CL",
        "baseQuery": "Cymru_Scout_IP_Data_Communications_CL"
      },
      {
        "metricName": "Total IP PDNS data received",
        "legend": "Cymru_Scout_IP_Data_PDNS_CL",
        "baseQuery": "Cymru_Scout_IP_Data_PDNS_CL"
      },
      {
        "metricName": "Total IP Fingerprints data received",
        "legend": "Cymru_Scout_IP_Data_Fingerprints_CL",
        "baseQuery": "Cymru_Scout_IP_Data_Fingerprints_CL"
      },
      {
        "metricName": "Total IP OpenPorts data received",
        "legend": "Cymru_Scout_IP_Data_OpenPorts_CL",
        "baseQuery": "Cymru_Scout_IP_Data_OpenPorts_CL"
      },
      {
        "metricName": "Total IP x509 data received",
        "legend": "Cymru_Scout_IP_Data_x509_CL",
        "baseQuery": "Cymru_Scout_IP_Data_x509_CL"
      },
      {
        "metricName": "Total IP Summary Details data received",
        "legend": "Cymru_Scout_IP_Data_Summary_Details_CL",
        "baseQuery": "Cymru_Scout_IP_Data_Summary_Details_CL"
      },
      {
        "metricName": "Total IP Summary PDNS data received",
        "legend": "Cymru_Scout_IP_Data_Summary_PDNS_CL",
        "baseQuery": "Cymru_Scout_IP_Data_Summary_PDNS_CL"
      },
      {
        "metricName": "Total IP Summary OpenPorts data received",
        "legend": "Cymru_Scout_IP_Data_Summary_OpenPorts_CL",
        "baseQuery": "Cymru_Scout_IP_Data_Summary_OpenPorts_CL"
      },
      {
        "metricName": "Total IP Summary Certs data received",
        "legend": "Cymru_Scout_IP_Data_Summary_Certs_CL",
        "baseQuery": "Cymru_Scout_IP_Data_Summary_Certs_CL"
      },
      {
        "metricName": "Total IP Summary Fingerprints data received",
        "legend": "Cymru_Scout_IP_Data_Summary_Fingerprints_CL",
        "baseQuery": "Cymru_Scout_IP_Data_Summary_Fingerprints_CL"
      },
      {
        "metricName": "Total Account Usage data received",
        "legend": "Cymru_Scout_Account_Usage_Data_CL",
        "baseQuery": "Cymru_Scout_Account_Usage_Data_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Team Cymru Scout Domain Data",
        "query": "Cymru_Scout_Domain_Data_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Team Cymru Scout IP Data Foundation",
        "query": "Cymru_Scout_IP_Data_Foundation_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Team Cymru Scout IP Data Details",
        "query": "Cymru_Scout_IP_Data_Details_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Team Cymru Scout IP Data Communications",
        "query": "Cymru_Scout_IP_Data_Communications_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Team Cymru Scout IP Data PDNS",
        "query": "Cymru_Scout_IP_Data_PDNS_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Team Cymru Scout IP Data Fingerprints",
        "query": "Cymru_Scout_IP_Data_Fingerprints_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Team Cymru Scout IP Data OpenPorts",
        "query": "Cymru_Scout_IP_Data_OpenPorts_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Team Cymru Scout IP Data x509",
        "query": "Cymru_Scout_IP_Data_x509_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Team Cymru Scout IP Data Summary Details",
        "query": "Cymru_Scout_IP_Data_Summary_Details_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Team Cymru Scout IP Data Summary PDNS",
        "query": "Cymru_Scout_IP_Data_Summary_PDNS_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Team Cymru Scout IP Data Summary OpenPorts",
        "query": "Cymru_Scout_IP_Data_Summary_OpenPorts_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Team Cymru Scout IP Data Summary Certs",
        "query": "Cymru_Scout_IP_Data_Summary_Certs_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Team Cymru Scout IP Data Summary Fingerprints",
        "query": "Cymru_Scout_IP_Data_Summary_Fingerprints_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Team Cymru Scout Account Usage Data",
        "query": "Cymru_Scout_Account_Usage_Data_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Cymru_Scout_Domain_Data_CL",
        "lastDataReceivedQuery": "Cymru_Scout_Domain_Data_CL\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "Cymru_Scout_IP_Data_Foundation_CL",
        "lastDataReceivedQuery": "Cymru_Scout_IP_Data_Foundation_CL\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "Cymru_Scout_IP_Data_Details_CL",
        "lastDataReceivedQuery": "Cymru_Scout_IP_Data_Details_CL\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "Cymru_Scout_IP_Data_Communications_CL",
        "lastDataReceivedQuery": "Cymru_Scout_IP_Data_Communications_CL\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "Cymru_Scout_IP_Data_PDNS_CL",
        "lastDataReceivedQuery": "Cymru_Scout_IP_Data_PDNS_CL\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "Cymru_Scout_IP_Data_Fingerprints_CL",
        "lastDataReceivedQuery": "Cymru_Scout_IP_Data_Fingerprints_CL\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "Cymru_Scout_IP_Data_OpenPorts_CL",
        "lastDataReceivedQuery": "Cymru_Scout_IP_Data_OpenPorts_CL\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "Cymru_Scout_IP_Data_x509_CL",
        "lastDataReceivedQuery": "Cymru_Scout_IP_Data_x509_CL\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "Cymru_Scout_IP_Data_Summary_Details_CL",
        "lastDataReceivedQuery": "Cymru_Scout_IP_Data_Summary_Details_CL\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "Cymru_Scout_IP_Data_Summary_PDNS_CL",
        "lastDataReceivedQuery": "Cymru_Scout_IP_Data_Summary_PDNS_CL\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "Cymru_Scout_IP_Data_Summary_OpenPorts_CL",
        "lastDataReceivedQuery": "Cymru_Scout_IP_Data_Summary_OpenPorts_CL\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "Cymru_Scout_IP_Data_Summary_Certs_CL",
        "lastDataReceivedQuery": "Cymru_Scout_IP_Data_Summary_Certs_CL\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "Cymru_Scout_IP_Data_Summary_Fingerprints_CL",
        "lastDataReceivedQuery": "Cymru_Scout_IP_Data_Summary_Fingerprints_CL\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      },
      {
        "name": "Cymru_Scout_Account_Usage_Data_CL",
        "lastDataReceivedQuery": "Cymru_Scout_Account_Usage_Data_CL\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Cymru_Scout_Domain_Data_CL\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Cymru_Scout_IP_Data_Foundation_CL\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Cymru_Scout_IP_Data_Details_CL\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Cymru_Scout_IP_Data_Communications_CL\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Cymru_Scout_IP_Data_PDNS_CL\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Cymru_Scout_IP_Data_Fingerprints_CL\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Cymru_Scout_IP_Data_OpenPorts_CL\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Cymru_Scout_IP_Data_x509_CL\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Cymru_Scout_IP_Data_Summary_Details_CL\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Cymru_Scout_IP_Data_Summary_PDNS_CL\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Cymru_Scout_IP_Data_Summary_OpenPorts_CL\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Cymru_Scout_IP_Data_Summary_Certs_CL\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Cymru_Scout_IP_Data_Summary_Fingerprints_CL\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Cymru_Scout_Account_Usage_Data_CL\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Permission to assign a role to the registered application",
          "description": "Permission to assign a role to the registered application in Microsoft Entra ID is required."
        },
        {
          "name": "Team Cymru Scout Credentials/permissions",
          "description": "Team Cymru Scout account credentials(Username, Password) is required."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Team Cymru Scout API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1 - Steps to Create Team Cymru Scout API Key**\n\n Follow these instructions to create a Team Cymru Scout API Key.\n 1. Refer to the [API Keys](https://scout.cymru.com/docs/api#api-keys) document to generate an API key to use as an alternate form of authorization.\n"
      },
      {
        "title": "",
        "description": "**STEP 2 - App Registration steps for the Application in Microsoft Entra ID**\n\n This integration requires an App registration in the Azure portal. Follow the steps in this section to create a new application in Microsoft Entra ID:\n 1. Sign in to the [Azure portal](https://portal.azure.com/).\n 2. Search for and select **Microsoft Entra ID**.\n 3. Under **Manage**, select **App registrations > New registration**.\n 4. Enter a display **Name** for your application.\n 5. Select **Register** to complete the initial app registration.\n 6. When registration finishes, the Azure portal displays the app registration's Overview pane. You see the **Application (client) ID** and **Tenant ID**. The client ID and Tenant ID is required as configuration parameters for the execution of TeamCymruScout Data Connector. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app)"
      },
      {
        "title": "",
        "description": "**STEP 3 - Add a client secret for application in Microsoft Entra ID**\n\n Sometimes called an application password, a client secret is a string value required for the execution of TeamCymruScout Data Connector. Follow the steps in this section to create a new Client Secret:\n 1. In the Azure portal, in **App registrations**, select your application.\n 2. Select **Certificates & secrets > Client secrets > New client secret**.\n 3. Add a description for your client secret.\n 4. Select an expiration for the secret or specify a custom lifetime. Limit is 24 months.\n 5. Select **Add**. \n 6. *Record the secret's value for use in your client application code. This secret value is never displayed again after you leave this page.* The secret value is required as configuration parameter for the execution of TeamCymruScout Data Connector. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret)"
      },
      {
        "title": "",
        "description": "**STEP 4 - Get Object ID of your application in Microsoft Entra ID**\n\n After creating your app registration, follow the steps in this section to get Object ID:\n 1. Go to **Microsoft Entra ID**.\n 2. Select **Enterprise applications** from the left menu.\n 3. Find your newly created application in the list (you can search by the name you provided).\n 4. Click on the application.\n 5. On the overview page, copy the **Object ID**. This is the **AzureEntraObjectId** needed for your ARM template role assignment.\n"
      },
      {
        "title": "",
        "description": "**STEP 5 - Assign role of Contributor to application in Microsoft Entra ID**\n\n Follow the steps in this section to assign the role:\n 1. In the Azure portal, Go to **Resource Group** and select your resource group.\n 2. Go to **Access control (IAM)** from left panel.\n 3. Click on **Add**, and then select **Add role assignment**.\n 4. Select **Contributor** as role and click on next.\n 5. In **Assign access to**, select `User, group, or service principal`.\n 6. Click on **add members** and type **your app name** that you have created and select it.\n 7. Now click on **Review + assign** and then again click on **Review + assign**. \n\n> **Reference link:** [https://learn.microsoft.com/azure/role-based-access-control/role-assignments-portal](https://learn.microsoft.com/azure/role-based-access-control/role-assignments-portal)"
      },
      {
        "title": "",
        "description": "**STEP 6 - Upload csv with indictaors in Watchlist**\n\n Follow the steps in this section to upload csv containing indicators in watchlist:\n 1. In the Azure portal, Go to **Microsoft Sentinel** and select your workspace.\n 2. Go to **Watchlist** under **Configuration** section from left panel.\n 3. Click on **TeamCymruScoutDomainData**, and then select **Bulk update** from **Update watchlist**.\n 4. Upload your csv files with domain indicators in **Upload file** input and click on **Next: Review+Create**.\n 5. Once validation is successful, click on **Update**.\n 6. Follow the same steps to update *TeamCymruScoutIPData* watchlist for ip indicators. \n\n> **Reference link:** [Bulk update a watchlist](https://learn.microsoft.com/en-us/azure/sentinel/watchlists-manage#bulk-update-a-watchlist)"
      },
      {
        "title": "",
        "description": "**STEP 7 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>"
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the TeamCymruScout data connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-TeamCymruScout-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the below information : \n\t\tLocation \n\t\tWorkspaceName \n\t\tFunction Name \n\t\tTeamCymruScoutBaseURL \n\t\tAuthenticationType \n\t\tUsername \n\t\tPassword \n\t\tAPIKey \n\t\tIPValues \n\t\tDomainValues \n\t\tAPIType \n\t\tAzureClientId \n\t\tAzureClientSecret \n\t\tTenantId \n\t\tAzureEntraObjectId \n\t\tIPTableName \n\t\tDomainTableName \n\t\tAccountUsageTableName \n\t\tSchedule \n\t\tAccountUsageSchedule \n\t\tLogLevel \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the TeamCymruScout data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-TeamCymruScout310-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. CymruScoutXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.12 or above.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following application settings individually, with their respective values (case-sensitive): \n\t\tCymruScoutBaseURL \n\t\tAuthenticationType \n\t\tTeamCymruScoutUsername \n\t\tTeamCymruScoutPassword \n\t\tAPIKey \n\t\tIPValues \n\t\tDomainValues \n\t\tAPIType \n\t\tAZURE_CLIENT_ID \n\t\tAZURE_CLIENT_SECRET \n\t\tAZURE_TENANT_ID \n\t\tIPTableName \n\t\tDomainTableName \n\t\tAccountUsageTableName \n\t\tSchedule \n\t\tAccountUsageSchedule \n\t\tLogLevel \n\t\tAZURE_DATA_COLLECTION_ENDPOINT \n\t\tAZURE_DATA_COLLECTION_RULE_ID_MAIN_TABLES \n\t\tAZURE_DATA_COLLECTION_RULE_ID_SUB_TABLES\n4. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "Tenable.ad",
    "title": "Tenable.ad",
    "publisher": "Tenable",
    "descriptionMarkdown": "Tenable.ad connector allows to export Tenable.ad Indicators of Exposures, trailflow and Indicators of Attacks logs to Azure Sentinel in real time.\nIt provides a data parser to manipulate the logs more easily. The different workbooks ease your Active Directory monitoring and provide different ways to visualize the data. The analytic templates allow to automate responses regarding different events, exposures, or attacks.",
    "additionalRequirementBanner": "This data connector depends on a parser based on Kusto Function to work as expected. Follow the steps to use this Kusto Function alias **afad_parser** in queries and workbooks.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Tenable_ad_CL",
        "baseQuery": "Tenable_ad_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get the number of alerts triggered by each IoE",
        "query": "afad_parser\n | where MessageType == 0\n | summarize AlertCount = count() by Codename"
      },
      {
        "description": "Get all IoE alerts with severity superior to the threshold",
        "query": "let threshold = 2;\n let SeverityTable=datatable(Severity:string,Level:int) [\n \"low\", 1,\n \"medium\", 2,\n \"high\", 3,\n \"critical\", 4\n ];\n afad_parser\n | where MessageType == 0\n | lookup kind=leftouter SeverityTable on Severity\n | where Level >= ['threshold']"
      },
      {
        "description": "Get all IoE alerts for the last 24 hours",
        "query": "afad_parser\r\n| where MessageType == 0 and TimeGenerated > ago(1d)"
      },
      {
        "description": "Get all IoE alerts for the last 7 days",
        "query": "afad_parser\r\n| where MessageType == 0 and TimeGenerated > ago(7d)"
      },
      {
        "description": "Get all IoE alerts for the last 30 days",
        "query": "afad_parser\r\n| where MessageType == 0 and TimeGenerated > ago(30d)"
      },
      {
        "description": "Get all trailflow changes for the last 24 hours",
        "query": "afad_parser\r\n| where MessageType == 1 and TimeGenerated > ago(1d)"
      },
      {
        "description": "Get all trailflow changes for the last 7 days",
        "query": "afad_parser\r\n| where MessageType == 1 and TimeGenerated > ago(7d)"
      },
      {
        "description": "Get the number of alerts triggered by each IoA",
        "query": "afad_parser\n | where MessageType == 2\n | summarize AlertCount = count() by Codename"
      },
      {
        "description": "Get all IoA alerts for the last 30 days",
        "query": "afad_parser\r\n| where MessageType == 2 and TimeGenerated > ago(30d)"
      }
    ],
    "dataTypes": [
      {
        "name": "Tenable_ad_CL",
        "lastDataReceivedQuery": "Tenable_ad_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "afad_parser\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Access to Tenable.ad Configuration",
          "description": "Permissions to configure syslog alerting engine"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">This data connector depends on a parser based on a Kusto Function to work as expected. [Follow these steps](https://raw.githubusercontent.com/tenable/Azure-Sentinel/Tenable.ad-connector/Solutions/TenableAD/Parsers/afad_parser.kql) to create the Kusto Functions alias, **afad_parser**",
        "instructions": []
      },
      {
        "title": "1. Configure the Syslog server",
        "description": "You will first need a **linux Syslog** server that Tenable.ad will send logs to. Typically you can run **rsyslog** on **Ubuntu**.\n You can then configure this server as you wish, but it is recommended to be able to output Tenable.ad logs in a separate file.\n\nConfigure rsyslog to accept logs from your Tenable.ad IP address.:\n\n```shell\nsudo -i\n\n# Set Tenable.ad source IP address\nexport TENABLE_AD_IP={Enter your IP address}\n\n# Create rsyslog configuration file\ncat > /etc/rsyslog.d/80-tenable.conf << EOF\n\\$ModLoad imudp\n\\$UDPServerRun 514\n\\$ModLoad imtcp\n\\$InputTCPServerRun 514\n\\$AllowedSender TCP, 127.0.0.1, $TENABLE_AD_IP\n\\$AllowedSender UDP, 127.0.0.1, $TENABLE_AD_IP\n\\$template MsgTemplate,\"%TIMESTAMP:::date-rfc3339% %HOSTNAME% %programname%[%procid%]:%msg%\\n\"\n\\$template remote-incoming-logs, \"/var/log/%PROGRAMNAME%.log\"\n*.* ?remote-incoming-logs;MsgTemplate\nEOF\n\n# Restart rsyslog\nsystemctl restart rsyslog\n```"
      },
      {
        "title": "2. Install and onboard the Microsoft agent for Linux",
        "description": "The OMS agent will receive the Tenable.ad syslog events and publish it in Sentinel :",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "3. Check agent logs on the Syslog server",
        "description": "```shell\ntail -f /var/opt/microsoft/omsagent/log/omsagent.log\n```"
      },
      {
        "title": "4. Configure Tenable.ad to send logs to your Syslog server",
        "description": "On your **Tenable.ad** portal, go to *System*, *Configuration* and then *Syslog*.\nFrom there you can create a new Syslog alert toward your Syslog server.\n\nOnce this is done, check that the logs are correctly gathered on your server in a separate file (to do this, you can use the *Test the configuration* button in the Syslog alert configuration in Tenable.ad).\nIf you used the Quickstart template, the Syslog server will by default listen on port 514 in UDP and 1514 in TCP, without TLS."
      },
      {
        "title": "5. Configure the custom logs",
        "description": "Configure the agent to collect the logs.\n\n1. In Sentinel, go to **Configuration** -> **Settings** -> **Workspace settings** -> **Custom logs**.\n2. Click **Add custom log**.\n3. Upload a sample Tenable.ad.log Syslog file from the **Linux** machine running the **Syslog** server and click **Next**\n4. Set the record delimiter to **New Line** if not already the case and click **Next**.\n5. Select **Linux** and enter the file path to the **Syslog** file, click **+** then **Next**. The default location of the file is `/var/log/Tenable.ad.log` if you have a Tenable version <3.1.0, you must also add this linux file location `/var/log/AlsidForAD.log`.\n6. Set the **Name** to *Tenable_ad_CL* (Azure automatically adds *_CL* at the end of the name, there must be only one, make sure the name is not *Tenable_ad_CL_CL*).\n7. Click **Next**, you will see a resume, then click **Create**\n",
        "instructions": []
      },
      {
        "title": "6. Enjoy !",
        "description": "> You should now be able to receive logs in the *Tenable_ad_CL* table, logs data can be parse using the **afad_parser()** function, used by all query samples, workbooks and analytic templates."
      }
    ],
    "metadata": {
      "id": "053c01c0-fe14-4eef-9b35-2637a129677b",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Tenable"
      },
      "support": {
        "name": "Tenable",
        "link": "https://www.tenable.com/about-tenable/contact-tenable",
        "tier": "developer"
      }
    }
  },
  {
    "id": "TenableIE",
    "title": "Tenable Identity Exposure",
    "publisher": "Tenable",
    "descriptionMarkdown": "Tenable Identity Exposure connector allows Indicators of Exposure, Indicators of Attack and trailflow logs to be ingested into Microsoft Sentinel.The different work books and data parsers allow you to more easily manipulate logs and monitor your Active Directory environment.  The analytic templates allow you to automate responses regarding different events, exposures and attacks.",
    "additionalRequirementBanner": "This data connector depends on a parser based on Kusto Function to work as expected. Follow the steps to use this Kusto Function alias **afad_parser** in queries and workbooks.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Tenable_IE_CL",
        "baseQuery": "Tenable_IE_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get the number of alerts triggered by each IoE",
        "query": "afad_parser\n | where MessageType == 0\n | summarize AlertCount = count() by Codename"
      },
      {
        "description": "Get all IoE alerts with severity superior to the threshold",
        "query": "let threshold = 2;\n let SeverityTable=datatable(Severity:string,Level:int) [\n \"low\", 1,\n \"medium\", 2,\n \"high\", 3,\n \"critical\", 4\n ];\n afad_parser\n | where MessageType == 0\n | lookup kind=leftouter SeverityTable on Severity\n | where Level >= ['threshold']"
      },
      {
        "description": "Get all IoE alerts for the last 24 hours",
        "query": "afad_parser\r\n| where MessageType == 0 and TimeGenerated > ago(1d)"
      },
      {
        "description": "Get all IoE alerts for the last 7 days",
        "query": "afad_parser\r\n| where MessageType == 0 and TimeGenerated > ago(7d)"
      },
      {
        "description": "Get all IoE alerts for the last 30 days",
        "query": "afad_parser\r\n| where MessageType == 0 and TimeGenerated > ago(30d)"
      },
      {
        "description": "Get all trailflow changes for the last 24 hours",
        "query": "afad_parser\r\n| where MessageType == 1 and TimeGenerated > ago(1d)"
      },
      {
        "description": "Get all trailflow changes for the last 7 days",
        "query": "afad_parser\r\n| where MessageType == 1 and TimeGenerated > ago(7d)"
      },
      {
        "description": "Get the number of alerts triggered by each IoA",
        "query": "afad_parser\n | where MessageType == 2\n | summarize AlertCount = count() by Codename"
      },
      {
        "description": "Get all IoA alerts for the last 30 days",
        "query": "afad_parser\r\n| where MessageType == 2 and TimeGenerated > ago(30d)"
      }
    ],
    "dataTypes": [
      {
        "name": "Tenable_IE_CL",
        "lastDataReceivedQuery": "Tenable_IE_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "afad_parser\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Access to TenableIE Configuration",
          "description": "Permissions to configure syslog alerting engine"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">This data connector depends on [afad_parser](https://aka.ms/sentinel-TenableApp-afad-parser) based on a Kusto Function to work as expected which is deployed with the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "1. Configure the Syslog server",
        "description": "You will first need a **linux Syslog** server that TenableIE will send logs to. Typically you can run **rsyslog** on **Ubuntu**.\n You can then configure this server as you wish, but it is recommended to be able to output TenableIE logs in a separate file.\n\nConfigure rsyslog to accept logs from your TenableIE IP address.:\n\n```shell\nsudo -i\n\n# Set TenableIE source IP address\nexport TENABLE_IE_IP={Enter your IP address}\n\n# Create rsyslog configuration file\ncat > /etc/rsyslog.d/80-tenable.conf << EOF\n\\$ModLoad imudp\n\\$UDPServerRun 514\n\\$ModLoad imtcp\n\\$InputTCPServerRun 514\n\\$AllowedSender TCP, 127.0.0.1, $TENABLE_IE_IP\n\\$AllowedSender UDP, 127.0.0.1, $TENABLE_IE_IP\n\\$template MsgTemplate,\"%TIMESTAMP:::date-rfc3339% %HOSTNAME% %programname%[%procid%]:%msg%\\n\"\n\\$template remote-incoming-logs, \"/var/log/%PROGRAMNAME%.log\"\n*.* ?remote-incoming-logs;MsgTemplate\nEOF\n\n# Restart rsyslog\nsystemctl restart rsyslog\n```"
      },
      {
        "title": "2. Install and onboard the Microsoft agent for Linux",
        "description": "The OMS agent will receive the TenableIE syslog events and publish it in Microsoft Sentinel :",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "3. Check agent logs on the Syslog server",
        "description": "```shell\ntail -f /var/opt/microsoft/omsagent/log/omsagent.log\n```"
      },
      {
        "title": "4. Configure TenableIE to send logs to your Syslog server",
        "description": "On your **TenableIE** portal, go to *System*, *Configuration* and then *Syslog*.\nFrom there you can create a new Syslog alert toward your Syslog server.\n\nOnce this is done, check that the logs are correctly gathered on your server in a separate file (to do this, you can use the *Test the configuration* button in the Syslog alert configuration in TenableIE).\nIf you used the Quickstart template, the Syslog server will by default listen on port 514 in UDP and 1514 in TCP, without TLS."
      },
      {
        "title": "5. Configure the custom logs",
        "description": "Configure the agent to collect the logs.\n\n1. In Microsoft Sentinel, go to **Configuration** -> **Settings** -> **Workspace settings** -> **Custom logs**.\n2. Click **Add custom log**.\n3. Upload a sample TenableIE.log Syslog file from the **Linux** machine running the **Syslog** server and click **Next**\n4. Set the record delimiter to **New Line** if not already the case and click **Next**.\n5. Select **Linux** and enter the file path to the **Syslog** file, click **+** then **Next**. The default location of the file is `/var/log/TenableIE.log` if you have a Tenable version <3.1.0, you must also add this linux file location `/var/log/AlsidForAD.log`.\n6. Set the **Name** to *Tenable_IE_CL* (Azure automatically adds *_CL* at the end of the name, there must be only one, make sure the name is not *Tenable_IE_CL_CL*).\n7. Click **Next**, you will see a resume, then click **Create**\n",
        "instructions": []
      },
      {
        "title": "6. Enjoy !",
        "description": "> You should now be able to receive logs in the *Tenable_IE_CL* table, logs data can be parse using the **afad_parser()** function, used by all query samples, workbooks and analytic templates."
      }
    ],
    "metadata": {
      "id": "053c01c0-fe14-4eef-9b35-2637a129677b",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Tenable"
      },
      "support": {
        "name": "Tenable",
        "link": "https://www.tenable.com/about-tenable/contact-tenable",
        "tier": "developer"
      }
    }
  },
  {
    "id": "TenableIOAPI",
    "title": "Tenable.io Vulnerability Management",
    "publisher": "Tenable",
    "descriptionMarkdown": "The [Tenable.io](https://www.tenable.com/products/tenable-io) data connector provides the capability to ingest Asset and Vulnerability data into Microsoft Sentinel through the REST API from the Tenable.io platform (Managed in the cloud). Refer to [API documentation](https://developer.tenable.com/reference) for more information. The connector provides the ability to get data which helps to examine potential security risks, get insight into your computing assets, diagnose configuration problems and more",
    "additionalRequirementBanner": "These queries and workbooks are dependent on a [**Tenable.io parser for vulnerabilities**](https://aka.ms/sentinel-TenableIO-TenableIOVulnerabilities-parser) and a [**Tenable.io parser for assets**](https://aka.ms/sentinel-TenableIO-TenableIOAssets-parser) based on Kusto to work as expected which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Tenable_IO_Assets_CL",
        "baseQuery": "Tenable_IO_Assets_CL"
      },
      {
        "metricName": "Total data received",
        "legend": "Tenable_IO_Vuln_CL",
        "baseQuery": "Tenable_IO_Vuln_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "TenableIO VM Report - All Assets",
        "query": "Tenable_IO_Assets_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "TenableIO VM Report - All Vulns",
        "query": "Tenable_IO_Vuln_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Select unique vulnerabilities by a specific asset.",
        "query": "Tenable_IO_Vuln_CL\n | where asset_fqdn_s has \"one.one.one.one\"\n | summarize any(asset_fqdn_s, plugin_id_d, plugin_cve_s) by plugin_id_d"
      },
      {
        "description": "Select all Azure assets.",
        "query": "Tenable_IO_Assets_CL\n | where isnotempty(azure_resource_id_s) or isnotempty(azure_vm_id_g)"
      }
    ],
    "dataTypes": [
      {
        "name": "Tenable_IO_Assets_CL",
        "lastDataReceivedQuery": "Tenable_IO_Assets_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Tenable_IO_Vuln_CL",
        "lastDataReceivedQuery": "Tenable_IO_Vuln_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Tenable_IO_Assets_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Tenable_IO_Vuln_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "Both a **TenableAccessKey** and a **TenableSecretKey** is required to access the Tenable REST API. [See the documentation to learn more about API](https://developer.tenable.com/reference#vulnerability-management). Check all [requirements and follow  the instructions](https://docs.tenable.com/tenableio/vulnerabilitymanagement/Content/Settings/GenerateAPIKey.htm) for obtaining credentials."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Durable Functions to connect to the Tenable.io API to pull [assets](https://developer.tenable.com/reference#exports-assets-download-chunk) and [vulnerabilities](https://developer.tenable.com/reference#exports-vulns-request-export) at a regular interval into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "description": ">**NOTE:** This data connector depends on a [**Tenable.io parser for vulnerabilities**](https://aka.ms/sentinel-TenableIO-TenableIOVulnerabilities-parser) and a [**Tenable.io parser for assets**](https://aka.ms/sentinel-TenableIO-TenableIOAssets-parser) based on a Kusto Function to work as expected which is deployed with the Microsoft Sentinel Solution."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for Tenable.io**\n\n [Follow the instructions](https://docs.tenable.com/tenableio/vulnerabilitymanagement/Content/Settings/GenerateAPIKey.htm) to obtain the required API credentials. \n"
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function App**\n\n>**IMPORTANT:** Before deploying the Workspace data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following).",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the Tenable.io Vulnerability Management Report data connector using an ARM Template.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-TenableIO-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **TenableAccessKey** and **TenableSecretKey** and deploy. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the Tenable.io Vulnerability Management Report data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-TenableIO-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. TenableIOXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.8.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tTenableAccessKey\n\t\tTenableSecretKey\n\t\tWorkspaceID\n\t\tWorkspaceKey\n\t\tlogAnalyticsUri (optional)\n> - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<WorkspaceID>.ods.opinsights.azure.us`.\n3. Once all application settings have been entered, click **Save**."
      }
    ],
    "metadata": {
      "id": "87b003e3-ad99-4399-be20-ffcdafb8ac2b",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "TenableIO"
      },
      "author": {
        "name": "Tenable"
      },
      "support": {
        "tier": "community",
        "name": "Tenable",
        "link": "https://www.tenable.com/support/technical-support"
      }
    }
  },
  {
    "id": "TenableVM",
    "title": "Tenable Vulnerability Management",
    "publisher": "Tenable",
    "descriptionMarkdown": "The TVM data connector provides the ability to ingest Asset, Vulnerability, Compliance, WAS assets and WAS vulnerabilities data into Microsoft Sentinel using TVM REST APIs. Refer to [API documentation](https://developer.tenable.com/reference) for more information. The connector provides the ability to get data which helps to examine potential security risks, get insight into your computing assets, diagnose configuration problems and more",
    "additionalRequirementBanner": "These queries and workbooks are dependent on a [**TenableVM parser for vulnerabilities**](https://aka.ms/sentinel-TenableApp-TenableVMVulnerabilities-parser) and a [**TenableVM parser for assets**](https://aka.ms/sentinel-TenableApp-TenableVMAssets-parser) based on Kusto to work as expected which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total Assets data received",
        "legend": "Tenable_VM_Asset_CL",
        "baseQuery": "Tenable_VM_Asset_CL"
      },
      {
        "metricName": "Total Vulnerability data received",
        "legend": "Tenable_VM_Vuln_CL",
        "baseQuery": "Tenable_VM_Vuln_CL"
      },
      {
        "metricName": "Total Compliance data received",
        "legend": "Tenable_VM_Compliance_CL",
        "baseQuery": "Tenable_VM_Compliance_CL"
      },
      {
        "metricName": "Total WAS asset data received",
        "legend": "Tenable_WAS_Asset_CL",
        "baseQuery": "Tenable_WAS_Asset_CL"
      },
      {
        "metricName": "Total WAS vulnerabilities data received",
        "legend": "Tenable_WAS_Vuln_CL",
        "baseQuery": "Tenable_WAS_Vuln_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Tenable VM Report - All Assets",
        "query": "Tenable_VM_Asset_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Tenable VM Report - All Vulns",
        "query": "Tenable_VM_Vuln_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Tenable VM Report - All Compliance",
        "query": "Tenable_VM_Compliance_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Tenable WAS Report - All Assets",
        "query": "Tenable_WAS_Asset_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Tenable WAS Report - All Vulns",
        "query": "Tenable_WAS_Vuln_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Select unique vulnerabilities by a specific asset.",
        "query": "Tenable_VM_Vuln_CL\n | where asset_fqdn has \"one.one.one.one\"\n | summarize any(asset_fqdn, plugin_id, plugin_cve) by plugin_id"
      },
      {
        "description": "Select all Azure assets.",
        "query": "Tenable_VM_Asset_CL\n | where isnotempty(azure_resource_id) or isnotempty(azure_vm_id)"
      }
    ],
    "dataTypes": [
      {
        "name": "Tenable_VM_Asset_CL",
        "lastDataReceivedQuery": "Tenable_VM_Asset_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Tenable_VM_Vuln_CL",
        "lastDataReceivedQuery": "Tenable_VM_Vuln_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Tenable_VM_Compliance_CL",
        "lastDataReceivedQuery": "Tenable_VM_Compliance_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Tenable_WAS_Asset_CL",
        "lastDataReceivedQuery": "Tenable_WAS_Asset_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Tenable_WAS_Vuln_CL",
        "lastDataReceivedQuery": "Tenable_WAS_Vuln_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Tenable_VM_Asset_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Tenable_VM_Vuln_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Tenable_VM_Compliance_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Tenable_WAS_Asset_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Tenable_WAS_Vuln_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "Both a **TenableAccessKey** and a **TenableSecretKey** is required to access the Tenable REST API. [See the documentation to learn more about API](https://developer.tenable.com/reference#vulnerability-management). Check all [requirements and follow  the instructions](https://docs.tenable.com/vulnerability-management/Content/Settings/my-account/GenerateAPIKey.htm) for obtaining credentials."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Durable Functions to connect to the TenableVM API to pull [assets](https://developer.tenable.com/reference#exports-assets-download-chunk), [vulnerabilities](https://developer.tenable.com/reference#exports-vulns-request-export) and [compliance](https://developer.tenable.com/reference#exports-compliance-request-export)(if selected) at a regular interval into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "description": ">**NOTE:** This data connector depends on a [**TenableVM parser for vulnerabilities**](https://aka.ms/sentinel-TenableApp-TenableVMVulnerabilities-parser) and a [**TenableVM parser for assets**](https://aka.ms/sentinel-TenableApp-TenableVMAssets-parser) based on a Kusto Function to work as expected which is deployed with the Microsoft Sentinel Solution."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for TenableVM**\n\n [Follow the instructions](https://docs.tenable.com/vulnerability-management/Content/Settings/my-account/GenerateAPIKey.htm) to obtain the required API credentials. \n"
      },
      {
        "title": "",
        "description": "**STEP 2 - App Registration steps for the Application in Microsoft Entra ID**\n\n This integration requires an App registration in the Azure portal. Follow the steps in this section to create a new application in Microsoft Entra ID:\n 1. Sign in to the [Azure portal](https://portal.azure.com/).\n 2. Search for and select **Microsoft Entra ID**.\n 3. Under **Manage**, select **App registrations > New registration**.\n 4. Enter a display **Name** for your application.\n 5. Select **Register** to complete the initial app registration.\n 6. When registration finishes, the Azure portal displays the app registration's Overview pane. You see the **Application (client) ID** and **Tenant ID**. The client ID and Tenant ID is required as configuration parameters for the execution of TenableVM Data Connector. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app)"
      },
      {
        "title": "",
        "description": "**STEP 3 - Add a client secret for application in Microsoft Entra ID**\n\n Sometimes called an application password, a client secret is a string value required for the execution of TenableVM Data Connector. Follow the steps in this section to create a new Client Secret:\n 1. In the Azure portal, in **App registrations**, select your application.\n 2. Select **Certificates & secrets > Client secrets > New client secret**.\n 3. Add a description for your client secret.\n 4. Select an expiration for the secret or specify a custom lifetime. Limit is 24 months.\n 5. Select **Add**. \n 6. *Record the secret's value for use in your client application code. This secret value is never displayed again after you leave this page.* The secret value is required as configuration parameter for the execution of TenableVM Data Connector. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret)"
      },
      {
        "title": "",
        "description": "**STEP 4 - Get Object ID of your application in Microsoft Entra ID**\n\n After creating your app registration, follow the steps in this section to get Object ID:\n 1. Go to **Microsoft Entra ID**.\n 2. Select **Enterprise applications** from the left menu.\n 3. Find your newly created application in the list (you can search by the name you provided).\n 4. Click on the application.\n 5. On the overview page, copy the **Object ID**. This is the **AzureEntraObjectId** needed for your ARM template role assignment.\n"
      },
      {
        "title": "",
        "description": "**STEP 5 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function App**\n\n"
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the TenableVM Vulnerability Management Report data connector using an ARM Template.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-TenableVM-azuredeploy) [![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://aka.ms/sentinel-TenableVM-azuredeploy-gov)\n2. Select the preferred **Subscription**, **Resource Group**, **FunctionApp Name** and **Location**. \n3. Enter the below information :  \n\n\t a. **WorkspaceName** - Enter the Workspace Name of the log analytics Workspace. \n\n\t b. **TenableAccessKey** - Enter Access key for using the Tenable API. \n\n\t c. **TenableSecretKey** - Enter Tenable Secret Key for Authentication. \n\n\t d. **AzureClientID** - Enter Azure Client ID. \n\n\t e. **AzureClientSecret** - Enter Azure Client Secret. \n\n\t f. **TenantID** - Enter Tenant ID got from above steps. \n\n\t g. **AzureEntraObjectId** - Enter Azure Object ID got from above steps. \n\n\t h. **LowestSeveritytoStore** - Lowest vulnerability severity to store. Allowed Values: Info, Low, Medium, High, Critical. Default is Info. \n\n\t i. **ComplianceDataIngestion** - Select true if you want to enable Compliance data ingestion from Tenable VM. Default is false. \n\n\t j. **WASAssetDataIngestion** - Select true if you want to enable WAS Asset data ingestion from Tenable VM. Default is false. \n\n\t k. **WASVulnerabilityDataIngestion** - Select true if you want to enable WAS Vulnerability data ingestion from Tenable VM. Default is false. \n\n\t l. **LowestSeveritytoStoreWAS** - The Lowest Vulnerability severity to store for WAS. Allowed Values: Info, Low, Medium, High, Critical. Default is Info. \n\n\t m. **TenableExportScheduleInMinutes** - Schedule in minutes to create new export job from Tenable VM. Default is 1440. \n\n\t n. **AssetTableName** - Enter name of the table used to store Asset Data logs. \n\n\t o. **VulnTableName** - Enter name of the table used to store Vulnerability Data logs. \n\n\t p. **ComplianceTableName** - Enter name of the table used to store Compliance Data logs. \n\n\t q. **WASAssetTableName** - Enter name of the table used to store WAS Asset Data logs. \n\n\t r. **WASVulnTableName** - Enter name of the table used to store WAS Vulnerability Data logs. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the TenableVM Vulnerability Management Report data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-TenableVMAzureSentinelConnector310Updated-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. TenableVMXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.12.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\n\t a. **WorkspaceName** - Enter the Workspace Name of the log analytics Workspace. \n\n\t b. **TenableAccessKey** - Enter Access key for using the Tenable API. \n\n\t c. **TenableSecretKey** - Enter Tenable Secret Key for Authentication. \n\n\t d. **AzureClientID** - Enter Azure Client ID. \n\n\t e. **AzureClientSecret** - Enter Azure Client Secret. \n\n\t f. **TenantID** - Enter Tenant ID got from above steps. \n\n\t g. **AzureEntraObjectId** - Enter Azure Object ID got from above steps. \n\n\t h. **LowestSeveritytoStore** - Lowest vulnerability severity to store. Allowed Values: Info, Low, Medium, High, Critical. Default is Info. \n\n\t i. **ComplianceDataIngestion** - Select true if you want to enable Compliance data ingestion from Tenable VM. Default is false. \n\n\t j. **WASAssetDataIngestion** - Select true if you want to enable WAS Asset data ingestion from Tenable VM. Default is false. \n\n\t k. **WASVulnerabilityDataIngestion** - Select true if you want to enable WAS Vulnerability data ingestion from Tenable VM. Default is false. \n\n\t l. **LowestSeveritytoStoreWAS** - The Lowest Vulnerability severity to store for WAS. Allowed Values: Info, Low, Medium, High, Critical. Default is Info. \n\n\t m. **TenableExportScheduleInMinutes** - Schedule in minutes to create new export job from Tenable VM. Default is 1440. \n\n\t n. **AssetTableName** - Enter name of the table used to store Asset Data logs. \n\n\t o. **VulnTableName** - Enter name of the table used to store Vulnerability Data logs. \n\n\t p. **ComplianceTableName** - Enter name of the table used to store Compliance Data logs. \n\n\t q. **WASAssetTableName** - Enter name of the table used to store WAS Asset Data logs. \n\n\t r. **WASVulnTableName** - Enter name of the table used to store WAS Vulnerability Data logs. \n\n\t s. **PyTenableUAVendor** - Value must be set to **Microsoft**. \n\n\t t. **PyTenableUAProduct** - Value must be set to **Azure Sentinel**. \n\n\t u. **PyTenableUABuild** - Value must be set to **0.0.1**.\n3. Once all application settings have been entered, click **Save**."
      }
    ],
    "metadata": {
      "id": "87b003e3-ad99-4399-be20-ffcdafb8ac2b",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "TenableVM"
      },
      "author": {
        "name": "Tenable"
      },
      "support": {
        "tier": "community",
        "name": "Tenable",
        "link": "https://www.tenable.com/support/technical-support"
      }
    }
  },
  {
    "id": "TheHiveProjectTheHive",
    "title": "TheHive Project - TheHive",
    "publisher": "TheHive Project",
    "descriptionMarkdown": "The [TheHive](http://thehive-project.org/) data connector provides the capability to ingest common TheHive events into Microsoft Sentinel through Webhooks. TheHive can notify external system of modification events (case creation, alert update, task assignment) in real time. When a change occurs in the TheHive, an HTTPS POST request with event information is sent to a callback data connector URL.  Refer to [Webhooks documentation](https://docs.thehive-project.org/thehive/legacy/thehive3/admin/webhooks/) for more information. The connector provides ability to get events which helps to examine potential security risks, analyze your team's use of collaboration, diagnose configuration problems and more.",
    "additionalRequirementBanner": ">This data connector depends on a parser based on a Kusto Function to work as expected [**TheHive**](https://aka.ms/sentinel-TheHive-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "TheHive_CL",
        "baseQuery": "TheHive_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "TheHive Events - All Activities.",
        "query": "TheHive_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "TheHive_CL",
        "lastDataReceivedQuery": "TheHive_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "TheHive_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Webhooks Credentials/permissions",
          "description": "**TheHiveBearerToken**, **Callback URL** are required for working Webhooks. See the documentation to learn more about [configuring Webhooks](https://docs.thehive-project.org/thehive/installation-and-configuration/configuration/webhooks/)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector uses Azure Functions based on HTTP Trigger for waiting POST requests with logs to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**TheHive**](https://aka.ms/sentinel-TheHive-parser) which is deployed with the Microsoft Sentinel Solution."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the TheHive**\n\n Follow the [instructions](https://docs.thehive-project.org/thehive/installation-and-configuration/configuration/webhooks/) to configure Webhooks.\n\n1. Authentication method is *Beared Auth*.\n2. Generate the **TheHiveBearerToken** according to your password policy.\n3. Setup Webhook notifications in the *application.conf* file including **TheHiveBearerToken** parameter."
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the TheHive data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following).",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Option 1 - Azure Resource Manager (ARM) Template",
                  "description": "Use this method for automated deployment of the TheHive data connector using an ARM Template.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-TheHive-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n> **NOTE:** Within the same resource group, you can't mix Windows and Linux apps in the same region. Select existing resource group without Windows apps in it or create new resource group.\n3. Enter the **TheHiveBearerToken** and deploy. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy.\n6. After deploying open Function App page, select your app, go to the **Functions** and click **Get Function Url** copy it and follow p.7 from STEP 1."
                },
                {
                  "title": "Option 2 - Manual Deployment of Azure Functions",
                  "description": "Use the following step-by-step instructions to deploy the TheHive data connector manually with Azure Functions (Deployment via Visual Studio Code).",
                  "instructions": [
                    {
                      "parameters": {
                        "instructionSteps": [
                          {
                            "title": "Step 1 - Deploy a Function App",
                            "description": "**NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-TheHive-functionapp) file. Extract archive to your local development computer.\n2. Follow the [function app manual deployment instructions](https://github.com/Azure/Azure-Sentinel/blob/master/DataConnectors/AzureFunctionsManualDeployment.md#function-app-manual-deployment-instructions) to deploy the Azure Functions app using VSCode.\n3. After successful deployment of the function app, follow next steps for configuring it."
                          },
                          {
                            "title": "Step 2 - Configure the Function App",
                            "description": "1. Go to Azure Portal for the Function App configuration.\n2. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select ** New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tTheHiveBearerToken\n\t\tWorkspaceID\n\t\tWorkspaceKey\n\t\tlogAnalyticsUri (optional)\n> - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n4. Once all application settings have been entered, click **Save**."
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "Theom",
    "title": "Theom",
    "publisher": "Theom",
    "descriptionMarkdown": "Theom Data Connector enables organizations to connect their Theom environment to Microsoft Sentinel. This solution enables users to receive alerts on data security risks, create and enrich incidents, check statistics and trigger SOAR playbooks in Microsoft Sentinel",
    "graphQueries": [
      {
        "metricName": "Total alerts received",
        "legend": "TheomAlerts_CL",
        "baseQuery": "TheomAlerts_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All alerts in the past 24 hour",
        "query": "TheomAlerts_CL\n     | where TimeGenerated > ago(24h)\n  | sort by TimeGenerated\n  | limit 10"
      }
    ],
    "dataTypes": [
      {
        "name": "TheomAlerts_CL",
        "lastDataReceivedQuery": "TheomAlerts_CL\n | summarize Time = max(TimeGenerated)\n  | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "TheomAlerts_CL\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(90d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "1. In **Theom UI Console** click on **Manage -> Alerts** on the side bar.\n2. Select  **Sentinel** tab.\n3. Click on **Active** button to enable the configuration.\n4. Enter `Primary` key as `Authorization Token`\n5. Enter `Endpoint URL` as `https://<Workspace ID>.ods.opinsights.azure.com/api/logs?api-version=2016-04-01`\n6. Click on `SAVE SETTINGS`\n",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ],
    "metadata": {
      "id": "6f2e8d0b-7ae8-4fd6-a471-8fda71dd8ae6",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Theom"
      },
      "support": {
        "name": "Theom Support",
        "email": "",
        "tier": "developer",
        "link": "https://www.theom.ai"
      }
    }
  },
  {
    "id": "ThreatIntelligence",
    "title": "Threat Intelligence Platforms",
    "publisher": "Microsoft",
    "logo": {
      "type": 258,
      "options": null
    },
    "descriptionMarkdown": "Microsoft Sentinel integrates with Microsoft Graph Security API data sources to enable monitoring, alerting, and hunting using your threat intelligence. Use this connector to send threat indicators to Microsoft Sentinel from your Threat Intelligence Platform (TIP), such as Threat Connect, Palo Alto Networks MindMeld, MISP, or other integrated applications. Threat indicators can include IP addresses, domains, URLs, and file hashes. For more information, see the [Microsoft Sentinel documentation >](https://go.microsoft.com/fwlink/p/?linkid=2223729&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ThreatIntelligenceIndicator",
        "baseQuery": "ThreatIntelligenceIndicator | where SourceSystem == \"SecurityGraph\""
      }
    ],
    "sampleQueries": [
      {
        "description": "Summarize by threat type",
        "query": "ThreatIntelligenceIndicator\n| where ExpirationDateTime > now()\n| where SourceSystem == \"SecurityGraph\"\n| join (\n    SigninLogs\n) on $left.NetworkIP == $right.IPAddress\n| summarize count() by ThreatType"
      },
      {
        "description": "Summarize by 1 hour bins",
        "query": "CommonSecurityLog\n| where DestinationIP in\n((\n    ThreatIntelligenceIndicator\n    | where ExpirationDateTime > now()\n    | where SourceSystem == \"SecurityGraph\"\n    | where ThreatType == \"DDoS\"\n    | project NetworkIP\n))\n| summarize count() by bin(TimeGenerated, 1d)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "SentinelKinds",
        "value": [
          "ThreatIntelligence"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "ThreatIntelligenceIndicator",
        "lastDataReceivedQuery": "ThreatIntelligenceIndicator | where SourceSystem == \"SecurityGraph\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 2,
      "isPreview": true,
      "featureFlag": {
        "feature": "TIConnector",
        "featureStates": {
          "1": 2,
          "2": 2,
          "3": 2,
          "4": 2
        }
      }
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        }
      ],
      "tenant": [
        "GlobalAdmin",
        "SecurityAdmin"
      ]
    },
    "instructionSteps": [
      {
        "title": "You can connect your threat intelligence data sources to Microsoft Sentinel by either:",
        "description": "- Using an integrated Threat Intelligence Platform (TIP), such as Threat Connect, Palo Alto Networks MindMeld, MISP, and others.\n\n- Calling the Microsoft Graph Security API directly from another application."
      },
      {
        "title": "Follow These Steps to Connect your Threat Intelligence:",
        "description": "1) [Register an application](https://docs.microsoft.com/graph/auth-v2-service#1-register-your-app) in Azure Active Directory.\n\n2) [Configure permissions](https://docs.microsoft.com/graph/auth-v2-service#2-configure-permissions-for-microsoft-graph) and be sure to add the ThreatIndicators.ReadWrite.OwnedBy permission to the application.\n\n3) Ask your Azure AD tenant administrator to [grant consent](https://docs.microsoft.com/graph/auth-v2-service#3-get-administrator-consent) to the application.\n\n4) Configure your TIP or other integrated application to push indicators to Microsoft Sentinel by specifying the following:\n\n    a. The application ID and secret you received when registering the app (step 1 above). \n\n    b. Set Microsoft Sentinel as the target.\n\n    c. Set an action for each indicator - alert is most relevant for Microsoft Sentinel use cases \n\nFor the latest list of integrated Threat Intelligence Platforms and detailed configuration instructions, see the [full documentation](https://docs.microsoft.com/azure/sentinel/import-threat-intelligence#adding-threat-indicators-to-azure-sentinel-with-the-threat-intelligence-platforms-data-connector).\n\nClick on \"Connect\" below\n\n> Data from all regions will be sent to and stored in the workspace's region.",
        "instructions": [
          {
            "parameters": {},
            "type": "ThreatIntelligence"
          }
        ]
      }
    ]
  },
  {
    "id": "ThreatIntelligence",
    "title": "Threat Intelligence Platforms",
    "publisher": "Microsoft",
    "logo": {
      "type": 258,
      "options": null
    },
    "descriptionMarkdown": "Microsoft Sentinel integrates with Microsoft Graph Security API data sources to enable monitoring, alerting, and hunting using your threat intelligence. Use this connector to send threat indicators to Microsoft Sentinel from your Threat Intelligence Platform (TIP), such as Threat Connect, Palo Alto Networks MindMeld, MISP, or other integrated applications. Threat indicators can include IP addresses, domains, URLs, and file hashes. For more information, see the [Microsoft Sentinel documentation >](https://go.microsoft.com/fwlink/p/?linkid=2223729&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ThreatIntelIndicators",
        "baseQuery": "ThreatIntelIndicators | where SourceSystem == \"SecurityGraph\""
      },
      {
        "metricName": "Total data received",
        "legend": "ThreatIntelObjects",
        "baseQuery": "ThreatIntelObjects | where SourceSystem == \"SecurityGraph\""
      }
    ],
    "sampleQueries": [
      {
        "description": "Summarize by threat type",
        "query": "ThreatIntelIndicators\n| where ExpirationDateTime > now()\n| where SourceSystem == \"SecurityGraph\"\n| join (\n    SigninLogs\n) on $left.NetworkIP == $right.IPAddress\n| summarize count() by ThreatType"
      },
      {
        "description": "Summarize by 1 hour bins",
        "query": "CommonSecurityLog\n| where DestinationIP in\n((\n    ThreatIntelIndicators\n    | where ExpirationDateTime > now()\n    | where SourceSystem == \"SecurityGraph\"\n    | where ThreatType == \"DDoS\"\n    | project NetworkIP\n))\n| summarize count() by bin(TimeGenerated, 1d)"
      },
      {
        "description": "Summarize by threat type",
        "query": "ThreatIntelObjects\n| where ExpirationDateTime > now()\n| where SourceSystem == \"SecurityGraph\"\n| join (\n    SigninLogs\n) on $left.NetworkIP == $right.IPAddress\n| summarize count() by ThreatType"
      },
      {
        "description": "Summarize by 1 hour bins",
        "query": "CommonSecurityLog\n| where DestinationIP in\n((\n    ThreatIntelObjects\n    | where ExpirationDateTime > now()\n    | where SourceSystem == \"SecurityGraph\"\n    | where ThreatType == \"DDoS\"\n    | project NetworkIP\n))\n| summarize count() by bin(TimeGenerated, 1d)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "SentinelKinds",
        "value": [
          "ThreatIntelligence"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "ThreatIntelIndicators",
        "lastDataReceivedQuery": "ThreatIntelIndicators | where SourceSystem == \"SecurityGraph\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ThreatIntelObjects",
        "lastDataReceivedQuery": "ThreatIntelObjects | where SourceSystem == \"SecurityGraph\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 2,
      "isPreview": true,
      "featureFlag": {
        "feature": "TIConnector",
        "featureStates": {
          "1": 2,
          "2": 2,
          "3": 2,
          "4": 2
        }
      }
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        }
      ],
      "tenant": [
        "GlobalAdmin",
        "SecurityAdmin"
      ]
    },
    "instructionSteps": [
      {
        "title": "You can connect your threat intelligence data sources to Microsoft Sentinel by either:",
        "description": "- Using an integrated Threat Intelligence Platform (TIP), such as Threat Connect, Palo Alto Networks MindMeld, MISP, and others.\n\n- Calling the Microsoft Graph Security API directly from another application."
      },
      {
        "title": "Follow These Steps to Connect your Threat Intelligence:",
        "description": "1) [Register an application](https://docs.microsoft.com/graph/auth-v2-service#1-register-your-app) in Azure Active Directory.\n\n2) [Configure permissions](https://docs.microsoft.com/graph/auth-v2-service#2-configure-permissions-for-microsoft-graph) and be sure to add the ThreatIndicators.ReadWrite.OwnedBy permission to the application.\n\n3) Ask your Azure AD tenant administrator to [grant consent](https://docs.microsoft.com/graph/auth-v2-service#3-get-administrator-consent) to the application.\n\n4) Configure your TIP or other integrated application to push indicators to Microsoft Sentinel by specifying the following:\n\n    a. The application ID and secret you received when registering the app (step 1 above). \n\n    b. Set Microsoft Sentinel as the target.\n\n    c. Set an action for each indicator - alert is most relevant for Microsoft Sentinel use cases \n\nFor the latest list of integrated Threat Intelligence Platforms and detailed configuration instructions, see the [full documentation](https://docs.microsoft.com/azure/sentinel/import-threat-intelligence#adding-threat-indicators-to-azure-sentinel-with-the-threat-intelligence-platforms-data-connector).\n\nClick on \"Connect\" below\n\n> Data from all regions will be sent to and stored in the workspace's region.",
        "instructions": [
          {
            "parameters": {},
            "type": "ThreatIntelligence"
          }
        ]
      }
    ]
  },
  {
    "id": "ThreatIntelligenceTaxii",
    "title": "Threat intelligence - TAXII",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Microsoft Sentinel integrates with TAXII 2.0 and 2.1 data sources to enable monitoring, alerting, and hunting using your threat intelligence. Use this connector to send the supported STIX object types from TAXII servers to Microsoft Sentinel. Threat indicators can include IP addresses, domains, URLs, and file hashes. For more information, see the [Microsoft Sentinel documentation >](https://go.microsoft.com/fwlink/p/?linkid=2224105&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ThreatIntelligenceIndicator",
        "baseQuery": "ThreatIntelligenceIndicator | where SourceSystem !in (\"SecurityGraph\", \"Azure Sentinel\", \"Microsoft Sentinel\") "
      }
    ],
    "sampleQueries": [
      {
        "description": "Summarize by threat type",
        "query": "ThreatIntelligenceIndicator | where SourceSystem !in (\"SecurityGraph\", \"Azure Sentinel\", \"Microsoft Sentinel\") \n            and ExpirationDateTime > now() | join ( SigninLogs ) on $left.NetworkIP == $right.IPAddress | summarize count() by ThreatType"
      },
      {
        "description": "Summarize by 1 hour bins",
        "query": "ThreatIntelligenceIndicator | where SourceSystem !in (\"SecurityGraph\", \"Azure Sentinel\", \"Microsoft Sentinel\") \n            and TimeGenerated >= ago(1d) | summarize count()"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "SentinelKinds",
        "value": [
          "ThreatIntelligenceTaxii"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "ThreatIntelligenceIndicator",
        "lastDataReceivedQuery": "ThreatIntelligenceIndicator | where SourceSystem !in (\"SecurityGraph\", \"Azure Sentinel\", \"Microsoft Sentinel\") \n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 2,
      "isPreview": false,
      "featureFlag": {
        "feature": "TaxiiConnector",
        "featureStates": {
          "1": 2,
          "2": 2,
          "3": 2,
          "4": 2,
          "5": 2,
          "6": 1,
          "7": 1,
          "8": 2
        }
      }
    },
    "permissions": {
      "customs": [
        {
          "name": "TAXII Server",
          "description": "TAXII 2.0 or TAXII 2.1 Server URI and Collection ID."
        }
      ],
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Configure TAXII servers to stream STIX 2.0 or 2.1 STIX objects to Microsoft Sentinel",
        "description": "You can connect your TAXII servers to Microsoft Sentinel using the built-in TAXII connector. For detailed configuration instructions, see the [full documentation](https://docs.microsoft.com/azure/sentinel/import-threat-intelligence#adding-threat-indicators-to-azure-sentinel-with-the-threat-intelligence---taxii-data-connector). \n\nEnter the following information and select Add to configure your TAXII server.",
        "instructions": [
          {
            "parameters": {},
            "type": "ThreatIntelligenceTaxii"
          }
        ]
      }
    ]
  },
  {
    "id": "ThreatIntelligenceTaxii",
    "title": "Threat intelligence - TAXII",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Microsoft Sentinel integrates with TAXII 2.0 and 2.1 data sources to enable monitoring, alerting, and hunting using your threat intelligence. Use this connector to send the supported STIX object types from TAXII servers to Microsoft Sentinel. Threat indicators can include IP addresses, domains, URLs, and file hashes. For more information, see the [Microsoft Sentinel documentation >](https://go.microsoft.com/fwlink/p/?linkid=2224105&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ThreatIntelIndicators",
        "baseQuery": "ThreatIntelIndicators | where SourceSystem !in (\"SecurityGraph\", \"Azure Sentinel\", \"Microsoft Sentinel\") "
      },
      {
        "metricName": "Total data received",
        "legend": "ThreatIntelObjects",
        "baseQuery": "ThreatIntelObjects | where SourceSystem !in (\"SecurityGraph\", \"Azure Sentinel\", \"Microsoft Sentinel\") "
      }
    ],
    "sampleQueries": [
      {
        "description": "Summarize by threat type",
        "query": "ThreatIntelIndicators | where SourceSystem !in (\"SecurityGraph\", \"Azure Sentinel\", \"Microsoft Sentinel\") \n            and ExpirationDateTime > now() | join ( SigninLogs ) on $left.NetworkIP == $right.IPAddress | summarize count() by ThreatType"
      },
      {
        "description": "Summarize by 1 hour bins",
        "query": "ThreatIntelIndicators | where SourceSystem !in (\"SecurityGraph\", \"Azure Sentinel\", \"Microsoft Sentinel\") \n            and TimeGenerated >= ago(1d) | summarize count()"
      },
      {
        "description": "Summarize by threat type",
        "query": "ThreatIntelObjects | where SourceSystem !in (\"SecurityGraph\", \"Azure Sentinel\", \"Microsoft Sentinel\") \n            and ExpirationDateTime > now() | join ( SigninLogs ) on $left.NetworkIP == $right.IPAddress | summarize count() by ThreatType"
      },
      {
        "description": "Summarize by 1 hour bins",
        "query": "ThreatIntelObjects | where SourceSystem !in (\"SecurityGraph\", \"Azure Sentinel\", \"Microsoft Sentinel\") \n            and TimeGenerated >= ago(1d) | summarize count()"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "SentinelKinds",
        "value": [
          "ThreatIntelligenceTaxii"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "ThreatIntelIndicators",
        "lastDataReceivedQuery": "ThreatIntelIndicators | where SourceSystem !in (\"SecurityGraph\", \"Azure Sentinel\", \"Microsoft Sentinel\") \n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ThreatIntelObjects",
        "lastDataReceivedQuery": "ThreatIntelObjects | where SourceSystem !in (\"SecurityGraph\", \"Azure Sentinel\", \"Microsoft Sentinel\") \n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 2,
      "isPreview": false,
      "featureFlag": {
        "feature": "TaxiiConnector",
        "featureStates": {
          "1": 2,
          "2": 2,
          "3": 2,
          "4": 2,
          "5": 2,
          "6": 1,
          "7": 1,
          "8": 2
        }
      }
    },
    "permissions": {
      "customs": [
        {
          "name": "TAXII Server",
          "description": "TAXII 2.0 or TAXII 2.1 Server URI and Collection ID."
        }
      ],
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Configure TAXII servers to stream STIX 2.0 or 2.1 STIX objects to Microsoft Sentinel",
        "description": "You can connect your TAXII servers to Microsoft Sentinel using the built-in TAXII connector. For detailed configuration instructions, see the [full documentation](https://docs.microsoft.com/azure/sentinel/import-threat-intelligence#adding-threat-indicators-to-azure-sentinel-with-the-threat-intelligence---taxii-data-connector). \n\nEnter the following information and select Add to configure your TAXII server.",
        "instructions": [
          {
            "parameters": {},
            "type": "ThreatIntelligenceTaxii"
          }
        ]
      }
    ]
  },
  {
    "id": "ThreatIntelligenceTaxiiExport",
    "title": "Threat intelligence - TAXII Export (Preview)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Microsoft Sentinel integrates with TAXII 2.1 servers to enable exporting of your threat intelligence objects. Use this connector to send the supported STIX object types from Microsoft Sentinel to TAXII servers.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ExportThreatIntelligenceLogs",
        "baseQuery": "ThreatIntelExportOperation"
      }
    ],
    "sampleQueries": [],
    "connectivityCriterias": [
      {
        "type": "SentinelKinds",
        "value": [
          "ThreatIntelligenceTaxiiExport"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "ExportThreatIntelligenceLogs",
        "lastDataReceivedQuery": "ThreatIntelExportOperation | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 2,
      "isPreview": true,
      "featureFlag": {
        "feature": "ExportTi",
        "featureStates": {
          "1": 2,
          "2": 2,
          "3": 2,
          "4": 2
        }
      }
    },
    "permissions": {
      "customs": [
        {
          "name": "TAXII Server",
          "description": "TAXII 2.1 Server URL and Collection ID."
        }
      ],
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Configure TAXII servers to export STIX 2.1 objects to. Once configured, you can start exporting STIX objects from your TI repository",
        "instructions": [
          {
            "parameters": {
              "isExport": true
            },
            "type": "ThreatIntelligenceTaxii"
          }
        ]
      }
    ]
  },
  {
    "id": "ThreatIntelligenceUploadIndicatorsAPI",
    "title": "Threat Intelligence Upload API (Preview)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Microsoft Sentinel offers a data plane API to bring in threat intelligence from your Threat Intelligence Platform (TIP), such as Threat Connect, Palo Alto Networks MineMeld, MISP, or other integrated applications. Threat indicators can include IP addresses, domains, URLs, file hashes and email addresses. For more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2269830&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "graphQueries": [
      {
        "metricName": "Total indicators received",
        "legend": "Connection Events",
        "baseQuery": "ThreatIntelIndicators | where SourceSystem != 'Microsoft Sentinel'"
      },
      {
        "metricName": "Total indicators received",
        "legend": "Connection Events",
        "baseQuery": "ThreatIntelObjects | where SourceSystem != 'Microsoft Sentinel'"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Threat Intelligence APIs Indicators",
        "query": "ThreatIntelIndicators | where SourceSystem !in ('SecurityGraph', 'Azure Sentinel', 'Microsoft Sentinel')| sort by TimeGenerated desc"
      },
      {
        "description": "All Threat Intelligence APIs Indicators",
        "query": "ThreatIntelObjects | where SourceSystem !in ('SecurityGraph', 'Azure Sentinel', 'Microsoft Sentinel')| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "ThreatIntelIndicators",
        "lastDataReceivedQuery": "ThreatIntelIndicators | where isnotempty(TimeGenerated) and SourceSystem !in ('SecurityGraph', 'Azure Sentinel', 'Microsoft Sentinel')| summarize Time = max(TimeGenerated)"
      },
      {
        "name": "ThreatIntelObjects",
        "lastDataReceivedQuery": "ThreatIntelObjects| where isnotempty(TimeGenerated) and SourceSystem !in ('SecurityGraph', 'Azure Sentinel', 'Microsoft Sentinel')| summarize Time = max(TimeGenerated)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ThreatIntelIndicators | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = false"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.SecurityInsights/threatintelligence/write",
          "permissionsDisplayText": "write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "You can connect your threat intelligence data sources to Microsoft Sentinel by either: ",
        "description": "\n>Using an integrated Threat Intelligence Platform (TIP), such as Threat Connect, Palo Alto Networks MineMeld, MISP, and others. \n\n>Calling the Microsoft Sentinel data plane API directly from another application. \n - Note: The 'Status' of the connector will not appear as 'Connected' here, because the data is ingested by making an API call."
      },
      {
        "title": "Follow These Steps to Connect to your Threat Intelligence: ",
        "description": ""
      },
      {
        "title": "1. Get Microsoft Entra ID Access Token",
        "description": "To send request to the APIs, you need to acquire Microsoft Entra ID access token. You can follow instruction in this page: https://docs.microsoft.com/azure/databricks/dev-tools/api/latest/aad/app-aad-token#get-an-azure-ad-access-token \n  - Notice: Please request Microsoft Entra ID access token with scope value: https://management.azure.com/.default  "
      },
      {
        "title": "2. Send STIX objects to Sentinel",
        "description": "You can send the supported STIX object types by calling our Upload API. For more information about the API, click [here](https://learn.microsoft.com/azure/sentinel/stix-objects-api). \n\n>HTTP method: POST \n\n>Endpoint: https://api.ti.sentinel.azure.com/workspaces/[WorkspaceID]/threatintelligence-stix-objects:upload?api-version=2024-02-01-preview \n\n>WorkspaceID: the workspace that the STIX objects are uploaded to.  \n\n\n>Header Value 1: \"Authorization\" = \"Bearer [Microsoft Entra ID Access Token from step 1]\" \n\n\n> Header Value 2: \"Content-Type\" = \"application/json\"  \n \n>Body: The body is a JSON object containing an array of STIX objects."
      }
    ]
  },
  {
    "id": "ThreatIntelligenceUploadIndicatorsAPI",
    "title": "Threat Intelligence Upload API (Preview)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Microsoft Sentinel offers a data plane API to bring in threat intelligence from your Threat Intelligence Platform (TIP), such as Threat Connect, Palo Alto Networks MineMeld, MISP, or other integrated applications. Threat indicators can include IP addresses, domains, URLs, file hashes and email addresses. For more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2269830&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "graphQueries": [
      {
        "metricName": "Total indicators received",
        "legend": "Connection Events",
        "baseQuery": "ThreatIntelIndicators | where SourceSystem != 'Microsoft Sentinel'"
      },
      {
        "metricName": "Total indicators received",
        "legend": "Connection Events",
        "baseQuery": "ThreatIntelObjects | where SourceSystem != 'Microsoft Sentinel'"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Threat Intelligence APIs Indicators",
        "query": "ThreatIntelIndicators | where SourceSystem !in ('SecurityGraph', 'Azure Sentinel', 'Microsoft Sentinel')| sort by TimeGenerated desc"
      },
      {
        "description": "All Threat Intelligence APIs Indicators",
        "query": "ThreatIntelObjects | where SourceSystem !in ('SecurityGraph', 'Azure Sentinel', 'Microsoft Sentinel')| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "ThreatIntelIndicators",
        "lastDataReceivedQuery": "ThreatIntelIndicators| where isnotempty(TimeGenerated) and SourceSystem !in ('SecurityGraph', 'Azure Sentinel', 'Microsoft Sentinel')| summarize Time = max(TimeGenerated)"
      },
      {
        "name": "ThreatIntelObjects",
        "lastDataReceivedQuery": "ThreatIntelObjects| where isnotempty(TimeGenerated) and SourceSystem !in ('SecurityGraph', 'Azure Sentinel', 'Microsoft Sentinel')| summarize Time = max(TimeGenerated)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ThreatIntelIndicators | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = false"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.SecurityInsights/threatintelligence/write",
          "permissionsDisplayText": "write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "You can connect your threat intelligence data sources to Microsoft Sentinel by either: ",
        "description": "\n>Using an integrated Threat Intelligence Platform (TIP), such as Threat Connect, Palo Alto Networks MineMeld, MISP, and others. \n\n>Calling the Microsoft Sentinel data plane API directly from another application. \n - Note: The 'Status' of the connector will not appear as 'Connected' here, because the data is ingested by making an API call."
      },
      {
        "title": "Follow These Steps to Connect to your Threat Intelligence: ",
        "description": ""
      },
      {
        "title": "1. Get Microsoft Entra ID Access Token",
        "description": "To send request to the APIs, you need to acquire Microsoft Entra ID access token. You can follow instruction in this page: https://docs.microsoft.com/azure/databricks/dev-tools/api/latest/aad/app-aad-token#get-an-azure-ad-access-token \n  - Notice: Please request Microsoft Entra ID access token with scope value:  \nFairfax: https://management.usgovcloudapi.net/.default  \nMooncake: https://management.chinacloudapi.cn/.default "
      },
      {
        "title": "2. Send STIX objects to Sentinel",
        "description": "You can send the supported STIX object types by calling our Upload API. For more information about the API, click [here](https://learn.microsoft.com/azure/sentinel/stix-objects-api). \n\n>HTTP method: POST \n\n>Endpoint: \nFairfax: https://api.ti.sentinel.azure.us/workspaces/[WorkspaceID]/threatintelligence-stix-objects:upload?api-version=2024-02-01-preview \nMooncake: https://api.ti.sentinel.azure.cn/workspaces/[WorkspaceID]/threatintelligence-stix-objects:upload?api-version=2024-02-01-preview \n\n>WorkspaceID: the workspace that the STIX objects are uploaded to.  \n\n\n>Header Value 1: \"Authorization\" = \"Bearer [Microsoft Entra ID Access Token from step 1]\" \n\n\n> Header Value 2: \"Content-Type\" = \"application/json\"  \n \n>Body: The body is a JSON object containing an array of STIX objects."
      }
    ]
  },
  {
    "id": "ThreatIntelligenceUploadIndicatorsAPI",
    "title": "Threat Intelligence Upload API (Preview)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Microsoft Sentinel offers a data plane API to bring in threat intelligence from your Threat Intelligence Platform (TIP), such as Threat Connect, Palo Alto Networks MineMeld, MISP, or other integrated applications. Threat indicators can include IP addresses, domains, URLs, file hashes and email addresses. For more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2269830&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "graphQueries": [
      {
        "metricName": "Total indicators received",
        "legend": "Connection Events",
        "baseQuery": "ThreatIntelligenceIndicator | where SourceSystem != 'Microsoft Sentinel'"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Threat Intelligence APIs Indicators",
        "query": "ThreatIntelligenceIndicator | where SourceSystem !in ('SecurityGraph', 'Azure Sentinel', 'Microsoft Sentinel')| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "ThreatIntelligenceIndicator",
        "lastDataReceivedQuery": "ThreatIntelligenceIndicator| where isnotempty(TimeGenerated) and SourceSystem !in ('SecurityGraph', 'Azure Sentinel', 'Microsoft Sentinel')| summarize Time = max(TimeGenerated)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ThreatIntelligenceIndicator | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = false"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.SecurityInsights/threatintelligence/write",
          "permissionsDisplayText": "write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "You can connect your threat intelligence data sources to Microsoft Sentinel by either: ",
        "description": "\n>Using an integrated Threat Intelligence Platform (TIP), such as Threat Connect, Palo Alto Networks MineMeld, MISP, and others. \n\n>Calling the Microsoft Sentinel data plane API directly from another application. \n - Note: The 'Status' of the connector will not appear as 'Connected' here, because the data is ingested by making an API call."
      },
      {
        "title": "Follow These Steps to Connect to your Threat Intelligence: ",
        "description": ""
      },
      {
        "title": "1. Get Microsoft Entra ID Access Token",
        "description": "To send request to the APIs, you need to acquire Microsoft Entra ID access token. You can follow instruction in this page: https://docs.microsoft.com/azure/databricks/dev-tools/api/latest/aad/app-aad-token#get-an-azure-ad-access-token \n  - Notice: Please request Microsoft Entra ID access token with scope value:  \nFairfax: https://management.usgovcloudapi.net/.default  \nMooncake: https://management.chinacloudapi.cn/.default "
      },
      {
        "title": "2. Send STIX objects to Sentinel",
        "description": "You can send the supported STIX object types by calling our Upload API. For more information about the API, click [here](https://learn.microsoft.com/azure/sentinel/stix-objects-api). \n\n>HTTP method: POST \n\n>Endpoint: \nFairfax: https://api.ti.sentinel.azure.us/workspaces/[WorkspaceID]/threatintelligence-stix-objects:upload?api-version=2024-02-01-preview \nMooncake: https://api.ti.sentinel.azure.cn/workspaces/[WorkspaceID]/threatintelligence-stix-objects:upload?api-version=2024-02-01-preview \n\n>WorkspaceID: the workspace that the STIX objects are uploaded to.  \n\n\n>Header Value 1: \"Authorization\" = \"Bearer [Microsoft Entra ID Access Token from step 1]\" \n\n\n> Header Value 2: \"Content-Type\" = \"application/json\"  \n \n>Body: The body is a JSON object containing an array of STIX objects."
      }
    ]
  },
  {
    "id": "ThreatIntelligenceUploadIndicatorsAPI",
    "title": "Threat Intelligence Upload API (Preview)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Microsoft Sentinel offers a data plane API to bring in threat intelligence from your Threat Intelligence Platform (TIP), such as Threat Connect, Palo Alto Networks MineMeld, MISP, or other integrated applications. Threat indicators can include IP addresses, domains, URLs, file hashes and email addresses. For more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2269830&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "graphQueries": [
      {
        "metricName": "Total indicators received",
        "legend": "Connection Events",
        "baseQuery": "ThreatIntelligenceIndicator | where SourceSystem != 'Microsoft Sentinel'"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Threat Intelligence APIs Indicators",
        "query": "ThreatIntelligenceIndicator | where SourceSystem !in ('SecurityGraph', 'Azure Sentinel', 'Microsoft Sentinel')| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "ThreatIntelligenceIndicator",
        "lastDataReceivedQuery": "ThreatIntelligenceIndicator| where isnotempty(TimeGenerated) and SourceSystem !in ('SecurityGraph', 'Azure Sentinel', 'Microsoft Sentinel')| summarize Time = max(TimeGenerated)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ThreatIntelligenceIndicator | summarize LastLogReceived = max(TimeGenerated) | project IsConnected = false"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.SecurityInsights/threatintelligence/write",
          "permissionsDisplayText": "write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "You can connect your threat intelligence data sources to Microsoft Sentinel by either: ",
        "description": "\n>Using an integrated Threat Intelligence Platform (TIP), such as Threat Connect, Palo Alto Networks MineMeld, MISP, and others. \n\n>Calling the Microsoft Sentinel data plane API directly from another application. \n - Note: The 'Status' of the connector will not appear as 'Connected' here, because the data is ingested by making an API call."
      },
      {
        "title": "Follow These Steps to Connect to your Threat Intelligence: ",
        "description": ""
      },
      {
        "title": "1. Get Microsoft Entra ID Access Token",
        "description": "To send request to the APIs, you need to acquire Microsoft Entra ID access token. You can follow instruction in this page: https://docs.microsoft.com/azure/databricks/dev-tools/api/latest/aad/app-aad-token#get-an-azure-ad-access-token \n  - Notice: Please request Microsoft Entra ID access token with scope value: https://management.azure.com/.default  "
      },
      {
        "title": "2. Send STIX objects to Sentinel",
        "description": "You can send the supported STIX object types by calling our Upload API. For more information about the API, click [here](https://learn.microsoft.com/azure/sentinel/stix-objects-api). \n\n>HTTP method: POST \n\n>Endpoint: https://api.ti.sentinel.azure.com/workspaces/[WorkspaceID]/threatintelligence-stix-objects:upload?api-version=2024-02-01-preview \n\n>WorkspaceID: the workspace that the STIX objects are uploaded to.  \n\n\n>Header Value 1: \"Authorization\" = \"Bearer [Microsoft Entra ID Access Token from step 1]\" \n\n\n> Header Value 2: \"Content-Type\" = \"application/json\"  \n \n>Body: The body is a JSON object containing an array of STIX objects."
      }
    ]
  },
  {
    "id": "TransmitSecurity",
    "title": "Transmit Security Connector",
    "publisher": "TransmitSecurity",
    "descriptionMarkdown": "The [Transmit Security] data connector provides the capability to ingest common Transmit Security API events into Microsoft Sentinel through the REST API. [Refer to API documentation for more information](https://developer.transmitsecurity.com/). The connector provides ability to get events which helps to examine potential security risks, analyze your team's use of collaboration, diagnose configuration problems and more.",
    "graphQueries": [
      {
        "metricName": "Activity data received",
        "legend": "TransmitSecurityActivity_CL",
        "baseQuery": "TransmitSecurityActivity_CL"
      }
    ],
    "sampleQueries": [
      {
        "name": "All activities",
        "query": "TransmitSecurityActivity_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "TransmitSecurityActivity_CL",
        "lastDataReceivedQuery": "TransmitSecurityActivity_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "TransmitSecurityActivity_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(3d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Client ID",
          "description": "**TransmitSecurityClientID** is required. See the documentation to learn more about API on the `https://developer.transmitsecurity.com/`."
        },
        {
          "name": "REST API Client Secret",
          "description": "**TransmitSecurityClientSecret** is required. See the documentation to learn more about API on the `https://developer.transmitsecurity.com/`."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Transmit Security API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the Transmit Security API**\n\nFollow the instructions to obtain the credentials.\n\n1. Log in to the Transmit Security Portal.\n2. Configure a [management app](https://developer.transmitsecurity.com/guides/user/management_apps/). Give the app a suitable name, for example, MyAzureSentinelCollector.\n3. Save credentials of the new user for using in the data connector."
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Transmit Security data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following).",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the Transmit Security data connector using an ARM Template.\n\n1. Click the **Deploy to Azure** button below.\n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-TransmitSecurityAPI-azuredeploy) [![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://aka.ms/sentinel-TransmitSecurityAPI-azuredeploy-gov)\n\n2. Select the preferred **Subscription**, **Resource Group**, and **Location**.\n\n> **NOTE:** Within the same resource group, you can't mix Windows and Linux apps in the same region. Select an existing resource group without Windows apps in it or create a new resource group.\n\n3. Enter the **TransmitSecurityClientID**, **TransmitSecurityClientSecret**, **TransmitSecurityPullEndpoint**, **TransmitSecurityTokenEndpoint**, and deploy.\n\n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**.\n\n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the Transmit Security data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS Code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-TransmitSecurityAPI-functionapp) file. Extract the archive to your local development computer.\n\n2. Start VS Code. Choose **File** in the main menu and select **Open Folder**.\n\n3. Select the top-level folder from the extracted files.\n\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\n\n   If you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**.\n\n   If you're already signed in, go to the next step.\n\n5. Provide the following information at the prompts:\n\n   a. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n   b. **Select Subscription:** Choose the subscription to use.\n\n   c. Select **Create new Function App in Azure** (Don't choose the Advanced option).\n\n   d. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions.\n\n   e. **Select a runtime:** Choose Python 3.11.\n\n   f. Select a location for new resources. For better performance and lower costs, choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n\n7. Go to the Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n\n2. Select **Environment variables**.\n\n3. Add each of the following application settings individually, with their respective string values (case-sensitive):\n\n   - **TransmitSecurityClientID**\n   - **TransmitSecurityClientSecret**\n   - **TransmitSecurityPullEndpoint**\n   - **TransmitSecurityTokenEndpoint**\n   - **WorkspaceID**\n   - **WorkspaceKey**\n   - **logAnalyticsUri** (optional)\n\n   > - Use **logAnalyticsUri** to override the log analytics API endpoint for a dedicated cloud. For example, for the public cloud, leave the value empty; for the Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n\n4. Once all application settings have been entered, click **Apply**."
      }
    ]
  },
  {
    "id": "TrendMicro",
    "title": "[Deprecated] Trend Micro Deep Security via Legacy",
    "publisher": "Trend Micro",
    "descriptionMarkdown": "The Trend Micro Deep Security connector allows you to easily connect your Deep Security logs with Microsoft Sentinel, to view dashboards, create custom alerts, and improve investigation. This gives you more insight into your organization's networks/systems and improves your security operation capabilities.",
    "additionalRequirementBanner": "These queries and workbooks are dependent on Kusto functions based on Kusto to work as expected. Follow the steps to use the Kusto functions alias \"TrendMicroDeepSecurity\" \nin queries and workbooks. [Follow steps to get this Kusto function.](https://aka.ms/TrendMicroDeepSecurityFunction)",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "TrendMicroDeepSecurity",
        "baseQuery": "\nTrendMicroDeepSecurity\n"
      }
    ],
    "sampleQueries": [
      {
        "description": "Intrusion Prevention Events",
        "query": "\nTrendMicroDeepSecurity\n\n            | where DeepSecurityModuleName == \"Intrusion Prevention\"\n            | sort by TimeGenerated"
      },
      {
        "description": "Integrity Monitoring Events",
        "query": "\nTrendMicroDeepSecurity\n\n            | where DeepSecurityModuleName == \"Integrity Monitoring\"\n            | sort by TimeGenerated"
      },
      {
        "description": "Firewall Events",
        "query": "\nTrendMicroDeepSecurity\n\n            | where DeepSecurityModuleName == \"Firewall Events\"\n            | sort by TimeGenerated"
      },
      {
        "description": "Log Inspection Events",
        "query": "\nTrendMicroDeepSecurity\n\n            | where DeepSecurityModuleName == \"Log Inspection\"\n            | sort by TimeGenerated"
      },
      {
        "description": "Anti-Malware Events",
        "query": "\nTrendMicroDeepSecurity\n\n            | where DeepSecurityModuleName == \"Anti-Malware\"\n            | sort by TimeGenerated"
      },
      {
        "description": "Web Reputation Events",
        "query": "\nTrendMicroDeepSecurity\n\n            | where DeepSecurityModuleName == \"Web Reputation\"\n            | sort by TimeGenerated"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "\nTrendMicroDeepSecurity\n\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (TrendMicroDeepSecurity)",
        "lastDataReceivedQuery": "\nTrendMicroDeepSecurity\n\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Trend Micro Deep Security logs to Syslog agent",
        "description": "1. Set your security solution to send Syslog messages in CEF format to the proxy machine. Make sure to send the logs to port 514 TCP on the machine's IP address.\n2. Forward Trend Micro Deep Security events to the Syslog agent.\n3. Define a new Syslog Configuration that uses the CEF format by referencing [this knowledge article](https://aka.ms/Sentinel-trendmicro-kblink)  for additional information.\n4. Configure the Deep Security Manager to use this new configuration to forward events to the Syslog agent using [these instructions](https://aka.ms/Sentinel-trendMicro-connectorInstructions).\n5. Make sure to save the [TrendMicroDeepSecurity](https://aka.ms/TrendMicroDeepSecurityFunction) function so that it queries the Trend Micro Deep Security data properly."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "abf0937a-e5be-4587-a805-fd5dbcffd6cd",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Trend Micro"
      },
      "support": {
        "name": "Trend Micro",
        "link": "https://success.trendmicro.com/technical-support",
        "tier": "developer"
      }
    }
  },
  {
    "id": "TrendMicroApexOne",
    "title": "[Deprecated] Trend Micro Apex One via Legacy Agent",
    "publisher": "Trend Micro",
    "descriptionMarkdown": "The [Trend Micro Apex One](https://www.trendmicro.com/en_us/business/products/user-protection/sps/endpoint.html) data connector provides the capability to ingest [Trend Micro Apex One events](https://aka.ms/sentinel-TrendMicroApex-OneEvents) into Microsoft Sentinel. Refer to [Trend Micro Apex Central](https://aka.ms/sentinel-TrendMicroApex-OneCentral) for more information.",
    "additionalRequirementBanner": "This data connector depends on a parser based on Kusto Function to work as expected [**TMApexOneEvent**](https://aka.ms/sentinel-TMApexOneEvent-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "TrendMicroApexOne",
        "baseQuery": "TMApexOneEvent"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "\nTMApexOneEvent\n| sort by TimeGenerated"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (TrendMicroApexOne)",
        "lastDataReceivedQuery": "TMApexOneEvent\n | summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "TMApexOneEvent\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">This data connector depends on a parser based on a Kusto Function to work as expected [**TMApexOneEvent**](https://aka.ms/sentinel-TMApexOneEvent-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "",
        "description": ">**NOTE:** This data connector has been developed using Trend Micro Apex Central 2019",
        "instructions": []
      },
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Common Event Format (CEF) logs to Syslog agent",
        "description": "[Follow these steps](https://docs.trendmicro.com/en-us/enterprise/trend-micro-apex-central-2019-online-help/detections/logs_001/syslog-forwarding.aspx) to configure Apex Central sending alerts via syslog. While configuring, on step 6, select the log format **CEF**."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "TrendMicroApexOneAma",
    "title": "[Deprecated] Trend Micro Apex One via AMA",
    "publisher": "Trend Micro",
    "descriptionMarkdown": "The [Trend Micro Apex One](https://www.trendmicro.com/en_us/business/products/user-protection/sps/endpoint.html) data connector provides the capability to ingest [Trend Micro Apex One events](https://aka.ms/sentinel-TrendMicroApex-OneEvents) into Microsoft Sentinel. Refer to [Trend Micro Apex Central](https://aka.ms/sentinel-TrendMicroApex-OneCentral) for more information.",
    "additionalRequirementBanner": "This data connector depends on a parser based on Kusto Function to work as expected [**TMApexOneEvent**](https://aka.ms/sentinel-TMApexOneEvent-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "TrendMicroApexOne",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Trend Micro'\n |where DeviceProduct =~ 'Apex Central'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "\nTMApexOneEvent\n| sort by TimeGenerated"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (TrendMicroApexOne)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Trend Micro'\n |where DeviceProduct =~ 'Apex Central'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'Trend Micro'\n |where DeviceProduct =~ 'Apex Central'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">This data connector depends on a parser based on a Kusto Function to work as expected [**TMApexOneEvent**](https://aka.ms/sentinel-TMApexOneEvent-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine",
                  "instructions": []
                },
                {
                  "title": "Step B. Forward Common Event Format (CEF) logs to Syslog agent",
                  "description": "[Follow these steps](https://docs.trendmicro.com/en-us/enterprise/trend-micro-apex-central-2019-online-help/detections/logs_001/syslog-forwarding.aspx) to configure Apex Central sending alerts via syslog. While configuring, on step 6, select the log format **CEF**.",
                  "instructions": []
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "TrendMicroCAS",
    "title": "Trend Micro Cloud App Security",
    "publisher": "Trend Micro",
    "descriptionMarkdown": "The [Trend Micro Cloud App Security](https://www.trendmicro.com/en_be/business/products/user-protection/sps/email-and-collaboration/cloud-app-security.html) data connector provides the capability to retrieve security event logs of the services that Cloud App Security protects and more events into Microsoft Sentinel through the Log Retrieval API. Refer to API [documentation](https://docs.trendmicro.com/en-us/enterprise/cloud-app-security-integration-api-online-help/supported-cloud-app-/log-retrieval-api/get-security-logs.aspx) for more information. The connector provides ability to get events which helps to examine potential security risks, analyze your team's use of collaboration, diagnose configuration problems and more.",
    "additionalRequirementBanner": ">This data connector depends on a parser based on a Kusto Function to work as expected [**TrendMicroCAS**](https://aka.ms/sentinel-TrendMicroCAS-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "TrendMicroCAS_CL",
        "baseQuery": "TrendMicroCAS_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Trend Micro Cloud App Security Events - All Activities.",
        "query": "TrendMicroCAS\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "TrendMicroCAS_CL",
        "lastDataReceivedQuery": "TrendMicroCAS_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "TrendMicroCAS_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "**TrendMicroCASToken** and **TrendMicroCASServiceURL** are required for making API calls.  See the [documentation](https://docs.trendmicro.com/en-us/enterprise/cloud-app-security-integration-api-online-help/getting-started-with/using-cloud-app-secu.aspx) to learn more about API."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Azure Blob Storage API to pull logs into Microsoft Sentinel. This might result in additional costs for data ingestion and for storing data in Azure Blob Storage costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) and [Azure Blob Storage pricing page](https://azure.microsoft.com/pricing/details/storage/blobs/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**TrendMicroCAS**](https://aka.ms/sentinel-TrendMicroCAS-parser) which is deployed with the Microsoft Sentinel Solution."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the Trend Micro Log Retrieval API**\n\n Follow the instructions to obtain the credentials.\n\n1. Obtain the **TrendMicroCASToken** using the [documentation](https://docs.trendmicro.com/en-us/enterprise/cloud-app-security-integration-api-online-help/getting-started-with/generating-an-authen.aspx).\n2. Save credentials for using in the data connector."
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Trend Micro Cloud App Security data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following).",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the Trend Micro Cloud App Security data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-TrendMicroCAS-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n> **NOTE:** Within the same resource group, you can't mix Windows and Linux apps in the same region. Select existing resource group without Windows apps in it or create new resource group.\n3. Enter the **TrendMicroCASToken**, **TrendMicroCASServiceURL**  and deploy. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the Trend Micro Cloud App Security data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-TMCASAPI-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. TMCASXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.11.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select ** New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tTrendMicroCASToken\n\t\tTrendMicroCASServiceURL\n\t\tWorkspaceID\n\t\tWorkspaceKey\n\t\tlogAnalyticsUri (optional)\n> - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n4. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "TrendMicroTippingPoint",
    "title": "[Deprecated] Trend Micro TippingPoint via Legacy",
    "publisher": "Trend Micro",
    "descriptionMarkdown": "The Trend Micro TippingPoint connector allows you to easily connect your TippingPoint SMS IPS events with Microsoft Sentinel, to view dashboards, create custom alerts, and improve investigation. This gives you more insight into your organization's networks/systems and improves your security operation capabilities.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "TrendMicroTippingPoint",
        "baseQuery": "\nTrendMicroTippingPoint\n"
      }
    ],
    "sampleQueries": [
      {
        "description": "TippingPoint IPS Events",
        "query": "\nTrendMicroTippingPoint\n\n            | sort by TimeGenerated"
      },
      {
        "description": "Top IPS Events",
        "query": "\nTrendMicroTippingPoint\n\n            | summarize EventCountTotal = sum(EventCount) by DeviceEventClassID, Activity, SimplifiedDeviceAction\n            | sort by EventCountTotal desc"
      },
      {
        "description": "Top Source IP for IPS Events",
        "query": "\nTrendMicroTippingPoint\n\n            | summarize EventCountTotal = sum(EventCount) by SourceIP\n            | sort by EventCountTotal desc"
      },
      {
        "description": "Top Destination IP for IPS Events",
        "query": "\nTrendMicroTippingPoint\n\n            | summarize EventCountTotal = sum(EventCount) by DestinationIP\n            | sort by EventCountTotal desc"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "\nTrendMicroTippingPoint\n\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (TrendMicroTippingPoint)",
        "lastDataReceivedQuery": "\nTrendMicroTippingPoint\n\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "description": "**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias TrendMicroTippingPoint and load the function code or click [here](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Trend%20Micro%20TippingPoint/Parsers/TrendMicroTippingPoint).The function usually takes 10-15 minutes to activate after solution installation/update."
      },
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Trend Micro TippingPoint SMS logs to Syslog agent",
        "description": "Set your TippingPoint SMS to send Syslog messages in ArcSight CEF Format v4.2 format to the proxy machine. Make sure you to send the logs to port 514 TCP on the machine's IP address."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "78cd5319-f6b0-4428-be45-5dea94c8ec83",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Trend Micro"
      },
      "support": {
        "name": "Trend Micro",
        "link": "https://success.trendmicro.com/technical-support",
        "tier": "developer"
      }
    }
  },
  {
    "id": "TrendMicroXDR",
    "title": "Trend Vision One",
    "publisher": "Trend Micro",
    "descriptionMarkdown": "The [Trend Vision One](https://www.trendmicro.com/en_us/business/products/detection-response/xdr.html) connector allows you to easily connect your Workbench alert data with Microsoft Sentinel to view dashboards, create custom alerts, and to improve monitoring and investigation capabilities. This gives you more insight into your organization's networks/systems and improves your security operation capabilities.\n\nThe Trend Vision One connector is supported in Microsoft Sentinel in the following regions: Australia East, Australia Southeast, Brazil South, Canada Central, Canada East, Central India, Central US, East Asia, East US, East US 2, France Central, Japan East, Korea Central, North Central US, North Europe, Norway East, South Africa North, South Central US, Southeast Asia, Sweden Central, Switzerland North, UAE North, UK South, UK West, West Europe, West US, West US 2, West US 3.",
    "graphQueries": [
      {
        "metricName": "Workbench data",
        "legend": "TrendMicro_XDR_WORKBENCH_CL",
        "baseQuery": "TrendMicro_XDR_WORKBENCH_CL\n    | project-reorder alertTriggerTimestamp_t, workbenchId_s, priorityScore_d, model_s, severity_s\n  | project-away alertProvider_s, SourceSystem, TenantId"
      },
      {
        "metricName": "RCA task",
        "legend": "TrendMicro_XDR_RCA_Task_CL",
        "baseQuery": "TrendMicro_XDR_RCA_Task_CL\n    | project-reorder workbenchId_s, id_g, name_s, xdrCustomerID_g, targets_s\n  | project-away SourceSystem, TenantId"
      },
      {
        "metricName": "RCA result",
        "legend": "TrendMicro_XDR_RCA_Result_CL",
        "baseQuery": "TrendMicro_XDR_RCA_Result_CL\n    | project-reorder workbenchId_s, taskId_g, taskName_s, xdrCustomerID_g\n  | project-away SourceSystem, TenantId"
      },
      {
        "metricName": "OAT data",
        "legend": "TrendMicro_XDR_OAT_CL",
        "baseQuery": "TrendMicro_XDR_OAT_CL\n    | project-reorder detectionTime_t*, xdrCustomerId_g, filterRiskLevel_s\n  | project-away SourceSystem, TenantId"
      }
    ],
    "sampleQueries": [
      {
        "description": "Critical & High Severity Workbench Alerts",
        "query": "TrendMicro_XDR_WORKBENCH_CL\n           | where severity_s  == 'critical' or severity_s == 'high'"
      },
      {
        "description": "Medium & Low Severity Workbench Alerts",
        "query": "TrendMicro_XDR_WORKBENCH_CL\n           | where severity_s  == 'medium' or severity_s == 'low'"
      }
    ],
    "dataTypes": [
      {
        "name": "TrendMicro_XDR_WORKBENCH_CL",
        "lastDataReceivedQuery": "TrendMicro_XDR_WORKBENCH_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "TrendMicro_XDR_RCA_Task_CL",
        "lastDataReceivedQuery": "TrendMicro_XDR_RCA_Task_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "TrendMicro_XDR_RCA_Result_CL",
        "lastDataReceivedQuery": "TrendMicro_XDR_RCA_Result_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "TrendMicro_XDR_OAT_CL",
        "lastDataReceivedQuery": "TrendMicro_XDR_OAT_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "TrendMicro_XDR_Health_Check_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Trend Vision One API Token",
          "description": "A Trend Vision One API Token is required. See the documentation to learn more about the [Trend Vision One API](https://docs.trendmicro.com/documentation/article/trend-vision-one-api-keys-third-party-apps)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Trend Vision One API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the Trend Vision One API**\n\n [Follow these instructions](https://docs.trendmicro.com/documentation/article/trend-vision-one-api-keys-third-party-apps) to create an account and an API authentication token."
      },
      {
        "title": "",
        "description": "**STEP 2 - Use the below deployment option to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Trend Vision One connector, have the Workspace ID and Workspace Primary Key (can be copied from the following), as well as the Trend Vision One API Authorization Token, readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Azure Resource Manager (ARM) Template Deployment",
        "description": "This method provides an automated deployment of the Trend Vision One connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-trendmicroxdr-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter a unique **Function Name**, **Workspace ID**, **Workspace Key**, **API Token** and **Region Code**. \n - Note: Provide the appropriate region code based on where your Trend Vision One instance is deployed: us, eu, au, in, sg, jp  \n - Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      }
    ],
    "metadata": {
      "id": "61d3a450-20c0-4f0e-9209-b8cf41d9a774",
      "version": "1.1.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Trend Micro"
      },
      "support": {
        "name": "Trend Micro",
        "link": "https://success.trendmicro.com/technical-support",
        "tier": "developer"
      }
    }
  },
  {
    "id": "UbiquitiUnifi",
    "title": "[Deprecated] Ubiquiti UniFi",
    "publisher": "Ubiquiti",
    "descriptionMarkdown": "The [Ubiquiti UniFi](https://www.ui.com/) data connector provides the capability to ingest [Ubiquiti UniFi firewall, dns, ssh, AP events](https://help.ui.com/hc/en-us/articles/204959834-UniFi-How-to-View-Log-Files) into Microsoft Sentinel.",
    "additionalRequirementBanner": "This data connector depends on a parser based on a Kusto Function to work as expected [**UbiquitiAuditEvent**](https://aka.ms/sentinel-UbiquitiUnifi-parser) which is deployed with the Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Ubiquiti_CL",
        "baseQuery": "UbiquitiAuditEvent"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Clients (Source IP)",
        "query": "UbiquitiAuditEvent\n | summarize count() by SrcIpAddr\n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "Ubiquiti_CL",
        "lastDataReceivedQuery": "UbiquitiAuditEvent\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "UbiquitiAuditEvent\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected [**UbiquitiAuditEvent**](https://aka.ms/sentinel-UbiquitiUnifi-parser) which is deployed with the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "",
        "description": ">**NOTE:** This data connector has been developed using Enterprise System Controller Release Version: 5.6.2 (Syslog)",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux or Windows",
        "description": "Install the agent on the Server to which the Ubiquiti logs are forwarder from Ubiquiti device (e.g.remote syslog server)\n\n> Logs from Ubiquiti Server deployed on Linux or Windows servers are collected by **Linux** or **Windows** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Linux agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Windows agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Windows Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Windows Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Follow the configuration steps below to get Ubiquiti logs into Microsoft Sentinel. Refer to the [Azure Monitor Documentation](https://docs.microsoft.com/azure/azure-monitor/agents/data-sources-json) for more details on these steps.\n1. Configure log forwarding on your Ubiquiti controller: \n\n\t i. Go to Settings > System Setting > Controller Configuration > Remote Logging and enable the Syslog and Debugging (optional) logs (Refer to [User Guide](https://dl.ui.com/guides/UniFi/UniFi_Controller_V5_UG.pdf) for detailed instructions).\n2. Download config file [Ubiquiti.conf](https://aka.ms/sentinel-UbiquitiUnifi-conf).\n3. Login to the server where you have installed Azure Log Analytics agent.\n4. Copy Ubiquiti.conf to the /etc/opt/microsoft/omsagent/**workspace_id**/conf/omsagent.d/ folder.\n5. Edit Ubiquiti.conf as follows:\n\n\t i. specify port which you have set your Ubiquiti device to forward logs to (line 4)\n\n\t ii. replace **workspace_id** with real value of your Workspace ID (lines 14,15,16,19)\n5. Save changes and restart the Azure Log Analytics agent for Linux service with the following command:\n\t\tsudo /opt/microsoft/omsagent/bin/service_control restart",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ]
  },
  {
    "id": "ValenceSecurity",
    "title": "SaaS Security",
    "publisher": "Valence Security",
    "descriptionMarkdown": "Connects the Valence SaaS security platform Azure Log Analytics via the REST API interface.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Valence Alerts",
        "baseQuery": "ValenceAlert_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Valence Security alerts",
        "query": "ValenceAlert_CL"
      },
      {
        "description": "All critical Valence Security alerts",
        "query": "ValenceAlert_CL | where alertType_severity_s == \"Critical\""
      }
    ],
    "dataTypes": [
      {
        "name": "ValenceAlert_CL",
        "lastDataReceivedQuery": "ValenceAlert_CL\n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ValenceAlert_CL\n| summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Step 1 : Read the detailed documentation",
        "description": "The installation process is documented in great detail in [Valence Security's knowledge base](https://support.valencesecurity.com). The user should consult this documentation further to understand installation and debug of the integration."
      },
      {
        "title": "Step 2: Retrieve the workspace access credentials",
        "description": "The first installation step is to retrieve both your **Workspace ID** and **Primary Key** from the Microsoft Sentinel platform.\nCopy the values shown below and save them for configuration of the API log forwarder integration.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Step 3: Configure Sentinel integration on the Valence Security Platform",
        "description": "As a Valence Security Platform admin, go to the [configuration screen](https://app.valencesecurity.com/settings/configuration), click Connect in the SIEM Integration card, and choose Microsoft Sentinel. Paste the values from the previous step and click Connect. Valence will test the connection so when success is reported, the connection worked."
      }
    ],
    "metadata": {
      "id": "0116a50c-9282-4237-9962-5da1dfcbfb55",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Valence Security"
      },
      "support": {
        "tier": "community",
        "name": "Valence Security",
        "email": "info@valencesecurity.com",
        "link": "https://www.valencesecurity.com"
      }
    }
  },
  {
    "id": "vArmourAC",
    "title": "[Deprecated] vArmour Application Controller via Legacy Agent",
    "publisher": "vArmour",
    "descriptionMarkdown": "vArmour reduces operational risk and increases cyber resiliency by visualizing and controlling application relationships across the enterprise. This vArmour connector enables streaming of Application Controller Violation Alerts into Microsoft Sentinel, so you can take advantage of search & correlation, alerting, & threat intelligence enrichment for each log.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "vArmour",
        "baseQuery": "CommonSecurityLog\n| where DeviceVendor == \"vArmour\"\n| where DeviceProduct == \"AC\""
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 App to App violations",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"vArmour\"\n| where DeviceProduct == \"AC\"\n| where Activity == \"POLICY_VIOLATION\"\n| extend AppNameSrcDstPair = extract_all(\"AppName=;(\\\\w+)\", AdditionalExtensions)\n| summarize count() by tostring(AppNameSrcDstPair)\n| top 10 by count_\n"
      },
      {
        "description": "Top 10 Policy names matching violations",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"vArmour\"\n| where DeviceProduct == \"AC\"\n| where Activity == \"POLICY_VIOLATION\"\n| summarize count() by DeviceCustomString1\n| top 10 by count_ desc\n"
      },
      {
        "description": "Top 10 Source IPs generating violations",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"vArmour\"\n| where DeviceProduct == \"AC\"\n| where Activity == \"POLICY_VIOLATION\"\n| summarize count() by SourceIP\n| top 10 by count_\n"
      },
      {
        "description": "Top 10 Destination IPs generating violations",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"vArmour\"\n| where DeviceProduct == \"AC\"\n| where Activity == \"POLICY_VIOLATION\"\n| summarize count() by DestinationIP\n| top 10 by count_\n"
      },
      {
        "description": "Top 10 Application Protocols matching violations",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"vArmour\"\n| where DeviceProduct == \"AC\"\n| where Activity == \"POLICY_VIOLATION\"\n| summarize count() by ApplicationProtocol\n| top 10 by count_\n"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (vArmour)",
        "lastDataReceivedQuery": "CommonSecurityLog\n| where DeviceVendor == \"vArmour\"\n| where DeviceProduct == \"AC\"\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n| where DeviceVendor == \"vArmour\"\n| where DeviceProduct == \"AC\"\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Configure the vArmour Application Controller to forward Common Event Format (CEF) logs to the Syslog agent",
        "description": "Send Syslog messages in CEF format to the proxy machine. Make sure you to send the logs to port 514 TCP on the machine's IP address.",
        "innerSteps": [
          {
            "title": "2.1 Download the vArmour Application Controller user guide",
            "description": "Download the user guide from https://support.varmour.com/hc/en-us/articles/360057444831-vArmour-Application-Controller-6-0-User-Guide."
          },
          {
            "title": "2.2 Configure the Application Controller to Send Policy Violations",
            "description": "In the user guide - refer to \"Configuring Syslog for Monitoring and Violations\" and follow steps 1 to 3."
          }
        ]
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "vArmourACAma",
    "title": "[Deprecated] vArmour Application Controller via AMA",
    "publisher": "vArmour",
    "descriptionMarkdown": "vArmour reduces operational risk and increases cyber resiliency by visualizing and controlling application relationships across the enterprise. This vArmour connector enables streaming of Application Controller Violation Alerts into Microsoft Sentinel, so you can take advantage of search & correlation, alerting, & threat intelligence enrichment for each log.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "vArmour",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'vArmour'\n |where DeviceProduct =~ 'AC'\n   |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 App to App violations",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"vArmour\"\n| where DeviceProduct == \"AC\"\n| where Activity == \"POLICY_VIOLATION\"\n| extend AppNameSrcDstPair = extract_all(\"AppName=;(\\\\w+)\", AdditionalExtensions)\n| summarize count() by tostring(AppNameSrcDstPair)\n| top 10 by count_\n"
      },
      {
        "description": "Top 10 Policy names matching violations",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"vArmour\"\n| where DeviceProduct == \"AC\"\n| where Activity == \"POLICY_VIOLATION\"\n| summarize count() by DeviceCustomString1\n| top 10 by count_ desc\n"
      },
      {
        "description": "Top 10 Source IPs generating violations",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"vArmour\"\n| where DeviceProduct == \"AC\"\n| where Activity == \"POLICY_VIOLATION\"\n| summarize count() by SourceIP\n| top 10 by count_\n"
      },
      {
        "description": "Top 10 Destination IPs generating violations",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"vArmour\"\n| where DeviceProduct == \"AC\"\n| where Activity == \"POLICY_VIOLATION\"\n| summarize count() by DestinationIP\n| top 10 by count_\n"
      },
      {
        "description": "Top 10 Application Protocols matching violations",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"vArmour\"\n| where DeviceProduct == \"AC\"\n| where Activity == \"POLICY_VIOLATION\"\n| summarize count() by ApplicationProtocol\n| top 10 by count_\n"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (vArmour)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'vArmour'\n |where DeviceProduct =~ 'AC'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'vArmour'\n |where DeviceProduct =~ 'AC'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine"
                },
                {
                  "title": "Step B. Configure the vArmour Application Controller to forward Common Event Format (CEF) logs to the Syslog agent",
                  "description": "Send Syslog messages in CEF format to the proxy machine. Make sure you to send the logs to port 514 TCP on the machine's IP address.",
                  "innerSteps": [
                    {
                      "title": "1 Download the vArmour Application Controller user guide",
                      "description": "Download the user guide from https://support.varmour.com/hc/en-us/articles/360057444831-vArmour-Application-Controller-6-0-User-Guide."
                    },
                    {
                      "title": "2 Configure the Application Controller to Send Policy Violations",
                      "description": "In the user guide - refer to \"Configuring Syslog for Monitoring and Violations\" and follow steps 1 to 3."
                    }
                  ]
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ]
  },
  {
    "id": "VaronisPurviewPush",
    "title": "Varonis Purview Push Connector",
    "publisher": "Varonis",
    "descriptionMarkdown": "The [Varonis Purview](https://www.varonis.com/) connector provides the capability to sync resources from Varonis to Microsoft Purview.",
    "graphQueries": [
      {
        "metricName": "Ressources",
        "legend": "varonisresources_CL",
        "baseQuery": "varonisresources_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Varonis all resources",
        "query": "varonisresources_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "varonisresources_CL",
        "lastDataReceivedQuery": "varonisresources_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1
    },
    "metadata": null
  },
  {
    "id": "VaronisSaaS",
    "title": "Varonis SaaS",
    "publisher": "Varonis",
    "descriptionMarkdown": "Varonis SaaS provides the capability to ingest [Varonis Alerts](https://www.varonis.com/products/datalert) into Microsoft Sentinel.\n\nVaronis prioritizes deep data visibility, classification capabilities, and automated remediation for data access. Varonis builds a single prioritized view of risk for your data, so you can proactively and systematically eliminate risk from insider threats and cyberattacks.",
    "graphQueries": [
      {
        "baseQuery": "VaronisAlerts_CL",
        "legend": "Varonis alerts",
        "metricName": "Total data recieved"
      },
      {
        "baseQuery": "VaronisAlerts_CL\n| where Severity_s == \"High\"",
        "legend": "High severity alerts",
        "metricName": "High severity alerts"
      },
      {
        "baseQuery": "VaronisAlerts_CL\n| where Severity_s == \"Medium\"",
        "legend": "Medium severity alerts",
        "metricName": "Medium severity alerts"
      },
      {
        "baseQuery": "VaronisAlerts_CL\n| where Severity_s == \"Low\"",
        "legend": "Low severity alerts",
        "metricName": "Low severity alerts"
      }
    ],
    "sampleQueries": [
      {
        "description": "List all Varonis Alerts",
        "query": "VaronisAlerts_CL\n| sort by TimeGenerated desc"
      },
      {
        "description": "List high severity Varonis Alerts",
        "query": "VaronisAlerts_CL\n| where Severity_s == \"High\"\n| sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "lastDataReceivedQuery": "VaronisAlerts_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)",
        "name": "VaronisAlerts_CL"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "VaronisAlerts_CL\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(3d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to Varonis DatAlert service to pull alerts into Microsoft Sentinel. This might result in additional data ingestion costs. See the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": "**For Azure function and related services installation use:**\n\n [![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2FAzure-Sentinel%2Fmaster%2FSolutions%2FVaronisSaaS%2FData%2520Connectors%2Fazuredeploy.json)"
      },
      {
        "title": "",
        "description": "STEP 1 - Obtain the Varonis DatAlert Endpoint API credentials.\n\n To generate the Client ID and API key:\n 1. Launch the Varonis Web Interface.\n 2. Navigate to Configuration -> API Keys. The API Keys page is displayed.\n 3. Click Create API Key. The Add New API Key settings are displayed on the right.\n 4. Fill in the name and description.\n 5. Click the Generate Key button.\n 6. Copy the API key secret and  save it in a handy location. You won't be able to copy it again.\n\nFor additional information, please check: [Varonis Documentation](https://help.varonis.com/s/document-item?bundleId=ami1661784208197&topicId=emp1703144742927.html&_LANG=enus)"
      },
      {
        "title": "",
        "description": "STEP 2 - Deploy the connector and the associated Azure Function.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceName"
              ],
              "label": "Workspace Name"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "",
        "description": "Use this method for automated deployment of the data connector using an ARM Template.\n\n1. Click the Deploy to Azure button. \n\n\t[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2FAzure-Sentinel%2Fmaster%2FSolutions%2FVaronisSaaS%2FData%2520Connectors%2Fazuredeploy.json)\n2. Select the preferred Subscription, Resource Group, Region, Storage Account Type.\n3. Enter Log Analytics Workspace Name, Varonis FQDN, Varonis SaaS API Key.\n4. Click Review + Create, Create."
      }
    ]
  },
  {
    "id": "VectraStreamAma",
    "title": "[Recommended] Vectra AI Stream via AMA",
    "publisher": "Vectra AI",
    "descriptionMarkdown": "The Vectra AI Stream connector allows to send Network Metadata collected by Vectra Sensors accross the Network and Cloud to Microsoft Sentinel",
    "additionalRequirementBanner": "This data connector depends on parsers based on Kusto Functions to work as expected [**VectraStream**](https://aka.ms/sentinel-aivectrastream-parser) which are deployed with this Microsoft Sentinel Solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Vectar AI Stream",
        "baseQuery": "vectra_isession_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "List all DNS Queries",
        "query": "vectra_dns_CL \n| project orig_hostname, id_orig_h, resp_hostname, id_resp_h, id_resp_p, qtype_name, query, answers"
      },
      {
        "description": "Number of DNS requests per type",
        "query": "vectra_dns_CL \n| summarize count() by qtype_name"
      },
      {
        "description": "Top 10 of query to non existing domain",
        "query": "vectra_dns_CL \n| where rcode_name == \"NXDomain\"\n| summarize Count=count() by query\n| order by Count desc\n| limit 10"
      },
      {
        "description": "Host and Web sites using non-ephemeral Diffie-Hellman key exchange",
        "query": "vectra_ssl_CL \n| where cipher contains \"TLS_RSA\"\n| distinct orig_hostname, id_orig_h, id_resp_h, server_name, cipher\n| project orig_hostname, id_orig_h, id_resp_h, server_name, cipher"
      }
    ],
    "dataTypes": [
      {
        "name": "vectra_isession",
        "lastDataReceivedQuery": "vectra_isession\n |  summarize Time = max(TimeGenerated)"
      },
      {
        "name": "vectra_dns",
        "lastDataReceivedQuery": "vectra_dns\n |  summarize Time = max(TimeGenerated)"
      },
      {
        "name": "vectra_ssl",
        "lastDataReceivedQuery": "vectra_ssl\n |  summarize Time = max(TimeGenerated)"
      },
      {
        "name": "vectra_beacon",
        "lastDataReceivedQuery": "vectra_beacon\n |  summarize Time = max(TimeGenerated)"
      },
      {
        "name": "vectra_dcerpc",
        "lastDataReceivedQuery": "vectra_dcerpc\n |  summarize Time = max(TimeGenerated)"
      },
      {
        "name": "vectra_dhcp",
        "lastDataReceivedQuery": "vectra_dhcp\n |  summarize Time = max(TimeGenerated)"
      },
      {
        "name": "vectra_http",
        "lastDataReceivedQuery": "vectra_http\n |  summarize Time = max(TimeGenerated)"
      },
      {
        "name": "vectra_kerberos",
        "lastDataReceivedQuery": "vectra_kerberos\n |  summarize Time = max(TimeGenerated)"
      },
      {
        "name": "vectra_ldap",
        "lastDataReceivedQuery": "vectra_ldap\n |  summarize Time = max(TimeGenerated)"
      },
      {
        "name": "vectra_ntlm",
        "lastDataReceivedQuery": "vectra_ntlm\n |  summarize Time = max(TimeGenerated)"
      },
      {
        "name": "vectra_radius",
        "lastDataReceivedQuery": "vectra_radius\n |  summarize Time = max(TimeGenerated)"
      },
      {
        "name": "vectra_rdp",
        "lastDataReceivedQuery": "vectra_rdp\n |  summarize Time = max(TimeGenerated)"
      },
      {
        "name": "vectra_smbfiles",
        "lastDataReceivedQuery": "vectra_smbfiles\n |  summarize Time = max(TimeGenerated)"
      },
      {
        "name": "vectra_smbmapping",
        "lastDataReceivedQuery": "vectra_smbmapping\n |  summarize Time = max(TimeGenerated)"
      },
      {
        "name": "vectra_smtp",
        "lastDataReceivedQuery": "vectra_smtp\n |  summarize Time = max(TimeGenerated)"
      },
      {
        "name": "vectra_ssh",
        "lastDataReceivedQuery": "vectra_ssh\n |  summarize Time = max(TimeGenerated)"
      },
      {
        "name": "vectra_x509",
        "lastDataReceivedQuery": "vectra_x509\n |  summarize Time = max(TimeGenerated)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "\nvectra_stream\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(1h)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Vectra AI Stream configuration",
          "description": "must be configured to export Stream metadata in JSON"
        },
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on parsers based on a Kusto Function to work as expected which are deployed as part of the Microsoft Sentinel Solution.",
        "instructions": []
      },
      {
        "title": "",
        "description": ">**IMPORTANT:** Vectra AI Stream connector is only available for **Linux** agents with **syslog-ng**. Make sure that syslog-ng is installed!\n\n In the first part, we are going to create the custom tables requires for this solution (using an ARM template). Then we are going to configure the Data Connector.",
        "instructions": [
          {
            "parameters": {
              "title": "Please proceed with these steps:",
              "instructionSteps": [
                {
                  "title": "Step 1. Create custom  tables in Log Analytic Workspace (ARM Template)",
                  "description": "1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fvectranetworks%2FMicrosoft_Sentinel%2Fmain%2FStream%2FAMA%2FARM_Templates%2Fazuredeploy_CustomTables_connector.json)\n2. Provide the required details such as the resource group and Microsoft Log Analytics Workspace (**the workspace must exist!**)\n4. Click **Review + Create** to deploy.\n\n\t_Note: Once deployed, you must be able to see the custom tables in your Log Analytic Workspace (Settings ---> Tables)._",
                  "instructions": []
                },
                {
                  "title": "Step 2. Install the Syslog via AMA Data connector",
                  "description": "_Note: This is only required if it has not been install yet in Microsoft Sentinel._\n1. Microsoft Sentinel workspace ---> Content Management ---> Content Hub.\n\n2. Search for 'Syslog' (Provider is Microsoft) and select it.\n\n3. Check 'Install' buton on the bottom of the right panel.",
                  "instructions": []
                },
                {
                  "title": "Step 3. Configure the Syslog via AMA data connector",
                  "description": "_Note: Two different Data Collection Rules (DCR) are going to be created during this step_\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector.\n\n2. Search for 'Syslog via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs: LOG_USER/LOG_NOTICE and LOG_LOCAL0/LOG_NOTICE.\n\n4. Create a first DCR (Data Collection Rule). Specify a name. Then, in the Resources tab, select the instance where AMA is going to run. In the Collect tab, select LOG_USER/LOG_NOTICE.\n\n5. Create a second DCR. Specify a different name. Then, in the Resources tab, choose the same host. In the Collect tab, select LOG_LOCAL0/LOG_NOTICE\n\n\n\n\tNote:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy.",
                  "instructions": []
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "",
        "description": "In the next section, we are goning to modify the syslog-ng configuration that has been created where the AMA is deployed. Then, we are going to modify the DCR configuration to be able to sent the network metadata from Vectra Stream to different custom tables.",
        "instructions": [
          {
            "parameters": {
              "title": "Please proceed with these steps:",
              "instructionSteps": [
                {
                  "title": "Step 1. Modify the syslog-ng configuration",
                  "description": "_Note: A DCR cannot have more than 10 output flows. As we have 16 custom tables in this solution, we need to split the traffic to two DCR using syslog-ng._\n1. Download the modified syslog-ng configuration file: [azuremonitoragent-tcp.conf](https://raw.githubusercontent.com/vectranetworks/Microsoft_Sentinel/main/Stream/AMA/syslog-ng/azuremonitoragent-tcp.conf).\n2. Log into the instance where syslog-ng/AMA is running.\n3. Browse to /etc/syslog-ng/conf.d/  and replace the content of _azuremonitoragent-tcp.conf_ file with the one that you just downloaded.\n4. Save and restart syslog-ng (_systemctl restart syslog-ng_).",
                  "instructions": []
                },
                {
                  "title": "Step 2. Modify the Data Collection rules configuration",
                  "description": "_Note: The Data Collection Rules that have been created are located in Azure Monitor (**Monitor ---> Settings ---> Data Collection Rules**)_\n 1. Locate the 2 DCR that you created in Microsoft Sentinel.\n 2. Open the first DCR where Syslog facility is LOG_USER. Then go to Automation ---> Export template ---> Deploy --> Edit template.\n 3. Download the dataFlows configuration for LOG_USER DCR: [Stream_DataFlows_dcr1.json](https://raw.githubusercontent.com/vectranetworks/Microsoft_Sentinel/main/Stream/AMA/dcr/Stream_DataFlows_dcr1.json) and find/replace the destination placeholder '<WORKSPACE_NAME>' with your workspace name.\n 4. Locate the dataFlows section in the template (Azure Monitor) and replace it with the content of the configuration you downloaded.\n 5. In the same DCR, locate the key: resources -> properties -> destinations -> name and replace 'DataCollectionEvent' with the name of the Log Analytics Workspace (same as step 3).\n 6. Save --> Review + Create --> Create.\n 7. Open the second DCR than you created (Facilily is LOG_LOCAL0) and edit the template (Automation ---> Export template ---> Deploy --> Edit template).\n 8. Download the dataFlows configuration for LOG_LOCAL0 DCR: [Stream_DataFlows_dcr2.json](https://raw.githubusercontent.com/vectranetworks/Microsoft_Sentinel/main/Stream/AMA/dcr/Stream_DataFlows_dcr2.json) and find/replace the destination placeholder '<WORKSPACE_NAME>' with your wokrspace name.\n 9. Locate the dataFlows section in the template (Azure Monitor) and replace it with the content of the configuration you downloaded.\n 10. In the same DCR, locate the key: resources -> properties -> destinations -> name and replace 'DataCollectionEvent' with the name of the Log Analytics Workspace.\n 11. Save --> Review + Create --> Create.",
                  "instructions": []
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "Configure Vectra AI Stream",
        "description": "\nConfigure Vectra AI Brain to forward Stream metadata in JSON format to your Microsoft Sentinel workspace via AMA.\n\nFrom the Vectra UI, navigate to Settings > Stream and Edit the destination configuration:\n\n 1. Select Publisher: RAW JSON\n 2. Set the server IP or hostname (which is the host whhere AMA is running)\n 3. Set all the port to **514**.\n 4. Save."
      },
      {
        "title": "Run the following command to validate (or set up) that syslog-ng is listening on port 514",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId",
                "PrimaryKey"
              ],
              "label": "",
              "value": "sudo wget -O Forwarder_AMA_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Forwarder_AMA_installer.py&&sudo python Forwarder_AMA_installer.py"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ],
    "metadata": {
      "id": "ec069726-811c-4f50-b141-295057367f49",
      "kind": "dataConnector",
      "version": "1.0.0",
      "source": {
        "kind": "solution",
        "name": "Vectra AI"
      },
      "author": {
        "name": "Vectra AI Technical Marketing"
      },
      "support": {
        "tier": "developer",
        "name": "Vectra AI",
        "email": "tme@vectra.ai",
        "link": "https://www.vectra.ai/support"
      }
    }
  },
  {
    "id": "VectraXDR",
    "title": "Vectra XDR",
    "publisher": "Vectra",
    "descriptionMarkdown": "The [Vectra XDR](https://www.vectra.ai/) connector gives the capability to ingest Vectra Detections, Audits, Entity Scoring, Lockdown, Health and Entities data into Microsoft Sentinel through the Vectra REST API. Refer to the API documentation: `https://support.vectra.ai/s/article/KB-VS-1666` for more information.",
    "additionalRequirementBanner": "These queries and workbooks are dependent on a parser based on Kusto to work as expected. Follow the steps to use this Kusto functions alias **VectraDetections** in queries and workbooks [Follow steps to get this VectraDetections Kusto functions>](https://aka.ms/sentinel-VectraDetections-parser), **VectraAudits** in queries and workbooks [Follow steps to get this VectraAudits Kusto functions>](https://aka.ms/sentinel-VectraAudits-parser) and **VectraEntityScoring** in queries and workbooks [Follow steps to get this VectraEntityScoring Kusto functions>](https://aka.ms/sentinel-VectraEntityScoring-parser).",
    "graphQueries": [
      {
        "metricName": "Total Detections data received",
        "legend": "Detections_Data_CL",
        "baseQuery": "Detections_Data_CL"
      },
      {
        "metricName": "Total Audits data received",
        "legend": "Audits_Data_CL",
        "baseQuery": "Audits_Data_CL"
      },
      {
        "metricName": "Total Entity Scoring data received",
        "legend": "Entity_Scoring_Data_CL",
        "baseQuery": "Entity_Scoring_Data_CL"
      },
      {
        "metricName": "Total Lockdown data received",
        "legend": "Lockdown_Data_CL",
        "baseQuery": "Lockdown_Data_CL"
      },
      {
        "metricName": "Total Health data received",
        "legend": "Health_Data_CL",
        "baseQuery": "Health_Data_CL"
      },
      {
        "metricName": "Total Entities data received",
        "legend": "Entities_Data_CL",
        "baseQuery": "Entities_Data_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Vectra Detections Events - All Detections Events.",
        "query": "Detections_Data_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Vectra Audits Events - All Audits Events.",
        "query": "Audits_Data_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Vectra Entity Scoring Events - All Entity Scoring Events.",
        "query": "Entity_Scoring_Data_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Vectra Lockdown Events - All Lockdown Events.",
        "query": "Lockdown_Data_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Vectra Health Events - All Health Events.",
        "query": "Health_Data_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "Vectra Entities Events - All Entities Events.",
        "query": "Entities_Data_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Detections_Data_CL",
        "lastDataReceivedQuery": "Detections_Data_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Audits_Data_CL",
        "lastDataReceivedQuery": "Audits_Data_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Entity_Scoring_Data_CL",
        "lastDataReceivedQuery": "Entity_Scoring_Data_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Lockdown_Data_CL",
        "lastDataReceivedQuery": "Lockdown_Data_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Health_Data_CL",
        "lastDataReceivedQuery": "Health_Data_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "Entities_Data_CL",
        "lastDataReceivedQuery": "Entities_Data_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Detections_Data_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Audits_Data_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Entity_Scoring_Data_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Lockdown_Data_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Health_Data_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Entities_Data_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "**Vectra Client ID** and **Client Secret**  is required for Health, Entity Scoring, Entities, Detections, Lockdown and Audit data collection.  See the documentation to learn more about API on the `https://support.vectra.ai/s/article/KB-VS-1666`."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Vectra API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected. Follow these steps for [Detections Parser](https://aka.ms/sentinel-VectraDetections-parser), [Audits Parser](https://aka.ms/sentinel-VectraAudits-parser), [Entity Scoring Parser](https://aka.ms/sentinel-VectraEntityScoring-parser), [Lockdown Parser](https://aka.ms/sentinel-VectraLockdown-parser) and [Health Parser](https://aka.ms/sentinel-VectraHealth-parser) to create the Kusto functions alias, **VectraDetections**, **VectraAudits**, **VectraEntityScoring**, **VectraLockdown** and **VectraHealth**."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the Vectra API Credentials**\n\n Follow these instructions to create a Vectra Client ID and Client Secret.\n 1. Log into your Vectra portal\n 2. Navigate to Manage -> API Clients\n 3. From the API Clients page, select 'Add API Client' to create a new client.\n 4. Add Client Name, select Role and click on Generate Credentials to obtain your client credentials. \n 5. Be sure to record your Client ID and Secret Key for safekeeping. You will need these two pieces of information to obtain an access token from the Vectra API. An access token is required to make requests to all of the Vectra API endpoints."
      },
      {
        "title": "",
        "description": "**STEP 2 - App Registration steps for the Application in Microsoft Entra ID**\n\n This integration requires an App registration in the Azure portal. Follow the steps in this section to create a new application in Microsoft Entra ID:\n 1. Sign in to the [Azure portal](https://portal.azure.com/).\n 2. Search for and select **Microsoft Entra ID**.\n 3. Under **Manage**, select **App registrations > New registration**.\n 4. Enter a display **Name** for your application.\n 5. Select **Register** to complete the initial app registration.\n 6. When registration finishes, the Azure portal displays the app registration's Overview pane. You see the **Application (client) ID** and **Tenant ID**. The client ID and Tenant ID is required as configuration parameters for the execution of Vectra Data Connector. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app)"
      },
      {
        "title": "",
        "description": "**STEP 3 - Add a client secret for application in Microsoft Entra ID**\n\n Sometimes called an application password, a client secret is a string value required for the execution of Vectra Data Connector. Follow the steps in this section to create a new Client Secret:\n 1. In the Azure portal, in **App registrations**, select your application.\n 2. Select **Certificates & secrets > Client secrets > New client secret**.\n 3. Add a description for your client secret.\n 4. Select an expiration for the secret or specify a custom lifetime. Limit is 24 months.\n 5. Select **Add**. \n 6. *Record the secret's value for use in your client application code. This secret value is never displayed again after you leave this page.* The secret value is required as configuration parameter for the execution of Vectra Data Connector. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret)"
      },
      {
        "title": "",
        "description": "**STEP 4 - Get Object ID of your application in Microsoft Entra ID**\n\n After creating your app registration, follow the steps in this section to get Object ID:\n 1. Go to **Microsoft Entra ID**.\n 2. Select **Enterprise applications** from the left menu.\n 3. Find your newly created application in the list (you can search by the name you provided).\n 4. Click on the application.\n 5. On the overview page, copy the **Object ID**. This is the **AzureEntraObjectId** needed for your ARM template role assignment.\n"
      },
      {
        "title": "",
        "description": "**STEP 5 - Assign role of Contributor to application in Microsoft Entra ID**\n\n Follow the steps in this section to assign the role:\n 1. In the Azure portal, Go to **Resource Group** and select your resource group.\n 2. Go to **Access control (IAM)** from left panel.\n 3. Click on **Add**, and then select **Add role assignment**.\n 4. Select **Contributor** as role and click on next.\n 5. In **Assign access to**, select `User, group, or service principal`.\n 6. Click on **add members** and type **your app name** that you have created and select it.\n 7. Now click on **Review + assign** and then again click on **Review + assign**. \n\n> **Reference link:** [https://learn.microsoft.com/azure/role-based-access-control/role-assignments-portal](https://learn.microsoft.com/azure/role-based-access-control/role-assignments-portal)"
      },
      {
        "title": "",
        "description": "**STEP 6 - Create a Keyvault**\n\n Follow these instructions to create a new Keyvault.\n 1. In the Azure portal, Go to **Key vaults** and click on Create.\n 2. Select Subsciption, Resource Group and provide unique name of keyvault."
      },
      {
        "title": "",
        "description": "**STEP 7 - Create Access Policy in Keyvault**\n\n Follow these instructions to create access policy in Keyvault.\n 1. Go to keyvaults, select your keyvault, go to Access policies on left side panel, click on create.\n 2. Select all keys & secrets permissions. Click next.\n 3. In the principal section, search by application name which was generated in STEP - 2. Click next.\n\n **Note: **Ensure the Permission model in the Access Configuration of Key Vault is set to **'Vault access policy'**"
      },
      {
        "title": "",
        "description": "**STEP 8 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Vectra data connector, have the Vectra API Authorization Credentials readily available.."
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the Vectra connector.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-VectraXDRAPI-azuredeploy) [![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://aka.ms/sentinel-VectraXDRAPI-azuredeploy-gov)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the below information : \n\t\tFunction Name \n\t\tWorkspace Name \n\t\tVectra Base URL (https://<vectra-portal-url>) \n\t\tVectra Client Id - Health \n\t\tVectra Client Secret Key - Health \n\t\tVectra Client Id - Entity Scoring \n\t\tVectra Client Secret - Entity Scoring \n\t\tVectra Client Id - Detections \n\t\tVectra Client Secret - Detections \n\t\tVectra Client Id - Audits \n\t\tVectra Client Secret - Audits \n\t\tVectra Client Id - Lockdown \n\t\tVectra Client Secret - Lockdown \n\t\tVectra Client Id - Host-Entity \n\t\tVectra Client Secret - Host-Entity \n\t\tVectra Client Id - Account-Entity \n\t\tVectra Client Secret - Account-Entity \n\t\tKey Vault Name \n\t\tAzure Client Id \n\t\tAzure Client Secret \n\t\tTenant Id \n\t\tAzure Entra ObjectID \n\t\tStartTime (in MM/DD/YYYY HH:MM:SS Format) \n\t\tInclude Score Decrease \n\t\tAudits Table Name \n\t\tDetections Table Name \n\t\tEntity Scoring Table Name \n\t\tLockdown Table Name \n\t\tHealth Table Name \n\t\tEntities Table Name \n\t\tExclude Group Details From Detections\n\t\tLog Level (Default: INFO) \n\t\tLockdown Schedule \n\t\tHealth Schedule \n\t\tDetections Schedule \n\t\tAudits Schedule \n\t\tEntity Scoring Schedule \n\t\tEntities Schedule \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the Vectra data connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-VectraXDR320-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. VECTRAXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.8 or above.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following application settings individually, with their respective values (case-sensitive): \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tVectra Base URL (https://<vectra-portal-url>) \n\t\tVectra Client Id - Health \n\t\tVectra Client Secret Key - Health \n\t\tVectra Client Id - Entity Scoring \n\t\tVectra Client Secret - Entity Scoring \n\t\tVectra Client Id - Detections \n\t\tVectra Client Secret - Detections \n\t\tVectra Client Id - Audits \n\t\tVectra Client Secret - Audits \n\t\tVectra Client Id - Lockdown \n\t\tVectra Client Secret - Lockdown \n\t\tVectra Client Id - Host-Entity \n\t\tVectra Client Secret - Host-Entity \n\t\tVectra Client Id - Account-Entity \n\t\tVectra Client Secret - Account-Entity \n\t\tKey Vault Name \n\t\tAzure Client Id \n\t\tAzure Client Secret \n\t\tTenant Id \n\t\tStartTime (in MM/DD/YYYY HH:MM:SS Format) \n\t\tInclude Score Decrease \n\t\tAudits Table Name \n\t\tDetections Table Name \n\t\tEntity Scoring Table Name \n\t\tLockdown Table Name \n\t\tHealth Table Name \n\t\tEntities Table Name \n\t\tLog Level (Default: INFO) \n\t\tLockdown Schedule \n\t\tHealth Schedule \n\t\tDetections Schedule \n\t\tAudits Schedule \n\t\tEntity Scoring Schedule \n\t\tEntities Schedule \n\t\tlogAnalyticsUri (optional) \n - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n4. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "VeeamCustomTablesDataConnector",
    "title": "Veeam Data Connector (using Azure Functions)",
    "publisher": "Veeam",
    "descriptionMarkdown": "Veeam Data Connector allows you to ingest Veeam telemetry data from multiple custom tables into Microsoft Sentinel.\n\nThe connector supports integration with Veeam Backup & Replication, Veeam ONE and Coveware platforms to provide comprehensive monitoring and security analytics. The data is collected through Azure Functions and stored in custom Log Analytics tables with dedicated Data Collection Rules (DCR) and Data Collection Endpoints (DCE).\n\n**Custom Tables Included:**\n- **VeeamMalwareEvents_CL**: Malware detection events from Veeam Backup & Replication\n- **VeeamSecurityComplianceAnalyzer_CL**: Security & Compliance Analyzer results collected from Veeam backup infrastructure components\n- **VeeamAuthorizationEvents_CL**: Authorization and authentication events\n- **VeeamOneTriggeredAlarms_CL**: Triggered alarms from Veeam ONE servers\n- **VeeamCovewareFindings_CL**: Security findings from Coveware solution\n- **VeeamSessions_CL**: Veeam sessions",
    "additionalRequirementBanner": "The following queries and workbooks require a parser based on Kusto to work properly. To use **VeeamSyslogEventsV2** alias for Kusto functions in queries and workbooks, see [this instruction](https://aka.ms/sentinel-veeam-function) ",
    "graphQueries": [
      {
        "metricName": "All malware events",
        "legend": "VeeamMalwareEvents_CL",
        "baseQuery": "VeeamMalwareEvents_CL"
      },
      {
        "metricName": "Critical malware events",
        "legend": "VeeamMalwareEvents_CL",
        "baseQuery": "VeeamMalwareEvents_CL\n| where Severity == \"Critical\""
      },
      {
        "metricName": "Security & Compliance Analyzer results",
        "legend": "VeeamSecurityComplianceAnalyzer_CL",
        "baseQuery": "VeeamSecurityComplianceAnalyzer_CL"
      },
      {
        "metricName": "Veeam ONE alarms",
        "legend": "VeeamOneTriggeredAlarms_CL",
        "baseQuery": "VeeamOneTriggeredAlarms_CL"
      },
      {
        "metricName": "Authorization events",
        "legend": "VeeamAuthorizationEvents_CL",
        "baseQuery": "VeeamAuthorizationEvents_CL"
      },
      {
        "metricName": "Coveware findings",
        "legend": "VeeamCovewareFindings_CL",
        "baseQuery": "VeeamCovewareFindings_CL"
      },
      {
        "metricName": "Veeam sessions",
        "legend": "VeeamSessions_CL",
        "baseQuery": "VeeamSessions_CL"
      }
    ],
    "sampleQueries": [],
    "dataTypes": [
      {
        "name": "VeeamMalwareEvents_CL",
        "lastDataReceivedQuery": "VeeamMalwareEvents_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "VeeamSecurityComplianceAnalyzer_CL",
        "lastDataReceivedQuery": "VeeamSecurityComplianceAnalyzer_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "VeeamAuthorizationEvents_CL",
        "lastDataReceivedQuery": "VeeamAuthorizationEvents_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "VeeamOneTriggeredAlarms_CL",
        "lastDataReceivedQuery": "VeeamOneTriggeredAlarms_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "VeeamCovewareFindings_CL",
        "lastDataReceivedQuery": "VeeamCovewareFindings_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "VeeamSessions_CL",
        "lastDataReceivedQuery": "VeeamSessions_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "union VeeamMalwareEvents_CL, VeeamSecurityComplianceAnalyzer_CL, VeeamAuthorizationEvents_CL, VeeamOneTriggeredAlarms_CL, VeeamCovewareFindings_CL, VeeamSessions_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(3d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Veeam Infrastructure Access",
          "description": "Access to Veeam Backup & Replication REST API and Veeam ONE monitoring platform is required. This includes proper authentication credentials and network connectivity."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to Veeam APIs and pull data into Microsoft Sentinel custom tables. This may result in additional data ingestion costs. See the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": "**STEP 1 - Select the deployment option for Veeam Data Connector and associated Azure Functions**\n\n>**IMPORTANT:** Before you deploy Veeam Data Connector, prepare Workspace Name (can be copied from the following).",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceName"
              ],
              "label": "Workspace Name"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the Veeam data connector using an ARM Template.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2FAzure-Sentinel%2Fmaster%2FSolutions%2FVeeam%2FData%2520Connectors%2Fazuredeploy_Veeam_API_FunctionApp.json)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Microsoft Sentinel Workspace Name**. \n4. Click **Review + Create**, **Create**."
      }
    ]
  },
  {
    "id": "VirtualMetricDirectorProxy",
    "title": "VirtualMetric Director Proxy",
    "publisher": "VirtualMetric",
    "descriptionMarkdown": "VirtualMetric Director Proxy deploys an Azure Function App to securely bridge VirtualMetric DataStream with Azure services including Microsoft Sentinel, Azure Data Explorer, and Azure Storage.",
    "graphQueriesTableName": "CommonSecurityLog",
    "graphQueries": [
      {
        "metricName": "Total CommonSecurityLog Events",
        "legend": "CommonSecurityLog",
        "baseQuery": "CommonSecurityLog"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get sample CommonSecurityLog events from the last 24 hours",
        "query": "CommonSecurityLog\n| where TimeGenerated > ago(24h)\n| take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog",
        "lastDataReceivedQuery": "CommonSecurityLog\n| where TimeGenerated > ago(7d)\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriteria": [
      {
        "type": "HasDataConnectors"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required.",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": false
          }
        }
      ],
      "customs": [
        {
          "name": "Azure Function App",
          "description": "An Azure Function App must be deployed to host the Director Proxy. Requires read, write, and delete permissions on Microsoft.Web/sites resources within your resource group to create and manage the Function App."
        },
        {
          "name": "VirtualMetric DataStream Configuration",
          "description": "You need VirtualMetric DataStream configured with authentication credentials to connect to the Director Proxy. The Director Proxy acts as a secure bridge between VirtualMetric DataStream and Azure services."
        },
        {
          "name": "Target Azure Services",
          "description": "Configure your target Azure services such as Microsoft Sentinel Data Collection Endpoints, Azure Data Explorer clusters, or Azure Storage accounts where the Director Proxy will forward data."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Deploy VirtualMetric Director Proxy",
        "description": "Deploy the Azure Function App that serves as a secure proxy between VirtualMetric DataStream and Microsoft Sentinel.",
        "instructions": [
          {
            "type": "InstructionStepsGroup",
            "parameters": {
              "enable": true,
              "instructionSteps": [
                {
                  "title": "Prerequisites and Deployment Order",
                  "description": "**Recommended Deployment Order:**\n\nFor optimal configuration, consider deploying the target connectors first:\n\n1. **Deploy Microsoft Sentinel Connector**: Deploy the VirtualMetric DataStream for Microsoft Sentinel connector first to create the required Data Collection Endpoints and Rules.\n\n2. **Deploy Microsoft Sentinel data lake Connector** (optional): If using Microsoft Sentinel data lake tables, deploy the VirtualMetric DataStream for Microsoft Sentinel data lake connector.\n\n3. **Deploy Director Proxy** (this step): The Director Proxy can then be configured with your Microsoft Sentinel targets.\n\n**Note:** This order is recommended but not required. You can deploy the Director Proxy independently and configure it with your targets later."
                },
                {
                  "title": "Deploy Azure Function App",
                  "description": "Deploy the VirtualMetric Director Proxy Azure Function App using the Deploy to Azure button.\n\n1. **Deploy to Azure**:\n   - Click the Deploy to Azure button below to deploy the Function App:\n   - [![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2FAzure-Sentinel%2Fmaster%2FSolutions%2FVirtualMetric%2520DataStream%2FData%2520Connectors%2FVirtualMetric-DirectorProxy%2FDeployToAzure.json)\n\n2. **Configure Deployment Parameters**:\n   - **Subscription**: Select your Azure subscription\n   - **Resource Group**: Choose the same resource group as your Microsoft Sentinel workspace or create a new one\n   - **Region**: Select the Azure region (should match your Microsoft Sentinel workspace region)\n   - **Function App Name**: Provide a unique name for the Function App (e.g., \"vmetric-director-proxy\")\n\n3. **Complete Deployment**:\n   - Click **Review + create** to validate the parameters\n   - Click **Create** to deploy the Function App\n   - Wait for deployment to complete (typically 3-5 minutes)\n   - Note the Function App URL: `https://<function-app-name>.azurewebsites.net`"
                },
                {
                  "title": "Configure Function App Permissions",
                  "description": "Assign the necessary permissions to the Function App's managed identity to access Microsoft Sentinel resources.\n\n1. **Enable System-Assigned Managed Identity**:\n   - Navigate to your deployed Function App in Azure Portal\n   - Go to **Identity** under Settings\n   - Toggle **Status** to **On** for System assigned identity\n   - Click **Save** and confirm\n\n2. **Navigate to Resource Group**:\n   - Go to the resource group containing your Microsoft Sentinel workspace and Data Collection Endpoints\n\n3. **Assign Required Roles**:\n   - Open **Access control (IAM)**\n   - Click **+ Add** > **Add role assignment**\n   - Assign the following roles to the Function App's system-assigned managed identity:\n     - **Monitoring Metrics Publisher**: For sending data to Data Collection Endpoints\n     - **Monitoring Reader**: For reading Data Collection Rules configuration\n\n4. **Select the Function App Identity**:\n   - In **Members** tab, select **Managed identity**\n   - Choose **Function App** and select your deployed Director Proxy Function App\n   - Complete the role assignment\n\n5. **Get Function App Access Token** (Optional for Function Key authentication):\n   - Navigate to your Function App\n   - Go to **App keys** under Functions\n   - Copy the default host key or create a new function key for authentication"
                },
                {
                  "title": "Configure VirtualMetric DataStream Integration",
                  "description": "Set up VirtualMetric DataStream to send security telemetry to Microsoft Sentinel through the Director Proxy.\n\n1. **Access VirtualMetric DataStream Configuration**:\n   - Log into your **VirtualMetric DataStream** management console\n   - Navigate to **Targets** section\n   - Click **Microsoft Sentinel Targets**\n   - Click **Add new target** or edit an existing Microsoft Sentinel target\n\n2. **Configure General Settings**:\n   - **Name**: Enter a name for your target (e.g., \"sentinel-with-proxy\")\n   - **Description**: Optionally provide a description for the target configuration\n\n3. **Configure Azure Authentication**:\n   \n   **For Service Principal Authentication:**\n   - **Managed Identity for Azure**: Keep **Disabled**\n   - **Tenant ID**: Enter your Azure Active Directory tenant ID\n   - **Client ID**: Enter your service principal application ID\n   - **Client Secret**: Enter your service principal client secret\n   \n   **For Azure Managed Identity:**\n   - **Managed Identity for Azure**: Set to **Enabled**\n\n4. **Configure Director Proxy** (in Azure Properties tab):\n   - **Endpoint Address**: Enter the Function App URL from Step 2 (format: `https://<function-app-name>.azurewebsites.net`)\n   - **Access Token**: Enter the Function App host key from Step 3 (optional if using Managed Identity)\n\n5. **Configure Stream Properties**:\n   - **Endpoint**: Enter the DCE Logs Ingestion URI (format: `https://<dce-name>.<region>.ingest.monitor.azure.com`)\n   - **Streams**: Select **Auto** for automatic stream detection, or configure specific streams if needed\n\n6. **Verify Data Ingestion in Microsoft Sentinel**:\n   - Return to your **Log Analytics Workspace**\n   - Run sample queries to confirm data is being received:\n     ```kql\n     CommonSecurityLog\n     | where TimeGenerated > ago(1h)\n     | take 10\n     ```\n   - Check the **Microsoft Sentinel Overview** dashboard for new data sources and event counts"
                }
              ]
            }
          }
        ]
      }
    ]
  },
  {
    "id": "VirtualMetricMSSentinelConnector",
    "title": "VirtualMetric DataStream for Microsoft Sentinel",
    "publisher": "VirtualMetric",
    "descriptionMarkdown": "VirtualMetric DataStream connector deploys Data Collection Rules to ingest security telemetry into Microsoft Sentinel.",
    "graphQueriesTableName": "CommonSecurityLog",
    "graphQueries": [
      {
        "metricName": "Total CommonSecurityLog Events",
        "legend": "CommonSecurityLog",
        "baseQuery": "CommonSecurityLog"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get sample CommonSecurityLog events from the last 24 hours",
        "query": "CommonSecurityLog\n| where TimeGenerated > ago(24h)\n| take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog",
        "lastDataReceivedQuery": "CommonSecurityLog\n| where TimeGenerated > ago(7d)\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriteria": [
      {
        "type": "HasDataConnectors"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required.",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": false
          }
        }
      ],
      "customs": [
        {
          "name": "App Registration or Azure Managed Identity",
          "description": "VirtualMetric DataStream requires an Entra ID identity to authenticate and send logs to Microsoft Sentinel. You can choose between creating an App Registration with Client ID and Client Secret, or using Azure Managed Identity for enhanced security without credential management."
        },
        {
          "name": "Resource Group Role Assignment",
          "description": "The chosen identity (App Registration or Managed Identity) must be assigned to the resource group containing the Data Collection Endpoint with the following roles: Monitoring Metrics Publisher (for log ingestion) and Monitoring Reader (for reading stream configuration)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Configure VirtualMetric DataStream for Microsoft Sentinel",
        "description": "Configure the VirtualMetric DataStream for Microsoft Sentinel to send data.",
        "instructions": [
          {
            "type": "InstructionStepsGroup",
            "parameters": {
              "enable": true,
              "instructionSteps": [
                {
                  "title": "Register Application in Microsoft Entra ID (Optional)",
                  "description": "**Choose your authentication method:**\n\n**Option A: Use Azure Managed Identity (Recommended)**\n- Skip this step if you plan to use Azure Managed Identity for authentication.\n- Azure Managed Identity provides a more secure authentication method without managing credentials.\n\n**Option B: Register a Service Principal Application**\n\n1. **Open the [Microsoft Entra ID page](https://entra.microsoft.com/)**:\n   - Click the provided link to open the **Microsoft Entra ID** registration page in a new tab.\n   - Ensure you are logged in with an account that has **Application Administrator** or **Global Administrator** permissions.\n\n2. **Create a New Application**:\n   - In the **Microsoft Entra ID portal**, select **App registrations** from the left-hand navigation.\n   - Click on **+ New registration**.\n   - Fill out the following fields:\n     - **Name**: Enter a descriptive name for the app (e.g., \"VirtualMetric ASIM Connector\").\n     - **Supported account types**: Choose **Accounts in this organizational directory only** (Single tenant).\n     - **Redirect URI**: Leave this blank.\n   - Click **Register** to create the application.\n\n3. **Copy Application and Tenant IDs**:\n   - Once the app is registered, note the **Application (client) ID** and **Directory (tenant) ID** from the **Overview** page. You'll need these for VirtualMetric DataStream configuration.\n\n4. **Create a Client Secret**:\n   - In the **Certificates & secrets** section, click **+ New client secret**.\n   - Add a description (e.g., 'VirtualMetric ASIM Secret') and set an appropriate expiration period.\n   - Click **Add**.\n   - **Copy the client secret value immediately**, as it will not be shown again. Store this securely for VirtualMetric DataStream configuration."
                },
                {
                  "title": "Assign Required Permissions",
                  "description": "Assign the required roles to your chosen authentication method (Service Principal or Managed Identity) in the resource group.\n\n**For Service Principal (if you completed Step 1):**\n\n1. **Navigate to Your Resource Group**:\n   - Open the **Azure Portal** and navigate to the **Resource Group** that contains your **Log Analytics Workspace** and where **Data Collection Rules (DCRs)** will be deployed.\n\n2. **Assign the Monitoring Metrics Publisher Role**:\n   - In the **Resource Group**, click on **Access control (IAM)** from the left-hand menu.\n   - Click **+ Add** and select **Add role assignment**.\n   - In the **Role** tab, search for and select **Monitoring Metrics Publisher**.\n   - Click **Next** to go to the **Members** tab.\n   - Under **Assign access to**, select **User, group, or service principal**.\n   - Click **+ Select members** and search for your registered application by name or client ID.\n   - Select your application and click **Select**.\n   - Click **Review + assign** twice to complete the assignment.\n\n3. **Assign the Monitoring Reader Role**:\n   - Repeat the same process to assign the **Monitoring Reader** role:\n   - Click **+ Add** and select **Add role assignment**.\n   - In the **Role** tab, search for and select **Monitoring Reader**.\n   - Follow the same member selection process as above.\n   - Click **Review + assign** twice to complete the assignment.\n\n**For Azure Managed Identity:**\n\n1. **Create or Identify Your Managed Identity**:\n   - If using **System-assigned Managed Identity**: Enable it on your Azure resource (VM, App Service, etc.).\n   - If using **User-assigned Managed Identity**: Create one in your resource group if it doesn't exist.\n\n2. **Assign the Monitoring Metrics Publisher Role**:\n   - Follow the same steps as above, but in the **Members** tab:\n   - Under **Assign access to**, select **Managed identity**.\n   - Click **+ Select members** and choose the appropriate managed identity type and select your identity.\n   - Click **Select**, then **Review + assign** twice to complete.\n\n3. **Assign the Monitoring Reader Role**:\n   - Repeat the process to assign the **Monitoring Reader** role to the same managed identity.\n\n**Required Permission Summary:**\nThe assigned roles provide the following capabilities:\n- **Monitoring Metrics Publisher**: Write data to Data Collection Endpoints (DCE) and send telemetry through Data Collection Rules (DCR)\n- **Monitoring Reader**: Read stream configuration and access Log Analytics workspace for ASIM table ingestion"
                },
                {
                  "title": "Deploy Azure Infrastructure",
                  "description": "Deploy the required Data Collection Endpoint (DCE) and Data Collection Rules (DCR) for Microsoft Sentinel tables using our ARM template.\n\n1. **Deploy to Azure**:\n   - Click the Deploy to Azure button below to automatically deploy the required infrastructure:\n   - [![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2FAzure-Sentinel%2Fmaster%2FSolutions%2FVirtualMetric%2520DataStream%2FData%2520Connectors%2FVirtualMetric-Sentinel%2FDeployToAzure.json)\n   - This will take you directly to the Azure portal to start the deployment.\n\n2. **Configure Deployment Parameters**:\n   - On the custom deployment page, configure the following settings:\n   \n   **Project details:**\n   - **Subscription**: Select your Azure subscription from the dropdown\n   - **Resource group**: Select an existing resource group or click **Create new** to create a new one\n   \n   **Instance details:**\n   - **Region**: Select the Azure region where your Log Analytics workspace is located (e.g., West Europe)\n   - **Workspace**: Enter your Log Analytics workspace name\n   - **DCE Name**: Provide a name for the Data Collection Endpoint (e.g., \"vmetric-dce\")\n   - **DCR Name Prefix**: Provide a prefix for the Data Collection Rules (e.g., \"vmetric-dcr\")\n\n3. **Complete the Deployment**:\n   - Click **Review + create** to validate the template.\n   - Review the parameters and click **Create** to deploy the resources.\n   - Wait for the deployment to complete (typically takes 2-5 minutes).\n\n4. **Verify Deployed Resources**:\n   - After deployment, verify the following resources were created:\n     - **Data Collection Endpoint (DCE)**: Check **Azure Portal > Monitor > Data Collection Endpoints**\n     - **Data Collection Rules (DCRs)**: Check **Azure Portal > Monitor > Data Collection Rules**\n   - **Copy the DCE Logs Ingestion URI** from the DCE **Overview** page (format: `https://<dce-name>.<region>.ingest.monitor.azure.com`)\n   - **Copy the DCE Resource ID** from the DCE **Overview** page (format: `/subscriptions/<subscription-id>/resourceGroups/<resource-group-name>/providers/Microsoft.Insights/dataCollectionEndpoints/<dce-name>`)\n   - For each DCR, note the **Immutable ID** from the **Overview** page - you'll need these for VirtualMetric DataStream configuration."
                },
                {
                  "title": "Configure VirtualMetric DataStream Integration",
                  "description": "Set up VirtualMetric DataStream to send security telemetry to Microsoft Sentinel tables.\n\n1. **Access VirtualMetric DataStream Configuration**:\n   - Log into your **VirtualMetric DataStream** management console.\n   - Navigate to **Fleet Management** > **Targets** section.\n   - Click **Add new target** button.\n   - Select **Microsoft Sentinel** target.\n\n2. **Configure General Settings**:\n   - **Name**: Enter a name for your target (e.g., \"cus01-ms-sentinel\")\n   - **Description**: Optionally provide a description for the target configuration\n\n3. **Configure Azure Authentication** (choose based on Step 1):\n   \n   **For Service Principal Authentication:**\n   - **Managed Identity for Azure**: Keep **Disabled**\n   - **Tenant ID**: Enter the Directory (tenant) ID from Step 1\n   - **Client ID**: Enter the Application (client) ID from Step 1\n   - **Client Secret**: Enter the client secret value from Step 1\n   \n   **For Azure Managed Identity:**\n   - **Managed Identity for Azure**: Set to **Enabled**\n\n4. **Configure Stream Properties**:\n   - **Endpoint**: Choose your configuration method:\n     - **For manual stream configuration**: Enter the DCE Logs Ingestion URI (format: `https://<dce-name>.<region>.ingest.monitor.azure.com`)\n     - **For auto stream detection**: Enter the DCE Resource ID (format: `/subscriptions/<subscription-id>/resourceGroups/<resource-group-name>/providers/Microsoft.Insights/dataCollectionEndpoints/<dce-name>`)\n   - **Streams**: Select **Auto** for automatic stream detection, or configure specific streams if needed\n\n5. **Verify Data Ingestion in Microsoft Sentinel**:\n   - Return to your **Log Analytics Workspace**\n   - Run sample queries on the ASIM tables to confirm data is being received:\n     ```kql\n     ASimNetworkSessionLogs\n     | where TimeGenerated > ago(1h)\n     | take 10\n     ```\n   - Check the **Microsoft Sentinel Overview** dashboard for new data sources and event counts."
                }
              ]
            }
          }
        ]
      }
    ]
  },
  {
    "id": "VirtualMetricMSSentinelDataLakeConnector",
    "title": "VirtualMetric DataStream for Microsoft Sentinel data lake",
    "publisher": "VirtualMetric",
    "descriptionMarkdown": "VirtualMetric DataStream connector deploys Data Collection Rules to ingest security telemetry into Microsoft Sentinel data lake.",
    "graphQueriesTableName": "CommonSecurityLog",
    "graphQueries": [
      {
        "metricName": "Total CommonSecurityLog Events",
        "legend": "CommonSecurityLog",
        "baseQuery": "CommonSecurityLog"
      }
    ],
    "sampleQueries": [
      {
        "description": "Get sample CommonSecurityLog events from the last 24 hours",
        "query": "CommonSecurityLog\n| where TimeGenerated > ago(24h)\n| take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog",
        "lastDataReceivedQuery": "CommonSecurityLog\n| where TimeGenerated > ago(7d)\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriteria": [
      {
        "type": "HasDataConnectors"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required.",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": false
          }
        }
      ],
      "customs": [
        {
          "name": "App Registration or Azure Managed Identity",
          "description": "VirtualMetric DataStream requires an Entra ID identity to authenticate and send logs to Microsoft Sentinel data lake. You can choose between creating an App Registration with Client ID and Client Secret, or using Azure Managed Identity for enhanced security without credential management."
        },
        {
          "name": "Resource Group Role Assignment",
          "description": "The chosen identity (App Registration or Managed Identity) must be assigned to the resource group containing the Data Collection Endpoint with the following roles: Monitoring Metrics Publisher (for log ingestion) and Monitoring Reader (for reading stream configuration)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Configure VirtualMetric DataStream for Microsoft Sentinel data lake",
        "description": "Configure the VirtualMetric DataStream for Microsoft Sentinel data lake to send data.",
        "instructions": [
          {
            "type": "InstructionStepsGroup",
            "parameters": {
              "enable": true,
              "instructionSteps": [
                {
                  "title": "Register Application in Microsoft Entra ID (Optional)",
                  "description": "**Choose your authentication method:**\n\n**Option A: Use Azure Managed Identity (Recommended)**\n- Skip this step if you plan to use Azure Managed Identity for authentication.\n- Azure Managed Identity provides a more secure authentication method without managing credentials.\n\n**Option B: Register a Service Principal Application**\n\n1. **Open the [Microsoft Entra ID page](https://entra.microsoft.com/)**:\n   - Click the provided link to open the **Microsoft Entra ID** registration page in a new tab.\n   - Ensure you are logged in with an account that has **Application Administrator** or **Global Administrator** permissions.\n\n2. **Create a New Application**:\n   - In the **Microsoft Entra ID portal**, select **App registrations** from the left-hand navigation.\n   - Click on **+ New registration**.\n   - Fill out the following fields:\n     - **Name**: Enter a descriptive name for the app (e.g., \"VirtualMetric ASIM Connector\").\n     - **Supported account types**: Choose **Accounts in this organizational directory only** (Single tenant).\n     - **Redirect URI**: Leave this blank.\n   - Click **Register** to create the application.\n\n3. **Copy Application and Tenant IDs**:\n   - Once the app is registered, note the **Application (client) ID** and **Directory (tenant) ID** from the **Overview** page. You'll need these for VirtualMetric DataStream configuration.\n\n4. **Create a Client Secret**:\n   - In the **Certificates & secrets** section, click **+ New client secret**.\n   - Add a description (e.g., 'VirtualMetric ASIM Secret') and set an appropriate expiration period.\n   - Click **Add**.\n   - **Copy the client secret value immediately**, as it will not be shown again. Store this securely for VirtualMetric DataStream configuration."
                },
                {
                  "title": "Assign Required Permissions",
                  "description": "Assign the required roles to your chosen authentication method (Service Principal or Managed Identity) in the resource group.\n\n**For Service Principal (if you completed Step 1):**\n\n1. **Navigate to Your Resource Group**:\n   - Open the **Azure Portal** and navigate to the **Resource Group** that contains your **Log Analytics Workspace** and where **Data Collection Rules (DCRs)** will be deployed.\n\n2. **Assign the Monitoring Metrics Publisher Role**:\n   - In the **Resource Group**, click on **Access control (IAM)** from the left-hand menu.\n   - Click **+ Add** and select **Add role assignment**.\n   - In the **Role** tab, search for and select **Monitoring Metrics Publisher**.\n   - Click **Next** to go to the **Members** tab.\n   - Under **Assign access to**, select **User, group, or service principal**.\n   - Click **+ Select members** and search for your registered application by name or client ID.\n   - Select your application and click **Select**.\n   - Click **Review + assign** twice to complete the assignment.\n\n3. **Assign the Monitoring Reader Role**:\n   - Repeat the same process to assign the **Monitoring Reader** role:\n   - Click **+ Add** and select **Add role assignment**.\n   - In the **Role** tab, search for and select **Monitoring Reader**.\n   - Follow the same member selection process as above.\n   - Click **Review + assign** twice to complete the assignment.\n\n**For Azure Managed Identity:**\n\n1. **Create or Identify Your Managed Identity**:\n   - If using **System-assigned Managed Identity**: Enable it on your Azure resource (VM, App Service, etc.).\n   - If using **User-assigned Managed Identity**: Create one in your resource group if it doesn't exist.\n\n2. **Assign the Monitoring Metrics Publisher Role**:\n   - Follow the same steps as above, but in the **Members** tab:\n   - Under **Assign access to**, select **Managed identity**.\n   - Click **+ Select members** and choose the appropriate managed identity type and select your identity.\n   - Click **Select**, then **Review + assign** twice to complete.\n\n3. **Assign the Monitoring Reader Role**:\n   - Repeat the process to assign the **Monitoring Reader** role to the same managed identity.\n\n**Required Permission Summary:**\nThe assigned roles provide the following capabilities:\n- **Monitoring Metrics Publisher**: Write data to Data Collection Endpoints (DCE) and send telemetry through Data Collection Rules (DCR)\n- **Monitoring Reader**: Read stream configuration and access Log Analytics workspace for ASIM table ingestion"
                },
                {
                  "title": "Deploy Azure Infrastructure",
                  "description": "Deploy the required Data Collection Endpoint (DCE) and Data Collection Rules (DCR) for Microsoft Sentinel data lake tables using our ARM template.\n\n1. **Deploy to Azure**:\n   - Click the Deploy to Azure button below to automatically deploy the required infrastructure:\n   - [![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2FAzure-Sentinel%2Fmaster%2FSolutions%2FVirtualMetric%2520DataStream%2FData%2520Connectors%2FVirtualMetric-SentinelDataLake%2FDeployToAzure.json)\n   - This will take you directly to the Azure portal to start the deployment.\n\n2. **Configure Deployment Parameters**:\n   - On the custom deployment page, configure the following settings:\n   \n   **Project details:**\n   - **Subscription**: Select your Azure subscription from the dropdown\n   - **Resource group**: Select an existing resource group or click **Create new** to create a new one\n   \n   **Instance details:**\n   - **Region**: Select the Azure region where your Log Analytics workspace is located (e.g., West Europe)\n   - **Workspace**: Enter your Log Analytics workspace name\n   - **DCE Name**: Provide a name for the Data Collection Endpoint (e.g., \"vmetric-dce\")\n   - **DCR Name Prefix**: Provide a prefix for the Data Collection Rules (e.g., \"vmetric-dcr\")\n\n3. **Complete the Deployment**:\n   - Click **Review + create** to validate the template.\n   - Review the parameters and click **Create** to deploy the resources.\n   - Wait for the deployment to complete (typically takes 2-5 minutes).\n\n4. **Verify Deployed Resources**:\n   - After deployment, verify the following resources were created:\n     - **Data Collection Endpoint (DCE)**: Check **Azure Portal > Monitor > Data Collection Endpoints**\n     - **Data Collection Rules (DCRs)**: Check **Azure Portal > Monitor > Data Collection Rules**\n   - **Copy the DCE Logs Ingestion URI** from the DCE **Overview** page (format: `https://<dce-name>.<region>.ingest.monitor.azure.com`)\n   - **Copy the DCE Resource ID** from the DCE **Overview** page (format: `/subscriptions/<subscription-id>/resourceGroups/<resource-group-name>/providers/Microsoft.Insights/dataCollectionEndpoints/<dce-name>`)\n   - For each DCR, note the **Immutable ID** from the **Overview** page - you'll need these for VirtualMetric DataStream configuration."
                },
                {
                  "title": "Configure VirtualMetric DataStream Integration",
                  "description": "Set up VirtualMetric DataStream to send security telemetry to Microsoft Sentinel data lake tables.\n\n1. **Access VirtualMetric DataStream Configuration**:\n   - Log into your **VirtualMetric DataStream** management console.\n   - Navigate to **Fleet Management** > **Targets** section.\n   - Click **Add new target** button.\n   - Select **Microsoft Sentinel** target.\n\n2. **Configure General Settings**:\n   - **Name**: Enter a name for your target (e.g., \"cus01-ms-sentinel\")\n   - **Description**: Optionally provide a description for the target configuration\n\n3. **Configure Azure Authentication** (choose based on Step 1):\n   \n   **For Service Principal Authentication:**\n   - **Managed Identity for Azure**: Keep **Disabled**\n   - **Tenant ID**: Enter the Directory (tenant) ID from Step 1\n   - **Client ID**: Enter the Application (client) ID from Step 1\n   - **Client Secret**: Enter the client secret value from Step 1\n   \n   **For Azure Managed Identity:**\n   - **Managed Identity for Azure**: Set to **Enabled**\n\n4. **Configure Stream Properties**:\n   - **Endpoint**: Choose your configuration method:\n     - **For manual stream configuration**: Enter the DCE Logs Ingestion URI (format: `https://<dce-name>.<region>.ingest.monitor.azure.com`)\n     - **For auto stream detection**: Enter the DCE Resource ID (format: `/subscriptions/<subscription-id>/resourceGroups/<resource-group-name>/providers/Microsoft.Insights/dataCollectionEndpoints/<dce-name>`)\n   - **Streams**: Select **Auto** for automatic stream detection, or configure specific streams if needed\n\n5. **Verify Data Ingestion in Microsoft Sentinel data lake**:\n   - Return to your **Log Analytics Workspace**\n   - Run sample queries on the ASIM tables to confirm data is being received:\n     ```kql\n     ASimNetworkSessionLogs\n     | where TimeGenerated > ago(1h)\n     | take 10\n     ```\n   - Check the **Microsoft Sentinel Overview** dashboard for new data sources and event counts."
                }
              ]
            }
          }
        ]
      }
    ]
  },
  {
    "id": "VMRay",
    "title": "VMRayThreatIntelligence",
    "publisher": "VMRay",
    "descriptionMarkdown": "VMRayThreatIntelligence connector automatically generates and feeds threat intelligence for all submissions to VMRay, improving threat detection and incident response in Sentinel. This seamless integration empowers teams to proactively address emerging threats.",
    "graphQueries": [
      {
        "metricName": "VMRay Threat Indicators data received",
        "legend": "ThreatIntelligenceIndicator | where SourceSystem contains 'VMRay'",
        "baseQuery": "ThreatIntelligenceIndicator | where SourceSystem contains 'VMRay'"
      },
      {
        "metricName": "Non-VMRay Threat Indicators data received",
        "legend": "ThreatIntelligenceIndicator | where SourceSystem !contains 'VMRay'",
        "baseQuery": "ThreatIntelligenceIndicator | where SourceSystem !contains 'VMRay'"
      }
    ],
    "sampleQueries": [
      {
        "description": "VMRay Based Indicators Events - All VMRay threat indicators in Microsoft Sentinel Threat Intelligence.",
        "query": "ThreatIntelligenceIndicator\n | where SourceSystem contains 'VMRay'\n | sort by TimeGenerated desc"
      },
      {
        "description": "Non-VMRay Based Indicators Events - All Non-VMRay threat indicators in Microsoft Sentinel Threat Intelligence.",
        "query": "ThreatIntelligenceIndicator\n | where SourceSystem !contains 'VMRay'\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "ThreatIntelligenceIndicator",
        "lastDataReceivedQuery": "ThreatIntelligenceIndicator\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ThreatIntelligenceIndicator\n            | where SourceSystem contains 'VMRay'\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "Report_links_data_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      },
      {
        "type": "IsConnectedQuery",
        "value": [
          "ThreatIntelligenceIndicator\n             | where SourceSystem !contains 'VMRay'\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Azure Subscription",
          "description": "Azure Subscription with owner role is required to register an application in azure active directory() and assign role of contributor to app in resource group."
        },
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "**VMRay API Key** is required."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the VMRay API to pull VMRay Threat IOCs into Microsoft Sentinel. This might result in additional costs for data ingestion and for storing data in Azure Blob Storage costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) and [Azure Blob Storage pricing page](https://azure.microsoft.com/pricing/details/storage/blobs/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Deploy VMRay Threat Intelligence Connector",
        "description": "1. Ensure you have all the required prerequisites: **Client ID**, **Tenant ID**, **Client Secret**, **VMRay API Key**, and **VMRay Base URL**.\n2. To obtain the Client ID, Client Secret, and Tenant ID, [follow these instructions](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/VMRay#vmray-configurations)\n3. For the **Flex Consumption Plan**, click the **Deploy to Azure** button below:\n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-VMRay-azuredeployflex)\n\n4. For the **Premium Plan**, click the **Deploy to Azure** button below:\n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-VMRay-azuredeploypremium)."
      }
    ]
  },
  {
    "id": "VMwareCarbonBlack",
    "title": "VMware Carbon Black Cloud",
    "publisher": "VMware",
    "descriptionMarkdown": "The [VMware Carbon Black Cloud](https://www.vmware.com/products/carbon-black-cloud.html) connector provides the capability to ingest Carbon Black data into Microsoft Sentinel. The connector provides visibility into Audit, Notification and Event logs in Microsoft Sentinel to view dashboards, create custom alerts, and to improve monitoring and investigation capabilities.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "CarbonBlackEvents_CL",
        "baseQuery": "CarbonBlackEvents_CL"
      },
      {
        "metricName": "Total data received",
        "legend": "CarbonBlackNotifications_CL",
        "baseQuery": "CarbonBlackNotifications_CL"
      },
      {
        "metricName": "Total data received",
        "legend": "CarbonBlackAuditLogs_CL",
        "baseQuery": "CarbonBlackAuditLogs_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Event Generating Endpoints",
        "query": "CarbonBlackEvents_CL\n | summarize count() by deviceDetails_deviceName_s \n| top 10 by count_"
      },
      {
        "description": "Top 10 User Console Logins",
        "query": "CarbonBlackAuditLogs_CL\n | summarize count() by loginName_s \n| top 10 by count_"
      },
      {
        "description": "Top 10 Threats",
        "query": "CarbonBlackNotifications_CL\n | summarize count() by threatHunterInfo_reportName_s \n| top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "CarbonBlackEvents_CL",
        "lastDataReceivedQuery": "CarbonBlackEvents_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CarbonBlackAuditLogs_CL",
        "lastDataReceivedQuery": "CarbonBlackAuditLogs_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "CarbonBlackNotifications_CL",
        "lastDataReceivedQuery": "CarbonBlackNotifications_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CarbonBlackEvents_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "CarbonBlackNotifications_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "CarbonBlackAuditLogs_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "VMware Carbon Black API Key(s)",
          "description": "Carbon Black API and/or SIEM Level API Key(s) are required. See the documentation to learn more about the [Carbon Black API](https://developer.carbonblack.com/reference/carbon-black-cloud/cb-defense/latest/rest-api/).\n - A Carbon Black **API** access level API ID and Key is required for [Audit](https://developer.carbonblack.com/reference/carbon-black-cloud/cb-defense/latest/rest-api/#audit-log-events) and [Event](https://developer.carbonblack.com/reference/carbon-black-cloud/platform/latest/data-forwarder-config-api/) logs. \n - A Carbon Black **SIEM** access level  API ID and Key is required for [Notification](https://developer.carbonblack.com/reference/carbon-black-cloud/cb-defense/latest/rest-api/#notifications) alerts."
        },
        {
          "name": "Amazon S3 REST API Credentials/permissions",
          "description": "**AWS Access Key Id**, **AWS Secret Access Key**, **AWS S3 Bucket Name**, **Folder Name in AWS S3 Bucket** are required for Amazon S3 REST API."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to VMware Carbon Black to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the VMware Carbon Black API**\n\n [Follow these instructions](https://developer.carbonblack.com/reference/carbon-black-cloud/authentication/#creating-an-api-key) to create an API Key."
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the VMware Carbon Black connector, have the Workspace ID and Workspace Primary Key (can be copied from the following), as well as the VMware Carbon Black API Authorization Key(s), readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "This method provides an automated deployment of the VMware Carbon Black connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinelcarbonblackazuredeploy) [![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://aka.ms/sentinelcarbonblackazuredeploy-gov)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace ID**, **Workspace Key**, **Log Types**, **API ID(s)**, **API Key(s)**, **Carbon Black Org Key**, **S3 Bucket Name**, **AWS Access Key Id**, **AWS Secret Access Key**, **EventPrefixFolderName**,**AlertPrefixFolderName**,  and validate the **URI**.\n> - Enter the URI that corresponds to your region. The complete list of API URLs can be [found here](https://community.carbonblack.com/t5/Knowledge-Base/PSC-What-URLs-are-used-to-access-the-APIs/ta-p/67346)\n - The default **Time Interval** is set to pull the last five (5) minutes of data. If the time interval needs to be modified, it is recommended to change the Function App Timer Trigger accordingly (in the function.json file, post deployment) to prevent overlapping data ingestion. \n - Carbon Black requires a seperate set of API ID/Keys to ingest Notification alerts. Enter the SIEM API ID/Key values or leave blank, if not required. \n> - Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the VMware Carbon Black connector manually with Azure Functions."
      },
      {
        "title": "",
        "description": "**1. Create a Function App**\n\n1.  From the Azure Portal, navigate to [Function App](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Web%2Fsites/kind/functionapp), and select **+ Add**.\n2. In the **Basics** tab, ensure Runtime stack is set to **Powershell Core**. \n3. In the **Hosting** tab, ensure the **Consumption (Serverless)** plan type is selected.\n4. Make other preferrable configuration changes, if needed, then click **Create**."
      },
      {
        "title": "",
        "description": "**2. Import Function App Code**\n\n1. In the newly created Function App, select **Functions** on the left pane and click **+ Add**.\n2. Select **Timer Trigger**.\n3. Enter a unique Function **Name** and modify the cron schedule, if needed. The default value is set to run the Function App every 5 minutes. (Note: the Timer trigger should match the `timeInterval` value below to prevent overlapping data), click **Create**.\n4. Click on **Code + Test** on the left pane. \n5. Copy the [Function App Code](https://aka.ms/sentinelcarbonblackazurefunctioncode) and paste into the Function App `run.ps1` editor.\n5. Click **Save**."
      },
      {
        "title": "",
        "description": "**3. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select **+ New application setting**.\n3. Add each of the following thirteen to sixteen (13-16) application settings individually, with their respective string values (case-sensitive): \n\t\tapiId\n\t\tapiKey\n\t\tworkspaceID\n\t\tworkspaceKey\n\t\turi\n\t\ttimeInterval\n\t\tCarbonBlackOrgKey\n\t\tCarbonBlackLogTypes \n\t\ts3BucketName \n\t\tEventPrefixFolderName \n\t\tAlertPrefixFolderName \n\t\tAWSAccessKeyId \n\t\tAWSSecretAccessKey \n\t\tSIEMapiId (Optional)\n\t\tSIEMapiKey (Optional)\n\t\tlogAnalyticsUri (optional) \n> - Enter the URI that corresponds to your region. The complete list of API URLs can be [found here](https://community.carbonblack.com/t5/Knowledge-Base/PSC-What-URLs-are-used-to-access-the-APIs/ta-p/67346). The `uri` value must follow the following schema: `https://<API URL>.conferdeploy.net` - There is no need to add a time suffix to the URI, the Function App will dynamically append the Time Value to the URI in the proper format.\n> - Set the `timeInterval` (in minutes) to the default value of `5` to correspond to the default Timer Trigger of every `5` minutes. If the time interval needs to be modified, it is recommended to change the Function App Timer Trigger accordingly to prevent overlapping data ingestion.\n> - Carbon Black requires a seperate set of API ID/Keys to ingest Notification alerts. Enter the `SIEMapiId` and `SIEMapiKey` values, if needed, or omit, if not required. \n> - Note: If using Azure Key Vault, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details. \n> - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`\n4. Once all application settings have been entered, click **Save**."
      }
    ]
  },
  {
    "id": "VMwareESXi",
    "title": "[Deprecated] VMware ESXi",
    "publisher": "VMWare",
    "descriptionMarkdown": "The [VMware ESXi](https://www.vmware.com/products/esxi-and-esx.html) connector allows you to easily connect your VMWare ESXi logs with Microsoft Sentinel This gives you more insight into your organization's ESXi servers and improves your security operation capabilities.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "VMwareESXi",
        "baseQuery": "VMwareESXi"
      }
    ],
    "sampleQueries": [
      {
        "description": "Total Events by Log Type",
        "query": "VMwareESXi \n| summarize count() by ProcessName"
      },
      {
        "description": "Top 10 ESXi Hosts Generating Events",
        "query": "VMwareESXi \n | summarize count() by HostName \n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog (VMwareESXi)",
        "lastDataReceivedQuery": "VMwareESXi \n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "VMwareESXi \n      | where TimeGenerated > ago(3d)\n   |take 1\n         | project IsConnected = true"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "write permission is required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "VMwareESXi",
          "description": "must be configured to export logs via Syslog"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias VMwareESXi and load the function code or click [here](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/VMWareESXi/Parsers/VMwareESXi.yaml), on the second line of the query, enter the hostname(s) of your VMwareESXi device(s) and any other unique identifiers for the logstream. The function usually takes 10-15 minutes to activate after solution installation/update.",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux",
        "description": "Typically, you should install the agent on a different computer from the one on which the logs are generated.\n\n>  Syslog logs are collected only from **Linux** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Configure the facilities you want to collect and their severities.\n 1. Under workspace advanced settings **Configuration**, select **Data** and then **Syslog**.\n 2. Select **Apply below configuration to my machines** and select the facilities and severities.\n 3.  Click **Save**.",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenSyslogSettings"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "3. Configure and connect the VMware ESXi",
        "description": "1. Follow these instructions to configure the VMWare ESXi to forward syslog: \n - [VMware ESXi 3.5 and 4.x](https://kb.vmware.com/s/article/1016621) \n - [VMware ESXi 5.0+](https://docs.vmware.com/en/VMware-vSphere/5.5/com.vmware.vsphere.monitoring.doc/GUID-9F67DB52-F469-451F-B6C8-DAE8D95976E7.html)\n2. Use the IP address or hostname for the Linux device with the Linux agent installed as the Destination IP address."
      }
    ]
  },
  {
    "id": "VMwareSDWAN",
    "title": "VMware SD-WAN and SASE Connector",
    "publisher": "VMware by Broadcom",
    "descriptionMarkdown": "The [VMware SD-WAN & SASE](https://sase.vmware.com) data connector offers the capability to ingest VMware SD-WAN and CWS events into Microsoft Sentinel through the REST API. Refer to [API documentation](https://developer.vmware.com/apis/vmware-sase-platform/) for more information. The connector provides ability to get events which helps to examine potential network security issues, identify misconfigured network devices and monitor SD-WAN and SASE usage. If you have your own custom connector, make sure that the connector is deployed under an isolated Log Analytics Workspace first. In case of issues, questions or feature requests, please contact us via email on sase-siem-integration@vmware.com.",
    "graphQueries": [
      {
        "metricName": "Function App - VECO Event Logs ingested",
        "legend": "VMware_VECO_EventLogs_CL",
        "baseQuery": "let min_t = toscalar(VMware_VECO_EventLogs_CL | summarize min(TimeGenerated));\nlet max_t = toscalar(VMware_VECO_EventLogs_CL | summarize max(TimeGenerated));\nVMware_VECO_EventLogs_CL\n| make-series num=count() default=0 on TimeGenerated from min_t to max_t step 1h\n| render areachart with(title=\"VECO Event Log ingestion\")"
      }
    ],
    "sampleQueries": [
      {
        "description": "SD-WAN API Events - All captured events",
        "query": "VMware_VECO_EventLogs_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "VMware_VECO_EventLogs_CL",
        "lastDataReceivedQuery": "VMware_VECO_EventLogs_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "VMware_CWS_Weblogs_CL",
        "lastDataReceivedQuery": "VMware_CWS_Weblogs_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "VMware_CWS_Health_CL",
        "lastDataReceivedQuery": "VMware_CWS_Health_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "VMware_CWS_DLPLogs_CL",
        "lastDataReceivedQuery": "VMware_CWS_DLPLogs_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "VMware_VECO_EventLogs_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "**api_veco_authorization**, **api_veco_fqdn** is required for REST API. [See the documentation to learn more about VMware SASE APIs](https://developer.vmware.com/apis/vmware-sase-platform/). Check all [requirements and follow  the instructions](https://docs.vmware.com/en/VMware-SD-WAN/5.3/VMware-SD-WAN-Administration-Guide/GUID-2FA3763F-835C-4D10-A32B-450FEB5397D8.html) for obtaining credentials. The Function App only supports token-based API authentication. Be advised that the API Token generated will inherit the access rights of the user account under which it was generated."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the VMware Edge Cloud Orchestrator REST API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the VECO API**\n\n [Follow the instructions](https://docs.vmware.com/en/VMware-SD-WAN/5.3/VMware-SD-WAN-Administration-Guide/GUID-2FA3763F-835C-4D10-A32B-450FEB5397D8.html) to create and obtain the credentials. \n"
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function.**"
      },
      {
        "title": "Option 1 - Azure Resource Manager (ARM) Template",
        "description": "Use this method for automated deployment of the VMware SD-WAN and SASE Connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinelvmwaresdwan)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**.\n3. Enter or modify the Function App, Log Analytics and Azure Monitor settings, enter the VECO FQDN (without https://, for example vco123-usvi1.velocloud.net), enter the API token created (including \"Token \" at the beginning of the string), and adjust your desired Function App freaquency, then deploy. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy."
      },
      {
        "title": "Option 2 - Manual Deployment of Azure Functions",
        "description": "Use the following step-by-step instructions to deploy the VMware SD-WAN and SASE Connector manually with Azure Functions (Deployment via Visual Studio Code)."
      },
      {
        "title": "",
        "description": "**1. Deploy a Function App**\n\n> **NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-vmwaresdwan-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. vmwsase-siemXXXXXXXXXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.10.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration."
      },
      {
        "title": "",
        "description": "**2. Configure the Function App**\n\n1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab .\n3. Check if the application has these settings defined correctly and adjust if needed: \n\t\tapi_veco_authorization\n\t\tapi_veco_fqdn\n\t\tapp_frequency_mins\n\t\tazsa_share_connectionstring\n\t\tazsa_share_name dce_endpoint\n\t\tdcr_cwsdlplog_immutableid\n\t\tdcr_cwshealth_immutableid\n\t\tdcr_cwsweblog_immutableid\n\t\tdcr_efsfwlog_immutableid\n\t\tdcr_efshealth_immutableid\n\t\tdcr_saseaudit_immutableid\n\t\tstream_cwsdlplog\n\t\tstream_cwshealth\n\t\tstream_cwsweblog\n\t\tstream_efsfwlog\n\t\tstream_efshealth\n\t\tstream_saseaudit\n3. In case you made changes to application settings have been entered, make sure that you click **Save**."
      }
    ]
  },
  {
    "id": "VMwarevCenter",
    "title": "[Deprecated] VMware vCenter",
    "publisher": "VMware",
    "descriptionMarkdown": "The [vCenter](https://www.vmware.com/in/products/vcenter-server.html) connector allows you to easily connect your vCenter server logs with Microsoft Sentinel. This gives you more insight into your organization's data centers and improves your security operation capabilities.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "vCenter",
        "baseQuery": "vCenter"
      }
    ],
    "sampleQueries": [
      {
        "description": "Total Events by Event Type",
        "query": "vCenter \n | summarize count() by EventType"
      },
      {
        "description": "log in/out to vCenter Server",
        "query": "vCenter \n | where EventType in ('UserLogoutSessionEvent','UserLoginSessionEvent') \n | summarize count() by EventType,EventID,UserName,UserAgent \n | top 10 by count_"
      }
    ],
    "dataTypes": [
      {
        "name": "vcenter_CL",
        "lastDataReceivedQuery": "vCenter \n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "vCenter \n      | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Include custom pre-requisites if the connectivity requires - else delete customs",
          "description": "Description for any custom pre-requisite"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias VMware vCenter and load the function code or click [here](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/VMware%20vCenter/Parsers/vCenter.txt), on the second line of the query, enter the hostname(s) of your VMware vCenter device(s) and any other unique identifiers for the logstream. The function usually takes 10-15 minutes to activate after solution installation/update. \n> 1. If you have not installed the vCenter solution from ContentHub then [Follow the steps](https://aka.ms/sentinel-vCenter-parser) to use the Kusto function alias, **vCenter**",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux",
        "description": "Typically, you should install the agent on a different computer from the one on which the logs are generated.\n\n>  Syslog logs are collected only from **Linux** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Follow the configuration steps below to get vCenter server logs into Microsoft Sentinel. Refer to the [Azure Monitor Documentation](https://docs.microsoft.com/azure/azure-monitor/agents/data-sources-json) for more details on these steps.\n For vCenter Server logs, we have issues while parsing the data by OMS agent data using default settings. \nSo we advice to capture the logs into custom table **vcenter_CL** using below instructions. \n1. Login to the server where you have installed OMS agent.\n2. Download config file vCenter.conf \n\t\twget -v https://aka.ms/sentinel-vcenteroms-conf -O vcenter.conf \n3. Copy vcenter.conf to the /etc/opt/microsoft/omsagent/**workspace_id**/conf/omsagent.d/ folder. \n\t\tcp vcenter.conf /etc/opt/microsoft/omsagent/<<workspace_id>>/conf/omsagent.d/\n4. Edit vcenter.conf as follows:\n\n\t a. vcenter.conf uses the port **22033** by default. Ensure this port is not being used by any other source on your server\n\n\t b. If you would like to change the default port for **vcenter.conf** make sure that you dont use default Azure monotoring /log analytic agent ports I.e.(For example CEF uses TCP port **25226** or **25224**) \n\n\t c. replace **workspace_id** with real value of your Workspace ID (lines 13,14,15,18)\n5. Save changes and restart the Azure Log Analytics agent for Linux service with the following command:\n\t\tsudo /opt/microsoft/omsagent/bin/service_control restart\n6. Modify /etc/rsyslog.conf file - add below template preferably at the beginning / before directives section \n\n\t\t$template vcenter,\"%timestamp% %hostname% %msg%\\ n\" \n\n **Note - There is no space between slash(\\\\) and character 'n' in above command.**\n\n 7. Create a custom conf file in /etc/rsyslog.d/ for example 10-vcenter.conf and add following filter conditions.\n\nDownload config file [10-vCenter.conf](https://aka.ms/sentinel-vcenter-conf)\n\n\t With an added statement you will need to create a filter which will specify the logs coming from the vcenter server to be forwarded to the custom table.\n\n\t reference: [Filter Conditions  rsyslog 8.18.0.master documentation](https://rsyslog.readthedocs.io/en/latest/configuration/filters.html)\n\n\t Here is an example of filtering that can be defined, this is not complete and will require additional testing for each installation.\n\t\t if $rawmsg contains \"vcenter-server\" then @@127.0.0.1:22033;vcenter\n\t\t & stop \n\t\t if $rawmsg contains \"vpxd\" then @@127.0.0.1:22033;vcenter\n\t\t & stop\n\t\t \n8. Restart rsyslog\n\t\t systemctl restart rsyslog",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "3. Configure and connect the vCenter device(s)",
        "description": "[Follow these instructions](https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.monitoring.doc/GUID-9633A961-A5C3-4658-B099-B81E0512DC21.html) to configure the vCenter to forward syslog. Use the IP address or hostname for the Linux device with the Linux agent installed as the Destination IP address."
      }
    ],
    "metadata": {
      "id": "VMwarevCenter",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "solution",
        "name": "VMware vCenter"
      },
      "author": {
        "name": "Microsoft"
      },
      "support": {
        "tier": "microsoft",
        "name": "Microsoft",
        "email": "support@microsoft.com"
      }
    }
  },
  {
    "id": "Votiro",
    "title": "[Deprecated] Votiro Sanitization Engine Logs",
    "publisher": "Votiro",
    "descriptionMarkdown": "The Votiro data connector allows you to easily connect your Votiro Event logs with Microsoft Sentinel, to view dashboards, create custom alerts, and improve investigation.  Using Votiro on Microsoft Sentinel will provide you more insights into the sanitization results of files.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Votiro",
        "baseQuery": "\nCommonSecurityLog\n| where DeviceVendor == \"Votiro\" and DeviceProduct == \"Votiro cloud\"\n"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Votiro Events sorted by Time Generated",
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"Votiro\" and DeviceProduct == \"Votiro cloud\"\n\n | sort by TimeGenerated"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (Votiro)",
        "lastDataReceivedQuery": "CommonSecurityLog\n| where DeviceVendor == \"Votiro\" and DeviceProduct == \"Votiro cloud\"\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n| where DeviceVendor == \"Votiro\" and DeviceProduct == \"Votiro cloud\"\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(3d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Common Event Format (CEF) logs to Syslog agent",
        "description": "Set Votiro Endpoints to send Syslog messages in CEF format to the Forwarder machine. Make sure you to send the logs to port 514 TCP on the Forwarder machine's IP address."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget  -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "89c629ae-9c83-447e-b84d-55eb52ff06da",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community",
        "name": "Votiro"
      },
      "author": {
        "name": "Votiro"
      },
      "support": {
        "tier": "developer",
        "name": "Votiro",
        "email": "support@votiro.com",
        "link": "https://support.votiro.com/"
      }
    }
  },
  {
    "id": "WAF",
    "title": "Azure Web Application Firewall (WAF)",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Connect to the Azure Web Application Firewall (WAF) for Application Gateway, Front Door, or CDN. This WAF protects your applications from common web vulnerabilities such as SQL injection and cross-site scripting, and lets you customize rules to reduce false positives. Follow these instructions to stream your Microsoft Web application firewall logs into Microsoft Sentinel. For more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2223546&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "logo": "MicrosoftWebApplication.svg",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Application Gateways",
        "baseQuery": "AzureDiagnostics | where ResourceType == \"APPLICATIONGATEWAYS\""
      },
      {
        "metricName": "Total data received",
        "legend": "FrontDoors",
        "baseQuery": "AzureDiagnostics | where ResourceType == \"FRONTDOORS\""
      },
      {
        "metricName": "Total data received",
        "legend": "CDN",
        "baseQuery": "AzureDiagnostics | where ResourceType == \"CDNWEBAPPLICATIONFIREWALLPOLICIES\""
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "AzureDiagnostics | where ResourceType == \"APPLICATIONGATEWAYS\" or ResourceType == \"FRONTDOORS\" or ResourceType == \"CDNWEBAPPLICATIONFIREWALLPOLICIES\"\n            | sort by TimeGenerated"
      },
      {
        "description": "Blocked actions",
        "query": "AzureDiagnostics | where ResourceType == \"APPLICATIONGATEWAYS\" or ResourceType == \"FRONTDOORS\" or ResourceType == \"CDNWEBAPPLICATIONFIREWALLPOLICIES\"\n            | where OperationName == \"ApplicationGatewayFirewall\"| where action_s == \"Blocked\"\n            | sort by TimeGenerated"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "AzureDiagnostics | where ResourceType == \"APPLICATIONGATEWAYS\"\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AzureDiagnostics | where ResourceType == \"FRONTDOORS\"\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)",
          "AzureDiagnostics | where ResourceType == \"CDNWEBAPPLICATIONFIREWALLPOLICIES\"\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "AzureDiagnostics (Application Gateways)",
        "lastDataReceivedQuery": "AzureDiagnostics | where ResourceType == \"APPLICATIONGATEWAYS\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "AzureDiagnostics (FrontDoors)",
        "lastDataReceivedQuery": "AzureDiagnostics | where ResourceType == \"FRONTDOORS\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "AzureDiagnostics (CDN)",
        "lastDataReceivedQuery": "AzureDiagnostics | where ResourceType == \"CDNWEBAPPLICATIONFIREWALLPOLICIES\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Connect Azure WAF to Microsoft Sentinel",
        "description": "Go to each WAF resource type and choose your WAF.",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenWaf"
            },
            "type": "InstallAgent"
          },
          {
            "parameters": {
              "linkType": "OpenFrontDoors"
            },
            "type": "InstallAgent"
          },
          {
            "parameters": {
              "linkType": "OpenCdnProfile"
            },
            "type": "InstallAgent"
          }
        ]
      },
      {
        "title": "",
        "description": "Inside your WAF resource:\n\n1.  Select **Diagnostic logs.**\n2.  Select **+ Add diagnostic setting.**\n3.  In the **Diagnostic setting** blade:\n    -   Type a **Name**.\n    -   Select **Send to Log Analytics**.\n    -   Choose the log destination workspace.\n    -   Select the categories that you want to analyze (recommended: ApplicationGatewayAccessLog, ApplicationGatewayFirewallLog, FrontdoorAccessLog, FrontdoorWebApplicationFirewallLog, WebApplicationFirewallLogs).\n    -   Click **Save**."
      }
    ]
  },
  {
    "id": "WatchguardFirebox",
    "title": "[Deprecated] WatchGuard Firebox",
    "publisher": "WatchGuard Technologies",
    "descriptionMarkdown": "WatchGuard Firebox (https://www.watchguard.com/wgrd-products/firewall-appliances and https://www.watchguard.com/wgrd-products/cloud-and-virtual-firewalls) is security products/firewall-appliances. Watchguard Firebox will send syslog to Watchguard Firebox collector agent.The agent then sends the message to the workspace.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "WatchGuardFirebox",
        "baseQuery": "WatchGuardFirebox"
      }
    ],
    "sampleQueries": [
      {
        "description": "Top 10 Fireboxes in last 24 hours",
        "query": "WatchGuardFirebox\n | where TimeGenerated >= ago(24h)\n| summarize count() by HostName\n| top 10 by count_ desc"
      },
      {
        "description": "Firebox Named WatchGuard-XTM top 10 messages in last 24 hours",
        "query": "WatchGuardFirebox\n | where HostName contains 'WatchGuard-XTM'\n| where TimeGenerated >= ago(24h)\n| summarize count() by MessageId\n| top 10 by count_ desc"
      },
      {
        "description": "Firebox Named WatchGuard-XTM top 10 applications in last 24 hours",
        "query": "WatchGuardFirebox\n | where HostName contains 'WatchGuard-XTM'\n| where TimeGenerated >= ago(24h)\n| summarize count() by Application\n| top 10 by count_ desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Syslog (WatchGuardFirebox)",
        "lastDataReceivedQuery": "WatchGuardFirebox\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "WatchGuardFirebox\n  |where TimeGenerated > ago(3d)\n    |take 1\n   | project IsConnected = true"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "write permission is required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "delete": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias WatchGuardFirebox and load the function code or click [here](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Watchguard%20Firebox/Parsers/WatchGuardFirebox.txt) on the second line of the query, enter the hostname(s) of your WatchGuard Firebox device(s) and any other unique identifiers for the logstream. The function usually takes 10-15 minutes to activate after solution installation/update.",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux",
        "description": "Typically, you should install the agent on a different computer from the one on which the logs are generated.\n\n>  Syslog logs are collected only from **Linux** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Configure the facilities you want to collect and their severities.\n\n1.  Under workspace advanced settings **Configuration**, select **Data** and then **Syslog**.\n2.  Select **Apply below configuration to my machines** and select the facilities and severities.\n3.  Click **Save**.",
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenSyslogSettings"
            },
            "type": "InstallAgent"
          }
        ]
      }
    ],
    "metadata": {
      "id": "47835227-715b-4000-892e-e1fff81023c0",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "WatchGuard"
      },
      "support": {
        "name": "WatchGuard",
        "link": "https://www.watchguard.com/wgrd-support/overview",
        "tier": "developer"
      }
    }
  },
  {
    "id": "WindowsFirewall",
    "title": "Windows Firewall",
    "publisher": "Microsoft",
    "logo": {
      "type": 258,
      "options": null
    },
    "descriptionMarkdown": "Windows Firewall is a Microsoft Windows application that filters information coming to your system from the Internet and blocking potentially harmful programs. The software blocks most programs from communicating through the firewall. Users simply add a program to the list of allowed programs to allow it to communicate through the firewall. When using a public network, Windows Firewall can also secure the system by blocking all unsolicited attempts to connect to your computer. For more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2219791&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "AzureDiagnostics",
        "baseQuery": "WindowsFirewall"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "WindowsFirewall\n            | sort by TimeGenerated"
      },
      {
        "description": "Summarize by Firewall actions",
        "query": "WindowsFirewall\n            | summarize count() by FirewallAction"
      }
    ],
    "dataTypes": [
      {
        "name": "WindowsFirewall",
        "lastDataReceivedQuery": "WindowsFirewall\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "OmsSolutions",
        "value": [
          "WindowsFirewall"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/solutions",
          "permissionsDisplayText": "[read and write permissions](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles#log-analytics-contributor).",
          "providerDisplayName": "Solutions",
          "scope": "ResourceGroup",
          "requiredPermissions": {
            "read": true,
            "write": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Download and install the agent",
        "description": ">  Windows Firewall logs are collected only from **Windows** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Windows Virtual Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on non-Azure Windows Machine",
                  "description": "Select the machine to install the agent and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Install Windows Firewall solution",
        "instructions": [
          {
            "parameters": {
              "solutionName": "WindowsFirewall"
            },
            "type": "OmsSolutions"
          }
        ]
      }
    ]
  },
  {
    "id": "WindowsFirewallAma",
    "title": "Windows Firewall Events via AMA",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Windows Firewall is a Microsoft Windows application that filters information coming to your system from the internet and blocking potentially harmful programs. The firewall software blocks most programs from communicating through the firewall. To stream your Windows Firewall application logs collected from your machines, use the Azure Monitor agent (AMA) to stream those logs to the Microsoft Sentinel workspace.\n\nA configured data collection endpoint (DCE) is required to be linked with the data collection rule (DCR) created for the AMA to collect logs. For this connector, a DCE is automatically created in the same region as the workspace. If you already use a DCE stored in the same region, it's possible to change the default created DCE and use your existing one through the API. DCEs can be located in your resources with **SentinelDCE** prefix in the resource name.\n\nFor more information, see the following articles:\n- [Data collection endpoints in Azure Monitor](https://learn.microsoft.com/azure/azure-monitor/essentials/data-collection-endpoint-overview?tabs=portal)\n- [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2228623&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci)",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ASimNetworkSessionLogs",
        "baseQuery": "ASimNetworkSessionLogs\n| where EventProduct == \"Windows Firewall\""
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "ASimNetworkSessionLogs\n| where EventProduct == \"Windows Firewall\"\n            | sort by TimeGenerated"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "ASimNetworkSessionLogs",
        "value": null
      }
    ],
    "dataTypes": [
      {
        "name": "ASimNetworkSessionLogs",
        "lastDataReceivedQuery": "ASimNetworkSessionLogs\n| where EventProduct == \"Windows Firewall\"\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces/datasources",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace data sources",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Enable data collection rule",
        "description": "> Windows Firewall events are collected only from Windows agents.",
        "instructions": [
          {
            "type": "WindowsFirewallAma"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenCreateDataCollectionRule",
              "dataCollectionRuleType": 5
            },
            "type": "InstallAgent"
          }
        ]
      }
    ]
  },
  {
    "id": "WindowsForwardedEvents",
    "title": "Windows Forwarded Events",
    "publisher": "Microsoft",
    "descriptionMarkdown": "You can stream all Windows Event Forwarding (WEF) logs from the Windows Servers connected to your Microsoft Sentinel workspace using Azure Monitor Agent (AMA).\n\tThis connection enables you to view dashboards, create custom alerts, and improve investigation.\n\tThis gives you more insight into your organizations network and improves your security operation capabilities. For more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2219963&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "WindowsEvents",
        "baseQuery": "WindowsEvent"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "WindowsEvent\n            | sort by TimeGenerated"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "WindowsForwardedEvents",
        "value": null
      }
    ],
    "dataTypes": [
      {
        "name": "WindowsEvents",
        "lastDataReceivedQuery": "WindowsEvent\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 2,
      "isPreview": false,
      "featureFlag": {
        "feature": "WindowsForwardedEventsFeature",
        "featureStates": {
          "1": 2,
          "2": 2,
          "3": 2,
          "4": 2,
          "5": 2
        }
      }
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces/datasources",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace data sources",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Enable data collection rule",
        "description": ">  Windows Forwarded Events logs are collected only from **Windows** agents.",
        "instructions": [
          {
            "type": "WindowsForwardedEvents"
          },
          {
            "parameters": {
              "linkType": "OpenCreateDataCollectionRule",
              "dataCollectionRuleType": 1
            },
            "type": "InstallAgent"
          },
          {
            "parameters": {
              "linkType": "OpenCustomDeploymentBlade",
              "dataCollectionRuleType": 1
            },
            "type": "InstallAgent"
          }
        ]
      }
    ]
  },
  {
    "id": "WindowsSecurityEvents",
    "title": "Windows Security Events via AMA",
    "publisher": "Microsoft",
    "descriptionMarkdown": "You can stream all security events from the Windows machines connected to your Microsoft Sentinel workspace using the Windows agent. This connection enables you to view dashboards, create custom alerts, and improve investigation. This gives you more insight into your organizations network and improves your security operation capabilities. For more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2220225&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "SecurityEvents",
        "baseQuery": "SecurityEvent"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "SecurityEvent\n            | sort by TimeGenerated"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "WindowsSecurityEvents",
        "value": null
      }
    ],
    "dataTypes": [
      {
        "name": "SecurityEvents",
        "lastDataReceivedQuery": "SecurityEvent\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 2,
      "featureFlag": {
        "feature": "WindowsSecurityEventsFeature",
        "featureStates": {
          "1": 2,
          "2": 2,
          "3": 2,
          "4": 2,
          "5": 2,
          "6": 1,
          "7": 1
        }
      }
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces/datasources",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace data sources",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Enable data collection rule",
        "description": ">  Security Events logs are collected only from **Windows** agents.",
        "instructions": [
          {
            "type": "WindowsSecurityEvents"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "linkType": "OpenCreateDataCollectionRule",
              "dataCollectionRuleType": 0
            },
            "type": "InstallAgent"
          }
        ]
      }
    ]
  },
  {
    "id": "WireX_Systems_NFP",
    "title": "[Deprecated] WireX Network Forensics Platform via Legacy Agent",
    "publisher": "WireX_Systems",
    "descriptionMarkdown": "The WireX Systems data connector allows security professional to integrate with Microsoft Sentinel to allow you to further enrich your forensics investigations; to not only encompass the contextual content offered by WireX but to analyze data from other sources, and to create custom dashboards to give the most complete picture during a forensic investigation and to create custom workflows.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "WireXNFPevents",
        "baseQuery": "\nCommonSecurityLog\n| where DeviceVendor == \"WireX\"\n| where DeviceProduct == \"WireX NFP\"\n"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Imported Events from WireX",
        "query": "CommonSecurityLog | where DeviceVendor == \"WireX\"\n"
      },
      {
        "description": "Imported DNS Events from WireX",
        "query": "CommonSecurityLog| where DeviceVendor == \"WireX\"\n and ApplicationProtocol == \"DNS\"\n"
      },
      {
        "description": "Imported DNS Events from WireX",
        "query": "CommonSecurityLog| where DeviceVendor == \"WireX\"\n and ApplicationProtocol == \"HTTP\"\n"
      },
      {
        "description": "Imported DNS Events from WireX",
        "query": "CommonSecurityLog| where DeviceVendor == \"WireX\"\n and ApplicationProtocol == \"TDS\"\n"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (WireXNFPevents)",
        "lastDataReceivedQuery": "\nCommonSecurityLog\n| where DeviceVendor == \"WireX\"\n| where DeviceProduct == \"WireX NFP\"\n\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "\nCommonSecurityLog\n| where DeviceVendor == \"WireX\"\n| where DeviceProduct == \"WireX NFP\"\n\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Common Event Format (CEF) logs to Syslog agent",
        "description": "Contact WireX support (https://wirexsystems.com/contact-us/) in order to configure your NFP solution to send Syslog messages in CEF format to the proxy machine. Make sure that they central manager can send the logs to port 514 TCP on the machine's IP address."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "4c0776c2-a5dc-419d-8cf7-81c2484448d2",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "WireX Systems"
      },
      "support": {
        "name": "WireX Systems",
        "email": "support@wirexsystems.com",
        "tier": "developer"
      }
    }
  },
  {
    "id": "WireX_Systems_NFPAma",
    "title": "[Deprecated] WireX Network Forensics Platform via AMA",
    "publisher": "WireX_Systems",
    "descriptionMarkdown": "The WireX Systems data connector allows security professional to integrate with Microsoft Sentinel to allow you to further enrich your forensics investigations; to not only encompass the contextual content offered by WireX but to analyze data from other sources, and to create custom dashboards to give the most complete picture during a forensic investigation and to create custom workflows.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "WireXNFPevents",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'WireX'\n |where DeviceProduct=~'WireX NFP'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "description": "All Imported Events from WireX",
        "query": "CommonSecurityLog | where DeviceVendor == \"WireX\"\n"
      },
      {
        "description": "Imported DNS Events from WireX",
        "query": "CommonSecurityLog| where DeviceVendor == \"WireX\"\n and ApplicationProtocol == \"DNS\"\n"
      },
      {
        "description": "Imported DNS Events from WireX",
        "query": "CommonSecurityLog| where DeviceVendor == \"WireX\"\n and ApplicationProtocol == \"HTTP\"\n"
      },
      {
        "description": "Imported DNS Events from WireX",
        "query": "CommonSecurityLog| where DeviceVendor == \"WireX\"\n and ApplicationProtocol == \"TDS\"\n"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (WireXNFPevents)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'WireX'\n |where DeviceProduct=~'WireX NFP'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'WireX'\n |where DeviceProduct=~'WireX NFP'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine"
                },
                {
                  "title": "Step B. Forward Common Event Format (CEF) logs to Syslog agent",
                  "description": "Contact WireX support (https://wirexsystems.com/contact-us/) in order to configure your NFP solution to send Syslog messages in CEF format to the proxy machine. Make sure that they central manager can send the logs to port 514 TCP on the machine's IP address."
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "4c0776c2-a5dc-419d-8cf7-81c2484448d2",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "WireX Systems"
      },
      "support": {
        "name": "WireX Systems",
        "email": "support@wirexsystems.com",
        "tier": "developer"
      }
    }
  },
  {
    "id": "WithSecureElementsViaConnector",
    "title": "[Deprecated] WithSecure Elements via Connector",
    "publisher": "WithSecure",
    "descriptionMarkdown": "WithSecure Elements is a unified cloud-based cyber security platform.\nBy connecting WithSecure Elements via Connector to Microsoft Sentinel, security events can be received in Common Event Format (CEF) over syslog.\nIt requires deploying \"Elements Connector\" either on-prem or in cloud.\nThe Common Event Format (CEF) provides natively search & correlation, alerting and threat intelligence enrichment for each data log.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "WITH_SECURE_ELEMENTS_CONNECTOR",
        "baseQuery": "CommonSecurityLog\n| where DeviceVendor == \"WithSecure\""
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "CommonSecurityLog\n| where DeviceVendor == \"WithSecure\"\n| sort by TimeGenerated"
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (WithSecure Events)",
        "lastDataReceivedQuery": "CommonSecurityLog\n| where DeviceVendor == \"WithSecure\"\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n| where DeviceVendor == \"WithSecure\"\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your WithSecurity solution and Sentinel. The machine can be on-prem environment, Microsoft Azure or other cloud based.\n> Linux needs to have `syslog-ng` and `python`/`python3` installed."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python -version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              },
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "For python3 use command below:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python3 cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward data from WithSecure Elements Connector to Syslog agent",
        "description": "This describes how to install and configure Elements Connector step by step.",
        "innerSteps": [
          {
            "title": "2.1 Order Connector subscription",
            "description": "If Connector subscription has not been ordered yet go to EPP in Elements Portal. Then navigate to Downloads and in Elements Connector section click 'Create subscription key' button. You can check Your subscription key in Subscriptions."
          },
          {
            "title": "2.2 Download Connector",
            "description": "Go to Downloads and in WithSecure Elements Connector section select correct installer."
          },
          {
            "title": "2.3 Create management API key",
            "description": "When in EPP open account settings in top right corner. Then select Get management API key. If key has been created earlier it can be read there as well."
          },
          {
            "title": "2.4 Install Connector",
            "description": "To install Elements Connector follow [Elements Connector Docs](https://www.withsecure.com/userguides/product.html#business/connector/latest/en/)."
          },
          {
            "title": "2.5 Configure event forwarding",
            "description": "If api access has not been configured during installation follow [Configuring API access for Elements Connector](https://www.withsecure.com/userguides/product.html#business/connector/latest/en/task_F657F4D0F2144CD5913EE510E155E234-latest-en).\nThen go to EPP, then Profiles, then use For Connector from where you can see the connector profiles. Create a new profile (or edit an existing not read-only profile). In Event forwarding enable it. SIEM system address: **127.0.0.1:514**. Set format to **Common Event Format**. Protocol is **TCP**. Save profile and assign it to Elements Connector in Devices tab."
          }
        ]
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python -version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py {0}"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "For python3 use command below:",
              "value": "sudo wget -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python3 cef_troubleshoot.py {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "2687fa7e-95f4-442d-bd41-8da4d634b0cb",
      "version": "1.0.1",
      "kind": "dataConnector",
      "author": {
        "name": "WithSecure"
      },
      "support": {
        "tier": "developer",
        "name": "WithSecure",
        "link": "https://www.withsecure.com/en/support"
      }
    }
  },
  {
    "id": "WithSecureElementsViaFunction",
    "title": "WithSecure Elements API (Azure Function)",
    "publisher": "WithSecure",
    "descriptionMarkdown": "WithSecure Elements is the unified cloud-based cyber security platform designed to reduce risk, complexity, and inefficiency.\n\nElevate your security from your endpoints to your cloud applications. Arm yourself against every type of cyber threat, from targeted attacks to zero-day ransomware.\n\nWithSecure Elements combines powerful predictive, preventive, and responsive security capabilities - all managed and monitored through a single security center. Our modular structure and flexible pricing models give you the freedom to evolve. With our expertise and insight, you'll always be empowered - and you'll never be alone.\n\nWith Microsoft Sentinel integration, you can correlate [security events](https://connect.withsecure.com/api-reference/security-events#overview) data from the WithSecure Elements solution with data from other sources, enabling a rich overview of your entire environment and faster reaction to threats.\n\nWith this solution Azure Function is deployed to your tenant, polling periodically for the WithSecure Elements security events.\n\nFor more information visit our website at: [https://www.withsecure.com](https://www.withsecure.com).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "WITH_SECURE_ELEMENTS_CONNECTOR",
        "baseQuery": "WsSecurityEvents_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "WsSecurityEvents_CL\n| sort by TimeGenerated"
      }
    ],
    "dataTypes": [
      {
        "name": "WsSecurityEvents_CL (WithSecure Events)",
        "lastDataReceivedQuery": "WsSecurityEvents_CL\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "WsSecurityEvents_CL\n| summarize LastLogReceived = max(TimeGenerated)\n| project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "WithSecure Elements API client credentials",
          "description": "Client credentials are required. [See the documentation to learn more.](https://connect.withsecure.com/getting-started/elements#getting-client-credentials)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Create WithSecure Elements API credentials",
        "description": "Follow the [user guide](https://connect.withsecure.com/getting-started/elements#getting-client-credentials) to create Elements API credentials. Save credentials in a safe place."
      },
      {
        "title": "2. Create Microsoft Entra application",
        "description": "Create new Microsoft Entra application and credentials. Follow [the instructions](https://learn.microsoft.com/en-us/azure/azure-monitor/logs/tutorial-logs-ingestion-portal#create-microsoft-entra-application) and store values of **Directory (tenant) ID**, **Object ID**, **Application (client) ID** and **Client Secret** (from client credentials field). Remember to store Client Secret in a safe place."
      },
      {
        "title": "3. Deploy Function App",
        "description": ">**NOTE:** This connector uses Azure Functions to pull logs from WithSecure Elements. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store Microsoft Entra client credentials and WithSecure Elements API client credentials in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": ">**IMPORTANT:** Before deploying the WithSecure Elements connector, have the Workspace Name (can be copied from the following), data from Microsoft Entra (Directory (tenant) ID, Object ID, Application (client) ID and Client Secret), as well as the WithSecure Elements client credentials, readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "workspaceName"
              ],
              "label": "Workspace Name"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Deploy all the resources related to the connector",
        "description": "1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-WithSecureElementsViaFunction-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the **Workspace ID**, **Entra Client ID**, **Entra Client Secret**, **Entra Tenant ID**, **Elements API Client ID**, **Elements API Client Secret**.\n>Note: If using Azure Key Vault secrets for any of the values above, use the`@Microsoft.KeyVault(SecretUri={Security Identifier})`schema in place of the string values. Refer to [Key Vault references documentation](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) for further details. \n4. You can also fill in optional fields: **Elements API url**, **Engine**, **Engine Group**. Use default value of **Elements API url** unless you have some special case. **Engine** and **Engine Group** map to [security events request parameters](https://connect.withsecure.com/api-reference/elements#post-/security-events/v1/security-events), fill in those parameters if you are interested only in events from specific engine or engine group, in case you want to receive all security events leave the fields with default values.\n5. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n6. Click **Purchase** to deploy."
      }
    ],
    "metadata": {
      "id": "Unique Identifier (GUID) used to identify dependencies and content from solutions or community.",
      "version": "1.0.0",
      "kind": "dataConnector",
      "author": {
        "name": "WithSecure"
      },
      "support": {
        "tier": "developer",
        "name": "WithSecure",
        "link": "https://www.withsecure.com/en/support"
      }
    }
  },
  {
    "id": "Wiz",
    "title": "Wiz",
    "publisher": "Wiz",
    "descriptionMarkdown": "The Wiz connector allows you to easily send Wiz Issues, Vulnerability Findings, and Audit logs to Microsoft Sentinel.",
    "logo": "Wiz.svg",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "WizIssues",
        "baseQuery": "union isfuzzy=true \n(WizIssues_CL),\n(WizIssuesV2_CL)"
      },
      {
        "metricName": "Total data received",
        "legend": "WizVulnerabilities",
        "baseQuery": "union isfuzzy=true \n(WizVulnerabilities_CL),\n(WizVulnerabilitiesV2_CL)"
      },
      {
        "metricName": "Total data received",
        "legend": "WizAuditLogs",
        "baseQuery": "union isfuzzy=true \n(WizAuditLogs_CL),\n(WizAuditLogsV2_CL)"
      }
    ],
    "sampleQueries": [
      {
        "description": "Summary by Issues's severity",
        "query": "union isfuzzy=true \n(WizIssues_CL),\n(WizIssuesV2_CL)\n       | summarize Count=count() by severity_s"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "union isfuzzy=true \n(WizIssues_CL),\n(WizIssuesV2_CL)\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "union isfuzzy=true \n(WizVulnerabilities_CL),\n(WizVulnerabilitiesV2_CL)\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)",
          "union isfuzzy=true \n(WizAuditLogs_CL),\n(WizAuditLogsV2_CL)\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "WizIssues",
        "lastDataReceivedQuery": "union isfuzzy=true \n(WizIssues_CL),\n(WizIssuesV2_CL)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "WizVulnerabilities",
        "lastDataReceivedQuery": "union isfuzzy=true \n(WizVulnerabilities_CL),\n(WizVulnerabilitiesV2_CL)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "WizAuditLogs",
        "lastDataReceivedQuery": "union isfuzzy=true \n(WizAuditLogs_CL),\n(WizAuditLogsV2_CL)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 2,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Wiz Service Account credentials",
          "description": "Ensure you have your Wiz service account client ID and client secret, API endpoint URL, and auth URL. Instructions can be found on [Wiz documentation](https://docs.wiz.io/wiz-docs/docs/azure-sentinel-native-integration#collect-authentication-info-from-wiz)."
        }
      ]
    },
    "instructionSteps": [
      {
        "description": ">**NOTE:** This connector: Uses Azure Functions to connect to Wiz API to pull Wiz Issues, Vulnerability Findings, and Audit Logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details.\nCreates an Azure Key Vault with all the required parameters stored as secrets."
      },
      {
        "description": "\nFollow the instructions on [Wiz documentation](https://docs.wiz.io/wiz-docs/docs/azure-sentinel-native-integration#collect-authentication-info-from-wiz) to get the erquired credentials.",
        "title": "STEP 1 - Get your Wiz credentials"
      },
      {
        "description": "\n>**IMPORTANT:** Before deploying the Wiz Connector, have the Workspace ID and Workspace Primary Key (can be copied from the following), as well as the Wiz credentials from the previous step.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ],
        "title": "STEP 2 - Deploy the connector and the associated Azure Function"
      },
      {
        "description": "1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-wiz-azuredeploy) \n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the following parameters: \n> - Choose **KeyVaultName** and **FunctionName** for the new resources \n >- Enter the following Wiz credentials from step 1: **WizAuthUrl**, **WizEndpointUrl**, **WizClientId**, and **WizClientSecret** \n>- Enter the Workspace credentials **AzureLogsAnalyticsWorkspaceId** and **AzureLogAnalyticsWorkspaceSharedKey**\n>- Choose the Wiz data types you want to send to Microsoft Sentinel, choose at least one from **Wiz Issues**, **Vulnerability Findings**, and **Audit Logs**.\n \n>- (optional) follow [Wiz documentation](https://docs.wiz.io/wiz-docs/docs/azure-sentinel-native-integration#optional-create-a-filter-for-wiz-queries) to add **IssuesQueryFilter**, **VulnerbailitiesQueryFilter**, and **AuditLogsQueryFilter**.\n \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy.\n",
        "title": "Option 1: Deploy using the Azure Resource Manager (ARM) Template"
      },
      {
        "description": ">Follow [Wiz documentation](https://docs.wiz.io/wiz-docs/docs/azure-sentinel-native-integration#manual-deployment) to deploy the connector manually.",
        "title": "Option 2: Manual Deployment of the Azure Function"
      }
    ]
  },
  {
    "id": "WorkdayCCPDefinition",
    "title": "Workday User Activity",
    "publisher": "Microsoft",
    "descriptionMarkdown": "The [Workday](https://www.workday.com/) User Activity data connector provides the capability to ingest User Activity Logs from [Workday API](https://community.workday.com/sites/default/files/file-hosting/restapi/index.html#privacy/v1/get-/activityLogging) into Microsoft Sentinel.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Workday User Activity logs",
        "baseQuery": "{{graphQueriesTableName}}\n| where EventProduct == \"Workday\""
      }
    ],
    "sampleQueries": [
      {
        "description": "Get a sample of Workday User Activity logs",
        "query": "{{graphQueriesTableName}}\n | where EventProduct == \"Workday\" | take 10"
      }
    ],
    "dataTypes": [
      {
        "name": "{{graphQueriesTableName}}",
        "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | where EventProduct == \"Workday\" |summarize Time = max  (TimeGenerated)\n|where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "WorkplaceFacebook",
    "title": "Workplace from Facebook",
    "publisher": "Facebook",
    "descriptionMarkdown": "The [Workplace](https://www.workplace.com/) data connector provides the capability to ingest common Workplace events into Microsoft Sentinel through Webhooks. Webhooks enable custom integration apps to subscribe to events in Workplace and receive updates in real time. When a change occurs in Workplace, an HTTPS POST request with event information is sent to a callback data connector URL.  Refer to [Webhooks documentation](https://developers.facebook.com/docs/workplace/reference/webhooks) for more information. The connector provides ability to get events which helps to examine potential security risks, analyze your team's use of collaboration, diagnose configuration problems and more.",
    "additionalRequirementBanner": "These queries are dependent on a parser based on a Kusto Function deployed as part of the solution.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Workplace_Facebook_CL",
        "baseQuery": "Workplace_Facebook_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Workplace Events - All Activities.",
        "query": "Workplace_Facebook_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Workplace_Facebook_CL",
        "lastDataReceivedQuery": "Workplace_Facebook_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Workplace_Facebook_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "Webhooks Credentials/permissions",
          "description": "WorkplaceAppSecret, WorkplaceVerifyToken, Callback URL are required for working Webhooks. See the documentation to learn more about [configuring Webhooks](https://developers.facebook.com/docs/workplace/reference/webhooks), [configuring permissions](https://developers.facebook.com/docs/workplace/reference/permissions). "
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector uses Azure Functions based on HTTP Trigger for waiting POST requests with logs to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Functions App."
      },
      {
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias WorkplaceFacebook and load the function code or click [here](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Workplace%20from%20Facebook/Parsers/Workplace_Facebook.txt) on the second line of the query, enter the hostname(s) of your Workplace Facebook device(s) and any other unique identifiers for the logstream. The function usually takes 10-15 minutes to activate after solution installation/update."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the Workplace**\n\n Follow the instructions to configure Webhooks.\n\n1. Log in to the Workplace with Admin user credentials.\n2. In the Admin panel, click **Integrations**.\n3. In the **All integrations** view, click **Create custom integration**\n4. Enter the name and description and click **Create**.\n5. In the **Integration details** panel show **App secret** and copy.\n6. In the **Integration permissions** pannel set all read permissions. Refer to [permission page](https://developers.facebook.com/docs/workplace/reference/permissions) for details.\n7. Now proceed to STEP 2 to follow the steps (listed in Option 1 or 2) to Deploy the Azure Function.\n8. Enter the requested parameters and also enter a Token of choice. Copy this Token / Note it for the upcoming step.\n9. After the deployment of Azure Functions completes successfully, open Function App page, select your app, go to **Functions**, click **Get Function URL** and copy this / Note it for the upcoming step.\n10. Go back to Workplace from Facebook. In the **Configure webhooks** panel on each Tab set **Callback URL** as the same value that you copied in point 9 above and Verify token as the same\n value you copied in point 8 above which was obtained during STEP 2 of Azure Functions deployment.\n11. Click Save."
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Functions**\n\n>**IMPORTANT:** Before deploying the Workplace data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following).",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Option 1 - Azure Resource Manager (ARM) Template",
                  "description": "Use this method for automated deployment of the Workplace data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-WorkplaceFacebook-azuredeploy) [![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://aka.ms/sentinel-WorkplaceFacebook-azuredeploy-gov)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n> **NOTE:** Within the same resource group, you can't mix Windows and Linux apps in the same region. Select existing resource group without Windows apps in it or create new resource group.\n3. Enter the **WorkplaceVerifyToken** (can be any expression, copy and save it for STEP 1), **WorkplaceAppSecret** and deploy. \n4. Mark the checkbox labeled **I agree to the terms and conditions stated above**. \n5. Click **Purchase** to deploy.\n6. After deploying open Function App page, select your app, go to the **Functions** and click **Get Function Url** copy it and follow p.7 from STEP 1."
                },
                {
                  "title": "Option 2 - Manual Deployment of Azure Functions",
                  "description": "Use the following step-by-step instructions to deploy the Sophos Endpoint Protection data connector manually with Azure Functions (Deployment via Visual Studio Code).",
                  "instructions": [
                    {
                      "parameters": {
                        "instructionSteps": [
                          {
                            "title": "Step 1 - Deploy a Function App",
                            "description": "**NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-WorkplaceFacebook-functionapp) file. Extract archive to your local development computer.\n2. Follow the [function app manual deployment instructions](https://github.com/Azure/Azure-Sentinel/blob/master/DataConnectors/AzureFunctionsManualDeployment.md#function-app-manual-deployment-instructions) to deploy the Azure Functions app using VSCode.\n3. After successful deployment of the function app, follow next steps for configuring it."
                          },
                          {
                            "title": "Step 2 - Configure the Function App",
                            "description": "1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select ** New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tWorkplaceAppSecret\n\t\tWorkplaceVerifyToken\n\t\tWorkspaceID\n\t\tWorkspaceKey\n\t\tlogAnalyticsUri (optional)\n> - Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n4. Once all application settings have been entered, click **Save**."
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "ZeroFoxAlertsDefinition",
    "title": "ZeroFox Enterprise - Alerts (Polling CCF)",
    "publisher": "ZeroFox Enterprise",
    "descriptionMarkdown": "Collects alerts from ZeroFox API.",
    "graphQueries": [
      {
        "metricName": "Total alerts received",
        "legend": "ZeroFox Alerts",
        "baseQuery": "ZeroFoxAlertPoller_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "List all ZeroFox alerts",
        "query": "ZeroFoxAlertPoller_CL\n| sort by TimeGenerated asc"
      },
      {
        "description": "Count alerts by network type",
        "query": "ZeroFoxAlertPoller_CL\n| summarize Count = count() by ThreatSource=network_s"
      },
      {
        "description": "Count alerts by entity",
        "query": "ZeroFoxAlertPoller_CL\n| summarize Count = count() by Entity=entity_name_s"
      }
    ],
    "dataTypes": [
      {
        "name": "ZeroFoxAlertPoller_CL",
        "lastDataReceivedQuery": "ZeroFoxAlertPoller_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": null,
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "metadata": null
  },
  {
    "id": "ZeroFoxCTIDataConnector",
    "title": "ZeroFox CTI",
    "publisher": "ZeroFox",
    "descriptionMarkdown": "The ZeroFox CTI data connectors provide the capability to ingest the different [ZeroFox](https://www.zerofox.com/threat-intelligence/) cyber threat intelligence alerts into Microsoft Sentinel.",
    "graphQueries": [
      {
        "metricName": "ZeroFox CTI Advanced Dark Web Logs",
        "legend": "ZeroFox_CTI_advanced_dark_web_CL",
        "baseQuery": "ZeroFox_CTI_advanced_dark_web_CL"
      },
      {
        "metricName": "ZeroFox CTI Botnet Logs",
        "baseQuery": "ZeroFox_CTI_botnet_CL"
      },
      {
        "metricName": "ZeroFox CTI Breaches Logs",
        "legend": "ZeroFox_CTI_breaches_CL",
        "baseQuery": "ZeroFox_CTI_breaches_CL"
      },
      {
        "metricName": "ZeroFox CTI C2 Domains Logs",
        "legend": "ZeroFox_CTI_C2_CL",
        "baseQuery": "ZeroFox_CTI_C2_CL"
      },
      {
        "metricName": "ZeroFox CTI Compromised Credentials Logs",
        "legend": "ZeroFox_CTI_compromised_credentials_CL",
        "baseQuery": "ZeroFox_CTI_compromised_credentials_CL"
      },
      {
        "metricName": "ZeroFox CTI Credit Cards Logs",
        "legend": "ZeroFox_CTI_credit_cards_CL",
        "baseQuery": "ZeroFox_CTI_credit_cards_CL"
      },
      {
        "metricName": "ZeroFox CTI Dark Web Logs",
        "legend": "ZeroFox_CTI_dark_web_CL",
        "baseQuery": "ZeroFox_CTI_dark_web_CL"
      },
      {
        "metricName": "ZeroFox CTI Discord Logs",
        "legend": "ZeroFox_CTI_discord_CL",
        "baseQuery": "ZeroFox_CTI_discord_CL"
      },
      {
        "metricName": "ZeroFox CTI Disruption Logs",
        "legend": "ZeroFox_CTI_disruption_CL",
        "baseQuery": "ZeroFox_CTI_disruption_CL"
      },
      {
        "metricName": "ZeroFox CTI Email Addresses Logs",
        "legend": "ZeroFox_CTI_email_addresses_CL",
        "baseQuery": "ZeroFox_CTI_email_addresses_CL"
      },
      {
        "metricName": "ZeroFox CTI Exploits Logs",
        "legend": "ZeroFox_CTI_exploits_CL",
        "baseQuery": "ZeroFox_CTI_exploits_CL"
      },
      {
        "metricName": "ZeroFox CTI IRC Logs",
        "legend": "ZeroFox_CTI_irc_CL",
        "baseQuery": "ZeroFox_CTI_irc_CL"
      },
      {
        "metricName": "ZeroFox CTI Malware Logs",
        "legend": "ZeroFox_CTI_malware_CL",
        "baseQuery": "ZeroFox_CTI_malware_CL"
      },
      {
        "metricName": "ZeroFox CTI National Ids Logs",
        "legend": "ZeroFox_CTI_national_ids_CL",
        "baseQuery": "ZeroFox_CTI_national_ids_CL"
      },
      {
        "metricName": "ZeroFox CTI Phishing Logs",
        "legend": "ZeroFox_CTI_phishing_CL",
        "baseQuery": "ZeroFox_CTI_phishing_CL"
      },
      {
        "metricName": "ZeroFox CTI Phone Numbers Logs",
        "legend": "ZeroFox_CTI_phone_numbers_CL",
        "baseQuery": "ZeroFox_CTI_phone_numbers_CL"
      },
      {
        "metricName": "ZeroFox CTI Ransomware Logs",
        "legend": "ZeroFox_CTI_ransomware_CL",
        "baseQuery": "ZeroFox_CTI_ransomware_CL"
      },
      {
        "metricName": "ZeroFox CTI Telegram Logs",
        "legend": "ZeroFox_CTI_telegram_CL",
        "baseQuery": "ZeroFox_CTI_telegram_CL"
      },
      {
        "metricName": "ZeroFox CTI Threat Actors Logs",
        "legend": "ZeroFox_CTI_threat_actors_CL",
        "baseQuery": "ZeroFox_CTI_threat_actors_CL"
      },
      {
        "metricName": "ZeroFox CTI Vulnerabilities Logs",
        "legend": "ZeroFox_CTI_vulnerabilities_CL",
        "baseQuery": "ZeroFox_CTI_vulnerabilities_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "ZeroFox CTI C2-domains Logs",
        "query": "ZeroFox_CTI_C2_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "ZeroFox CTI Email Addresses Logs",
        "query": "ZeroFox_CTI_email_addresses_CL\n | sort by TimeGenerated desc"
      },
      {
        "description": "ZeroFox CTI Malware Logs",
        "query": "ZeroFox_CTI_malware_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "ZeroFox_CTI_advanced_dark_web_CL",
        "lastDataReceivedQuery": "ZeroFox_CTI_advanced_dark_web_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ZeroFox_CTI_botnet_CL",
        "lastDataReceivedQuery": "ZeroFox_CTI_botnet_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ZeroFox_CTI_breaches_CL",
        "lastDataReceivedQuery": "ZeroFox_CTI_breaches_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ZeroFox_CTI_C2_CL",
        "lastDataReceivedQuery": "ZeroFox_CTI_C2_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ZeroFox_CTI_compromised_credentials_CL",
        "lastDataReceivedQuery": "ZeroFox_CTI_compromised_credentials_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ZeroFox_CTI_credit_cards_CL",
        "lastDataReceivedQuery": "ZeroFox_CTI_credit_cards_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ZeroFox_CTI_dark_web_CL",
        "lastDataReceivedQuery": "ZeroFox_CTI_dark_web_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ZeroFox_CTI_discord_CL",
        "lastDataReceivedQuery": "ZeroFox_CTI_discord_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ZeroFox_CTI_disruption_CL",
        "lastDataReceivedQuery": "ZeroFox_CTI_disruption_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ZeroFox_CTI_email_addresses_CL",
        "lastDataReceivedQuery": "ZeroFox_CTI_email_addresses_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ZeroFox_CTI_exploits_CL",
        "lastDataReceivedQuery": "ZeroFox_CTI_exploits_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ZeroFox_CTI_irc_CL",
        "lastDataReceivedQuery": "ZeroFox_CTI_irc_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ZeroFox_CTI_malware_CL",
        "lastDataReceivedQuery": "ZeroFox_CTI_malware_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ZeroFox_CTI_national_ids_CL",
        "lastDataReceivedQuery": "ZeroFox_CTI_national_ids_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ZeroFox_CTI_phishing_CL",
        "lastDataReceivedQuery": "ZeroFox_CTI_phishing_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ZeroFox_CTI_phone_numbers_CL",
        "lastDataReceivedQuery": "ZeroFox_CTI_phone_numbers_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ZeroFox_CTI_ransomware_CL",
        "lastDataReceivedQuery": "ZeroFox_CTI_ransomware_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ZeroFox_CTI_telegram_CL",
        "lastDataReceivedQuery": "ZeroFox_CTI_telegram_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ZeroFox_CTI_threat_actors_CL",
        "lastDataReceivedQuery": "ZeroFox_CTI_threat_actors_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ZeroFox_CTI_vulnerabilities_CL",
        "lastDataReceivedQuery": "ZeroFox_CTI_vulnerabilities_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ZeroFox_CTI_advanced_dark_web_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)",
          "ZeroFox_CTI_botnet_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)",
          "ZeroFox_CTI_breaches_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)",
          "ZeroFox_CTI_C2_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)",
          "ZeroFox_CTI_compromised_credentials_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)",
          "ZeroFox_CTI_credit_cards_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)",
          "ZeroFox_CTI_dark_web_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)",
          "ZeroFox_CTI_discord_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)",
          "ZeroFox_CTI_disruption_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)",
          "ZeroFox_CTI_email_addresses_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)",
          "ZeroFox_CTI_exploits_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)",
          "ZeroFox_CTI_irc_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)",
          "ZeroFox_CTI_malware_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)",
          "ZeroFox_CTI_national_ids_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)",
          "ZeroFox_CTI_phishing_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)",
          "ZeroFox_CTI_phone_numbers_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)",
          "ZeroFox_CTI_ransomware_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)",
          "ZeroFox_CTI_telegram_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)",
          "ZeroFox_CTI_threat_actors_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)",
          "ZeroFox_CTI_vulnerabilities_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(1d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "ZeroFox API Credentials/permissions",
          "description": "**ZeroFox Username**, **ZeroFox Personal Access Token** are required for ZeroFox CTI REST API."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the ZeroFox CTI REST API to pull logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "title": "",
        "description": "**STEP 1 - Retrieval of ZeroFox credentials:**\n\n Follow these instructions for set up logging and obtain credentials. \n1. [Log into ZeroFox's website.](https://cloud.zerofox.com/login) using your username and password \n2 - Click into the Settings button and go to the Data Connectors Section. \n3 - Select the API DATA FEEDS tab and head to the bottom of the page, select <<Reset>> in the API Information box, to obtain a Personal Access Token to be used along with your username."
      },
      {
        "title": "",
        "description": "**STEP 2 - Deploy the Azure Function data connectors using the Azure Resource Manager template: **\n\n>**IMPORTANT:** Before deploying the ZeroFox CTI data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following), readily available.",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "Preparing resources for deployment.",
        "description": "1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-zerofox-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group**, Log analytics Workspace and **Location**. \n3. Enter the **Workspace ID**, **Workspace Key**, **ZeroFox Username**, **ZeroFox Personal Access Token**\n4.\n5. Click **Review + Create** to deploy."
      }
    ]
  },
  {
    "id": "ZimperiumMtdAlerts",
    "title": "Zimperium Mobile Threat Defense",
    "publisher": "Zimperium",
    "descriptionMarkdown": "Zimperium Mobile Threat Defense connector gives you the ability to connect the Zimperium threat log with Microsoft Sentinel to view dashboards, create custom alerts, and improve investigation. This gives you more insight into your organization's mobile threat landscape and enhances your security operation capabilities.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ZimperiumThreatLog_CL",
        "baseQuery": "ZimperiumThreatLog_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All threats with threat vector equal to Device",
        "query": "ZimperiumThreatLog_CL \n | where threat_vector_s  == \"Device\" \n | limit 100"
      },
      {
        "description": "All threats for devices running iOS",
        "query": "ZimperiumThreatLog_CL \n | where device_os_s == \"ios\" \n | order by event_timestamp_s  desc nulls last"
      },
      {
        "description": "View latest mitigations",
        "query": "ZimperiumMitigationLog_CL \n | order by event_timestamp_s  desc nulls last"
      }
    ],
    "dataTypes": [
      {
        "name": "ZimperiumThreatLog_CL",
        "lastDataReceivedQuery": "ZimperiumThreatLog_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      },
      {
        "name": "ZimperiumMitigationLog_CL",
        "lastDataReceivedQuery": "ZimperiumMitigationLog_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ZimperiumThreatLog_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "Configure and connect Zimperium MTD",
        "description": "1. In zConsole, click **Manage** on the navigation bar.\n2. Click the **Integrations** tab.\n3. Click the **Threat Reporting** button and then the **Add Integrations** button.\n4. Create the Integration:\n  - From the available integrations, select Microsoft Sentinel.\n  - Enter your workspace id and primary key from the fields below, click **Next**.\n  - Fill in a name for your Microsoft Sentinel integration.\n  - Select a Filter Level for the threat data you wish to push to Microsoft Sentinel.\n  - Click **Finish**\n5. For additional instructions, please refer to the [Zimperium customer support portal](https://support.zimperium.com).",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ],
    "metadata": {
      "id": "26bcf619-26b2-44aa-a7ad-212da52deeb8",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Zimperium"
      },
      "support": {
        "name": "Zimperium",
        "link": "https://www.zimperium.com/support",
        "tier": "developer"
      }
    }
  },
  {
    "id": "Zoom",
    "title": "Zoom Reports",
    "publisher": "Zoom",
    "descriptionMarkdown": "The [Zoom](https://zoom.us/) Reports data connector provides the capability to ingest [Zoom Reports](https://developers.zoom.us/docs/api/rest/reference/zoom-api/methods/#tag/Reports) events into Microsoft Sentinel through the REST API. Refer to [API documentation](https://developers.zoom.us/docs/api/) for more information. The connector provides ability to get events which helps to examine potential security risks, analyze your team's use of collaboration, diagnose configuration problems and more.",
    "additionalRequirementBanner": "These queries and workbooks are dependent on a parser based on Kusto to work as expected. Follow the steps to use this Kusto functions alias **Zoom** in queries and workbooks [Follow steps to get this Kusto functions>](https://aka.ms/sentinel-ZoomAPI-parser).",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Zoom_CL",
        "baseQuery": "Zoom_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "Zoom Events - All Activities.",
        "query": "Zoom_CL\n | sort by TimeGenerated desc"
      }
    ],
    "dataTypes": [
      {
        "name": "Zoom_CL",
        "lastDataReceivedQuery": "Zoom_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "Zoom_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": true
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions on the workspace are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "name": "Microsoft.Web/sites permissions",
          "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
        },
        {
          "name": "REST API Credentials/permissions",
          "description": "**AccountID**, **ClientID** and **ClientSecret** are required for Zoom API. [See the documentation to learn more about Zoom API](https://developers.zoom.us/docs/internal-apps/create/). [Follow the instructions for Zoom API configurations](https://aka.ms/sentinel-zoomreports-readme)."
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This connector uses Azure Functions to connect to the Zoom API to pull its logs into Microsoft Sentinel. This might result in additional data ingestion costs. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
      },
      {
        "title": "",
        "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
      },
      {
        "description": "**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected which is deployed as part of the solution. To view the function code in Log Analytics, open Log Analytics/Microsoft Sentinel Logs blade, click Functions and search for the alias Zoom and load the function code or click [here](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/ZoomReports/Parsers/Zoom.yaml). The function usually takes 10-15 minutes to activate after solution installation/update."
      },
      {
        "title": "",
        "description": "**STEP 1 - Configuration steps for the Zoom API**\n\n [Follow the instructions](https://developers.zoom.us/docs/internal-apps/create/) to obtain the credentials. \n"
      },
      {
        "title": "",
        "description": "**STEP 2 - Choose ONE from the following two deployment options to deploy the connector and the associated Azure Function**\n\n>**IMPORTANT:** Before deploying the Zoom Reports data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following).",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          },
          {
            "parameters": {
              "fillWith": [
                "PrimaryKey"
              ],
              "label": "Primary Key"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "instructionSteps": [
                {
                  "title": "Option 1 - Azure Resource Manager (ARM) Template",
                  "description": "Use this method for automated deployment of the Zoom Audit data connector using an ARM Tempate.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-ZoomAPI-azuredeployV2) [![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://aka.ms/sentinel-ZoomAPI-azuredeployV2-gov)\n2. Select the preferred **Subscription**, **Resource Group** and **Region**. \n> **NOTE:** Within the same resource group, you can't mix Windows and Linux apps in the same region. Select existing resource group without Windows apps in it or create new resource group.\n3. Enter the **AccountID**, **ClientID**, **ClientSecret**, **WorkspaceID**, **WorkspaceKey**, **Function Name**  and click Review + create. \n4. Finally click **Create** to deploy."
                },
                {
                  "title": "Option 2 - Manual Deployment of Azure Functions",
                  "description": "Use the following step-by-step instructions to deploy the Zoom Reports data connector manually with Azure Functions (Deployment via Visual Studio Code).",
                  "instructions": [
                    {
                      "parameters": {
                        "instructionSteps": [
                          {
                            "title": "Step 1 - Deploy a Function App",
                            "description": "**NOTE:** You will need to [prepare VS code](https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-python#prerequisites) for Azure function development.\n\n1. Download the [Azure Function App](https://aka.ms/sentinel-ZoomAPI-functionapp) file. Extract archive to your local development computer.\n2. Start VS Code. Choose File in the main menu and select Open Folder.\n3. Select the top level folder from extracted files.\n4. Choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose the **Deploy to function app** button.\nIf you aren't already signed in, choose the Azure icon in the Activity bar, then in the **Azure: Functions** area, choose **Sign in to Azure**\nIf you're already signed in, go to the next step.\n5. Provide the following information at the prompts:\n\n\ta. **Select folder:** Choose a folder from your workspace or browse to one that contains your function app.\n\n\tb. **Select Subscription:** Choose the subscription to use.\n\n\tc. Select **Create new Function App in Azure** (Don't choose the Advanced option)\n\n\td. **Enter a globally unique name for the function app:** Type a name that is valid in a URL path. The name you type is validated to make sure that it's unique in Azure Functions. (e.g. ZoomXXXXX).\n\n\te. **Select a runtime:** Choose Python 3.11.\n\n\tf. Select a location for new resources. For better performance and lower costs choose the same [region](https://azure.microsoft.com/regions/) where Microsoft Sentinel is located.\n\n6. Deployment will begin. A notification is displayed after your function app is created and the deployment package is applied.\n7. Go to Azure Portal for the Function App configuration"
                          },
                          {
                            "title": "Step 2 - Configure the Function App",
                            "description": "1. In the Function App, select the Function App Name and select **Configuration**.\n2. In the **Application settings** tab, select ** New application setting**.\n3. Add each of the following application settings individually, with their respective string values (case-sensitive): \n\t\tAccountID\n\t\tClientID\n\t\tClientSecret\n\t\tWorkspaceID\n\t\tWorkspaceKey\n\t\tlogAnalyticsUri (optional)\n  Use logAnalyticsUri to override the log analytics API endpoint for dedicated cloud. For example, for public cloud, leave the value empty; for Azure GovUS cloud environment, specify the value in the following format: `https://<CustomerId>.ods.opinsights.azure.us`.\n4. Once all application settings have been entered, click **Save**."
                          }
                        ]
                      },
                      "type": "InstructionStepsGroup"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      }
    ]
  },
  {
    "id": "Zscaler",
    "title": "[Deprecated] Zscaler via Legacy Agent",
    "publisher": "Zscaler",
    "logo": "ZscalerLogo.svg",
    "descriptionMarkdown": "The Zscaler data connector allows you to easily connect your Zscaler Internet Access (ZIA) logs with Microsoft Sentinel, to view dashboards, create custom alerts, and improve investigation.  Using Zscaler on Microsoft Sentinel will provide you more insights into your organizations Internet usage, and will enhance its security operation capabilities.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Zscaler",
        "baseQuery": "\nCommonSecurityLog\n| where DeviceVendor == \"Zscaler\"\n"
      }
    ],
    "sampleQueries": [
      {
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"Zscaler\"\n\n            | sort by TimeGenerated"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "\nCommonSecurityLog\n| where DeviceVendor == \"Zscaler\"\n\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(7d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (Zscaler)",
        "lastDataReceivedQuery": "\nCommonSecurityLog\n| where DeviceVendor == \"Zscaler\"\n\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "1. Linux Syslog agent configuration",
        "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
        "innerSteps": [
          {
            "title": "1.1 Select or create a Linux machine",
            "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
          },
          {
            "title": "1.2 Install the CEF collector on the Linux machine",
            "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python --version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
            "instructions": [
              {
                "parameters": {
                  "fillWith": [
                    "WorkspaceId",
                    "PrimaryKey"
                  ],
                  "label": "Run the following command to install and apply the CEF collector:",
                  "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                },
                "type": "CopyableLabel"
              }
            ]
          }
        ]
      },
      {
        "title": "2. Forward Common Event Format (CEF) logs to Syslog agent",
        "description": "Set Zscaler product to send Syslog messages in CEF format to your Syslog agent. Make sure you to send the logs on port 514 TCP. \n\nGo to [Zscaler Microsoft Sentinel integration guide](https://aka.ms/ZscalerCEFInstructions) to learn more."
      },
      {
        "title": "3. Validate connection",
        "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python --version\n\n>2. You must have elevated permissions (sudo) on your machine",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Run the following command to validate your connectivity:",
              "value": "sudo wget -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
            },
            "type": "CopyableLabel"
          }
        ]
      },
      {
        "title": "4. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "4621323a-6201-4731-966c-012e4f2505be",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Zscaler"
      },
      "support": {
        "name": "Zscaler",
        "link": "https://help.zscaler.com/submit-ticket-links",
        "tier": "developer"
      }
    }
  },
  {
    "id": "ZscalerAma",
    "title": "[Deprecated] Zscaler via AMA",
    "publisher": "Zscaler",
    "logo": "ZscalerLogo.svg",
    "descriptionMarkdown": "The Zscaler data connector allows you to easily connect your Zscaler Internet Access (ZIA) logs with Microsoft Sentinel, to view dashboards, create custom alerts, and improve investigation.  Using Zscaler on Microsoft Sentinel will provide you more insights into your organizations Internet usage, and will enhance its security operation capabilities.",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "Zscaler",
        "baseQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Zscaler'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)"
      }
    ],
    "sampleQueries": [
      {
        "query": "\nCommonSecurityLog\n| where DeviceVendor == \"Zscaler\"\n\n            | sort by TimeGenerated"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "CommonSecurityLog\n |where DeviceVendor =~ 'Zscaler'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n | summarize LastLogReceived = max(TimeGenerated)\n | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "dataTypes": [
      {
        "name": "CommonSecurityLog (Zscaler)",
        "lastDataReceivedQuery": "CommonSecurityLog\n |where DeviceVendor =~ 'Zscaler'\n  |extend sent_by_ama = column_ifexists('CollectorHostName','')\n |where isnotempty(sent_by_ama)\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "read": true,
            "write": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ],
      "customs": [
        {
          "description": "To collect data from non-Azure VMs, they must have Azure Arc installed and enabled. [Learn more](https://docs.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-install?tabs=ARMAgentPowerShell,PowerShellWindows,PowerShellWindowsArc,CLIWindows,CLIWindowsArc)"
        },
        {
          "description": "Common Event Format (CEF) via AMA and Syslog via AMA data connectors must be installed [Learn more](https://learn.microsoft.com/azure/sentinel/connect-cef-ama#open-the-connector-page-and-create-the-dcr)"
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": "",
        "instructions": [
          {
            "parameters": {
              "title": "1. Kindly follow the steps to configure the data connector",
              "instructionSteps": [
                {
                  "title": "Step A. Configure the Common Event Format (CEF) via AMA data connector",
                  "description": "_Note:- CEF logs are collected only from Linux Agents_\n\n1. Navigate to Microsoft Sentinel workspace ---> configuration ---> Data connector blade .\n\n2. Search for 'Common Event Format (CEF) via AMA' data connector and open it.\n\n3. Check If there is no existing DCR configured to collect required facility of logs, Create a new DCR (Data Collection Rule)\n\n\t_Note:- It is recommended to install minimum 1.27 version of AMA agent [Learn more](https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal ) and ensure there is no duplicate DCR as it can cause log duplicacy_\n\n4. Run the command provided in the CEF via AMA data connector page to configure the CEF collector on the machine"
                },
                {
                  "title": "Step B. Forward Common Event Format (CEF) logs to Syslog agent",
                  "description": "Set Zscaler product to send Syslog messages in CEF format to your Syslog agent. Make sure you to send the logs on port 514 TCP. \n\nGo to [Zscaler Microsoft Sentinel integration guide](https://aka.ms/ZscalerCEFInstructions) to learn more."
                },
                {
                  "title": "Step C. Validate connection",
                  "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\nIt may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n 1. Make sure that you have Python on your machine using the following command: python -version\n\n2. You must have elevated permissions (sudo) on your machine",
                  "instructions": [
                    {
                      "parameters": {
                        "label": "Run the following command to validate your connectivity:",
                        "value": "sudo wget -O Sentinel_AMA_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/Syslog/Sentinel_AMA_troubleshoot.py&&sudo python Sentinel_AMA_troubleshoot.py --cef"
                      },
                      "type": "CopyableLabel"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Secure your machine ",
        "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)"
      }
    ],
    "metadata": {
      "id": "4621323a-6201-4731-966c-012e4f2505be",
      "version": "1.0.0",
      "kind": "dataConnector",
      "source": {
        "kind": "community"
      },
      "author": {
        "name": "Zscaler"
      },
      "support": {
        "name": "Zscaler",
        "link": "https://help.zscaler.com/submit-ticket-links",
        "tier": "developer"
      }
    }
  },
  {
    "id": "ZscalerPrivateAccess",
    "title": "[Deprecated] Zscaler Private Access",
    "publisher": "Zscaler",
    "descriptionMarkdown": "The [Zscaler Private Access (ZPA)](https://help.zscaler.com/zpa/what-zscaler-private-access) data connector provides the capability to ingest [Zscaler Private Access events](https://help.zscaler.com/zpa/log-streaming-service) into Microsoft Sentinel. Refer to [Zscaler Private Access documentation](https://help.zscaler.com/zpa) for more information.",
    "additionalRequirementBanner": "This data connector depends on a parser based on Kusto Function to work as expected. Follow the steps to use this Kusto Function alias **ZPAEvent** in queries and workbooks. [Follow steps to get this Kusto Function>](https://aka.ms/sentinel-ZscalerPrivateAccess-parser)",
    "graphQueries": [
      {
        "metricName": "Total data received",
        "legend": "ZPA_CL",
        "baseQuery": "ZPA_CL"
      }
    ],
    "sampleQueries": [
      {
        "description": "All logs",
        "query": "\nZPAEvent\n| sort by TimeGenerated"
      }
    ],
    "dataTypes": [
      {
        "name": "ZPA_CL",
        "lastDataReceivedQuery": "ZPA_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
      }
    ],
    "connectivityCriterias": [
      {
        "type": "IsConnectedQuery",
        "value": [
          "ZPA_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
        ]
      }
    ],
    "availability": {
      "status": 1,
      "isPreview": false
    },
    "permissions": {
      "resourceProvider": [
        {
          "provider": "Microsoft.OperationalInsights/workspaces",
          "permissionsDisplayText": "read and write permissions are required.",
          "providerDisplayName": "Workspace",
          "scope": "Workspace",
          "requiredPermissions": {
            "write": true,
            "read": true,
            "delete": true
          }
        },
        {
          "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
          "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
          "providerDisplayName": "Keys",
          "scope": "Workspace",
          "requiredPermissions": {
            "action": true
          }
        }
      ]
    },
    "instructionSteps": [
      {
        "title": "",
        "description": ">**NOTE:** This data connector depends on a parser based on a Kusto Function to work as expected. [Follow these steps](https://aka.ms/sentinel-ZscalerPrivateAccess-parser) to create the Kusto Functions alias, **ZPAEvent**",
        "instructions": []
      },
      {
        "title": "",
        "description": ">**NOTE:** This data connector has been developed using Zscaler Private Access version: 21.67.1",
        "instructions": []
      },
      {
        "title": "1. Install and onboard the agent for Linux or Windows",
        "description": "Install the agent on the Server where the Zscaler Private Access logs are forwarded.\n\n> Logs from Zscaler Private Access Server deployed on Linux or Windows servers are collected by **Linux** or **Windows** agents.",
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Linux agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Linux Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Linux Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnLinuxNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "instructions": [
          {
            "parameters": {
              "title": "Choose where to install the Windows agent:",
              "instructionSteps": [
                {
                  "title": "Install agent on Azure Windows Virtual Machine",
                  "description": "Select the machine to install the agent on and then click **Connect**.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnVirtualMachine"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                },
                {
                  "title": "Install agent on a non-Azure Windows Machine",
                  "description": "Download the agent on the relevant machine and follow the instructions.",
                  "instructions": [
                    {
                      "parameters": {
                        "linkType": "InstallAgentOnNonAzure"
                      },
                      "type": "InstallAgent"
                    }
                  ]
                }
              ]
            },
            "type": "InstructionStepsGroup"
          }
        ]
      },
      {
        "title": "2. Configure the logs to be collected",
        "description": "Follow the configuration steps below to get Zscaler Private Access logs into Microsoft Sentinel. Refer to the [Azure Monitor Documentation](https://docs.microsoft.com/azure/azure-monitor/agents/data-sources-json) for more details on these steps.\nZscaler Private Access logs are delivered via Log Streaming Service (LSS). Refer to [LSS documentation](https://help.zscaler.com/zpa/about-log-streaming-service) for detailed information\n1. Configure [Log Receivers](https://help.zscaler.com/zpa/configuring-log-receiver). While configuring a Log Receiver, choose **JSON** as **Log Template**.\n2. Download config file [zpa.conf](https://aka.ms/sentinel-ZscalerPrivateAccess-conf) \n\t\twget -v https://aka.ms/sentinel-zscalerprivateaccess-conf -O zpa.conf\n3. Login to the server where you have installed Azure Log Analytics agent.\n4. Copy zpa.conf to the /etc/opt/microsoft/omsagent/**workspace_id**/conf/omsagent.d/ folder.\n5. Edit zpa.conf as follows:\n\n\t a. specify port which you have set your Zscaler Log Receivers to forward logs to (line 4)\n\n\t b. zpa.conf uses the port **22033** by default. Ensure this port is not being used by any other source on your server\n\n\t c. If you would like to change the default port for **zpa.conf** make sure that it should not get conflict with default AMA agent ports I.e.(For example CEF uses TCP port **25226** or **25224**) \n\n\t d. replace **workspace_id** with real value of your Workspace ID (lines 14,15,16,19)\n5. Save changes and restart the Azure Log Analytics agent for Linux service with the following command:\n\t\tsudo /opt/microsoft/omsagent/bin/service_control restart",
        "instructions": [
          {
            "parameters": {
              "fillWith": [
                "WorkspaceId"
              ],
              "label": "Workspace ID"
            },
            "type": "CopyableLabel"
          }
        ]
      }
    ]
  }
]
